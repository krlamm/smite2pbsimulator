(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const u of a.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&r(u)}).observe(document,{childList:!0,subtree:!0});function t(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(s){if(s.ep)return;s.ep=!0;const a=t(s);fetch(s.href,a)}})();function DE(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var $p={exports:{}},ru={},Wp={exports:{}},Pe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Gv;function ZA(){if(Gv)return Pe;Gv=1;var n=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),u=Symbol.for("react.context"),h=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),p=Symbol.for("react.memo"),y=Symbol.for("react.lazy"),v=Symbol.iterator;function E(B){return B===null||typeof B!="object"?null:(B=v&&B[v]||B["@@iterator"],typeof B=="function"?B:null)}var S={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},R=Object.assign,N={};function O(B,Q,fe){this.props=B,this.context=Q,this.refs=N,this.updater=fe||S}O.prototype.isReactComponent={},O.prototype.setState=function(B,Q){if(typeof B!="object"&&typeof B!="function"&&B!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,B,Q,"setState")},O.prototype.forceUpdate=function(B){this.updater.enqueueForceUpdate(this,B,"forceUpdate")};function V(){}V.prototype=O.prototype;function K(B,Q,fe){this.props=B,this.context=Q,this.refs=N,this.updater=fe||S}var G=K.prototype=new V;G.constructor=K,R(G,O.prototype),G.isPureReactComponent=!0;var J=Array.isArray,ne=Object.prototype.hasOwnProperty,se={current:null},D={key:!0,ref:!0,__self:!0,__source:!0};function A(B,Q,fe){var ke,Te={},Fe=null,Ge=null;if(Q!=null)for(ke in Q.ref!==void 0&&(Ge=Q.ref),Q.key!==void 0&&(Fe=""+Q.key),Q)ne.call(Q,ke)&&!D.hasOwnProperty(ke)&&(Te[ke]=Q[ke]);var qe=arguments.length-2;if(qe===1)Te.children=fe;else if(1<qe){for(var nt=Array(qe),Mt=0;Mt<qe;Mt++)nt[Mt]=arguments[Mt+2];Te.children=nt}if(B&&B.defaultProps)for(ke in qe=B.defaultProps,qe)Te[ke]===void 0&&(Te[ke]=qe[ke]);return{$$typeof:n,type:B,key:Fe,ref:Ge,props:Te,_owner:se.current}}function k(B,Q){return{$$typeof:n,type:B.type,key:Q,ref:B.ref,props:B.props,_owner:B._owner}}function b(B){return typeof B=="object"&&B!==null&&B.$$typeof===n}function L(B){var Q={"=":"=0",":":"=2"};return"$"+B.replace(/[=:]/g,function(fe){return Q[fe]})}var j=/\/+/g;function x(B,Q){return typeof B=="object"&&B!==null&&B.key!=null?L(""+B.key):Q.toString(36)}function De(B,Q,fe,ke,Te){var Fe=typeof B;(Fe==="undefined"||Fe==="boolean")&&(B=null);var Ge=!1;if(B===null)Ge=!0;else switch(Fe){case"string":case"number":Ge=!0;break;case"object":switch(B.$$typeof){case n:case e:Ge=!0}}if(Ge)return Ge=B,Te=Te(Ge),B=ke===""?"."+x(Ge,0):ke,J(Te)?(fe="",B!=null&&(fe=B.replace(j,"$&/")+"/"),De(Te,Q,fe,"",function(Mt){return Mt})):Te!=null&&(b(Te)&&(Te=k(Te,fe+(!Te.key||Ge&&Ge.key===Te.key?"":(""+Te.key).replace(j,"$&/")+"/")+B)),Q.push(Te)),1;if(Ge=0,ke=ke===""?".":ke+":",J(B))for(var qe=0;qe<B.length;qe++){Fe=B[qe];var nt=ke+x(Fe,qe);Ge+=De(Fe,Q,fe,nt,Te)}else if(nt=E(B),typeof nt=="function")for(B=nt.call(B),qe=0;!(Fe=B.next()).done;)Fe=Fe.value,nt=ke+x(Fe,qe++),Ge+=De(Fe,Q,fe,nt,Te);else if(Fe==="object")throw Q=String(B),Error("Objects are not valid as a React child (found: "+(Q==="[object Object]"?"object with keys {"+Object.keys(B).join(", ")+"}":Q)+"). If you meant to render a collection of children, use an array instead.");return Ge}function Ke(B,Q,fe){if(B==null)return B;var ke=[],Te=0;return De(B,ke,"","",function(Fe){return Q.call(fe,Fe,Te++)}),ke}function Oe(B){if(B._status===-1){var Q=B._result;Q=Q(),Q.then(function(fe){(B._status===0||B._status===-1)&&(B._status=1,B._result=fe)},function(fe){(B._status===0||B._status===-1)&&(B._status=2,B._result=fe)}),B._status===-1&&(B._status=0,B._result=Q)}if(B._status===1)return B._result.default;throw B._result}var xe={current:null},ie={transition:null},ce={ReactCurrentDispatcher:xe,ReactCurrentBatchConfig:ie,ReactCurrentOwner:se};function ae(){throw Error("act(...) is not supported in production builds of React.")}return Pe.Children={map:Ke,forEach:function(B,Q,fe){Ke(B,function(){Q.apply(this,arguments)},fe)},count:function(B){var Q=0;return Ke(B,function(){Q++}),Q},toArray:function(B){return Ke(B,function(Q){return Q})||[]},only:function(B){if(!b(B))throw Error("React.Children.only expected to receive a single React element child.");return B}},Pe.Component=O,Pe.Fragment=t,Pe.Profiler=s,Pe.PureComponent=K,Pe.StrictMode=r,Pe.Suspense=f,Pe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ce,Pe.act=ae,Pe.cloneElement=function(B,Q,fe){if(B==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+B+".");var ke=R({},B.props),Te=B.key,Fe=B.ref,Ge=B._owner;if(Q!=null){if(Q.ref!==void 0&&(Fe=Q.ref,Ge=se.current),Q.key!==void 0&&(Te=""+Q.key),B.type&&B.type.defaultProps)var qe=B.type.defaultProps;for(nt in Q)ne.call(Q,nt)&&!D.hasOwnProperty(nt)&&(ke[nt]=Q[nt]===void 0&&qe!==void 0?qe[nt]:Q[nt])}var nt=arguments.length-2;if(nt===1)ke.children=fe;else if(1<nt){qe=Array(nt);for(var Mt=0;Mt<nt;Mt++)qe[Mt]=arguments[Mt+2];ke.children=qe}return{$$typeof:n,type:B.type,key:Te,ref:Fe,props:ke,_owner:Ge}},Pe.createContext=function(B){return B={$$typeof:u,_currentValue:B,_currentValue2:B,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},B.Provider={$$typeof:a,_context:B},B.Consumer=B},Pe.createElement=A,Pe.createFactory=function(B){var Q=A.bind(null,B);return Q.type=B,Q},Pe.createRef=function(){return{current:null}},Pe.forwardRef=function(B){return{$$typeof:h,render:B}},Pe.isValidElement=b,Pe.lazy=function(B){return{$$typeof:y,_payload:{_status:-1,_result:B},_init:Oe}},Pe.memo=function(B,Q){return{$$typeof:p,type:B,compare:Q===void 0?null:Q}},Pe.startTransition=function(B){var Q=ie.transition;ie.transition={};try{B()}finally{ie.transition=Q}},Pe.unstable_act=ae,Pe.useCallback=function(B,Q){return xe.current.useCallback(B,Q)},Pe.useContext=function(B){return xe.current.useContext(B)},Pe.useDebugValue=function(){},Pe.useDeferredValue=function(B){return xe.current.useDeferredValue(B)},Pe.useEffect=function(B,Q){return xe.current.useEffect(B,Q)},Pe.useId=function(){return xe.current.useId()},Pe.useImperativeHandle=function(B,Q,fe){return xe.current.useImperativeHandle(B,Q,fe)},Pe.useInsertionEffect=function(B,Q){return xe.current.useInsertionEffect(B,Q)},Pe.useLayoutEffect=function(B,Q){return xe.current.useLayoutEffect(B,Q)},Pe.useMemo=function(B,Q){return xe.current.useMemo(B,Q)},Pe.useReducer=function(B,Q,fe){return xe.current.useReducer(B,Q,fe)},Pe.useRef=function(B){return xe.current.useRef(B)},Pe.useState=function(B){return xe.current.useState(B)},Pe.useSyncExternalStore=function(B,Q,fe){return xe.current.useSyncExternalStore(B,Q,fe)},Pe.useTransition=function(){return xe.current.useTransition()},Pe.version="18.3.1",Pe}var qv;function sg(){return qv||(qv=1,Wp.exports=ZA()),Wp.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Kv;function ek(){if(Kv)return ru;Kv=1;var n=sg(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,s=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,a={key:!0,ref:!0,__self:!0,__source:!0};function u(h,f,p){var y,v={},E=null,S=null;p!==void 0&&(E=""+p),f.key!==void 0&&(E=""+f.key),f.ref!==void 0&&(S=f.ref);for(y in f)r.call(f,y)&&!a.hasOwnProperty(y)&&(v[y]=f[y]);if(h&&h.defaultProps)for(y in f=h.defaultProps,f)v[y]===void 0&&(v[y]=f[y]);return{$$typeof:e,type:h,key:E,ref:S,props:v,_owner:s.current}}return ru.Fragment=t,ru.jsx=u,ru.jsxs=u,ru}var Qv;function tk(){return Qv||(Qv=1,$p.exports=ek()),$p.exports}var I=tk(),U=sg();const xr=DE(U);var kh={},Hp={exports:{}},wn={},Gp={exports:{}},qp={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Yv;function nk(){return Yv||(Yv=1,function(n){function e(ie,ce){var ae=ie.length;ie.push(ce);e:for(;0<ae;){var B=ae-1>>>1,Q=ie[B];if(0<s(Q,ce))ie[B]=ce,ie[ae]=Q,ae=B;else break e}}function t(ie){return ie.length===0?null:ie[0]}function r(ie){if(ie.length===0)return null;var ce=ie[0],ae=ie.pop();if(ae!==ce){ie[0]=ae;e:for(var B=0,Q=ie.length,fe=Q>>>1;B<fe;){var ke=2*(B+1)-1,Te=ie[ke],Fe=ke+1,Ge=ie[Fe];if(0>s(Te,ae))Fe<Q&&0>s(Ge,Te)?(ie[B]=Ge,ie[Fe]=ae,B=Fe):(ie[B]=Te,ie[ke]=ae,B=ke);else if(Fe<Q&&0>s(Ge,ae))ie[B]=Ge,ie[Fe]=ae,B=Fe;else break e}}return ce}function s(ie,ce){var ae=ie.sortIndex-ce.sortIndex;return ae!==0?ae:ie.id-ce.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;n.unstable_now=function(){return a.now()}}else{var u=Date,h=u.now();n.unstable_now=function(){return u.now()-h}}var f=[],p=[],y=1,v=null,E=3,S=!1,R=!1,N=!1,O=typeof setTimeout=="function"?setTimeout:null,V=typeof clearTimeout=="function"?clearTimeout:null,K=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function G(ie){for(var ce=t(p);ce!==null;){if(ce.callback===null)r(p);else if(ce.startTime<=ie)r(p),ce.sortIndex=ce.expirationTime,e(f,ce);else break;ce=t(p)}}function J(ie){if(N=!1,G(ie),!R)if(t(f)!==null)R=!0,Oe(ne);else{var ce=t(p);ce!==null&&xe(J,ce.startTime-ie)}}function ne(ie,ce){R=!1,N&&(N=!1,V(A),A=-1),S=!0;var ae=E;try{for(G(ce),v=t(f);v!==null&&(!(v.expirationTime>ce)||ie&&!L());){var B=v.callback;if(typeof B=="function"){v.callback=null,E=v.priorityLevel;var Q=B(v.expirationTime<=ce);ce=n.unstable_now(),typeof Q=="function"?v.callback=Q:v===t(f)&&r(f),G(ce)}else r(f);v=t(f)}if(v!==null)var fe=!0;else{var ke=t(p);ke!==null&&xe(J,ke.startTime-ce),fe=!1}return fe}finally{v=null,E=ae,S=!1}}var se=!1,D=null,A=-1,k=5,b=-1;function L(){return!(n.unstable_now()-b<k)}function j(){if(D!==null){var ie=n.unstable_now();b=ie;var ce=!0;try{ce=D(!0,ie)}finally{ce?x():(se=!1,D=null)}}else se=!1}var x;if(typeof K=="function")x=function(){K(j)};else if(typeof MessageChannel<"u"){var De=new MessageChannel,Ke=De.port2;De.port1.onmessage=j,x=function(){Ke.postMessage(null)}}else x=function(){O(j,0)};function Oe(ie){D=ie,se||(se=!0,x())}function xe(ie,ce){A=O(function(){ie(n.unstable_now())},ce)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(ie){ie.callback=null},n.unstable_continueExecution=function(){R||S||(R=!0,Oe(ne))},n.unstable_forceFrameRate=function(ie){0>ie||125<ie?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):k=0<ie?Math.floor(1e3/ie):5},n.unstable_getCurrentPriorityLevel=function(){return E},n.unstable_getFirstCallbackNode=function(){return t(f)},n.unstable_next=function(ie){switch(E){case 1:case 2:case 3:var ce=3;break;default:ce=E}var ae=E;E=ce;try{return ie()}finally{E=ae}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(ie,ce){switch(ie){case 1:case 2:case 3:case 4:case 5:break;default:ie=3}var ae=E;E=ie;try{return ce()}finally{E=ae}},n.unstable_scheduleCallback=function(ie,ce,ae){var B=n.unstable_now();switch(typeof ae=="object"&&ae!==null?(ae=ae.delay,ae=typeof ae=="number"&&0<ae?B+ae:B):ae=B,ie){case 1:var Q=-1;break;case 2:Q=250;break;case 5:Q=1073741823;break;case 4:Q=1e4;break;default:Q=5e3}return Q=ae+Q,ie={id:y++,callback:ce,priorityLevel:ie,startTime:ae,expirationTime:Q,sortIndex:-1},ae>B?(ie.sortIndex=ae,e(p,ie),t(f)===null&&ie===t(p)&&(N?(V(A),A=-1):N=!0,xe(J,ae-B))):(ie.sortIndex=Q,e(f,ie),R||S||(R=!0,Oe(ne))),ie},n.unstable_shouldYield=L,n.unstable_wrapCallback=function(ie){var ce=E;return function(){var ae=E;E=ce;try{return ie.apply(this,arguments)}finally{E=ae}}}}(qp)),qp}var Jv;function rk(){return Jv||(Jv=1,Gp.exports=nk()),Gp.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Xv;function ik(){if(Xv)return wn;Xv=1;var n=sg(),e=rk();function t(i){for(var o="https://reactjs.org/docs/error-decoder.html?invariant="+i,l=1;l<arguments.length;l++)o+="&args[]="+encodeURIComponent(arguments[l]);return"Minified React error #"+i+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var r=new Set,s={};function a(i,o){u(i,o),u(i+"Capture",o)}function u(i,o){for(s[i]=o,i=0;i<o.length;i++)r.add(o[i])}var h=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),f=Object.prototype.hasOwnProperty,p=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,y={},v={};function E(i){return f.call(v,i)?!0:f.call(y,i)?!1:p.test(i)?v[i]=!0:(y[i]=!0,!1)}function S(i,o,l,d){if(l!==null&&l.type===0)return!1;switch(typeof o){case"function":case"symbol":return!0;case"boolean":return d?!1:l!==null?!l.acceptsBooleans:(i=i.toLowerCase().slice(0,5),i!=="data-"&&i!=="aria-");default:return!1}}function R(i,o,l,d){if(o===null||typeof o>"u"||S(i,o,l,d))return!0;if(d)return!1;if(l!==null)switch(l.type){case 3:return!o;case 4:return o===!1;case 5:return isNaN(o);case 6:return isNaN(o)||1>o}return!1}function N(i,o,l,d,m,_,T){this.acceptsBooleans=o===2||o===3||o===4,this.attributeName=d,this.attributeNamespace=m,this.mustUseProperty=l,this.propertyName=i,this.type=o,this.sanitizeURL=_,this.removeEmptyString=T}var O={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(i){O[i]=new N(i,0,!1,i,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(i){var o=i[0];O[o]=new N(o,1,!1,i[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(i){O[i]=new N(i,2,!1,i.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(i){O[i]=new N(i,2,!1,i,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(i){O[i]=new N(i,3,!1,i.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(i){O[i]=new N(i,3,!0,i,null,!1,!1)}),["capture","download"].forEach(function(i){O[i]=new N(i,4,!1,i,null,!1,!1)}),["cols","rows","size","span"].forEach(function(i){O[i]=new N(i,6,!1,i,null,!1,!1)}),["rowSpan","start"].forEach(function(i){O[i]=new N(i,5,!1,i.toLowerCase(),null,!1,!1)});var V=/[\-:]([a-z])/g;function K(i){return i[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(i){var o=i.replace(V,K);O[o]=new N(o,1,!1,i,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(i){var o=i.replace(V,K);O[o]=new N(o,1,!1,i,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(i){var o=i.replace(V,K);O[o]=new N(o,1,!1,i,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(i){O[i]=new N(i,1,!1,i.toLowerCase(),null,!1,!1)}),O.xlinkHref=new N("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(i){O[i]=new N(i,1,!1,i.toLowerCase(),null,!0,!0)});function G(i,o,l,d){var m=O.hasOwnProperty(o)?O[o]:null;(m!==null?m.type!==0:d||!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(R(o,l,m,d)&&(l=null),d||m===null?E(o)&&(l===null?i.removeAttribute(o):i.setAttribute(o,""+l)):m.mustUseProperty?i[m.propertyName]=l===null?m.type===3?!1:"":l:(o=m.attributeName,d=m.attributeNamespace,l===null?i.removeAttribute(o):(m=m.type,l=m===3||m===4&&l===!0?"":""+l,d?i.setAttributeNS(d,o,l):i.setAttribute(o,l))))}var J=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ne=Symbol.for("react.element"),se=Symbol.for("react.portal"),D=Symbol.for("react.fragment"),A=Symbol.for("react.strict_mode"),k=Symbol.for("react.profiler"),b=Symbol.for("react.provider"),L=Symbol.for("react.context"),j=Symbol.for("react.forward_ref"),x=Symbol.for("react.suspense"),De=Symbol.for("react.suspense_list"),Ke=Symbol.for("react.memo"),Oe=Symbol.for("react.lazy"),xe=Symbol.for("react.offscreen"),ie=Symbol.iterator;function ce(i){return i===null||typeof i!="object"?null:(i=ie&&i[ie]||i["@@iterator"],typeof i=="function"?i:null)}var ae=Object.assign,B;function Q(i){if(B===void 0)try{throw Error()}catch(l){var o=l.stack.trim().match(/\n( *(at )?)/);B=o&&o[1]||""}return`
`+B+i}var fe=!1;function ke(i,o){if(!i||fe)return"";fe=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(o)if(o=function(){throw Error()},Object.defineProperty(o.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(o,[])}catch(H){var d=H}Reflect.construct(i,[],o)}else{try{o.call()}catch(H){d=H}i.call(o.prototype)}else{try{throw Error()}catch(H){d=H}i()}}catch(H){if(H&&d&&typeof H.stack=="string"){for(var m=H.stack.split(`
`),_=d.stack.split(`
`),T=m.length-1,P=_.length-1;1<=T&&0<=P&&m[T]!==_[P];)P--;for(;1<=T&&0<=P;T--,P--)if(m[T]!==_[P]){if(T!==1||P!==1)do if(T--,P--,0>P||m[T]!==_[P]){var M=`
`+m[T].replace(" at new "," at ");return i.displayName&&M.includes("<anonymous>")&&(M=M.replace("<anonymous>",i.displayName)),M}while(1<=T&&0<=P);break}}}finally{fe=!1,Error.prepareStackTrace=l}return(i=i?i.displayName||i.name:"")?Q(i):""}function Te(i){switch(i.tag){case 5:return Q(i.type);case 16:return Q("Lazy");case 13:return Q("Suspense");case 19:return Q("SuspenseList");case 0:case 2:case 15:return i=ke(i.type,!1),i;case 11:return i=ke(i.type.render,!1),i;case 1:return i=ke(i.type,!0),i;default:return""}}function Fe(i){if(i==null)return null;if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case D:return"Fragment";case se:return"Portal";case k:return"Profiler";case A:return"StrictMode";case x:return"Suspense";case De:return"SuspenseList"}if(typeof i=="object")switch(i.$$typeof){case L:return(i.displayName||"Context")+".Consumer";case b:return(i._context.displayName||"Context")+".Provider";case j:var o=i.render;return i=i.displayName,i||(i=o.displayName||o.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case Ke:return o=i.displayName||null,o!==null?o:Fe(i.type)||"Memo";case Oe:o=i._payload,i=i._init;try{return Fe(i(o))}catch{}}return null}function Ge(i){var o=i.type;switch(i.tag){case 24:return"Cache";case 9:return(o.displayName||"Context")+".Consumer";case 10:return(o._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return i=o.render,i=i.displayName||i.name||"",o.displayName||(i!==""?"ForwardRef("+i+")":"ForwardRef");case 7:return"Fragment";case 5:return o;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Fe(o);case 8:return o===A?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof o=="function")return o.displayName||o.name||null;if(typeof o=="string")return o}return null}function qe(i){switch(typeof i){case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function nt(i){var o=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function Mt(i){var o=nt(i)?"checked":"value",l=Object.getOwnPropertyDescriptor(i.constructor.prototype,o),d=""+i[o];if(!i.hasOwnProperty(o)&&typeof l<"u"&&typeof l.get=="function"&&typeof l.set=="function"){var m=l.get,_=l.set;return Object.defineProperty(i,o,{configurable:!0,get:function(){return m.call(this)},set:function(T){d=""+T,_.call(this,T)}}),Object.defineProperty(i,o,{enumerable:l.enumerable}),{getValue:function(){return d},setValue:function(T){d=""+T},stopTracking:function(){i._valueTracker=null,delete i[o]}}}}function $r(i){i._valueTracker||(i._valueTracker=Mt(i))}function Ro(i){if(!i)return!1;var o=i._valueTracker;if(!o)return!0;var l=o.getValue(),d="";return i&&(d=nt(i)?i.checked?"true":"false":i.value),i=d,i!==l?(o.setValue(i),!0):!1}function ki(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}function Rs(i,o){var l=o.checked;return ae({},o,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:l??i._wrapperState.initialChecked})}function xo(i,o){var l=o.defaultValue==null?"":o.defaultValue,d=o.checked!=null?o.checked:o.defaultChecked;l=qe(o.value!=null?o.value:l),i._wrapperState={initialChecked:d,initialValue:l,controlled:o.type==="checkbox"||o.type==="radio"?o.checked!=null:o.value!=null}}function ul(i,o){o=o.checked,o!=null&&G(i,"checked",o,!1)}function cl(i,o){ul(i,o);var l=qe(o.value),d=o.type;if(l!=null)d==="number"?(l===0&&i.value===""||i.value!=l)&&(i.value=""+l):i.value!==""+l&&(i.value=""+l);else if(d==="submit"||d==="reset"){i.removeAttribute("value");return}o.hasOwnProperty("value")?Po(i,o.type,l):o.hasOwnProperty("defaultValue")&&Po(i,o.type,qe(o.defaultValue)),o.checked==null&&o.defaultChecked!=null&&(i.defaultChecked=!!o.defaultChecked)}function dc(i,o,l){if(o.hasOwnProperty("value")||o.hasOwnProperty("defaultValue")){var d=o.type;if(!(d!=="submit"&&d!=="reset"||o.value!==void 0&&o.value!==null))return;o=""+i._wrapperState.initialValue,l||o===i.value||(i.value=o),i.defaultValue=o}l=i.name,l!==""&&(i.name=""),i.defaultChecked=!!i._wrapperState.initialChecked,l!==""&&(i.name=l)}function Po(i,o,l){(o!=="number"||ki(i.ownerDocument)!==i)&&(l==null?i.defaultValue=""+i._wrapperState.initialValue:i.defaultValue!==""+l&&(i.defaultValue=""+l))}var Wr=Array.isArray;function Hr(i,o,l,d){if(i=i.options,o){o={};for(var m=0;m<l.length;m++)o["$"+l[m]]=!0;for(l=0;l<i.length;l++)m=o.hasOwnProperty("$"+i[l].value),i[l].selected!==m&&(i[l].selected=m),m&&d&&(i[l].defaultSelected=!0)}else{for(l=""+qe(l),o=null,m=0;m<i.length;m++){if(i[m].value===l){i[m].selected=!0,d&&(i[m].defaultSelected=!0);return}o!==null||i[m].disabled||(o=i[m])}o!==null&&(o.selected=!0)}}function hl(i,o){if(o.dangerouslySetInnerHTML!=null)throw Error(t(91));return ae({},o,{value:void 0,defaultValue:void 0,children:""+i._wrapperState.initialValue})}function bo(i,o){var l=o.value;if(l==null){if(l=o.children,o=o.defaultValue,l!=null){if(o!=null)throw Error(t(92));if(Wr(l)){if(1<l.length)throw Error(t(93));l=l[0]}o=l}o==null&&(o=""),l=o}i._wrapperState={initialValue:qe(l)}}function No(i,o){var l=qe(o.value),d=qe(o.defaultValue);l!=null&&(l=""+l,l!==i.value&&(i.value=l),o.defaultValue==null&&i.defaultValue!==l&&(i.defaultValue=l)),d!=null&&(i.defaultValue=""+d)}function dl(i){var o=i.textContent;o===i._wrapperState.initialValue&&o!==""&&o!==null&&(i.value=o)}function Pt(i){switch(i){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function bt(i,o){return i==null||i==="http://www.w3.org/1999/xhtml"?Pt(o):i==="http://www.w3.org/2000/svg"&&o==="foreignObject"?"http://www.w3.org/1999/xhtml":i}var Gr,fl=function(i){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(o,l,d,m){MSApp.execUnsafeLocalFunction(function(){return i(o,l,d,m)})}:i}(function(i,o){if(i.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in i)i.innerHTML=o;else{for(Gr=Gr||document.createElement("div"),Gr.innerHTML="<svg>"+o.valueOf().toString()+"</svg>",o=Gr.firstChild;i.firstChild;)i.removeChild(i.firstChild);for(;o.firstChild;)i.appendChild(o.firstChild)}});function Ri(i,o){if(o){var l=i.firstChild;if(l&&l===i.lastChild&&l.nodeType===3){l.nodeValue=o;return}}i.textContent=o}var xs={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Ps=["Webkit","ms","Moz","O"];Object.keys(xs).forEach(function(i){Ps.forEach(function(o){o=o+i.charAt(0).toUpperCase()+i.substring(1),xs[o]=xs[i]})});function pl(i,o,l){return o==null||typeof o=="boolean"||o===""?"":l||typeof o!="number"||o===0||xs.hasOwnProperty(i)&&xs[i]?(""+o).trim():o+"px"}function ml(i,o){i=i.style;for(var l in o)if(o.hasOwnProperty(l)){var d=l.indexOf("--")===0,m=pl(l,o[l],d);l==="float"&&(l="cssFloat"),d?i.setProperty(l,m):i[l]=m}}var gl=ae({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function _l(i,o){if(o){if(gl[i]&&(o.children!=null||o.dangerouslySetInnerHTML!=null))throw Error(t(137,i));if(o.dangerouslySetInnerHTML!=null){if(o.children!=null)throw Error(t(60));if(typeof o.dangerouslySetInnerHTML!="object"||!("__html"in o.dangerouslySetInnerHTML))throw Error(t(61))}if(o.style!=null&&typeof o.style!="object")throw Error(t(62))}}function yl(i,o){if(i.indexOf("-")===-1)return typeof o.is=="string";switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var bs=null;function Do(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var Oo=null,Vn=null,gr=null;function Lo(i){if(i=zl(i)){if(typeof Oo!="function")throw Error(t(280));var o=i.stateNode;o&&(o=zc(o),Oo(i.stateNode,i.type,o))}}function _r(i){Vn?gr?gr.push(i):gr=[i]:Vn=i}function vl(){if(Vn){var i=Vn,o=gr;if(gr=Vn=null,Lo(i),o)for(i=0;i<o.length;i++)Lo(o[i])}}function Ns(i,o){return i(o)}function wl(){}var qr=!1;function El(i,o,l){if(qr)return i(o,l);qr=!0;try{return Ns(i,o,l)}finally{qr=!1,(Vn!==null||gr!==null)&&(wl(),vl())}}function _t(i,o){var l=i.stateNode;if(l===null)return null;var d=zc(l);if(d===null)return null;l=d[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(d=!d.disabled)||(i=i.type,d=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!d;break e;default:i=!1}if(i)return null;if(l&&typeof l!="function")throw Error(t(231,o,typeof l));return l}var Mo=!1;if(h)try{var Qn={};Object.defineProperty(Qn,"passive",{get:function(){Mo=!0}}),window.addEventListener("test",Qn,Qn),window.removeEventListener("test",Qn,Qn)}catch{Mo=!1}function Ds(i,o,l,d,m,_,T,P,M){var H=Array.prototype.slice.call(arguments,3);try{o.apply(l,H)}catch(ee){this.onError(ee)}}var Os=!1,Vo=null,Yn=!1,Tl=null,_f={onError:function(i){Os=!0,Vo=i}};function Fo(i,o,l,d,m,_,T,P,M){Os=!1,Vo=null,Ds.apply(_f,arguments)}function fc(i,o,l,d,m,_,T,P,M){if(Fo.apply(this,arguments),Os){if(Os){var H=Vo;Os=!1,Vo=null}else throw Error(t(198));Yn||(Yn=!0,Tl=H)}}function Jn(i){var o=i,l=i;if(i.alternate)for(;o.return;)o=o.return;else{i=o;do o=i,(o.flags&4098)!==0&&(l=o.return),i=o.return;while(i)}return o.tag===3?l:null}function Ls(i){if(i.tag===13){var o=i.memoizedState;if(o===null&&(i=i.alternate,i!==null&&(o=i.memoizedState)),o!==null)return o.dehydrated}return null}function Xn(i){if(Jn(i)!==i)throw Error(t(188))}function pc(i){var o=i.alternate;if(!o){if(o=Jn(i),o===null)throw Error(t(188));return o!==i?null:i}for(var l=i,d=o;;){var m=l.return;if(m===null)break;var _=m.alternate;if(_===null){if(d=m.return,d!==null){l=d;continue}break}if(m.child===_.child){for(_=m.child;_;){if(_===l)return Xn(m),i;if(_===d)return Xn(m),o;_=_.sibling}throw Error(t(188))}if(l.return!==d.return)l=m,d=_;else{for(var T=!1,P=m.child;P;){if(P===l){T=!0,l=m,d=_;break}if(P===d){T=!0,d=m,l=_;break}P=P.sibling}if(!T){for(P=_.child;P;){if(P===l){T=!0,l=_,d=m;break}if(P===d){T=!0,d=_,l=m;break}P=P.sibling}if(!T)throw Error(t(189))}}if(l.alternate!==d)throw Error(t(190))}if(l.tag!==3)throw Error(t(188));return l.stateNode.current===l?i:o}function Il(i){return i=pc(i),i!==null?jo(i):null}function jo(i){if(i.tag===5||i.tag===6)return i;for(i=i.child;i!==null;){var o=jo(i);if(o!==null)return o;i=i.sibling}return null}var Uo=e.unstable_scheduleCallback,Cl=e.unstable_cancelCallback,mc=e.unstable_shouldYield,yf=e.unstable_requestPaint,rt=e.unstable_now,gc=e.unstable_getCurrentPriorityLevel,Ms=e.unstable_ImmediatePriority,xi=e.unstable_UserBlockingPriority,Fn=e.unstable_NormalPriority,Sl=e.unstable_LowPriority,_c=e.unstable_IdlePriority,Vs=null,An=null;function yc(i){if(An&&typeof An.onCommitFiberRoot=="function")try{An.onCommitFiberRoot(Vs,i,void 0,(i.current.flags&128)===128)}catch{}}var ln=Math.clz32?Math.clz32:wc,Al=Math.log,vc=Math.LN2;function wc(i){return i>>>=0,i===0?32:31-(Al(i)/vc|0)|0}var Bo=64,zo=4194304;function Pi(i){switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return i&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return i}}function Fs(i,o){var l=i.pendingLanes;if(l===0)return 0;var d=0,m=i.suspendedLanes,_=i.pingedLanes,T=l&268435455;if(T!==0){var P=T&~m;P!==0?d=Pi(P):(_&=T,_!==0&&(d=Pi(_)))}else T=l&~m,T!==0?d=Pi(T):_!==0&&(d=Pi(_));if(d===0)return 0;if(o!==0&&o!==d&&(o&m)===0&&(m=d&-d,_=o&-o,m>=_||m===16&&(_&4194240)!==0))return o;if((d&4)!==0&&(d|=l&16),o=i.entangledLanes,o!==0)for(i=i.entanglements,o&=d;0<o;)l=31-ln(o),m=1<<l,d|=i[l],o&=~m;return d}function vf(i,o){switch(i){case 1:case 2:case 4:return o+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Kr(i,o){for(var l=i.suspendedLanes,d=i.pingedLanes,m=i.expirationTimes,_=i.pendingLanes;0<_;){var T=31-ln(_),P=1<<T,M=m[T];M===-1?((P&l)===0||(P&d)!==0)&&(m[T]=vf(P,o)):M<=o&&(i.expiredLanes|=P),_&=~P}}function kn(i){return i=i.pendingLanes&-1073741825,i!==0?i:i&1073741824?1073741824:0}function js(){var i=Bo;return Bo<<=1,(Bo&4194240)===0&&(Bo=64),i}function bi(i){for(var o=[],l=0;31>l;l++)o.push(i);return o}function Ni(i,o,l){i.pendingLanes|=o,o!==536870912&&(i.suspendedLanes=0,i.pingedLanes=0),i=i.eventTimes,o=31-ln(o),i[o]=l}function et(i,o){var l=i.pendingLanes&~o;i.pendingLanes=o,i.suspendedLanes=0,i.pingedLanes=0,i.expiredLanes&=o,i.mutableReadLanes&=o,i.entangledLanes&=o,o=i.entanglements;var d=i.eventTimes;for(i=i.expirationTimes;0<l;){var m=31-ln(l),_=1<<m;o[m]=0,d[m]=-1,i[m]=-1,l&=~_}}function Di(i,o){var l=i.entangledLanes|=o;for(i=i.entanglements;l;){var d=31-ln(l),m=1<<d;m&o|i[d]&o&&(i[d]|=o),l&=~m}}var Ve=0;function Oi(i){return i&=-i,1<i?4<i?(i&268435455)!==0?16:536870912:4:1}var Ec,$o,Tc,Ic,Cc,kl=!1,yr=[],Ht=null,Zn=null,er=null,Li=new Map,jn=new Map,vr=[],wf="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Sc(i,o){switch(i){case"focusin":case"focusout":Ht=null;break;case"dragenter":case"dragleave":Zn=null;break;case"mouseover":case"mouseout":er=null;break;case"pointerover":case"pointerout":Li.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":jn.delete(o.pointerId)}}function fn(i,o,l,d,m,_){return i===null||i.nativeEvent!==_?(i={blockedOn:o,domEventName:l,eventSystemFlags:d,nativeEvent:_,targetContainers:[m]},o!==null&&(o=zl(o),o!==null&&$o(o)),i):(i.eventSystemFlags|=d,o=i.targetContainers,m!==null&&o.indexOf(m)===-1&&o.push(m),i)}function Ef(i,o,l,d,m){switch(o){case"focusin":return Ht=fn(Ht,i,o,l,d,m),!0;case"dragenter":return Zn=fn(Zn,i,o,l,d,m),!0;case"mouseover":return er=fn(er,i,o,l,d,m),!0;case"pointerover":var _=m.pointerId;return Li.set(_,fn(Li.get(_)||null,i,o,l,d,m)),!0;case"gotpointercapture":return _=m.pointerId,jn.set(_,fn(jn.get(_)||null,i,o,l,d,m)),!0}return!1}function Ac(i){var o=Ws(i.target);if(o!==null){var l=Jn(o);if(l!==null){if(o=l.tag,o===13){if(o=Ls(l),o!==null){i.blockedOn=o,Cc(i.priority,function(){Tc(l)});return}}else if(o===3&&l.stateNode.current.memoizedState.isDehydrated){i.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}i.blockedOn=null}function Qr(i){if(i.blockedOn!==null)return!1;for(var o=i.targetContainers;0<o.length;){var l=Wo(i.domEventName,i.eventSystemFlags,o[0],i.nativeEvent);if(l===null){l=i.nativeEvent;var d=new l.constructor(l.type,l);bs=d,l.target.dispatchEvent(d),bs=null}else return o=zl(l),o!==null&&$o(o),i.blockedOn=l,!1;o.shift()}return!0}function Us(i,o,l){Qr(i)&&l.delete(o)}function kc(){kl=!1,Ht!==null&&Qr(Ht)&&(Ht=null),Zn!==null&&Qr(Zn)&&(Zn=null),er!==null&&Qr(er)&&(er=null),Li.forEach(Us),jn.forEach(Us)}function tr(i,o){i.blockedOn===o&&(i.blockedOn=null,kl||(kl=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,kc)))}function nr(i){function o(m){return tr(m,i)}if(0<yr.length){tr(yr[0],i);for(var l=1;l<yr.length;l++){var d=yr[l];d.blockedOn===i&&(d.blockedOn=null)}}for(Ht!==null&&tr(Ht,i),Zn!==null&&tr(Zn,i),er!==null&&tr(er,i),Li.forEach(o),jn.forEach(o),l=0;l<vr.length;l++)d=vr[l],d.blockedOn===i&&(d.blockedOn=null);for(;0<vr.length&&(l=vr[0],l.blockedOn===null);)Ac(l),l.blockedOn===null&&vr.shift()}var Yr=J.ReactCurrentBatchConfig,Mi=!0;function ct(i,o,l,d){var m=Ve,_=Yr.transition;Yr.transition=null;try{Ve=1,Rl(i,o,l,d)}finally{Ve=m,Yr.transition=_}}function Tf(i,o,l,d){var m=Ve,_=Yr.transition;Yr.transition=null;try{Ve=4,Rl(i,o,l,d)}finally{Ve=m,Yr.transition=_}}function Rl(i,o,l,d){if(Mi){var m=Wo(i,o,l,d);if(m===null)Df(i,o,d,Bs,l),Sc(i,d);else if(Ef(m,i,o,l,d))d.stopPropagation();else if(Sc(i,d),o&4&&-1<wf.indexOf(i)){for(;m!==null;){var _=zl(m);if(_!==null&&Ec(_),_=Wo(i,o,l,d),_===null&&Df(i,o,d,Bs,l),_===m)break;m=_}m!==null&&d.stopPropagation()}else Df(i,o,d,null,l)}}var Bs=null;function Wo(i,o,l,d){if(Bs=null,i=Do(d),i=Ws(i),i!==null)if(o=Jn(i),o===null)i=null;else if(l=o.tag,l===13){if(i=Ls(o),i!==null)return i;i=null}else if(l===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;i=null}else o!==i&&(i=null);return Bs=i,null}function xl(i){switch(i){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(gc()){case Ms:return 1;case xi:return 4;case Fn:case Sl:return 16;case _c:return 536870912;default:return 16}default:return 16}}var Rn=null,Ho=null,pn=null;function Pl(){if(pn)return pn;var i,o=Ho,l=o.length,d,m="value"in Rn?Rn.value:Rn.textContent,_=m.length;for(i=0;i<l&&o[i]===m[i];i++);var T=l-i;for(d=1;d<=T&&o[l-d]===m[_-d];d++);return pn=m.slice(i,1<d?1-d:void 0)}function Go(i){var o=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&o===13&&(i=13)):i=o,i===10&&(i=13),32<=i||i===13?i:0}function wr(){return!0}function bl(){return!1}function Gt(i){function o(l,d,m,_,T){this._reactName=l,this._targetInst=m,this.type=d,this.nativeEvent=_,this.target=T,this.currentTarget=null;for(var P in i)i.hasOwnProperty(P)&&(l=i[P],this[P]=l?l(_):_[P]);return this.isDefaultPrevented=(_.defaultPrevented!=null?_.defaultPrevented:_.returnValue===!1)?wr:bl,this.isPropagationStopped=bl,this}return ae(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=wr)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=wr)},persist:function(){},isPersistent:wr}),o}var rr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},qo=Gt(rr),Er=ae({},rr,{view:0,detail:0}),If=Gt(Er),Ko,Jr,Vi,zs=ae({},Er,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Tr,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==Vi&&(Vi&&i.type==="mousemove"?(Ko=i.screenX-Vi.screenX,Jr=i.screenY-Vi.screenY):Jr=Ko=0,Vi=i),Ko)},movementY:function(i){return"movementY"in i?i.movementY:Jr}}),Qo=Gt(zs),Nl=ae({},zs,{dataTransfer:0}),Rc=Gt(Nl),Yo=ae({},Er,{relatedTarget:0}),Jo=Gt(Yo),xc=ae({},rr,{animationName:0,elapsedTime:0,pseudoElement:0}),Xr=Gt(xc),Pc=ae({},rr,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),bc=Gt(Pc),Nc=ae({},rr,{data:0}),Dl=Gt(Nc),Xo={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},un={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Dc={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Oc(i){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(i):(i=Dc[i])?!!o[i]:!1}function Tr(){return Oc}var c=ae({},Er,{key:function(i){if(i.key){var o=Xo[i.key]||i.key;if(o!=="Unidentified")return o}return i.type==="keypress"?(i=Go(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?un[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Tr,charCode:function(i){return i.type==="keypress"?Go(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?Go(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),g=Gt(c),w=ae({},zs,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),C=Gt(w),z=ae({},Er,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Tr}),q=Gt(z),oe=ae({},rr,{propertyName:0,elapsedTime:0,pseudoElement:0}),Ye=Gt(oe),Nt=ae({},zs,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),je=Gt(Nt),Vt=[9,13,27,32],Tt=h&&"CompositionEvent"in window,Un=null;h&&"documentMode"in document&&(Un=document.documentMode);var xn=h&&"TextEvent"in window&&!Un,$s=h&&(!Tt||Un&&8<Un&&11>=Un),Zo=" ",U_=!1;function B_(i,o){switch(i){case"keyup":return Vt.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function z_(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var ea=!1;function YS(i,o){switch(i){case"compositionend":return z_(o);case"keypress":return o.which!==32?null:(U_=!0,Zo);case"textInput":return i=o.data,i===Zo&&U_?null:i;default:return null}}function JS(i,o){if(ea)return i==="compositionend"||!Tt&&B_(i,o)?(i=Pl(),pn=Ho=Rn=null,ea=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return $s&&o.locale!=="ko"?null:o.data;default:return null}}var XS={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function $_(i){var o=i&&i.nodeName&&i.nodeName.toLowerCase();return o==="input"?!!XS[i.type]:o==="textarea"}function W_(i,o,l,d){_r(d),o=jc(o,"onChange"),0<o.length&&(l=new qo("onChange","change",null,l,d),i.push({event:l,listeners:o}))}var Ol=null,Ll=null;function ZS(i){ly(i,0)}function Lc(i){var o=sa(i);if(Ro(o))return i}function eA(i,o){if(i==="change")return o}var H_=!1;if(h){var Cf;if(h){var Sf="oninput"in document;if(!Sf){var G_=document.createElement("div");G_.setAttribute("oninput","return;"),Sf=typeof G_.oninput=="function"}Cf=Sf}else Cf=!1;H_=Cf&&(!document.documentMode||9<document.documentMode)}function q_(){Ol&&(Ol.detachEvent("onpropertychange",K_),Ll=Ol=null)}function K_(i){if(i.propertyName==="value"&&Lc(Ll)){var o=[];W_(o,Ll,i,Do(i)),El(ZS,o)}}function tA(i,o,l){i==="focusin"?(q_(),Ol=o,Ll=l,Ol.attachEvent("onpropertychange",K_)):i==="focusout"&&q_()}function nA(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return Lc(Ll)}function rA(i,o){if(i==="click")return Lc(o)}function iA(i,o){if(i==="input"||i==="change")return Lc(o)}function sA(i,o){return i===o&&(i!==0||1/i===1/o)||i!==i&&o!==o}var ir=typeof Object.is=="function"?Object.is:sA;function Ml(i,o){if(ir(i,o))return!0;if(typeof i!="object"||i===null||typeof o!="object"||o===null)return!1;var l=Object.keys(i),d=Object.keys(o);if(l.length!==d.length)return!1;for(d=0;d<l.length;d++){var m=l[d];if(!f.call(o,m)||!ir(i[m],o[m]))return!1}return!0}function Q_(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function Y_(i,o){var l=Q_(i);i=0;for(var d;l;){if(l.nodeType===3){if(d=i+l.textContent.length,i<=o&&d>=o)return{node:l,offset:o-i};i=d}e:{for(;l;){if(l.nextSibling){l=l.nextSibling;break e}l=l.parentNode}l=void 0}l=Q_(l)}}function J_(i,o){return i&&o?i===o?!0:i&&i.nodeType===3?!1:o&&o.nodeType===3?J_(i,o.parentNode):"contains"in i?i.contains(o):i.compareDocumentPosition?!!(i.compareDocumentPosition(o)&16):!1:!1}function X_(){for(var i=window,o=ki();o instanceof i.HTMLIFrameElement;){try{var l=typeof o.contentWindow.location.href=="string"}catch{l=!1}if(l)i=o.contentWindow;else break;o=ki(i.document)}return o}function Af(i){var o=i&&i.nodeName&&i.nodeName.toLowerCase();return o&&(o==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||o==="textarea"||i.contentEditable==="true")}function oA(i){var o=X_(),l=i.focusedElem,d=i.selectionRange;if(o!==l&&l&&l.ownerDocument&&J_(l.ownerDocument.documentElement,l)){if(d!==null&&Af(l)){if(o=d.start,i=d.end,i===void 0&&(i=o),"selectionStart"in l)l.selectionStart=o,l.selectionEnd=Math.min(i,l.value.length);else if(i=(o=l.ownerDocument||document)&&o.defaultView||window,i.getSelection){i=i.getSelection();var m=l.textContent.length,_=Math.min(d.start,m);d=d.end===void 0?_:Math.min(d.end,m),!i.extend&&_>d&&(m=d,d=_,_=m),m=Y_(l,_);var T=Y_(l,d);m&&T&&(i.rangeCount!==1||i.anchorNode!==m.node||i.anchorOffset!==m.offset||i.focusNode!==T.node||i.focusOffset!==T.offset)&&(o=o.createRange(),o.setStart(m.node,m.offset),i.removeAllRanges(),_>d?(i.addRange(o),i.extend(T.node,T.offset)):(o.setEnd(T.node,T.offset),i.addRange(o)))}}for(o=[],i=l;i=i.parentNode;)i.nodeType===1&&o.push({element:i,left:i.scrollLeft,top:i.scrollTop});for(typeof l.focus=="function"&&l.focus(),l=0;l<o.length;l++)i=o[l],i.element.scrollLeft=i.left,i.element.scrollTop=i.top}}var aA=h&&"documentMode"in document&&11>=document.documentMode,ta=null,kf=null,Vl=null,Rf=!1;function Z_(i,o,l){var d=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;Rf||ta==null||ta!==ki(d)||(d=ta,"selectionStart"in d&&Af(d)?d={start:d.selectionStart,end:d.selectionEnd}:(d=(d.ownerDocument&&d.ownerDocument.defaultView||window).getSelection(),d={anchorNode:d.anchorNode,anchorOffset:d.anchorOffset,focusNode:d.focusNode,focusOffset:d.focusOffset}),Vl&&Ml(Vl,d)||(Vl=d,d=jc(kf,"onSelect"),0<d.length&&(o=new qo("onSelect","select",null,o,l),i.push({event:o,listeners:d}),o.target=ta)))}function Mc(i,o){var l={};return l[i.toLowerCase()]=o.toLowerCase(),l["Webkit"+i]="webkit"+o,l["Moz"+i]="moz"+o,l}var na={animationend:Mc("Animation","AnimationEnd"),animationiteration:Mc("Animation","AnimationIteration"),animationstart:Mc("Animation","AnimationStart"),transitionend:Mc("Transition","TransitionEnd")},xf={},ey={};h&&(ey=document.createElement("div").style,"AnimationEvent"in window||(delete na.animationend.animation,delete na.animationiteration.animation,delete na.animationstart.animation),"TransitionEvent"in window||delete na.transitionend.transition);function Vc(i){if(xf[i])return xf[i];if(!na[i])return i;var o=na[i],l;for(l in o)if(o.hasOwnProperty(l)&&l in ey)return xf[i]=o[l];return i}var ty=Vc("animationend"),ny=Vc("animationiteration"),ry=Vc("animationstart"),iy=Vc("transitionend"),sy=new Map,oy="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Fi(i,o){sy.set(i,o),a(o,[i])}for(var Pf=0;Pf<oy.length;Pf++){var bf=oy[Pf],lA=bf.toLowerCase(),uA=bf[0].toUpperCase()+bf.slice(1);Fi(lA,"on"+uA)}Fi(ty,"onAnimationEnd"),Fi(ny,"onAnimationIteration"),Fi(ry,"onAnimationStart"),Fi("dblclick","onDoubleClick"),Fi("focusin","onFocus"),Fi("focusout","onBlur"),Fi(iy,"onTransitionEnd"),u("onMouseEnter",["mouseout","mouseover"]),u("onMouseLeave",["mouseout","mouseover"]),u("onPointerEnter",["pointerout","pointerover"]),u("onPointerLeave",["pointerout","pointerover"]),a("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),a("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),a("onBeforeInput",["compositionend","keypress","textInput","paste"]),a("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Fl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),cA=new Set("cancel close invalid load scroll toggle".split(" ").concat(Fl));function ay(i,o,l){var d=i.type||"unknown-event";i.currentTarget=l,fc(d,o,void 0,i),i.currentTarget=null}function ly(i,o){o=(o&4)!==0;for(var l=0;l<i.length;l++){var d=i[l],m=d.event;d=d.listeners;e:{var _=void 0;if(o)for(var T=d.length-1;0<=T;T--){var P=d[T],M=P.instance,H=P.currentTarget;if(P=P.listener,M!==_&&m.isPropagationStopped())break e;ay(m,P,H),_=M}else for(T=0;T<d.length;T++){if(P=d[T],M=P.instance,H=P.currentTarget,P=P.listener,M!==_&&m.isPropagationStopped())break e;ay(m,P,H),_=M}}}if(Yn)throw i=Tl,Yn=!1,Tl=null,i}function ot(i,o){var l=o[jf];l===void 0&&(l=o[jf]=new Set);var d=i+"__bubble";l.has(d)||(uy(o,i,2,!1),l.add(d))}function Nf(i,o,l){var d=0;o&&(d|=4),uy(l,i,d,o)}var Fc="_reactListening"+Math.random().toString(36).slice(2);function jl(i){if(!i[Fc]){i[Fc]=!0,r.forEach(function(l){l!=="selectionchange"&&(cA.has(l)||Nf(l,!1,i),Nf(l,!0,i))});var o=i.nodeType===9?i:i.ownerDocument;o===null||o[Fc]||(o[Fc]=!0,Nf("selectionchange",!1,o))}}function uy(i,o,l,d){switch(xl(o)){case 1:var m=ct;break;case 4:m=Tf;break;default:m=Rl}l=m.bind(null,o,l,i),m=void 0,!Mo||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(m=!0),d?m!==void 0?i.addEventListener(o,l,{capture:!0,passive:m}):i.addEventListener(o,l,!0):m!==void 0?i.addEventListener(o,l,{passive:m}):i.addEventListener(o,l,!1)}function Df(i,o,l,d,m){var _=d;if((o&1)===0&&(o&2)===0&&d!==null)e:for(;;){if(d===null)return;var T=d.tag;if(T===3||T===4){var P=d.stateNode.containerInfo;if(P===m||P.nodeType===8&&P.parentNode===m)break;if(T===4)for(T=d.return;T!==null;){var M=T.tag;if((M===3||M===4)&&(M=T.stateNode.containerInfo,M===m||M.nodeType===8&&M.parentNode===m))return;T=T.return}for(;P!==null;){if(T=Ws(P),T===null)return;if(M=T.tag,M===5||M===6){d=_=T;continue e}P=P.parentNode}}d=d.return}El(function(){var H=_,ee=Do(l),te=[];e:{var Z=sy.get(i);if(Z!==void 0){var he=qo,me=i;switch(i){case"keypress":if(Go(l)===0)break e;case"keydown":case"keyup":he=g;break;case"focusin":me="focus",he=Jo;break;case"focusout":me="blur",he=Jo;break;case"beforeblur":case"afterblur":he=Jo;break;case"click":if(l.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":he=Qo;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":he=Rc;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":he=q;break;case ty:case ny:case ry:he=Xr;break;case iy:he=Ye;break;case"scroll":he=If;break;case"wheel":he=je;break;case"copy":case"cut":case"paste":he=bc;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":he=C}var ge=(o&4)!==0,yt=!ge&&i==="scroll",$=ge?Z!==null?Z+"Capture":null:Z;ge=[];for(var F=H,W;F!==null;){W=F;var re=W.stateNode;if(W.tag===5&&re!==null&&(W=re,$!==null&&(re=_t(F,$),re!=null&&ge.push(Ul(F,re,W)))),yt)break;F=F.return}0<ge.length&&(Z=new he(Z,me,null,l,ee),te.push({event:Z,listeners:ge}))}}if((o&7)===0){e:{if(Z=i==="mouseover"||i==="pointerover",he=i==="mouseout"||i==="pointerout",Z&&l!==bs&&(me=l.relatedTarget||l.fromElement)&&(Ws(me)||me[Zr]))break e;if((he||Z)&&(Z=ee.window===ee?ee:(Z=ee.ownerDocument)?Z.defaultView||Z.parentWindow:window,he?(me=l.relatedTarget||l.toElement,he=H,me=me?Ws(me):null,me!==null&&(yt=Jn(me),me!==yt||me.tag!==5&&me.tag!==6)&&(me=null)):(he=null,me=H),he!==me)){if(ge=Qo,re="onMouseLeave",$="onMouseEnter",F="mouse",(i==="pointerout"||i==="pointerover")&&(ge=C,re="onPointerLeave",$="onPointerEnter",F="pointer"),yt=he==null?Z:sa(he),W=me==null?Z:sa(me),Z=new ge(re,F+"leave",he,l,ee),Z.target=yt,Z.relatedTarget=W,re=null,Ws(ee)===H&&(ge=new ge($,F+"enter",me,l,ee),ge.target=W,ge.relatedTarget=yt,re=ge),yt=re,he&&me)t:{for(ge=he,$=me,F=0,W=ge;W;W=ra(W))F++;for(W=0,re=$;re;re=ra(re))W++;for(;0<F-W;)ge=ra(ge),F--;for(;0<W-F;)$=ra($),W--;for(;F--;){if(ge===$||$!==null&&ge===$.alternate)break t;ge=ra(ge),$=ra($)}ge=null}else ge=null;he!==null&&cy(te,Z,he,ge,!1),me!==null&&yt!==null&&cy(te,yt,me,ge,!0)}}e:{if(Z=H?sa(H):window,he=Z.nodeName&&Z.nodeName.toLowerCase(),he==="select"||he==="input"&&Z.type==="file")var _e=eA;else if($_(Z))if(H_)_e=iA;else{_e=nA;var we=tA}else(he=Z.nodeName)&&he.toLowerCase()==="input"&&(Z.type==="checkbox"||Z.type==="radio")&&(_e=rA);if(_e&&(_e=_e(i,H))){W_(te,_e,l,ee);break e}we&&we(i,Z,H),i==="focusout"&&(we=Z._wrapperState)&&we.controlled&&Z.type==="number"&&Po(Z,"number",Z.value)}switch(we=H?sa(H):window,i){case"focusin":($_(we)||we.contentEditable==="true")&&(ta=we,kf=H,Vl=null);break;case"focusout":Vl=kf=ta=null;break;case"mousedown":Rf=!0;break;case"contextmenu":case"mouseup":case"dragend":Rf=!1,Z_(te,l,ee);break;case"selectionchange":if(aA)break;case"keydown":case"keyup":Z_(te,l,ee)}var Ee;if(Tt)e:{switch(i){case"compositionstart":var Se="onCompositionStart";break e;case"compositionend":Se="onCompositionEnd";break e;case"compositionupdate":Se="onCompositionUpdate";break e}Se=void 0}else ea?B_(i,l)&&(Se="onCompositionEnd"):i==="keydown"&&l.keyCode===229&&(Se="onCompositionStart");Se&&($s&&l.locale!=="ko"&&(ea||Se!=="onCompositionStart"?Se==="onCompositionEnd"&&ea&&(Ee=Pl()):(Rn=ee,Ho="value"in Rn?Rn.value:Rn.textContent,ea=!0)),we=jc(H,Se),0<we.length&&(Se=new Dl(Se,i,null,l,ee),te.push({event:Se,listeners:we}),Ee?Se.data=Ee:(Ee=z_(l),Ee!==null&&(Se.data=Ee)))),(Ee=xn?YS(i,l):JS(i,l))&&(H=jc(H,"onBeforeInput"),0<H.length&&(ee=new Dl("onBeforeInput","beforeinput",null,l,ee),te.push({event:ee,listeners:H}),ee.data=Ee))}ly(te,o)})}function Ul(i,o,l){return{instance:i,listener:o,currentTarget:l}}function jc(i,o){for(var l=o+"Capture",d=[];i!==null;){var m=i,_=m.stateNode;m.tag===5&&_!==null&&(m=_,_=_t(i,l),_!=null&&d.unshift(Ul(i,_,m)),_=_t(i,o),_!=null&&d.push(Ul(i,_,m))),i=i.return}return d}function ra(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5);return i||null}function cy(i,o,l,d,m){for(var _=o._reactName,T=[];l!==null&&l!==d;){var P=l,M=P.alternate,H=P.stateNode;if(M!==null&&M===d)break;P.tag===5&&H!==null&&(P=H,m?(M=_t(l,_),M!=null&&T.unshift(Ul(l,M,P))):m||(M=_t(l,_),M!=null&&T.push(Ul(l,M,P)))),l=l.return}T.length!==0&&i.push({event:o,listeners:T})}var hA=/\r\n?/g,dA=/\u0000|\uFFFD/g;function hy(i){return(typeof i=="string"?i:""+i).replace(hA,`
`).replace(dA,"")}function Uc(i,o,l){if(o=hy(o),hy(i)!==o&&l)throw Error(t(425))}function Bc(){}var Of=null,Lf=null;function Mf(i,o){return i==="textarea"||i==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var Vf=typeof setTimeout=="function"?setTimeout:void 0,fA=typeof clearTimeout=="function"?clearTimeout:void 0,dy=typeof Promise=="function"?Promise:void 0,pA=typeof queueMicrotask=="function"?queueMicrotask:typeof dy<"u"?function(i){return dy.resolve(null).then(i).catch(mA)}:Vf;function mA(i){setTimeout(function(){throw i})}function Ff(i,o){var l=o,d=0;do{var m=l.nextSibling;if(i.removeChild(l),m&&m.nodeType===8)if(l=m.data,l==="/$"){if(d===0){i.removeChild(m),nr(o);return}d--}else l!=="$"&&l!=="$?"&&l!=="$!"||d++;l=m}while(l);nr(o)}function ji(i){for(;i!=null;i=i.nextSibling){var o=i.nodeType;if(o===1||o===3)break;if(o===8){if(o=i.data,o==="$"||o==="$!"||o==="$?")break;if(o==="/$")return null}}return i}function fy(i){i=i.previousSibling;for(var o=0;i;){if(i.nodeType===8){var l=i.data;if(l==="$"||l==="$!"||l==="$?"){if(o===0)return i;o--}else l==="/$"&&o++}i=i.previousSibling}return null}var ia=Math.random().toString(36).slice(2),Ir="__reactFiber$"+ia,Bl="__reactProps$"+ia,Zr="__reactContainer$"+ia,jf="__reactEvents$"+ia,gA="__reactListeners$"+ia,_A="__reactHandles$"+ia;function Ws(i){var o=i[Ir];if(o)return o;for(var l=i.parentNode;l;){if(o=l[Zr]||l[Ir]){if(l=o.alternate,o.child!==null||l!==null&&l.child!==null)for(i=fy(i);i!==null;){if(l=i[Ir])return l;i=fy(i)}return o}i=l,l=i.parentNode}return null}function zl(i){return i=i[Ir]||i[Zr],!i||i.tag!==5&&i.tag!==6&&i.tag!==13&&i.tag!==3?null:i}function sa(i){if(i.tag===5||i.tag===6)return i.stateNode;throw Error(t(33))}function zc(i){return i[Bl]||null}var Uf=[],oa=-1;function Ui(i){return{current:i}}function at(i){0>oa||(i.current=Uf[oa],Uf[oa]=null,oa--)}function it(i,o){oa++,Uf[oa]=i.current,i.current=o}var Bi={},en=Ui(Bi),mn=Ui(!1),Hs=Bi;function aa(i,o){var l=i.type.contextTypes;if(!l)return Bi;var d=i.stateNode;if(d&&d.__reactInternalMemoizedUnmaskedChildContext===o)return d.__reactInternalMemoizedMaskedChildContext;var m={},_;for(_ in l)m[_]=o[_];return d&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=o,i.__reactInternalMemoizedMaskedChildContext=m),m}function gn(i){return i=i.childContextTypes,i!=null}function $c(){at(mn),at(en)}function py(i,o,l){if(en.current!==Bi)throw Error(t(168));it(en,o),it(mn,l)}function my(i,o,l){var d=i.stateNode;if(o=o.childContextTypes,typeof d.getChildContext!="function")return l;d=d.getChildContext();for(var m in d)if(!(m in o))throw Error(t(108,Ge(i)||"Unknown",m));return ae({},l,d)}function Wc(i){return i=(i=i.stateNode)&&i.__reactInternalMemoizedMergedChildContext||Bi,Hs=en.current,it(en,i),it(mn,mn.current),!0}function gy(i,o,l){var d=i.stateNode;if(!d)throw Error(t(169));l?(i=my(i,o,Hs),d.__reactInternalMemoizedMergedChildContext=i,at(mn),at(en),it(en,i)):at(mn),it(mn,l)}var ei=null,Hc=!1,Bf=!1;function _y(i){ei===null?ei=[i]:ei.push(i)}function yA(i){Hc=!0,_y(i)}function zi(){if(!Bf&&ei!==null){Bf=!0;var i=0,o=Ve;try{var l=ei;for(Ve=1;i<l.length;i++){var d=l[i];do d=d(!0);while(d!==null)}ei=null,Hc=!1}catch(m){throw ei!==null&&(ei=ei.slice(i+1)),Uo(Ms,zi),m}finally{Ve=o,Bf=!1}}return null}var la=[],ua=0,Gc=null,qc=0,Bn=[],zn=0,Gs=null,ti=1,ni="";function qs(i,o){la[ua++]=qc,la[ua++]=Gc,Gc=i,qc=o}function yy(i,o,l){Bn[zn++]=ti,Bn[zn++]=ni,Bn[zn++]=Gs,Gs=i;var d=ti;i=ni;var m=32-ln(d)-1;d&=~(1<<m),l+=1;var _=32-ln(o)+m;if(30<_){var T=m-m%5;_=(d&(1<<T)-1).toString(32),d>>=T,m-=T,ti=1<<32-ln(o)+m|l<<m|d,ni=_+i}else ti=1<<_|l<<m|d,ni=i}function zf(i){i.return!==null&&(qs(i,1),yy(i,1,0))}function $f(i){for(;i===Gc;)Gc=la[--ua],la[ua]=null,qc=la[--ua],la[ua]=null;for(;i===Gs;)Gs=Bn[--zn],Bn[zn]=null,ni=Bn[--zn],Bn[zn]=null,ti=Bn[--zn],Bn[zn]=null}var Pn=null,bn=null,ht=!1,sr=null;function vy(i,o){var l=Gn(5,null,null,0);l.elementType="DELETED",l.stateNode=o,l.return=i,o=i.deletions,o===null?(i.deletions=[l],i.flags|=16):o.push(l)}function wy(i,o){switch(i.tag){case 5:var l=i.type;return o=o.nodeType!==1||l.toLowerCase()!==o.nodeName.toLowerCase()?null:o,o!==null?(i.stateNode=o,Pn=i,bn=ji(o.firstChild),!0):!1;case 6:return o=i.pendingProps===""||o.nodeType!==3?null:o,o!==null?(i.stateNode=o,Pn=i,bn=null,!0):!1;case 13:return o=o.nodeType!==8?null:o,o!==null?(l=Gs!==null?{id:ti,overflow:ni}:null,i.memoizedState={dehydrated:o,treeContext:l,retryLane:1073741824},l=Gn(18,null,null,0),l.stateNode=o,l.return=i,i.child=l,Pn=i,bn=null,!0):!1;default:return!1}}function Wf(i){return(i.mode&1)!==0&&(i.flags&128)===0}function Hf(i){if(ht){var o=bn;if(o){var l=o;if(!wy(i,o)){if(Wf(i))throw Error(t(418));o=ji(l.nextSibling);var d=Pn;o&&wy(i,o)?vy(d,l):(i.flags=i.flags&-4097|2,ht=!1,Pn=i)}}else{if(Wf(i))throw Error(t(418));i.flags=i.flags&-4097|2,ht=!1,Pn=i}}}function Ey(i){for(i=i.return;i!==null&&i.tag!==5&&i.tag!==3&&i.tag!==13;)i=i.return;Pn=i}function Kc(i){if(i!==Pn)return!1;if(!ht)return Ey(i),ht=!0,!1;var o;if((o=i.tag!==3)&&!(o=i.tag!==5)&&(o=i.type,o=o!=="head"&&o!=="body"&&!Mf(i.type,i.memoizedProps)),o&&(o=bn)){if(Wf(i))throw Ty(),Error(t(418));for(;o;)vy(i,o),o=ji(o.nextSibling)}if(Ey(i),i.tag===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(t(317));e:{for(i=i.nextSibling,o=0;i;){if(i.nodeType===8){var l=i.data;if(l==="/$"){if(o===0){bn=ji(i.nextSibling);break e}o--}else l!=="$"&&l!=="$!"&&l!=="$?"||o++}i=i.nextSibling}bn=null}}else bn=Pn?ji(i.stateNode.nextSibling):null;return!0}function Ty(){for(var i=bn;i;)i=ji(i.nextSibling)}function ca(){bn=Pn=null,ht=!1}function Gf(i){sr===null?sr=[i]:sr.push(i)}var vA=J.ReactCurrentBatchConfig;function $l(i,o,l){if(i=l.ref,i!==null&&typeof i!="function"&&typeof i!="object"){if(l._owner){if(l=l._owner,l){if(l.tag!==1)throw Error(t(309));var d=l.stateNode}if(!d)throw Error(t(147,i));var m=d,_=""+i;return o!==null&&o.ref!==null&&typeof o.ref=="function"&&o.ref._stringRef===_?o.ref:(o=function(T){var P=m.refs;T===null?delete P[_]:P[_]=T},o._stringRef=_,o)}if(typeof i!="string")throw Error(t(284));if(!l._owner)throw Error(t(290,i))}return i}function Qc(i,o){throw i=Object.prototype.toString.call(o),Error(t(31,i==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":i))}function Iy(i){var o=i._init;return o(i._payload)}function Cy(i){function o($,F){if(i){var W=$.deletions;W===null?($.deletions=[F],$.flags|=16):W.push(F)}}function l($,F){if(!i)return null;for(;F!==null;)o($,F),F=F.sibling;return null}function d($,F){for($=new Map;F!==null;)F.key!==null?$.set(F.key,F):$.set(F.index,F),F=F.sibling;return $}function m($,F){return $=Yi($,F),$.index=0,$.sibling=null,$}function _($,F,W){return $.index=W,i?(W=$.alternate,W!==null?(W=W.index,W<F?($.flags|=2,F):W):($.flags|=2,F)):($.flags|=1048576,F)}function T($){return i&&$.alternate===null&&($.flags|=2),$}function P($,F,W,re){return F===null||F.tag!==6?(F=Vp(W,$.mode,re),F.return=$,F):(F=m(F,W),F.return=$,F)}function M($,F,W,re){var _e=W.type;return _e===D?ee($,F,W.props.children,re,W.key):F!==null&&(F.elementType===_e||typeof _e=="object"&&_e!==null&&_e.$$typeof===Oe&&Iy(_e)===F.type)?(re=m(F,W.props),re.ref=$l($,F,W),re.return=$,re):(re=vh(W.type,W.key,W.props,null,$.mode,re),re.ref=$l($,F,W),re.return=$,re)}function H($,F,W,re){return F===null||F.tag!==4||F.stateNode.containerInfo!==W.containerInfo||F.stateNode.implementation!==W.implementation?(F=Fp(W,$.mode,re),F.return=$,F):(F=m(F,W.children||[]),F.return=$,F)}function ee($,F,W,re,_e){return F===null||F.tag!==7?(F=to(W,$.mode,re,_e),F.return=$,F):(F=m(F,W),F.return=$,F)}function te($,F,W){if(typeof F=="string"&&F!==""||typeof F=="number")return F=Vp(""+F,$.mode,W),F.return=$,F;if(typeof F=="object"&&F!==null){switch(F.$$typeof){case ne:return W=vh(F.type,F.key,F.props,null,$.mode,W),W.ref=$l($,null,F),W.return=$,W;case se:return F=Fp(F,$.mode,W),F.return=$,F;case Oe:var re=F._init;return te($,re(F._payload),W)}if(Wr(F)||ce(F))return F=to(F,$.mode,W,null),F.return=$,F;Qc($,F)}return null}function Z($,F,W,re){var _e=F!==null?F.key:null;if(typeof W=="string"&&W!==""||typeof W=="number")return _e!==null?null:P($,F,""+W,re);if(typeof W=="object"&&W!==null){switch(W.$$typeof){case ne:return W.key===_e?M($,F,W,re):null;case se:return W.key===_e?H($,F,W,re):null;case Oe:return _e=W._init,Z($,F,_e(W._payload),re)}if(Wr(W)||ce(W))return _e!==null?null:ee($,F,W,re,null);Qc($,W)}return null}function he($,F,W,re,_e){if(typeof re=="string"&&re!==""||typeof re=="number")return $=$.get(W)||null,P(F,$,""+re,_e);if(typeof re=="object"&&re!==null){switch(re.$$typeof){case ne:return $=$.get(re.key===null?W:re.key)||null,M(F,$,re,_e);case se:return $=$.get(re.key===null?W:re.key)||null,H(F,$,re,_e);case Oe:var we=re._init;return he($,F,W,we(re._payload),_e)}if(Wr(re)||ce(re))return $=$.get(W)||null,ee(F,$,re,_e,null);Qc(F,re)}return null}function me($,F,W,re){for(var _e=null,we=null,Ee=F,Se=F=0,Ut=null;Ee!==null&&Se<W.length;Se++){Ee.index>Se?(Ut=Ee,Ee=null):Ut=Ee.sibling;var We=Z($,Ee,W[Se],re);if(We===null){Ee===null&&(Ee=Ut);break}i&&Ee&&We.alternate===null&&o($,Ee),F=_(We,F,Se),we===null?_e=We:we.sibling=We,we=We,Ee=Ut}if(Se===W.length)return l($,Ee),ht&&qs($,Se),_e;if(Ee===null){for(;Se<W.length;Se++)Ee=te($,W[Se],re),Ee!==null&&(F=_(Ee,F,Se),we===null?_e=Ee:we.sibling=Ee,we=Ee);return ht&&qs($,Se),_e}for(Ee=d($,Ee);Se<W.length;Se++)Ut=he(Ee,$,Se,W[Se],re),Ut!==null&&(i&&Ut.alternate!==null&&Ee.delete(Ut.key===null?Se:Ut.key),F=_(Ut,F,Se),we===null?_e=Ut:we.sibling=Ut,we=Ut);return i&&Ee.forEach(function(Ji){return o($,Ji)}),ht&&qs($,Se),_e}function ge($,F,W,re){var _e=ce(W);if(typeof _e!="function")throw Error(t(150));if(W=_e.call(W),W==null)throw Error(t(151));for(var we=_e=null,Ee=F,Se=F=0,Ut=null,We=W.next();Ee!==null&&!We.done;Se++,We=W.next()){Ee.index>Se?(Ut=Ee,Ee=null):Ut=Ee.sibling;var Ji=Z($,Ee,We.value,re);if(Ji===null){Ee===null&&(Ee=Ut);break}i&&Ee&&Ji.alternate===null&&o($,Ee),F=_(Ji,F,Se),we===null?_e=Ji:we.sibling=Ji,we=Ji,Ee=Ut}if(We.done)return l($,Ee),ht&&qs($,Se),_e;if(Ee===null){for(;!We.done;Se++,We=W.next())We=te($,We.value,re),We!==null&&(F=_(We,F,Se),we===null?_e=We:we.sibling=We,we=We);return ht&&qs($,Se),_e}for(Ee=d($,Ee);!We.done;Se++,We=W.next())We=he(Ee,$,Se,We.value,re),We!==null&&(i&&We.alternate!==null&&Ee.delete(We.key===null?Se:We.key),F=_(We,F,Se),we===null?_e=We:we.sibling=We,we=We);return i&&Ee.forEach(function(XA){return o($,XA)}),ht&&qs($,Se),_e}function yt($,F,W,re){if(typeof W=="object"&&W!==null&&W.type===D&&W.key===null&&(W=W.props.children),typeof W=="object"&&W!==null){switch(W.$$typeof){case ne:e:{for(var _e=W.key,we=F;we!==null;){if(we.key===_e){if(_e=W.type,_e===D){if(we.tag===7){l($,we.sibling),F=m(we,W.props.children),F.return=$,$=F;break e}}else if(we.elementType===_e||typeof _e=="object"&&_e!==null&&_e.$$typeof===Oe&&Iy(_e)===we.type){l($,we.sibling),F=m(we,W.props),F.ref=$l($,we,W),F.return=$,$=F;break e}l($,we);break}else o($,we);we=we.sibling}W.type===D?(F=to(W.props.children,$.mode,re,W.key),F.return=$,$=F):(re=vh(W.type,W.key,W.props,null,$.mode,re),re.ref=$l($,F,W),re.return=$,$=re)}return T($);case se:e:{for(we=W.key;F!==null;){if(F.key===we)if(F.tag===4&&F.stateNode.containerInfo===W.containerInfo&&F.stateNode.implementation===W.implementation){l($,F.sibling),F=m(F,W.children||[]),F.return=$,$=F;break e}else{l($,F);break}else o($,F);F=F.sibling}F=Fp(W,$.mode,re),F.return=$,$=F}return T($);case Oe:return we=W._init,yt($,F,we(W._payload),re)}if(Wr(W))return me($,F,W,re);if(ce(W))return ge($,F,W,re);Qc($,W)}return typeof W=="string"&&W!==""||typeof W=="number"?(W=""+W,F!==null&&F.tag===6?(l($,F.sibling),F=m(F,W),F.return=$,$=F):(l($,F),F=Vp(W,$.mode,re),F.return=$,$=F),T($)):l($,F)}return yt}var ha=Cy(!0),Sy=Cy(!1),Yc=Ui(null),Jc=null,da=null,qf=null;function Kf(){qf=da=Jc=null}function Qf(i){var o=Yc.current;at(Yc),i._currentValue=o}function Yf(i,o,l){for(;i!==null;){var d=i.alternate;if((i.childLanes&o)!==o?(i.childLanes|=o,d!==null&&(d.childLanes|=o)):d!==null&&(d.childLanes&o)!==o&&(d.childLanes|=o),i===l)break;i=i.return}}function fa(i,o){Jc=i,qf=da=null,i=i.dependencies,i!==null&&i.firstContext!==null&&((i.lanes&o)!==0&&(_n=!0),i.firstContext=null)}function $n(i){var o=i._currentValue;if(qf!==i)if(i={context:i,memoizedValue:o,next:null},da===null){if(Jc===null)throw Error(t(308));da=i,Jc.dependencies={lanes:0,firstContext:i}}else da=da.next=i;return o}var Ks=null;function Jf(i){Ks===null?Ks=[i]:Ks.push(i)}function Ay(i,o,l,d){var m=o.interleaved;return m===null?(l.next=l,Jf(o)):(l.next=m.next,m.next=l),o.interleaved=l,ri(i,d)}function ri(i,o){i.lanes|=o;var l=i.alternate;for(l!==null&&(l.lanes|=o),l=i,i=i.return;i!==null;)i.childLanes|=o,l=i.alternate,l!==null&&(l.childLanes|=o),l=i,i=i.return;return l.tag===3?l.stateNode:null}var $i=!1;function Xf(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function ky(i,o){i=i.updateQueue,o.updateQueue===i&&(o.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,effects:i.effects})}function ii(i,o){return{eventTime:i,lane:o,tag:0,payload:null,callback:null,next:null}}function Wi(i,o,l){var d=i.updateQueue;if(d===null)return null;if(d=d.shared,($e&2)!==0){var m=d.pending;return m===null?o.next=o:(o.next=m.next,m.next=o),d.pending=o,ri(i,l)}return m=d.interleaved,m===null?(o.next=o,Jf(d)):(o.next=m.next,m.next=o),d.interleaved=o,ri(i,l)}function Xc(i,o,l){if(o=o.updateQueue,o!==null&&(o=o.shared,(l&4194240)!==0)){var d=o.lanes;d&=i.pendingLanes,l|=d,o.lanes=l,Di(i,l)}}function Ry(i,o){var l=i.updateQueue,d=i.alternate;if(d!==null&&(d=d.updateQueue,l===d)){var m=null,_=null;if(l=l.firstBaseUpdate,l!==null){do{var T={eventTime:l.eventTime,lane:l.lane,tag:l.tag,payload:l.payload,callback:l.callback,next:null};_===null?m=_=T:_=_.next=T,l=l.next}while(l!==null);_===null?m=_=o:_=_.next=o}else m=_=o;l={baseState:d.baseState,firstBaseUpdate:m,lastBaseUpdate:_,shared:d.shared,effects:d.effects},i.updateQueue=l;return}i=l.lastBaseUpdate,i===null?l.firstBaseUpdate=o:i.next=o,l.lastBaseUpdate=o}function Zc(i,o,l,d){var m=i.updateQueue;$i=!1;var _=m.firstBaseUpdate,T=m.lastBaseUpdate,P=m.shared.pending;if(P!==null){m.shared.pending=null;var M=P,H=M.next;M.next=null,T===null?_=H:T.next=H,T=M;var ee=i.alternate;ee!==null&&(ee=ee.updateQueue,P=ee.lastBaseUpdate,P!==T&&(P===null?ee.firstBaseUpdate=H:P.next=H,ee.lastBaseUpdate=M))}if(_!==null){var te=m.baseState;T=0,ee=H=M=null,P=_;do{var Z=P.lane,he=P.eventTime;if((d&Z)===Z){ee!==null&&(ee=ee.next={eventTime:he,lane:0,tag:P.tag,payload:P.payload,callback:P.callback,next:null});e:{var me=i,ge=P;switch(Z=o,he=l,ge.tag){case 1:if(me=ge.payload,typeof me=="function"){te=me.call(he,te,Z);break e}te=me;break e;case 3:me.flags=me.flags&-65537|128;case 0:if(me=ge.payload,Z=typeof me=="function"?me.call(he,te,Z):me,Z==null)break e;te=ae({},te,Z);break e;case 2:$i=!0}}P.callback!==null&&P.lane!==0&&(i.flags|=64,Z=m.effects,Z===null?m.effects=[P]:Z.push(P))}else he={eventTime:he,lane:Z,tag:P.tag,payload:P.payload,callback:P.callback,next:null},ee===null?(H=ee=he,M=te):ee=ee.next=he,T|=Z;if(P=P.next,P===null){if(P=m.shared.pending,P===null)break;Z=P,P=Z.next,Z.next=null,m.lastBaseUpdate=Z,m.shared.pending=null}}while(!0);if(ee===null&&(M=te),m.baseState=M,m.firstBaseUpdate=H,m.lastBaseUpdate=ee,o=m.shared.interleaved,o!==null){m=o;do T|=m.lane,m=m.next;while(m!==o)}else _===null&&(m.shared.lanes=0);Js|=T,i.lanes=T,i.memoizedState=te}}function xy(i,o,l){if(i=o.effects,o.effects=null,i!==null)for(o=0;o<i.length;o++){var d=i[o],m=d.callback;if(m!==null){if(d.callback=null,d=l,typeof m!="function")throw Error(t(191,m));m.call(d)}}}var Wl={},Cr=Ui(Wl),Hl=Ui(Wl),Gl=Ui(Wl);function Qs(i){if(i===Wl)throw Error(t(174));return i}function Zf(i,o){switch(it(Gl,o),it(Hl,i),it(Cr,Wl),i=o.nodeType,i){case 9:case 11:o=(o=o.documentElement)?o.namespaceURI:bt(null,"");break;default:i=i===8?o.parentNode:o,o=i.namespaceURI||null,i=i.tagName,o=bt(o,i)}at(Cr),it(Cr,o)}function pa(){at(Cr),at(Hl),at(Gl)}function Py(i){Qs(Gl.current);var o=Qs(Cr.current),l=bt(o,i.type);o!==l&&(it(Hl,i),it(Cr,l))}function ep(i){Hl.current===i&&(at(Cr),at(Hl))}var dt=Ui(0);function eh(i){for(var o=i;o!==null;){if(o.tag===13){var l=o.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||l.data==="$?"||l.data==="$!"))return o}else if(o.tag===19&&o.memoizedProps.revealOrder!==void 0){if((o.flags&128)!==0)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===i)break;for(;o.sibling===null;){if(o.return===null||o.return===i)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var tp=[];function np(){for(var i=0;i<tp.length;i++)tp[i]._workInProgressVersionPrimary=null;tp.length=0}var th=J.ReactCurrentDispatcher,rp=J.ReactCurrentBatchConfig,Ys=0,ft=null,Dt=null,Ft=null,nh=!1,ql=!1,Kl=0,wA=0;function tn(){throw Error(t(321))}function ip(i,o){if(o===null)return!1;for(var l=0;l<o.length&&l<i.length;l++)if(!ir(i[l],o[l]))return!1;return!0}function sp(i,o,l,d,m,_){if(Ys=_,ft=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,th.current=i===null||i.memoizedState===null?CA:SA,i=l(d,m),ql){_=0;do{if(ql=!1,Kl=0,25<=_)throw Error(t(301));_+=1,Ft=Dt=null,o.updateQueue=null,th.current=AA,i=l(d,m)}while(ql)}if(th.current=sh,o=Dt!==null&&Dt.next!==null,Ys=0,Ft=Dt=ft=null,nh=!1,o)throw Error(t(300));return i}function op(){var i=Kl!==0;return Kl=0,i}function Sr(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ft===null?ft.memoizedState=Ft=i:Ft=Ft.next=i,Ft}function Wn(){if(Dt===null){var i=ft.alternate;i=i!==null?i.memoizedState:null}else i=Dt.next;var o=Ft===null?ft.memoizedState:Ft.next;if(o!==null)Ft=o,Dt=i;else{if(i===null)throw Error(t(310));Dt=i,i={memoizedState:Dt.memoizedState,baseState:Dt.baseState,baseQueue:Dt.baseQueue,queue:Dt.queue,next:null},Ft===null?ft.memoizedState=Ft=i:Ft=Ft.next=i}return Ft}function Ql(i,o){return typeof o=="function"?o(i):o}function ap(i){var o=Wn(),l=o.queue;if(l===null)throw Error(t(311));l.lastRenderedReducer=i;var d=Dt,m=d.baseQueue,_=l.pending;if(_!==null){if(m!==null){var T=m.next;m.next=_.next,_.next=T}d.baseQueue=m=_,l.pending=null}if(m!==null){_=m.next,d=d.baseState;var P=T=null,M=null,H=_;do{var ee=H.lane;if((Ys&ee)===ee)M!==null&&(M=M.next={lane:0,action:H.action,hasEagerState:H.hasEagerState,eagerState:H.eagerState,next:null}),d=H.hasEagerState?H.eagerState:i(d,H.action);else{var te={lane:ee,action:H.action,hasEagerState:H.hasEagerState,eagerState:H.eagerState,next:null};M===null?(P=M=te,T=d):M=M.next=te,ft.lanes|=ee,Js|=ee}H=H.next}while(H!==null&&H!==_);M===null?T=d:M.next=P,ir(d,o.memoizedState)||(_n=!0),o.memoizedState=d,o.baseState=T,o.baseQueue=M,l.lastRenderedState=d}if(i=l.interleaved,i!==null){m=i;do _=m.lane,ft.lanes|=_,Js|=_,m=m.next;while(m!==i)}else m===null&&(l.lanes=0);return[o.memoizedState,l.dispatch]}function lp(i){var o=Wn(),l=o.queue;if(l===null)throw Error(t(311));l.lastRenderedReducer=i;var d=l.dispatch,m=l.pending,_=o.memoizedState;if(m!==null){l.pending=null;var T=m=m.next;do _=i(_,T.action),T=T.next;while(T!==m);ir(_,o.memoizedState)||(_n=!0),o.memoizedState=_,o.baseQueue===null&&(o.baseState=_),l.lastRenderedState=_}return[_,d]}function by(){}function Ny(i,o){var l=ft,d=Wn(),m=o(),_=!ir(d.memoizedState,m);if(_&&(d.memoizedState=m,_n=!0),d=d.queue,up(Ly.bind(null,l,d,i),[i]),d.getSnapshot!==o||_||Ft!==null&&Ft.memoizedState.tag&1){if(l.flags|=2048,Yl(9,Oy.bind(null,l,d,m,o),void 0,null),jt===null)throw Error(t(349));(Ys&30)!==0||Dy(l,o,m)}return m}function Dy(i,o,l){i.flags|=16384,i={getSnapshot:o,value:l},o=ft.updateQueue,o===null?(o={lastEffect:null,stores:null},ft.updateQueue=o,o.stores=[i]):(l=o.stores,l===null?o.stores=[i]:l.push(i))}function Oy(i,o,l,d){o.value=l,o.getSnapshot=d,My(o)&&Vy(i)}function Ly(i,o,l){return l(function(){My(o)&&Vy(i)})}function My(i){var o=i.getSnapshot;i=i.value;try{var l=o();return!ir(i,l)}catch{return!0}}function Vy(i){var o=ri(i,1);o!==null&&ur(o,i,1,-1)}function Fy(i){var o=Sr();return typeof i=="function"&&(i=i()),o.memoizedState=o.baseState=i,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ql,lastRenderedState:i},o.queue=i,i=i.dispatch=IA.bind(null,ft,i),[o.memoizedState,i]}function Yl(i,o,l,d){return i={tag:i,create:o,destroy:l,deps:d,next:null},o=ft.updateQueue,o===null?(o={lastEffect:null,stores:null},ft.updateQueue=o,o.lastEffect=i.next=i):(l=o.lastEffect,l===null?o.lastEffect=i.next=i:(d=l.next,l.next=i,i.next=d,o.lastEffect=i)),i}function jy(){return Wn().memoizedState}function rh(i,o,l,d){var m=Sr();ft.flags|=i,m.memoizedState=Yl(1|o,l,void 0,d===void 0?null:d)}function ih(i,o,l,d){var m=Wn();d=d===void 0?null:d;var _=void 0;if(Dt!==null){var T=Dt.memoizedState;if(_=T.destroy,d!==null&&ip(d,T.deps)){m.memoizedState=Yl(o,l,_,d);return}}ft.flags|=i,m.memoizedState=Yl(1|o,l,_,d)}function Uy(i,o){return rh(8390656,8,i,o)}function up(i,o){return ih(2048,8,i,o)}function By(i,o){return ih(4,2,i,o)}function zy(i,o){return ih(4,4,i,o)}function $y(i,o){if(typeof o=="function")return i=i(),o(i),function(){o(null)};if(o!=null)return i=i(),o.current=i,function(){o.current=null}}function Wy(i,o,l){return l=l!=null?l.concat([i]):null,ih(4,4,$y.bind(null,o,i),l)}function cp(){}function Hy(i,o){var l=Wn();o=o===void 0?null:o;var d=l.memoizedState;return d!==null&&o!==null&&ip(o,d[1])?d[0]:(l.memoizedState=[i,o],i)}function Gy(i,o){var l=Wn();o=o===void 0?null:o;var d=l.memoizedState;return d!==null&&o!==null&&ip(o,d[1])?d[0]:(i=i(),l.memoizedState=[i,o],i)}function qy(i,o,l){return(Ys&21)===0?(i.baseState&&(i.baseState=!1,_n=!0),i.memoizedState=l):(ir(l,o)||(l=js(),ft.lanes|=l,Js|=l,i.baseState=!0),o)}function EA(i,o){var l=Ve;Ve=l!==0&&4>l?l:4,i(!0);var d=rp.transition;rp.transition={};try{i(!1),o()}finally{Ve=l,rp.transition=d}}function Ky(){return Wn().memoizedState}function TA(i,o,l){var d=Ki(i);if(l={lane:d,action:l,hasEagerState:!1,eagerState:null,next:null},Qy(i))Yy(o,l);else if(l=Ay(i,o,l,d),l!==null){var m=hn();ur(l,i,d,m),Jy(l,o,d)}}function IA(i,o,l){var d=Ki(i),m={lane:d,action:l,hasEagerState:!1,eagerState:null,next:null};if(Qy(i))Yy(o,m);else{var _=i.alternate;if(i.lanes===0&&(_===null||_.lanes===0)&&(_=o.lastRenderedReducer,_!==null))try{var T=o.lastRenderedState,P=_(T,l);if(m.hasEagerState=!0,m.eagerState=P,ir(P,T)){var M=o.interleaved;M===null?(m.next=m,Jf(o)):(m.next=M.next,M.next=m),o.interleaved=m;return}}catch{}finally{}l=Ay(i,o,m,d),l!==null&&(m=hn(),ur(l,i,d,m),Jy(l,o,d))}}function Qy(i){var o=i.alternate;return i===ft||o!==null&&o===ft}function Yy(i,o){ql=nh=!0;var l=i.pending;l===null?o.next=o:(o.next=l.next,l.next=o),i.pending=o}function Jy(i,o,l){if((l&4194240)!==0){var d=o.lanes;d&=i.pendingLanes,l|=d,o.lanes=l,Di(i,l)}}var sh={readContext:$n,useCallback:tn,useContext:tn,useEffect:tn,useImperativeHandle:tn,useInsertionEffect:tn,useLayoutEffect:tn,useMemo:tn,useReducer:tn,useRef:tn,useState:tn,useDebugValue:tn,useDeferredValue:tn,useTransition:tn,useMutableSource:tn,useSyncExternalStore:tn,useId:tn,unstable_isNewReconciler:!1},CA={readContext:$n,useCallback:function(i,o){return Sr().memoizedState=[i,o===void 0?null:o],i},useContext:$n,useEffect:Uy,useImperativeHandle:function(i,o,l){return l=l!=null?l.concat([i]):null,rh(4194308,4,$y.bind(null,o,i),l)},useLayoutEffect:function(i,o){return rh(4194308,4,i,o)},useInsertionEffect:function(i,o){return rh(4,2,i,o)},useMemo:function(i,o){var l=Sr();return o=o===void 0?null:o,i=i(),l.memoizedState=[i,o],i},useReducer:function(i,o,l){var d=Sr();return o=l!==void 0?l(o):o,d.memoizedState=d.baseState=o,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:o},d.queue=i,i=i.dispatch=TA.bind(null,ft,i),[d.memoizedState,i]},useRef:function(i){var o=Sr();return i={current:i},o.memoizedState=i},useState:Fy,useDebugValue:cp,useDeferredValue:function(i){return Sr().memoizedState=i},useTransition:function(){var i=Fy(!1),o=i[0];return i=EA.bind(null,i[1]),Sr().memoizedState=i,[o,i]},useMutableSource:function(){},useSyncExternalStore:function(i,o,l){var d=ft,m=Sr();if(ht){if(l===void 0)throw Error(t(407));l=l()}else{if(l=o(),jt===null)throw Error(t(349));(Ys&30)!==0||Dy(d,o,l)}m.memoizedState=l;var _={value:l,getSnapshot:o};return m.queue=_,Uy(Ly.bind(null,d,_,i),[i]),d.flags|=2048,Yl(9,Oy.bind(null,d,_,l,o),void 0,null),l},useId:function(){var i=Sr(),o=jt.identifierPrefix;if(ht){var l=ni,d=ti;l=(d&~(1<<32-ln(d)-1)).toString(32)+l,o=":"+o+"R"+l,l=Kl++,0<l&&(o+="H"+l.toString(32)),o+=":"}else l=wA++,o=":"+o+"r"+l.toString(32)+":";return i.memoizedState=o},unstable_isNewReconciler:!1},SA={readContext:$n,useCallback:Hy,useContext:$n,useEffect:up,useImperativeHandle:Wy,useInsertionEffect:By,useLayoutEffect:zy,useMemo:Gy,useReducer:ap,useRef:jy,useState:function(){return ap(Ql)},useDebugValue:cp,useDeferredValue:function(i){var o=Wn();return qy(o,Dt.memoizedState,i)},useTransition:function(){var i=ap(Ql)[0],o=Wn().memoizedState;return[i,o]},useMutableSource:by,useSyncExternalStore:Ny,useId:Ky,unstable_isNewReconciler:!1},AA={readContext:$n,useCallback:Hy,useContext:$n,useEffect:up,useImperativeHandle:Wy,useInsertionEffect:By,useLayoutEffect:zy,useMemo:Gy,useReducer:lp,useRef:jy,useState:function(){return lp(Ql)},useDebugValue:cp,useDeferredValue:function(i){var o=Wn();return Dt===null?o.memoizedState=i:qy(o,Dt.memoizedState,i)},useTransition:function(){var i=lp(Ql)[0],o=Wn().memoizedState;return[i,o]},useMutableSource:by,useSyncExternalStore:Ny,useId:Ky,unstable_isNewReconciler:!1};function or(i,o){if(i&&i.defaultProps){o=ae({},o),i=i.defaultProps;for(var l in i)o[l]===void 0&&(o[l]=i[l]);return o}return o}function hp(i,o,l,d){o=i.memoizedState,l=l(d,o),l=l==null?o:ae({},o,l),i.memoizedState=l,i.lanes===0&&(i.updateQueue.baseState=l)}var oh={isMounted:function(i){return(i=i._reactInternals)?Jn(i)===i:!1},enqueueSetState:function(i,o,l){i=i._reactInternals;var d=hn(),m=Ki(i),_=ii(d,m);_.payload=o,l!=null&&(_.callback=l),o=Wi(i,_,m),o!==null&&(ur(o,i,m,d),Xc(o,i,m))},enqueueReplaceState:function(i,o,l){i=i._reactInternals;var d=hn(),m=Ki(i),_=ii(d,m);_.tag=1,_.payload=o,l!=null&&(_.callback=l),o=Wi(i,_,m),o!==null&&(ur(o,i,m,d),Xc(o,i,m))},enqueueForceUpdate:function(i,o){i=i._reactInternals;var l=hn(),d=Ki(i),m=ii(l,d);m.tag=2,o!=null&&(m.callback=o),o=Wi(i,m,d),o!==null&&(ur(o,i,d,l),Xc(o,i,d))}};function Xy(i,o,l,d,m,_,T){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(d,_,T):o.prototype&&o.prototype.isPureReactComponent?!Ml(l,d)||!Ml(m,_):!0}function Zy(i,o,l){var d=!1,m=Bi,_=o.contextType;return typeof _=="object"&&_!==null?_=$n(_):(m=gn(o)?Hs:en.current,d=o.contextTypes,_=(d=d!=null)?aa(i,m):Bi),o=new o(l,_),i.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,o.updater=oh,i.stateNode=o,o._reactInternals=i,d&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=m,i.__reactInternalMemoizedMaskedChildContext=_),o}function ev(i,o,l,d){i=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(l,d),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(l,d),o.state!==i&&oh.enqueueReplaceState(o,o.state,null)}function dp(i,o,l,d){var m=i.stateNode;m.props=l,m.state=i.memoizedState,m.refs={},Xf(i);var _=o.contextType;typeof _=="object"&&_!==null?m.context=$n(_):(_=gn(o)?Hs:en.current,m.context=aa(i,_)),m.state=i.memoizedState,_=o.getDerivedStateFromProps,typeof _=="function"&&(hp(i,o,_,l),m.state=i.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof m.getSnapshotBeforeUpdate=="function"||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(o=m.state,typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount(),o!==m.state&&oh.enqueueReplaceState(m,m.state,null),Zc(i,l,m,d),m.state=i.memoizedState),typeof m.componentDidMount=="function"&&(i.flags|=4194308)}function ma(i,o){try{var l="",d=o;do l+=Te(d),d=d.return;while(d);var m=l}catch(_){m=`
Error generating stack: `+_.message+`
`+_.stack}return{value:i,source:o,stack:m,digest:null}}function fp(i,o,l){return{value:i,source:null,stack:l??null,digest:o??null}}function pp(i,o){try{console.error(o.value)}catch(l){setTimeout(function(){throw l})}}var kA=typeof WeakMap=="function"?WeakMap:Map;function tv(i,o,l){l=ii(-1,l),l.tag=3,l.payload={element:null};var d=o.value;return l.callback=function(){fh||(fh=!0,xp=d),pp(i,o)},l}function nv(i,o,l){l=ii(-1,l),l.tag=3;var d=i.type.getDerivedStateFromError;if(typeof d=="function"){var m=o.value;l.payload=function(){return d(m)},l.callback=function(){pp(i,o)}}var _=i.stateNode;return _!==null&&typeof _.componentDidCatch=="function"&&(l.callback=function(){pp(i,o),typeof d!="function"&&(Gi===null?Gi=new Set([this]):Gi.add(this));var T=o.stack;this.componentDidCatch(o.value,{componentStack:T!==null?T:""})}),l}function rv(i,o,l){var d=i.pingCache;if(d===null){d=i.pingCache=new kA;var m=new Set;d.set(o,m)}else m=d.get(o),m===void 0&&(m=new Set,d.set(o,m));m.has(l)||(m.add(l),i=BA.bind(null,i,o,l),o.then(i,i))}function iv(i){do{var o;if((o=i.tag===13)&&(o=i.memoizedState,o=o!==null?o.dehydrated!==null:!0),o)return i;i=i.return}while(i!==null);return null}function sv(i,o,l,d,m){return(i.mode&1)===0?(i===o?i.flags|=65536:(i.flags|=128,l.flags|=131072,l.flags&=-52805,l.tag===1&&(l.alternate===null?l.tag=17:(o=ii(-1,1),o.tag=2,Wi(l,o,1))),l.lanes|=1),i):(i.flags|=65536,i.lanes=m,i)}var RA=J.ReactCurrentOwner,_n=!1;function cn(i,o,l,d){o.child=i===null?Sy(o,null,l,d):ha(o,i.child,l,d)}function ov(i,o,l,d,m){l=l.render;var _=o.ref;return fa(o,m),d=sp(i,o,l,d,_,m),l=op(),i!==null&&!_n?(o.updateQueue=i.updateQueue,o.flags&=-2053,i.lanes&=~m,si(i,o,m)):(ht&&l&&zf(o),o.flags|=1,cn(i,o,d,m),o.child)}function av(i,o,l,d,m){if(i===null){var _=l.type;return typeof _=="function"&&!Mp(_)&&_.defaultProps===void 0&&l.compare===null&&l.defaultProps===void 0?(o.tag=15,o.type=_,lv(i,o,_,d,m)):(i=vh(l.type,null,d,o,o.mode,m),i.ref=o.ref,i.return=o,o.child=i)}if(_=i.child,(i.lanes&m)===0){var T=_.memoizedProps;if(l=l.compare,l=l!==null?l:Ml,l(T,d)&&i.ref===o.ref)return si(i,o,m)}return o.flags|=1,i=Yi(_,d),i.ref=o.ref,i.return=o,o.child=i}function lv(i,o,l,d,m){if(i!==null){var _=i.memoizedProps;if(Ml(_,d)&&i.ref===o.ref)if(_n=!1,o.pendingProps=d=_,(i.lanes&m)!==0)(i.flags&131072)!==0&&(_n=!0);else return o.lanes=i.lanes,si(i,o,m)}return mp(i,o,l,d,m)}function uv(i,o,l){var d=o.pendingProps,m=d.children,_=i!==null?i.memoizedState:null;if(d.mode==="hidden")if((o.mode&1)===0)o.memoizedState={baseLanes:0,cachePool:null,transitions:null},it(_a,Nn),Nn|=l;else{if((l&1073741824)===0)return i=_!==null?_.baseLanes|l:l,o.lanes=o.childLanes=1073741824,o.memoizedState={baseLanes:i,cachePool:null,transitions:null},o.updateQueue=null,it(_a,Nn),Nn|=i,null;o.memoizedState={baseLanes:0,cachePool:null,transitions:null},d=_!==null?_.baseLanes:l,it(_a,Nn),Nn|=d}else _!==null?(d=_.baseLanes|l,o.memoizedState=null):d=l,it(_a,Nn),Nn|=d;return cn(i,o,m,l),o.child}function cv(i,o){var l=o.ref;(i===null&&l!==null||i!==null&&i.ref!==l)&&(o.flags|=512,o.flags|=2097152)}function mp(i,o,l,d,m){var _=gn(l)?Hs:en.current;return _=aa(o,_),fa(o,m),l=sp(i,o,l,d,_,m),d=op(),i!==null&&!_n?(o.updateQueue=i.updateQueue,o.flags&=-2053,i.lanes&=~m,si(i,o,m)):(ht&&d&&zf(o),o.flags|=1,cn(i,o,l,m),o.child)}function hv(i,o,l,d,m){if(gn(l)){var _=!0;Wc(o)}else _=!1;if(fa(o,m),o.stateNode===null)lh(i,o),Zy(o,l,d),dp(o,l,d,m),d=!0;else if(i===null){var T=o.stateNode,P=o.memoizedProps;T.props=P;var M=T.context,H=l.contextType;typeof H=="object"&&H!==null?H=$n(H):(H=gn(l)?Hs:en.current,H=aa(o,H));var ee=l.getDerivedStateFromProps,te=typeof ee=="function"||typeof T.getSnapshotBeforeUpdate=="function";te||typeof T.UNSAFE_componentWillReceiveProps!="function"&&typeof T.componentWillReceiveProps!="function"||(P!==d||M!==H)&&ev(o,T,d,H),$i=!1;var Z=o.memoizedState;T.state=Z,Zc(o,d,T,m),M=o.memoizedState,P!==d||Z!==M||mn.current||$i?(typeof ee=="function"&&(hp(o,l,ee,d),M=o.memoizedState),(P=$i||Xy(o,l,P,d,Z,M,H))?(te||typeof T.UNSAFE_componentWillMount!="function"&&typeof T.componentWillMount!="function"||(typeof T.componentWillMount=="function"&&T.componentWillMount(),typeof T.UNSAFE_componentWillMount=="function"&&T.UNSAFE_componentWillMount()),typeof T.componentDidMount=="function"&&(o.flags|=4194308)):(typeof T.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=d,o.memoizedState=M),T.props=d,T.state=M,T.context=H,d=P):(typeof T.componentDidMount=="function"&&(o.flags|=4194308),d=!1)}else{T=o.stateNode,ky(i,o),P=o.memoizedProps,H=o.type===o.elementType?P:or(o.type,P),T.props=H,te=o.pendingProps,Z=T.context,M=l.contextType,typeof M=="object"&&M!==null?M=$n(M):(M=gn(l)?Hs:en.current,M=aa(o,M));var he=l.getDerivedStateFromProps;(ee=typeof he=="function"||typeof T.getSnapshotBeforeUpdate=="function")||typeof T.UNSAFE_componentWillReceiveProps!="function"&&typeof T.componentWillReceiveProps!="function"||(P!==te||Z!==M)&&ev(o,T,d,M),$i=!1,Z=o.memoizedState,T.state=Z,Zc(o,d,T,m);var me=o.memoizedState;P!==te||Z!==me||mn.current||$i?(typeof he=="function"&&(hp(o,l,he,d),me=o.memoizedState),(H=$i||Xy(o,l,H,d,Z,me,M)||!1)?(ee||typeof T.UNSAFE_componentWillUpdate!="function"&&typeof T.componentWillUpdate!="function"||(typeof T.componentWillUpdate=="function"&&T.componentWillUpdate(d,me,M),typeof T.UNSAFE_componentWillUpdate=="function"&&T.UNSAFE_componentWillUpdate(d,me,M)),typeof T.componentDidUpdate=="function"&&(o.flags|=4),typeof T.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof T.componentDidUpdate!="function"||P===i.memoizedProps&&Z===i.memoizedState||(o.flags|=4),typeof T.getSnapshotBeforeUpdate!="function"||P===i.memoizedProps&&Z===i.memoizedState||(o.flags|=1024),o.memoizedProps=d,o.memoizedState=me),T.props=d,T.state=me,T.context=M,d=H):(typeof T.componentDidUpdate!="function"||P===i.memoizedProps&&Z===i.memoizedState||(o.flags|=4),typeof T.getSnapshotBeforeUpdate!="function"||P===i.memoizedProps&&Z===i.memoizedState||(o.flags|=1024),d=!1)}return gp(i,o,l,d,_,m)}function gp(i,o,l,d,m,_){cv(i,o);var T=(o.flags&128)!==0;if(!d&&!T)return m&&gy(o,l,!1),si(i,o,_);d=o.stateNode,RA.current=o;var P=T&&typeof l.getDerivedStateFromError!="function"?null:d.render();return o.flags|=1,i!==null&&T?(o.child=ha(o,i.child,null,_),o.child=ha(o,null,P,_)):cn(i,o,P,_),o.memoizedState=d.state,m&&gy(o,l,!0),o.child}function dv(i){var o=i.stateNode;o.pendingContext?py(i,o.pendingContext,o.pendingContext!==o.context):o.context&&py(i,o.context,!1),Zf(i,o.containerInfo)}function fv(i,o,l,d,m){return ca(),Gf(m),o.flags|=256,cn(i,o,l,d),o.child}var _p={dehydrated:null,treeContext:null,retryLane:0};function yp(i){return{baseLanes:i,cachePool:null,transitions:null}}function pv(i,o,l){var d=o.pendingProps,m=dt.current,_=!1,T=(o.flags&128)!==0,P;if((P=T)||(P=i!==null&&i.memoizedState===null?!1:(m&2)!==0),P?(_=!0,o.flags&=-129):(i===null||i.memoizedState!==null)&&(m|=1),it(dt,m&1),i===null)return Hf(o),i=o.memoizedState,i!==null&&(i=i.dehydrated,i!==null)?((o.mode&1)===0?o.lanes=1:i.data==="$!"?o.lanes=8:o.lanes=1073741824,null):(T=d.children,i=d.fallback,_?(d=o.mode,_=o.child,T={mode:"hidden",children:T},(d&1)===0&&_!==null?(_.childLanes=0,_.pendingProps=T):_=wh(T,d,0,null),i=to(i,d,l,null),_.return=o,i.return=o,_.sibling=i,o.child=_,o.child.memoizedState=yp(l),o.memoizedState=_p,i):vp(o,T));if(m=i.memoizedState,m!==null&&(P=m.dehydrated,P!==null))return xA(i,o,T,d,P,m,l);if(_){_=d.fallback,T=o.mode,m=i.child,P=m.sibling;var M={mode:"hidden",children:d.children};return(T&1)===0&&o.child!==m?(d=o.child,d.childLanes=0,d.pendingProps=M,o.deletions=null):(d=Yi(m,M),d.subtreeFlags=m.subtreeFlags&14680064),P!==null?_=Yi(P,_):(_=to(_,T,l,null),_.flags|=2),_.return=o,d.return=o,d.sibling=_,o.child=d,d=_,_=o.child,T=i.child.memoizedState,T=T===null?yp(l):{baseLanes:T.baseLanes|l,cachePool:null,transitions:T.transitions},_.memoizedState=T,_.childLanes=i.childLanes&~l,o.memoizedState=_p,d}return _=i.child,i=_.sibling,d=Yi(_,{mode:"visible",children:d.children}),(o.mode&1)===0&&(d.lanes=l),d.return=o,d.sibling=null,i!==null&&(l=o.deletions,l===null?(o.deletions=[i],o.flags|=16):l.push(i)),o.child=d,o.memoizedState=null,d}function vp(i,o){return o=wh({mode:"visible",children:o},i.mode,0,null),o.return=i,i.child=o}function ah(i,o,l,d){return d!==null&&Gf(d),ha(o,i.child,null,l),i=vp(o,o.pendingProps.children),i.flags|=2,o.memoizedState=null,i}function xA(i,o,l,d,m,_,T){if(l)return o.flags&256?(o.flags&=-257,d=fp(Error(t(422))),ah(i,o,T,d)):o.memoizedState!==null?(o.child=i.child,o.flags|=128,null):(_=d.fallback,m=o.mode,d=wh({mode:"visible",children:d.children},m,0,null),_=to(_,m,T,null),_.flags|=2,d.return=o,_.return=o,d.sibling=_,o.child=d,(o.mode&1)!==0&&ha(o,i.child,null,T),o.child.memoizedState=yp(T),o.memoizedState=_p,_);if((o.mode&1)===0)return ah(i,o,T,null);if(m.data==="$!"){if(d=m.nextSibling&&m.nextSibling.dataset,d)var P=d.dgst;return d=P,_=Error(t(419)),d=fp(_,d,void 0),ah(i,o,T,d)}if(P=(T&i.childLanes)!==0,_n||P){if(d=jt,d!==null){switch(T&-T){case 4:m=2;break;case 16:m=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:m=32;break;case 536870912:m=268435456;break;default:m=0}m=(m&(d.suspendedLanes|T))!==0?0:m,m!==0&&m!==_.retryLane&&(_.retryLane=m,ri(i,m),ur(d,i,m,-1))}return Lp(),d=fp(Error(t(421))),ah(i,o,T,d)}return m.data==="$?"?(o.flags|=128,o.child=i.child,o=zA.bind(null,i),m._reactRetry=o,null):(i=_.treeContext,bn=ji(m.nextSibling),Pn=o,ht=!0,sr=null,i!==null&&(Bn[zn++]=ti,Bn[zn++]=ni,Bn[zn++]=Gs,ti=i.id,ni=i.overflow,Gs=o),o=vp(o,d.children),o.flags|=4096,o)}function mv(i,o,l){i.lanes|=o;var d=i.alternate;d!==null&&(d.lanes|=o),Yf(i.return,o,l)}function wp(i,o,l,d,m){var _=i.memoizedState;_===null?i.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:d,tail:l,tailMode:m}:(_.isBackwards=o,_.rendering=null,_.renderingStartTime=0,_.last=d,_.tail=l,_.tailMode=m)}function gv(i,o,l){var d=o.pendingProps,m=d.revealOrder,_=d.tail;if(cn(i,o,d.children,l),d=dt.current,(d&2)!==0)d=d&1|2,o.flags|=128;else{if(i!==null&&(i.flags&128)!==0)e:for(i=o.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&mv(i,l,o);else if(i.tag===19)mv(i,l,o);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===o)break e;for(;i.sibling===null;){if(i.return===null||i.return===o)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}d&=1}if(it(dt,d),(o.mode&1)===0)o.memoizedState=null;else switch(m){case"forwards":for(l=o.child,m=null;l!==null;)i=l.alternate,i!==null&&eh(i)===null&&(m=l),l=l.sibling;l=m,l===null?(m=o.child,o.child=null):(m=l.sibling,l.sibling=null),wp(o,!1,m,l,_);break;case"backwards":for(l=null,m=o.child,o.child=null;m!==null;){if(i=m.alternate,i!==null&&eh(i)===null){o.child=m;break}i=m.sibling,m.sibling=l,l=m,m=i}wp(o,!0,l,null,_);break;case"together":wp(o,!1,null,null,void 0);break;default:o.memoizedState=null}return o.child}function lh(i,o){(o.mode&1)===0&&i!==null&&(i.alternate=null,o.alternate=null,o.flags|=2)}function si(i,o,l){if(i!==null&&(o.dependencies=i.dependencies),Js|=o.lanes,(l&o.childLanes)===0)return null;if(i!==null&&o.child!==i.child)throw Error(t(153));if(o.child!==null){for(i=o.child,l=Yi(i,i.pendingProps),o.child=l,l.return=o;i.sibling!==null;)i=i.sibling,l=l.sibling=Yi(i,i.pendingProps),l.return=o;l.sibling=null}return o.child}function PA(i,o,l){switch(o.tag){case 3:dv(o),ca();break;case 5:Py(o);break;case 1:gn(o.type)&&Wc(o);break;case 4:Zf(o,o.stateNode.containerInfo);break;case 10:var d=o.type._context,m=o.memoizedProps.value;it(Yc,d._currentValue),d._currentValue=m;break;case 13:if(d=o.memoizedState,d!==null)return d.dehydrated!==null?(it(dt,dt.current&1),o.flags|=128,null):(l&o.child.childLanes)!==0?pv(i,o,l):(it(dt,dt.current&1),i=si(i,o,l),i!==null?i.sibling:null);it(dt,dt.current&1);break;case 19:if(d=(l&o.childLanes)!==0,(i.flags&128)!==0){if(d)return gv(i,o,l);o.flags|=128}if(m=o.memoizedState,m!==null&&(m.rendering=null,m.tail=null,m.lastEffect=null),it(dt,dt.current),d)break;return null;case 22:case 23:return o.lanes=0,uv(i,o,l)}return si(i,o,l)}var _v,Ep,yv,vv;_v=function(i,o){for(var l=o.child;l!==null;){if(l.tag===5||l.tag===6)i.appendChild(l.stateNode);else if(l.tag!==4&&l.child!==null){l.child.return=l,l=l.child;continue}if(l===o)break;for(;l.sibling===null;){if(l.return===null||l.return===o)return;l=l.return}l.sibling.return=l.return,l=l.sibling}},Ep=function(){},yv=function(i,o,l,d){var m=i.memoizedProps;if(m!==d){i=o.stateNode,Qs(Cr.current);var _=null;switch(l){case"input":m=Rs(i,m),d=Rs(i,d),_=[];break;case"select":m=ae({},m,{value:void 0}),d=ae({},d,{value:void 0}),_=[];break;case"textarea":m=hl(i,m),d=hl(i,d),_=[];break;default:typeof m.onClick!="function"&&typeof d.onClick=="function"&&(i.onclick=Bc)}_l(l,d);var T;l=null;for(H in m)if(!d.hasOwnProperty(H)&&m.hasOwnProperty(H)&&m[H]!=null)if(H==="style"){var P=m[H];for(T in P)P.hasOwnProperty(T)&&(l||(l={}),l[T]="")}else H!=="dangerouslySetInnerHTML"&&H!=="children"&&H!=="suppressContentEditableWarning"&&H!=="suppressHydrationWarning"&&H!=="autoFocus"&&(s.hasOwnProperty(H)?_||(_=[]):(_=_||[]).push(H,null));for(H in d){var M=d[H];if(P=m?.[H],d.hasOwnProperty(H)&&M!==P&&(M!=null||P!=null))if(H==="style")if(P){for(T in P)!P.hasOwnProperty(T)||M&&M.hasOwnProperty(T)||(l||(l={}),l[T]="");for(T in M)M.hasOwnProperty(T)&&P[T]!==M[T]&&(l||(l={}),l[T]=M[T])}else l||(_||(_=[]),_.push(H,l)),l=M;else H==="dangerouslySetInnerHTML"?(M=M?M.__html:void 0,P=P?P.__html:void 0,M!=null&&P!==M&&(_=_||[]).push(H,M)):H==="children"?typeof M!="string"&&typeof M!="number"||(_=_||[]).push(H,""+M):H!=="suppressContentEditableWarning"&&H!=="suppressHydrationWarning"&&(s.hasOwnProperty(H)?(M!=null&&H==="onScroll"&&ot("scroll",i),_||P===M||(_=[])):(_=_||[]).push(H,M))}l&&(_=_||[]).push("style",l);var H=_;(o.updateQueue=H)&&(o.flags|=4)}},vv=function(i,o,l,d){l!==d&&(o.flags|=4)};function Jl(i,o){if(!ht)switch(i.tailMode){case"hidden":o=i.tail;for(var l=null;o!==null;)o.alternate!==null&&(l=o),o=o.sibling;l===null?i.tail=null:l.sibling=null;break;case"collapsed":l=i.tail;for(var d=null;l!==null;)l.alternate!==null&&(d=l),l=l.sibling;d===null?o||i.tail===null?i.tail=null:i.tail.sibling=null:d.sibling=null}}function nn(i){var o=i.alternate!==null&&i.alternate.child===i.child,l=0,d=0;if(o)for(var m=i.child;m!==null;)l|=m.lanes|m.childLanes,d|=m.subtreeFlags&14680064,d|=m.flags&14680064,m.return=i,m=m.sibling;else for(m=i.child;m!==null;)l|=m.lanes|m.childLanes,d|=m.subtreeFlags,d|=m.flags,m.return=i,m=m.sibling;return i.subtreeFlags|=d,i.childLanes=l,o}function bA(i,o,l){var d=o.pendingProps;switch($f(o),o.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return nn(o),null;case 1:return gn(o.type)&&$c(),nn(o),null;case 3:return d=o.stateNode,pa(),at(mn),at(en),np(),d.pendingContext&&(d.context=d.pendingContext,d.pendingContext=null),(i===null||i.child===null)&&(Kc(o)?o.flags|=4:i===null||i.memoizedState.isDehydrated&&(o.flags&256)===0||(o.flags|=1024,sr!==null&&(Np(sr),sr=null))),Ep(i,o),nn(o),null;case 5:ep(o);var m=Qs(Gl.current);if(l=o.type,i!==null&&o.stateNode!=null)yv(i,o,l,d,m),i.ref!==o.ref&&(o.flags|=512,o.flags|=2097152);else{if(!d){if(o.stateNode===null)throw Error(t(166));return nn(o),null}if(i=Qs(Cr.current),Kc(o)){d=o.stateNode,l=o.type;var _=o.memoizedProps;switch(d[Ir]=o,d[Bl]=_,i=(o.mode&1)!==0,l){case"dialog":ot("cancel",d),ot("close",d);break;case"iframe":case"object":case"embed":ot("load",d);break;case"video":case"audio":for(m=0;m<Fl.length;m++)ot(Fl[m],d);break;case"source":ot("error",d);break;case"img":case"image":case"link":ot("error",d),ot("load",d);break;case"details":ot("toggle",d);break;case"input":xo(d,_),ot("invalid",d);break;case"select":d._wrapperState={wasMultiple:!!_.multiple},ot("invalid",d);break;case"textarea":bo(d,_),ot("invalid",d)}_l(l,_),m=null;for(var T in _)if(_.hasOwnProperty(T)){var P=_[T];T==="children"?typeof P=="string"?d.textContent!==P&&(_.suppressHydrationWarning!==!0&&Uc(d.textContent,P,i),m=["children",P]):typeof P=="number"&&d.textContent!==""+P&&(_.suppressHydrationWarning!==!0&&Uc(d.textContent,P,i),m=["children",""+P]):s.hasOwnProperty(T)&&P!=null&&T==="onScroll"&&ot("scroll",d)}switch(l){case"input":$r(d),dc(d,_,!0);break;case"textarea":$r(d),dl(d);break;case"select":case"option":break;default:typeof _.onClick=="function"&&(d.onclick=Bc)}d=m,o.updateQueue=d,d!==null&&(o.flags|=4)}else{T=m.nodeType===9?m:m.ownerDocument,i==="http://www.w3.org/1999/xhtml"&&(i=Pt(l)),i==="http://www.w3.org/1999/xhtml"?l==="script"?(i=T.createElement("div"),i.innerHTML="<script><\/script>",i=i.removeChild(i.firstChild)):typeof d.is=="string"?i=T.createElement(l,{is:d.is}):(i=T.createElement(l),l==="select"&&(T=i,d.multiple?T.multiple=!0:d.size&&(T.size=d.size))):i=T.createElementNS(i,l),i[Ir]=o,i[Bl]=d,_v(i,o,!1,!1),o.stateNode=i;e:{switch(T=yl(l,d),l){case"dialog":ot("cancel",i),ot("close",i),m=d;break;case"iframe":case"object":case"embed":ot("load",i),m=d;break;case"video":case"audio":for(m=0;m<Fl.length;m++)ot(Fl[m],i);m=d;break;case"source":ot("error",i),m=d;break;case"img":case"image":case"link":ot("error",i),ot("load",i),m=d;break;case"details":ot("toggle",i),m=d;break;case"input":xo(i,d),m=Rs(i,d),ot("invalid",i);break;case"option":m=d;break;case"select":i._wrapperState={wasMultiple:!!d.multiple},m=ae({},d,{value:void 0}),ot("invalid",i);break;case"textarea":bo(i,d),m=hl(i,d),ot("invalid",i);break;default:m=d}_l(l,m),P=m;for(_ in P)if(P.hasOwnProperty(_)){var M=P[_];_==="style"?ml(i,M):_==="dangerouslySetInnerHTML"?(M=M?M.__html:void 0,M!=null&&fl(i,M)):_==="children"?typeof M=="string"?(l!=="textarea"||M!=="")&&Ri(i,M):typeof M=="number"&&Ri(i,""+M):_!=="suppressContentEditableWarning"&&_!=="suppressHydrationWarning"&&_!=="autoFocus"&&(s.hasOwnProperty(_)?M!=null&&_==="onScroll"&&ot("scroll",i):M!=null&&G(i,_,M,T))}switch(l){case"input":$r(i),dc(i,d,!1);break;case"textarea":$r(i),dl(i);break;case"option":d.value!=null&&i.setAttribute("value",""+qe(d.value));break;case"select":i.multiple=!!d.multiple,_=d.value,_!=null?Hr(i,!!d.multiple,_,!1):d.defaultValue!=null&&Hr(i,!!d.multiple,d.defaultValue,!0);break;default:typeof m.onClick=="function"&&(i.onclick=Bc)}switch(l){case"button":case"input":case"select":case"textarea":d=!!d.autoFocus;break e;case"img":d=!0;break e;default:d=!1}}d&&(o.flags|=4)}o.ref!==null&&(o.flags|=512,o.flags|=2097152)}return nn(o),null;case 6:if(i&&o.stateNode!=null)vv(i,o,i.memoizedProps,d);else{if(typeof d!="string"&&o.stateNode===null)throw Error(t(166));if(l=Qs(Gl.current),Qs(Cr.current),Kc(o)){if(d=o.stateNode,l=o.memoizedProps,d[Ir]=o,(_=d.nodeValue!==l)&&(i=Pn,i!==null))switch(i.tag){case 3:Uc(d.nodeValue,l,(i.mode&1)!==0);break;case 5:i.memoizedProps.suppressHydrationWarning!==!0&&Uc(d.nodeValue,l,(i.mode&1)!==0)}_&&(o.flags|=4)}else d=(l.nodeType===9?l:l.ownerDocument).createTextNode(d),d[Ir]=o,o.stateNode=d}return nn(o),null;case 13:if(at(dt),d=o.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(ht&&bn!==null&&(o.mode&1)!==0&&(o.flags&128)===0)Ty(),ca(),o.flags|=98560,_=!1;else if(_=Kc(o),d!==null&&d.dehydrated!==null){if(i===null){if(!_)throw Error(t(318));if(_=o.memoizedState,_=_!==null?_.dehydrated:null,!_)throw Error(t(317));_[Ir]=o}else ca(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;nn(o),_=!1}else sr!==null&&(Np(sr),sr=null),_=!0;if(!_)return o.flags&65536?o:null}return(o.flags&128)!==0?(o.lanes=l,o):(d=d!==null,d!==(i!==null&&i.memoizedState!==null)&&d&&(o.child.flags|=8192,(o.mode&1)!==0&&(i===null||(dt.current&1)!==0?Ot===0&&(Ot=3):Lp())),o.updateQueue!==null&&(o.flags|=4),nn(o),null);case 4:return pa(),Ep(i,o),i===null&&jl(o.stateNode.containerInfo),nn(o),null;case 10:return Qf(o.type._context),nn(o),null;case 17:return gn(o.type)&&$c(),nn(o),null;case 19:if(at(dt),_=o.memoizedState,_===null)return nn(o),null;if(d=(o.flags&128)!==0,T=_.rendering,T===null)if(d)Jl(_,!1);else{if(Ot!==0||i!==null&&(i.flags&128)!==0)for(i=o.child;i!==null;){if(T=eh(i),T!==null){for(o.flags|=128,Jl(_,!1),d=T.updateQueue,d!==null&&(o.updateQueue=d,o.flags|=4),o.subtreeFlags=0,d=l,l=o.child;l!==null;)_=l,i=d,_.flags&=14680066,T=_.alternate,T===null?(_.childLanes=0,_.lanes=i,_.child=null,_.subtreeFlags=0,_.memoizedProps=null,_.memoizedState=null,_.updateQueue=null,_.dependencies=null,_.stateNode=null):(_.childLanes=T.childLanes,_.lanes=T.lanes,_.child=T.child,_.subtreeFlags=0,_.deletions=null,_.memoizedProps=T.memoizedProps,_.memoizedState=T.memoizedState,_.updateQueue=T.updateQueue,_.type=T.type,i=T.dependencies,_.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),l=l.sibling;return it(dt,dt.current&1|2),o.child}i=i.sibling}_.tail!==null&&rt()>ya&&(o.flags|=128,d=!0,Jl(_,!1),o.lanes=4194304)}else{if(!d)if(i=eh(T),i!==null){if(o.flags|=128,d=!0,l=i.updateQueue,l!==null&&(o.updateQueue=l,o.flags|=4),Jl(_,!0),_.tail===null&&_.tailMode==="hidden"&&!T.alternate&&!ht)return nn(o),null}else 2*rt()-_.renderingStartTime>ya&&l!==1073741824&&(o.flags|=128,d=!0,Jl(_,!1),o.lanes=4194304);_.isBackwards?(T.sibling=o.child,o.child=T):(l=_.last,l!==null?l.sibling=T:o.child=T,_.last=T)}return _.tail!==null?(o=_.tail,_.rendering=o,_.tail=o.sibling,_.renderingStartTime=rt(),o.sibling=null,l=dt.current,it(dt,d?l&1|2:l&1),o):(nn(o),null);case 22:case 23:return Op(),d=o.memoizedState!==null,i!==null&&i.memoizedState!==null!==d&&(o.flags|=8192),d&&(o.mode&1)!==0?(Nn&1073741824)!==0&&(nn(o),o.subtreeFlags&6&&(o.flags|=8192)):nn(o),null;case 24:return null;case 25:return null}throw Error(t(156,o.tag))}function NA(i,o){switch($f(o),o.tag){case 1:return gn(o.type)&&$c(),i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 3:return pa(),at(mn),at(en),np(),i=o.flags,(i&65536)!==0&&(i&128)===0?(o.flags=i&-65537|128,o):null;case 5:return ep(o),null;case 13:if(at(dt),i=o.memoizedState,i!==null&&i.dehydrated!==null){if(o.alternate===null)throw Error(t(340));ca()}return i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 19:return at(dt),null;case 4:return pa(),null;case 10:return Qf(o.type._context),null;case 22:case 23:return Op(),null;case 24:return null;default:return null}}var uh=!1,rn=!1,DA=typeof WeakSet=="function"?WeakSet:Set,pe=null;function ga(i,o){var l=i.ref;if(l!==null)if(typeof l=="function")try{l(null)}catch(d){mt(i,o,d)}else l.current=null}function Tp(i,o,l){try{l()}catch(d){mt(i,o,d)}}var wv=!1;function OA(i,o){if(Of=Mi,i=X_(),Af(i)){if("selectionStart"in i)var l={start:i.selectionStart,end:i.selectionEnd};else e:{l=(l=i.ownerDocument)&&l.defaultView||window;var d=l.getSelection&&l.getSelection();if(d&&d.rangeCount!==0){l=d.anchorNode;var m=d.anchorOffset,_=d.focusNode;d=d.focusOffset;try{l.nodeType,_.nodeType}catch{l=null;break e}var T=0,P=-1,M=-1,H=0,ee=0,te=i,Z=null;t:for(;;){for(var he;te!==l||m!==0&&te.nodeType!==3||(P=T+m),te!==_||d!==0&&te.nodeType!==3||(M=T+d),te.nodeType===3&&(T+=te.nodeValue.length),(he=te.firstChild)!==null;)Z=te,te=he;for(;;){if(te===i)break t;if(Z===l&&++H===m&&(P=T),Z===_&&++ee===d&&(M=T),(he=te.nextSibling)!==null)break;te=Z,Z=te.parentNode}te=he}l=P===-1||M===-1?null:{start:P,end:M}}else l=null}l=l||{start:0,end:0}}else l=null;for(Lf={focusedElem:i,selectionRange:l},Mi=!1,pe=o;pe!==null;)if(o=pe,i=o.child,(o.subtreeFlags&1028)!==0&&i!==null)i.return=o,pe=i;else for(;pe!==null;){o=pe;try{var me=o.alternate;if((o.flags&1024)!==0)switch(o.tag){case 0:case 11:case 15:break;case 1:if(me!==null){var ge=me.memoizedProps,yt=me.memoizedState,$=o.stateNode,F=$.getSnapshotBeforeUpdate(o.elementType===o.type?ge:or(o.type,ge),yt);$.__reactInternalSnapshotBeforeUpdate=F}break;case 3:var W=o.stateNode.containerInfo;W.nodeType===1?W.textContent="":W.nodeType===9&&W.documentElement&&W.removeChild(W.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(re){mt(o,o.return,re)}if(i=o.sibling,i!==null){i.return=o.return,pe=i;break}pe=o.return}return me=wv,wv=!1,me}function Xl(i,o,l){var d=o.updateQueue;if(d=d!==null?d.lastEffect:null,d!==null){var m=d=d.next;do{if((m.tag&i)===i){var _=m.destroy;m.destroy=void 0,_!==void 0&&Tp(o,l,_)}m=m.next}while(m!==d)}}function ch(i,o){if(o=o.updateQueue,o=o!==null?o.lastEffect:null,o!==null){var l=o=o.next;do{if((l.tag&i)===i){var d=l.create;l.destroy=d()}l=l.next}while(l!==o)}}function Ip(i){var o=i.ref;if(o!==null){var l=i.stateNode;switch(i.tag){case 5:i=l;break;default:i=l}typeof o=="function"?o(i):o.current=i}}function Ev(i){var o=i.alternate;o!==null&&(i.alternate=null,Ev(o)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(o=i.stateNode,o!==null&&(delete o[Ir],delete o[Bl],delete o[jf],delete o[gA],delete o[_A])),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}function Tv(i){return i.tag===5||i.tag===3||i.tag===4}function Iv(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||Tv(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function Cp(i,o,l){var d=i.tag;if(d===5||d===6)i=i.stateNode,o?l.nodeType===8?l.parentNode.insertBefore(i,o):l.insertBefore(i,o):(l.nodeType===8?(o=l.parentNode,o.insertBefore(i,l)):(o=l,o.appendChild(i)),l=l._reactRootContainer,l!=null||o.onclick!==null||(o.onclick=Bc));else if(d!==4&&(i=i.child,i!==null))for(Cp(i,o,l),i=i.sibling;i!==null;)Cp(i,o,l),i=i.sibling}function Sp(i,o,l){var d=i.tag;if(d===5||d===6)i=i.stateNode,o?l.insertBefore(i,o):l.appendChild(i);else if(d!==4&&(i=i.child,i!==null))for(Sp(i,o,l),i=i.sibling;i!==null;)Sp(i,o,l),i=i.sibling}var qt=null,ar=!1;function Hi(i,o,l){for(l=l.child;l!==null;)Cv(i,o,l),l=l.sibling}function Cv(i,o,l){if(An&&typeof An.onCommitFiberUnmount=="function")try{An.onCommitFiberUnmount(Vs,l)}catch{}switch(l.tag){case 5:rn||ga(l,o);case 6:var d=qt,m=ar;qt=null,Hi(i,o,l),qt=d,ar=m,qt!==null&&(ar?(i=qt,l=l.stateNode,i.nodeType===8?i.parentNode.removeChild(l):i.removeChild(l)):qt.removeChild(l.stateNode));break;case 18:qt!==null&&(ar?(i=qt,l=l.stateNode,i.nodeType===8?Ff(i.parentNode,l):i.nodeType===1&&Ff(i,l),nr(i)):Ff(qt,l.stateNode));break;case 4:d=qt,m=ar,qt=l.stateNode.containerInfo,ar=!0,Hi(i,o,l),qt=d,ar=m;break;case 0:case 11:case 14:case 15:if(!rn&&(d=l.updateQueue,d!==null&&(d=d.lastEffect,d!==null))){m=d=d.next;do{var _=m,T=_.destroy;_=_.tag,T!==void 0&&((_&2)!==0||(_&4)!==0)&&Tp(l,o,T),m=m.next}while(m!==d)}Hi(i,o,l);break;case 1:if(!rn&&(ga(l,o),d=l.stateNode,typeof d.componentWillUnmount=="function"))try{d.props=l.memoizedProps,d.state=l.memoizedState,d.componentWillUnmount()}catch(P){mt(l,o,P)}Hi(i,o,l);break;case 21:Hi(i,o,l);break;case 22:l.mode&1?(rn=(d=rn)||l.memoizedState!==null,Hi(i,o,l),rn=d):Hi(i,o,l);break;default:Hi(i,o,l)}}function Sv(i){var o=i.updateQueue;if(o!==null){i.updateQueue=null;var l=i.stateNode;l===null&&(l=i.stateNode=new DA),o.forEach(function(d){var m=$A.bind(null,i,d);l.has(d)||(l.add(d),d.then(m,m))})}}function lr(i,o){var l=o.deletions;if(l!==null)for(var d=0;d<l.length;d++){var m=l[d];try{var _=i,T=o,P=T;e:for(;P!==null;){switch(P.tag){case 5:qt=P.stateNode,ar=!1;break e;case 3:qt=P.stateNode.containerInfo,ar=!0;break e;case 4:qt=P.stateNode.containerInfo,ar=!0;break e}P=P.return}if(qt===null)throw Error(t(160));Cv(_,T,m),qt=null,ar=!1;var M=m.alternate;M!==null&&(M.return=null),m.return=null}catch(H){mt(m,o,H)}}if(o.subtreeFlags&12854)for(o=o.child;o!==null;)Av(o,i),o=o.sibling}function Av(i,o){var l=i.alternate,d=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:if(lr(o,i),Ar(i),d&4){try{Xl(3,i,i.return),ch(3,i)}catch(ge){mt(i,i.return,ge)}try{Xl(5,i,i.return)}catch(ge){mt(i,i.return,ge)}}break;case 1:lr(o,i),Ar(i),d&512&&l!==null&&ga(l,l.return);break;case 5:if(lr(o,i),Ar(i),d&512&&l!==null&&ga(l,l.return),i.flags&32){var m=i.stateNode;try{Ri(m,"")}catch(ge){mt(i,i.return,ge)}}if(d&4&&(m=i.stateNode,m!=null)){var _=i.memoizedProps,T=l!==null?l.memoizedProps:_,P=i.type,M=i.updateQueue;if(i.updateQueue=null,M!==null)try{P==="input"&&_.type==="radio"&&_.name!=null&&ul(m,_),yl(P,T);var H=yl(P,_);for(T=0;T<M.length;T+=2){var ee=M[T],te=M[T+1];ee==="style"?ml(m,te):ee==="dangerouslySetInnerHTML"?fl(m,te):ee==="children"?Ri(m,te):G(m,ee,te,H)}switch(P){case"input":cl(m,_);break;case"textarea":No(m,_);break;case"select":var Z=m._wrapperState.wasMultiple;m._wrapperState.wasMultiple=!!_.multiple;var he=_.value;he!=null?Hr(m,!!_.multiple,he,!1):Z!==!!_.multiple&&(_.defaultValue!=null?Hr(m,!!_.multiple,_.defaultValue,!0):Hr(m,!!_.multiple,_.multiple?[]:"",!1))}m[Bl]=_}catch(ge){mt(i,i.return,ge)}}break;case 6:if(lr(o,i),Ar(i),d&4){if(i.stateNode===null)throw Error(t(162));m=i.stateNode,_=i.memoizedProps;try{m.nodeValue=_}catch(ge){mt(i,i.return,ge)}}break;case 3:if(lr(o,i),Ar(i),d&4&&l!==null&&l.memoizedState.isDehydrated)try{nr(o.containerInfo)}catch(ge){mt(i,i.return,ge)}break;case 4:lr(o,i),Ar(i);break;case 13:lr(o,i),Ar(i),m=i.child,m.flags&8192&&(_=m.memoizedState!==null,m.stateNode.isHidden=_,!_||m.alternate!==null&&m.alternate.memoizedState!==null||(Rp=rt())),d&4&&Sv(i);break;case 22:if(ee=l!==null&&l.memoizedState!==null,i.mode&1?(rn=(H=rn)||ee,lr(o,i),rn=H):lr(o,i),Ar(i),d&8192){if(H=i.memoizedState!==null,(i.stateNode.isHidden=H)&&!ee&&(i.mode&1)!==0)for(pe=i,ee=i.child;ee!==null;){for(te=pe=ee;pe!==null;){switch(Z=pe,he=Z.child,Z.tag){case 0:case 11:case 14:case 15:Xl(4,Z,Z.return);break;case 1:ga(Z,Z.return);var me=Z.stateNode;if(typeof me.componentWillUnmount=="function"){d=Z,l=Z.return;try{o=d,me.props=o.memoizedProps,me.state=o.memoizedState,me.componentWillUnmount()}catch(ge){mt(d,l,ge)}}break;case 5:ga(Z,Z.return);break;case 22:if(Z.memoizedState!==null){xv(te);continue}}he!==null?(he.return=Z,pe=he):xv(te)}ee=ee.sibling}e:for(ee=null,te=i;;){if(te.tag===5){if(ee===null){ee=te;try{m=te.stateNode,H?(_=m.style,typeof _.setProperty=="function"?_.setProperty("display","none","important"):_.display="none"):(P=te.stateNode,M=te.memoizedProps.style,T=M!=null&&M.hasOwnProperty("display")?M.display:null,P.style.display=pl("display",T))}catch(ge){mt(i,i.return,ge)}}}else if(te.tag===6){if(ee===null)try{te.stateNode.nodeValue=H?"":te.memoizedProps}catch(ge){mt(i,i.return,ge)}}else if((te.tag!==22&&te.tag!==23||te.memoizedState===null||te===i)&&te.child!==null){te.child.return=te,te=te.child;continue}if(te===i)break e;for(;te.sibling===null;){if(te.return===null||te.return===i)break e;ee===te&&(ee=null),te=te.return}ee===te&&(ee=null),te.sibling.return=te.return,te=te.sibling}}break;case 19:lr(o,i),Ar(i),d&4&&Sv(i);break;case 21:break;default:lr(o,i),Ar(i)}}function Ar(i){var o=i.flags;if(o&2){try{e:{for(var l=i.return;l!==null;){if(Tv(l)){var d=l;break e}l=l.return}throw Error(t(160))}switch(d.tag){case 5:var m=d.stateNode;d.flags&32&&(Ri(m,""),d.flags&=-33);var _=Iv(i);Sp(i,_,m);break;case 3:case 4:var T=d.stateNode.containerInfo,P=Iv(i);Cp(i,P,T);break;default:throw Error(t(161))}}catch(M){mt(i,i.return,M)}i.flags&=-3}o&4096&&(i.flags&=-4097)}function LA(i,o,l){pe=i,kv(i)}function kv(i,o,l){for(var d=(i.mode&1)!==0;pe!==null;){var m=pe,_=m.child;if(m.tag===22&&d){var T=m.memoizedState!==null||uh;if(!T){var P=m.alternate,M=P!==null&&P.memoizedState!==null||rn;P=uh;var H=rn;if(uh=T,(rn=M)&&!H)for(pe=m;pe!==null;)T=pe,M=T.child,T.tag===22&&T.memoizedState!==null?Pv(m):M!==null?(M.return=T,pe=M):Pv(m);for(;_!==null;)pe=_,kv(_),_=_.sibling;pe=m,uh=P,rn=H}Rv(i)}else(m.subtreeFlags&8772)!==0&&_!==null?(_.return=m,pe=_):Rv(i)}}function Rv(i){for(;pe!==null;){var o=pe;if((o.flags&8772)!==0){var l=o.alternate;try{if((o.flags&8772)!==0)switch(o.tag){case 0:case 11:case 15:rn||ch(5,o);break;case 1:var d=o.stateNode;if(o.flags&4&&!rn)if(l===null)d.componentDidMount();else{var m=o.elementType===o.type?l.memoizedProps:or(o.type,l.memoizedProps);d.componentDidUpdate(m,l.memoizedState,d.__reactInternalSnapshotBeforeUpdate)}var _=o.updateQueue;_!==null&&xy(o,_,d);break;case 3:var T=o.updateQueue;if(T!==null){if(l=null,o.child!==null)switch(o.child.tag){case 5:l=o.child.stateNode;break;case 1:l=o.child.stateNode}xy(o,T,l)}break;case 5:var P=o.stateNode;if(l===null&&o.flags&4){l=P;var M=o.memoizedProps;switch(o.type){case"button":case"input":case"select":case"textarea":M.autoFocus&&l.focus();break;case"img":M.src&&(l.src=M.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(o.memoizedState===null){var H=o.alternate;if(H!==null){var ee=H.memoizedState;if(ee!==null){var te=ee.dehydrated;te!==null&&nr(te)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}rn||o.flags&512&&Ip(o)}catch(Z){mt(o,o.return,Z)}}if(o===i){pe=null;break}if(l=o.sibling,l!==null){l.return=o.return,pe=l;break}pe=o.return}}function xv(i){for(;pe!==null;){var o=pe;if(o===i){pe=null;break}var l=o.sibling;if(l!==null){l.return=o.return,pe=l;break}pe=o.return}}function Pv(i){for(;pe!==null;){var o=pe;try{switch(o.tag){case 0:case 11:case 15:var l=o.return;try{ch(4,o)}catch(M){mt(o,l,M)}break;case 1:var d=o.stateNode;if(typeof d.componentDidMount=="function"){var m=o.return;try{d.componentDidMount()}catch(M){mt(o,m,M)}}var _=o.return;try{Ip(o)}catch(M){mt(o,_,M)}break;case 5:var T=o.return;try{Ip(o)}catch(M){mt(o,T,M)}}}catch(M){mt(o,o.return,M)}if(o===i){pe=null;break}var P=o.sibling;if(P!==null){P.return=o.return,pe=P;break}pe=o.return}}var MA=Math.ceil,hh=J.ReactCurrentDispatcher,Ap=J.ReactCurrentOwner,Hn=J.ReactCurrentBatchConfig,$e=0,jt=null,It=null,Kt=0,Nn=0,_a=Ui(0),Ot=0,Zl=null,Js=0,dh=0,kp=0,eu=null,yn=null,Rp=0,ya=1/0,oi=null,fh=!1,xp=null,Gi=null,ph=!1,qi=null,mh=0,tu=0,Pp=null,gh=-1,_h=0;function hn(){return($e&6)!==0?rt():gh!==-1?gh:gh=rt()}function Ki(i){return(i.mode&1)===0?1:($e&2)!==0&&Kt!==0?Kt&-Kt:vA.transition!==null?(_h===0&&(_h=js()),_h):(i=Ve,i!==0||(i=window.event,i=i===void 0?16:xl(i.type)),i)}function ur(i,o,l,d){if(50<tu)throw tu=0,Pp=null,Error(t(185));Ni(i,l,d),(($e&2)===0||i!==jt)&&(i===jt&&(($e&2)===0&&(dh|=l),Ot===4&&Qi(i,Kt)),vn(i,d),l===1&&$e===0&&(o.mode&1)===0&&(ya=rt()+500,Hc&&zi()))}function vn(i,o){var l=i.callbackNode;Kr(i,o);var d=Fs(i,i===jt?Kt:0);if(d===0)l!==null&&Cl(l),i.callbackNode=null,i.callbackPriority=0;else if(o=d&-d,i.callbackPriority!==o){if(l!=null&&Cl(l),o===1)i.tag===0?yA(Nv.bind(null,i)):_y(Nv.bind(null,i)),pA(function(){($e&6)===0&&zi()}),l=null;else{switch(Oi(d)){case 1:l=Ms;break;case 4:l=xi;break;case 16:l=Fn;break;case 536870912:l=_c;break;default:l=Fn}l=Uv(l,bv.bind(null,i))}i.callbackPriority=o,i.callbackNode=l}}function bv(i,o){if(gh=-1,_h=0,($e&6)!==0)throw Error(t(327));var l=i.callbackNode;if(va()&&i.callbackNode!==l)return null;var d=Fs(i,i===jt?Kt:0);if(d===0)return null;if((d&30)!==0||(d&i.expiredLanes)!==0||o)o=yh(i,d);else{o=d;var m=$e;$e|=2;var _=Ov();(jt!==i||Kt!==o)&&(oi=null,ya=rt()+500,Zs(i,o));do try{jA();break}catch(P){Dv(i,P)}while(!0);Kf(),hh.current=_,$e=m,It!==null?o=0:(jt=null,Kt=0,o=Ot)}if(o!==0){if(o===2&&(m=kn(i),m!==0&&(d=m,o=bp(i,m))),o===1)throw l=Zl,Zs(i,0),Qi(i,d),vn(i,rt()),l;if(o===6)Qi(i,d);else{if(m=i.current.alternate,(d&30)===0&&!VA(m)&&(o=yh(i,d),o===2&&(_=kn(i),_!==0&&(d=_,o=bp(i,_))),o===1))throw l=Zl,Zs(i,0),Qi(i,d),vn(i,rt()),l;switch(i.finishedWork=m,i.finishedLanes=d,o){case 0:case 1:throw Error(t(345));case 2:eo(i,yn,oi);break;case 3:if(Qi(i,d),(d&130023424)===d&&(o=Rp+500-rt(),10<o)){if(Fs(i,0)!==0)break;if(m=i.suspendedLanes,(m&d)!==d){hn(),i.pingedLanes|=i.suspendedLanes&m;break}i.timeoutHandle=Vf(eo.bind(null,i,yn,oi),o);break}eo(i,yn,oi);break;case 4:if(Qi(i,d),(d&4194240)===d)break;for(o=i.eventTimes,m=-1;0<d;){var T=31-ln(d);_=1<<T,T=o[T],T>m&&(m=T),d&=~_}if(d=m,d=rt()-d,d=(120>d?120:480>d?480:1080>d?1080:1920>d?1920:3e3>d?3e3:4320>d?4320:1960*MA(d/1960))-d,10<d){i.timeoutHandle=Vf(eo.bind(null,i,yn,oi),d);break}eo(i,yn,oi);break;case 5:eo(i,yn,oi);break;default:throw Error(t(329))}}}return vn(i,rt()),i.callbackNode===l?bv.bind(null,i):null}function bp(i,o){var l=eu;return i.current.memoizedState.isDehydrated&&(Zs(i,o).flags|=256),i=yh(i,o),i!==2&&(o=yn,yn=l,o!==null&&Np(o)),i}function Np(i){yn===null?yn=i:yn.push.apply(yn,i)}function VA(i){for(var o=i;;){if(o.flags&16384){var l=o.updateQueue;if(l!==null&&(l=l.stores,l!==null))for(var d=0;d<l.length;d++){var m=l[d],_=m.getSnapshot;m=m.value;try{if(!ir(_(),m))return!1}catch{return!1}}}if(l=o.child,o.subtreeFlags&16384&&l!==null)l.return=o,o=l;else{if(o===i)break;for(;o.sibling===null;){if(o.return===null||o.return===i)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function Qi(i,o){for(o&=~kp,o&=~dh,i.suspendedLanes|=o,i.pingedLanes&=~o,i=i.expirationTimes;0<o;){var l=31-ln(o),d=1<<l;i[l]=-1,o&=~d}}function Nv(i){if(($e&6)!==0)throw Error(t(327));va();var o=Fs(i,0);if((o&1)===0)return vn(i,rt()),null;var l=yh(i,o);if(i.tag!==0&&l===2){var d=kn(i);d!==0&&(o=d,l=bp(i,d))}if(l===1)throw l=Zl,Zs(i,0),Qi(i,o),vn(i,rt()),l;if(l===6)throw Error(t(345));return i.finishedWork=i.current.alternate,i.finishedLanes=o,eo(i,yn,oi),vn(i,rt()),null}function Dp(i,o){var l=$e;$e|=1;try{return i(o)}finally{$e=l,$e===0&&(ya=rt()+500,Hc&&zi())}}function Xs(i){qi!==null&&qi.tag===0&&($e&6)===0&&va();var o=$e;$e|=1;var l=Hn.transition,d=Ve;try{if(Hn.transition=null,Ve=1,i)return i()}finally{Ve=d,Hn.transition=l,$e=o,($e&6)===0&&zi()}}function Op(){Nn=_a.current,at(_a)}function Zs(i,o){i.finishedWork=null,i.finishedLanes=0;var l=i.timeoutHandle;if(l!==-1&&(i.timeoutHandle=-1,fA(l)),It!==null)for(l=It.return;l!==null;){var d=l;switch($f(d),d.tag){case 1:d=d.type.childContextTypes,d!=null&&$c();break;case 3:pa(),at(mn),at(en),np();break;case 5:ep(d);break;case 4:pa();break;case 13:at(dt);break;case 19:at(dt);break;case 10:Qf(d.type._context);break;case 22:case 23:Op()}l=l.return}if(jt=i,It=i=Yi(i.current,null),Kt=Nn=o,Ot=0,Zl=null,kp=dh=Js=0,yn=eu=null,Ks!==null){for(o=0;o<Ks.length;o++)if(l=Ks[o],d=l.interleaved,d!==null){l.interleaved=null;var m=d.next,_=l.pending;if(_!==null){var T=_.next;_.next=m,d.next=T}l.pending=d}Ks=null}return i}function Dv(i,o){do{var l=It;try{if(Kf(),th.current=sh,nh){for(var d=ft.memoizedState;d!==null;){var m=d.queue;m!==null&&(m.pending=null),d=d.next}nh=!1}if(Ys=0,Ft=Dt=ft=null,ql=!1,Kl=0,Ap.current=null,l===null||l.return===null){Ot=1,Zl=o,It=null;break}e:{var _=i,T=l.return,P=l,M=o;if(o=Kt,P.flags|=32768,M!==null&&typeof M=="object"&&typeof M.then=="function"){var H=M,ee=P,te=ee.tag;if((ee.mode&1)===0&&(te===0||te===11||te===15)){var Z=ee.alternate;Z?(ee.updateQueue=Z.updateQueue,ee.memoizedState=Z.memoizedState,ee.lanes=Z.lanes):(ee.updateQueue=null,ee.memoizedState=null)}var he=iv(T);if(he!==null){he.flags&=-257,sv(he,T,P,_,o),he.mode&1&&rv(_,H,o),o=he,M=H;var me=o.updateQueue;if(me===null){var ge=new Set;ge.add(M),o.updateQueue=ge}else me.add(M);break e}else{if((o&1)===0){rv(_,H,o),Lp();break e}M=Error(t(426))}}else if(ht&&P.mode&1){var yt=iv(T);if(yt!==null){(yt.flags&65536)===0&&(yt.flags|=256),sv(yt,T,P,_,o),Gf(ma(M,P));break e}}_=M=ma(M,P),Ot!==4&&(Ot=2),eu===null?eu=[_]:eu.push(_),_=T;do{switch(_.tag){case 3:_.flags|=65536,o&=-o,_.lanes|=o;var $=tv(_,M,o);Ry(_,$);break e;case 1:P=M;var F=_.type,W=_.stateNode;if((_.flags&128)===0&&(typeof F.getDerivedStateFromError=="function"||W!==null&&typeof W.componentDidCatch=="function"&&(Gi===null||!Gi.has(W)))){_.flags|=65536,o&=-o,_.lanes|=o;var re=nv(_,P,o);Ry(_,re);break e}}_=_.return}while(_!==null)}Mv(l)}catch(_e){o=_e,It===l&&l!==null&&(It=l=l.return);continue}break}while(!0)}function Ov(){var i=hh.current;return hh.current=sh,i===null?sh:i}function Lp(){(Ot===0||Ot===3||Ot===2)&&(Ot=4),jt===null||(Js&268435455)===0&&(dh&268435455)===0||Qi(jt,Kt)}function yh(i,o){var l=$e;$e|=2;var d=Ov();(jt!==i||Kt!==o)&&(oi=null,Zs(i,o));do try{FA();break}catch(m){Dv(i,m)}while(!0);if(Kf(),$e=l,hh.current=d,It!==null)throw Error(t(261));return jt=null,Kt=0,Ot}function FA(){for(;It!==null;)Lv(It)}function jA(){for(;It!==null&&!mc();)Lv(It)}function Lv(i){var o=jv(i.alternate,i,Nn);i.memoizedProps=i.pendingProps,o===null?Mv(i):It=o,Ap.current=null}function Mv(i){var o=i;do{var l=o.alternate;if(i=o.return,(o.flags&32768)===0){if(l=bA(l,o,Nn),l!==null){It=l;return}}else{if(l=NA(l,o),l!==null){l.flags&=32767,It=l;return}if(i!==null)i.flags|=32768,i.subtreeFlags=0,i.deletions=null;else{Ot=6,It=null;return}}if(o=o.sibling,o!==null){It=o;return}It=o=i}while(o!==null);Ot===0&&(Ot=5)}function eo(i,o,l){var d=Ve,m=Hn.transition;try{Hn.transition=null,Ve=1,UA(i,o,l,d)}finally{Hn.transition=m,Ve=d}return null}function UA(i,o,l,d){do va();while(qi!==null);if(($e&6)!==0)throw Error(t(327));l=i.finishedWork;var m=i.finishedLanes;if(l===null)return null;if(i.finishedWork=null,i.finishedLanes=0,l===i.current)throw Error(t(177));i.callbackNode=null,i.callbackPriority=0;var _=l.lanes|l.childLanes;if(et(i,_),i===jt&&(It=jt=null,Kt=0),(l.subtreeFlags&2064)===0&&(l.flags&2064)===0||ph||(ph=!0,Uv(Fn,function(){return va(),null})),_=(l.flags&15990)!==0,(l.subtreeFlags&15990)!==0||_){_=Hn.transition,Hn.transition=null;var T=Ve;Ve=1;var P=$e;$e|=4,Ap.current=null,OA(i,l),Av(l,i),oA(Lf),Mi=!!Of,Lf=Of=null,i.current=l,LA(l),yf(),$e=P,Ve=T,Hn.transition=_}else i.current=l;if(ph&&(ph=!1,qi=i,mh=m),_=i.pendingLanes,_===0&&(Gi=null),yc(l.stateNode),vn(i,rt()),o!==null)for(d=i.onRecoverableError,l=0;l<o.length;l++)m=o[l],d(m.value,{componentStack:m.stack,digest:m.digest});if(fh)throw fh=!1,i=xp,xp=null,i;return(mh&1)!==0&&i.tag!==0&&va(),_=i.pendingLanes,(_&1)!==0?i===Pp?tu++:(tu=0,Pp=i):tu=0,zi(),null}function va(){if(qi!==null){var i=Oi(mh),o=Hn.transition,l=Ve;try{if(Hn.transition=null,Ve=16>i?16:i,qi===null)var d=!1;else{if(i=qi,qi=null,mh=0,($e&6)!==0)throw Error(t(331));var m=$e;for($e|=4,pe=i.current;pe!==null;){var _=pe,T=_.child;if((pe.flags&16)!==0){var P=_.deletions;if(P!==null){for(var M=0;M<P.length;M++){var H=P[M];for(pe=H;pe!==null;){var ee=pe;switch(ee.tag){case 0:case 11:case 15:Xl(8,ee,_)}var te=ee.child;if(te!==null)te.return=ee,pe=te;else for(;pe!==null;){ee=pe;var Z=ee.sibling,he=ee.return;if(Ev(ee),ee===H){pe=null;break}if(Z!==null){Z.return=he,pe=Z;break}pe=he}}}var me=_.alternate;if(me!==null){var ge=me.child;if(ge!==null){me.child=null;do{var yt=ge.sibling;ge.sibling=null,ge=yt}while(ge!==null)}}pe=_}}if((_.subtreeFlags&2064)!==0&&T!==null)T.return=_,pe=T;else e:for(;pe!==null;){if(_=pe,(_.flags&2048)!==0)switch(_.tag){case 0:case 11:case 15:Xl(9,_,_.return)}var $=_.sibling;if($!==null){$.return=_.return,pe=$;break e}pe=_.return}}var F=i.current;for(pe=F;pe!==null;){T=pe;var W=T.child;if((T.subtreeFlags&2064)!==0&&W!==null)W.return=T,pe=W;else e:for(T=F;pe!==null;){if(P=pe,(P.flags&2048)!==0)try{switch(P.tag){case 0:case 11:case 15:ch(9,P)}}catch(_e){mt(P,P.return,_e)}if(P===T){pe=null;break e}var re=P.sibling;if(re!==null){re.return=P.return,pe=re;break e}pe=P.return}}if($e=m,zi(),An&&typeof An.onPostCommitFiberRoot=="function")try{An.onPostCommitFiberRoot(Vs,i)}catch{}d=!0}return d}finally{Ve=l,Hn.transition=o}}return!1}function Vv(i,o,l){o=ma(l,o),o=tv(i,o,1),i=Wi(i,o,1),o=hn(),i!==null&&(Ni(i,1,o),vn(i,o))}function mt(i,o,l){if(i.tag===3)Vv(i,i,l);else for(;o!==null;){if(o.tag===3){Vv(o,i,l);break}else if(o.tag===1){var d=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof d.componentDidCatch=="function"&&(Gi===null||!Gi.has(d))){i=ma(l,i),i=nv(o,i,1),o=Wi(o,i,1),i=hn(),o!==null&&(Ni(o,1,i),vn(o,i));break}}o=o.return}}function BA(i,o,l){var d=i.pingCache;d!==null&&d.delete(o),o=hn(),i.pingedLanes|=i.suspendedLanes&l,jt===i&&(Kt&l)===l&&(Ot===4||Ot===3&&(Kt&130023424)===Kt&&500>rt()-Rp?Zs(i,0):kp|=l),vn(i,o)}function Fv(i,o){o===0&&((i.mode&1)===0?o=1:(o=zo,zo<<=1,(zo&130023424)===0&&(zo=4194304)));var l=hn();i=ri(i,o),i!==null&&(Ni(i,o,l),vn(i,l))}function zA(i){var o=i.memoizedState,l=0;o!==null&&(l=o.retryLane),Fv(i,l)}function $A(i,o){var l=0;switch(i.tag){case 13:var d=i.stateNode,m=i.memoizedState;m!==null&&(l=m.retryLane);break;case 19:d=i.stateNode;break;default:throw Error(t(314))}d!==null&&d.delete(o),Fv(i,l)}var jv;jv=function(i,o,l){if(i!==null)if(i.memoizedProps!==o.pendingProps||mn.current)_n=!0;else{if((i.lanes&l)===0&&(o.flags&128)===0)return _n=!1,PA(i,o,l);_n=(i.flags&131072)!==0}else _n=!1,ht&&(o.flags&1048576)!==0&&yy(o,qc,o.index);switch(o.lanes=0,o.tag){case 2:var d=o.type;lh(i,o),i=o.pendingProps;var m=aa(o,en.current);fa(o,l),m=sp(null,o,d,i,m,l);var _=op();return o.flags|=1,typeof m=="object"&&m!==null&&typeof m.render=="function"&&m.$$typeof===void 0?(o.tag=1,o.memoizedState=null,o.updateQueue=null,gn(d)?(_=!0,Wc(o)):_=!1,o.memoizedState=m.state!==null&&m.state!==void 0?m.state:null,Xf(o),m.updater=oh,o.stateNode=m,m._reactInternals=o,dp(o,d,i,l),o=gp(null,o,d,!0,_,l)):(o.tag=0,ht&&_&&zf(o),cn(null,o,m,l),o=o.child),o;case 16:d=o.elementType;e:{switch(lh(i,o),i=o.pendingProps,m=d._init,d=m(d._payload),o.type=d,m=o.tag=HA(d),i=or(d,i),m){case 0:o=mp(null,o,d,i,l);break e;case 1:o=hv(null,o,d,i,l);break e;case 11:o=ov(null,o,d,i,l);break e;case 14:o=av(null,o,d,or(d.type,i),l);break e}throw Error(t(306,d,""))}return o;case 0:return d=o.type,m=o.pendingProps,m=o.elementType===d?m:or(d,m),mp(i,o,d,m,l);case 1:return d=o.type,m=o.pendingProps,m=o.elementType===d?m:or(d,m),hv(i,o,d,m,l);case 3:e:{if(dv(o),i===null)throw Error(t(387));d=o.pendingProps,_=o.memoizedState,m=_.element,ky(i,o),Zc(o,d,null,l);var T=o.memoizedState;if(d=T.element,_.isDehydrated)if(_={element:d,isDehydrated:!1,cache:T.cache,pendingSuspenseBoundaries:T.pendingSuspenseBoundaries,transitions:T.transitions},o.updateQueue.baseState=_,o.memoizedState=_,o.flags&256){m=ma(Error(t(423)),o),o=fv(i,o,d,l,m);break e}else if(d!==m){m=ma(Error(t(424)),o),o=fv(i,o,d,l,m);break e}else for(bn=ji(o.stateNode.containerInfo.firstChild),Pn=o,ht=!0,sr=null,l=Sy(o,null,d,l),o.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling;else{if(ca(),d===m){o=si(i,o,l);break e}cn(i,o,d,l)}o=o.child}return o;case 5:return Py(o),i===null&&Hf(o),d=o.type,m=o.pendingProps,_=i!==null?i.memoizedProps:null,T=m.children,Mf(d,m)?T=null:_!==null&&Mf(d,_)&&(o.flags|=32),cv(i,o),cn(i,o,T,l),o.child;case 6:return i===null&&Hf(o),null;case 13:return pv(i,o,l);case 4:return Zf(o,o.stateNode.containerInfo),d=o.pendingProps,i===null?o.child=ha(o,null,d,l):cn(i,o,d,l),o.child;case 11:return d=o.type,m=o.pendingProps,m=o.elementType===d?m:or(d,m),ov(i,o,d,m,l);case 7:return cn(i,o,o.pendingProps,l),o.child;case 8:return cn(i,o,o.pendingProps.children,l),o.child;case 12:return cn(i,o,o.pendingProps.children,l),o.child;case 10:e:{if(d=o.type._context,m=o.pendingProps,_=o.memoizedProps,T=m.value,it(Yc,d._currentValue),d._currentValue=T,_!==null)if(ir(_.value,T)){if(_.children===m.children&&!mn.current){o=si(i,o,l);break e}}else for(_=o.child,_!==null&&(_.return=o);_!==null;){var P=_.dependencies;if(P!==null){T=_.child;for(var M=P.firstContext;M!==null;){if(M.context===d){if(_.tag===1){M=ii(-1,l&-l),M.tag=2;var H=_.updateQueue;if(H!==null){H=H.shared;var ee=H.pending;ee===null?M.next=M:(M.next=ee.next,ee.next=M),H.pending=M}}_.lanes|=l,M=_.alternate,M!==null&&(M.lanes|=l),Yf(_.return,l,o),P.lanes|=l;break}M=M.next}}else if(_.tag===10)T=_.type===o.type?null:_.child;else if(_.tag===18){if(T=_.return,T===null)throw Error(t(341));T.lanes|=l,P=T.alternate,P!==null&&(P.lanes|=l),Yf(T,l,o),T=_.sibling}else T=_.child;if(T!==null)T.return=_;else for(T=_;T!==null;){if(T===o){T=null;break}if(_=T.sibling,_!==null){_.return=T.return,T=_;break}T=T.return}_=T}cn(i,o,m.children,l),o=o.child}return o;case 9:return m=o.type,d=o.pendingProps.children,fa(o,l),m=$n(m),d=d(m),o.flags|=1,cn(i,o,d,l),o.child;case 14:return d=o.type,m=or(d,o.pendingProps),m=or(d.type,m),av(i,o,d,m,l);case 15:return lv(i,o,o.type,o.pendingProps,l);case 17:return d=o.type,m=o.pendingProps,m=o.elementType===d?m:or(d,m),lh(i,o),o.tag=1,gn(d)?(i=!0,Wc(o)):i=!1,fa(o,l),Zy(o,d,m),dp(o,d,m,l),gp(null,o,d,!0,i,l);case 19:return gv(i,o,l);case 22:return uv(i,o,l)}throw Error(t(156,o.tag))};function Uv(i,o){return Uo(i,o)}function WA(i,o,l,d){this.tag=i,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=d,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Gn(i,o,l,d){return new WA(i,o,l,d)}function Mp(i){return i=i.prototype,!(!i||!i.isReactComponent)}function HA(i){if(typeof i=="function")return Mp(i)?1:0;if(i!=null){if(i=i.$$typeof,i===j)return 11;if(i===Ke)return 14}return 2}function Yi(i,o){var l=i.alternate;return l===null?(l=Gn(i.tag,o,i.key,i.mode),l.elementType=i.elementType,l.type=i.type,l.stateNode=i.stateNode,l.alternate=i,i.alternate=l):(l.pendingProps=o,l.type=i.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=i.flags&14680064,l.childLanes=i.childLanes,l.lanes=i.lanes,l.child=i.child,l.memoizedProps=i.memoizedProps,l.memoizedState=i.memoizedState,l.updateQueue=i.updateQueue,o=i.dependencies,l.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},l.sibling=i.sibling,l.index=i.index,l.ref=i.ref,l}function vh(i,o,l,d,m,_){var T=2;if(d=i,typeof i=="function")Mp(i)&&(T=1);else if(typeof i=="string")T=5;else e:switch(i){case D:return to(l.children,m,_,o);case A:T=8,m|=8;break;case k:return i=Gn(12,l,o,m|2),i.elementType=k,i.lanes=_,i;case x:return i=Gn(13,l,o,m),i.elementType=x,i.lanes=_,i;case De:return i=Gn(19,l,o,m),i.elementType=De,i.lanes=_,i;case xe:return wh(l,m,_,o);default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case b:T=10;break e;case L:T=9;break e;case j:T=11;break e;case Ke:T=14;break e;case Oe:T=16,d=null;break e}throw Error(t(130,i==null?i:typeof i,""))}return o=Gn(T,l,o,m),o.elementType=i,o.type=d,o.lanes=_,o}function to(i,o,l,d){return i=Gn(7,i,d,o),i.lanes=l,i}function wh(i,o,l,d){return i=Gn(22,i,d,o),i.elementType=xe,i.lanes=l,i.stateNode={isHidden:!1},i}function Vp(i,o,l){return i=Gn(6,i,null,o),i.lanes=l,i}function Fp(i,o,l){return o=Gn(4,i.children!==null?i.children:[],i.key,o),o.lanes=l,o.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},o}function GA(i,o,l,d,m){this.tag=o,this.containerInfo=i,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=bi(0),this.expirationTimes=bi(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=bi(0),this.identifierPrefix=d,this.onRecoverableError=m,this.mutableSourceEagerHydrationData=null}function jp(i,o,l,d,m,_,T,P,M){return i=new GA(i,o,l,P,M),o===1?(o=1,_===!0&&(o|=8)):o=0,_=Gn(3,null,null,o),i.current=_,_.stateNode=i,_.memoizedState={element:d,isDehydrated:l,cache:null,transitions:null,pendingSuspenseBoundaries:null},Xf(_),i}function qA(i,o,l){var d=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:se,key:d==null?null:""+d,children:i,containerInfo:o,implementation:l}}function Bv(i){if(!i)return Bi;i=i._reactInternals;e:{if(Jn(i)!==i||i.tag!==1)throw Error(t(170));var o=i;do{switch(o.tag){case 3:o=o.stateNode.context;break e;case 1:if(gn(o.type)){o=o.stateNode.__reactInternalMemoizedMergedChildContext;break e}}o=o.return}while(o!==null);throw Error(t(171))}if(i.tag===1){var l=i.type;if(gn(l))return my(i,l,o)}return o}function zv(i,o,l,d,m,_,T,P,M){return i=jp(l,d,!0,i,m,_,T,P,M),i.context=Bv(null),l=i.current,d=hn(),m=Ki(l),_=ii(d,m),_.callback=o??null,Wi(l,_,m),i.current.lanes=m,Ni(i,m,d),vn(i,d),i}function Eh(i,o,l,d){var m=o.current,_=hn(),T=Ki(m);return l=Bv(l),o.context===null?o.context=l:o.pendingContext=l,o=ii(_,T),o.payload={element:i},d=d===void 0?null:d,d!==null&&(o.callback=d),i=Wi(m,o,T),i!==null&&(ur(i,m,T,_),Xc(i,m,T)),T}function Th(i){if(i=i.current,!i.child)return null;switch(i.child.tag){case 5:return i.child.stateNode;default:return i.child.stateNode}}function $v(i,o){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var l=i.retryLane;i.retryLane=l!==0&&l<o?l:o}}function Up(i,o){$v(i,o),(i=i.alternate)&&$v(i,o)}function KA(){return null}var Wv=typeof reportError=="function"?reportError:function(i){console.error(i)};function Bp(i){this._internalRoot=i}Ih.prototype.render=Bp.prototype.render=function(i){var o=this._internalRoot;if(o===null)throw Error(t(409));Eh(i,o,null,null)},Ih.prototype.unmount=Bp.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var o=i.containerInfo;Xs(function(){Eh(null,i,null,null)}),o[Zr]=null}};function Ih(i){this._internalRoot=i}Ih.prototype.unstable_scheduleHydration=function(i){if(i){var o=Ic();i={blockedOn:null,target:i,priority:o};for(var l=0;l<vr.length&&o!==0&&o<vr[l].priority;l++);vr.splice(l,0,i),l===0&&Ac(i)}};function zp(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function Ch(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11&&(i.nodeType!==8||i.nodeValue!==" react-mount-point-unstable "))}function Hv(){}function QA(i,o,l,d,m){if(m){if(typeof d=="function"){var _=d;d=function(){var H=Th(T);_.call(H)}}var T=zv(o,d,i,0,null,!1,!1,"",Hv);return i._reactRootContainer=T,i[Zr]=T.current,jl(i.nodeType===8?i.parentNode:i),Xs(),T}for(;m=i.lastChild;)i.removeChild(m);if(typeof d=="function"){var P=d;d=function(){var H=Th(M);P.call(H)}}var M=jp(i,0,!1,null,null,!1,!1,"",Hv);return i._reactRootContainer=M,i[Zr]=M.current,jl(i.nodeType===8?i.parentNode:i),Xs(function(){Eh(o,M,l,d)}),M}function Sh(i,o,l,d,m){var _=l._reactRootContainer;if(_){var T=_;if(typeof m=="function"){var P=m;m=function(){var M=Th(T);P.call(M)}}Eh(o,T,i,m)}else T=QA(l,o,i,m,d);return Th(T)}Ec=function(i){switch(i.tag){case 3:var o=i.stateNode;if(o.current.memoizedState.isDehydrated){var l=Pi(o.pendingLanes);l!==0&&(Di(o,l|1),vn(o,rt()),($e&6)===0&&(ya=rt()+500,zi()))}break;case 13:Xs(function(){var d=ri(i,1);if(d!==null){var m=hn();ur(d,i,1,m)}}),Up(i,1)}},$o=function(i){if(i.tag===13){var o=ri(i,134217728);if(o!==null){var l=hn();ur(o,i,134217728,l)}Up(i,134217728)}},Tc=function(i){if(i.tag===13){var o=Ki(i),l=ri(i,o);if(l!==null){var d=hn();ur(l,i,o,d)}Up(i,o)}},Ic=function(){return Ve},Cc=function(i,o){var l=Ve;try{return Ve=i,o()}finally{Ve=l}},Oo=function(i,o,l){switch(o){case"input":if(cl(i,l),o=l.name,l.type==="radio"&&o!=null){for(l=i;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll("input[name="+JSON.stringify(""+o)+'][type="radio"]'),o=0;o<l.length;o++){var d=l[o];if(d!==i&&d.form===i.form){var m=zc(d);if(!m)throw Error(t(90));Ro(d),cl(d,m)}}}break;case"textarea":No(i,l);break;case"select":o=l.value,o!=null&&Hr(i,!!l.multiple,o,!1)}},Ns=Dp,wl=Xs;var YA={usingClientEntryPoint:!1,Events:[zl,sa,zc,_r,vl,Dp]},nu={findFiberByHostInstance:Ws,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},JA={bundleType:nu.bundleType,version:nu.version,rendererPackageName:nu.rendererPackageName,rendererConfig:nu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:J.ReactCurrentDispatcher,findHostInstanceByFiber:function(i){return i=Il(i),i===null?null:i.stateNode},findFiberByHostInstance:nu.findFiberByHostInstance||KA,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ah=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ah.isDisabled&&Ah.supportsFiber)try{Vs=Ah.inject(JA),An=Ah}catch{}}return wn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=YA,wn.createPortal=function(i,o){var l=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!zp(o))throw Error(t(200));return qA(i,o,null,l)},wn.createRoot=function(i,o){if(!zp(i))throw Error(t(299));var l=!1,d="",m=Wv;return o!=null&&(o.unstable_strictMode===!0&&(l=!0),o.identifierPrefix!==void 0&&(d=o.identifierPrefix),o.onRecoverableError!==void 0&&(m=o.onRecoverableError)),o=jp(i,1,!1,null,null,l,!1,d,m),i[Zr]=o.current,jl(i.nodeType===8?i.parentNode:i),new Bp(o)},wn.findDOMNode=function(i){if(i==null)return null;if(i.nodeType===1)return i;var o=i._reactInternals;if(o===void 0)throw typeof i.render=="function"?Error(t(188)):(i=Object.keys(i).join(","),Error(t(268,i)));return i=Il(o),i=i===null?null:i.stateNode,i},wn.flushSync=function(i){return Xs(i)},wn.hydrate=function(i,o,l){if(!Ch(o))throw Error(t(200));return Sh(null,i,o,!0,l)},wn.hydrateRoot=function(i,o,l){if(!zp(i))throw Error(t(405));var d=l!=null&&l.hydratedSources||null,m=!1,_="",T=Wv;if(l!=null&&(l.unstable_strictMode===!0&&(m=!0),l.identifierPrefix!==void 0&&(_=l.identifierPrefix),l.onRecoverableError!==void 0&&(T=l.onRecoverableError)),o=zv(o,null,i,1,l??null,m,!1,_,T),i[Zr]=o.current,jl(i),d)for(i=0;i<d.length;i++)l=d[i],m=l._getVersion,m=m(l._source),o.mutableSourceEagerHydrationData==null?o.mutableSourceEagerHydrationData=[l,m]:o.mutableSourceEagerHydrationData.push(l,m);return new Ih(o)},wn.render=function(i,o,l){if(!Ch(o))throw Error(t(200));return Sh(null,i,o,!1,l)},wn.unmountComponentAtNode=function(i){if(!Ch(i))throw Error(t(40));return i._reactRootContainer?(Xs(function(){Sh(null,null,i,!1,function(){i._reactRootContainer=null,i[Zr]=null})}),!0):!1},wn.unstable_batchedUpdates=Dp,wn.unstable_renderSubtreeIntoContainer=function(i,o,l,d){if(!Ch(l))throw Error(t(200));if(i==null||i._reactInternals===void 0)throw Error(t(38));return Sh(i,o,l,!1,d)},wn.version="18.3.1-next-f1338f8080-20240426",wn}var Zv;function sk(){if(Zv)return Hp.exports;Zv=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Hp.exports=ik(),Hp.exports}var ew;function ok(){if(ew)return kh;ew=1;var n=sk();return kh.createRoot=n.createRoot,kh.hydrateRoot=n.hydrateRoot,kh}var ak=ok();const lk=DE(ak);var iu={},tw;function uk(){if(tw)return iu;tw=1,Object.defineProperty(iu,"__esModule",{value:!0}),iu.parse=u,iu.serialize=p;const n=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,e=/^[\u0021-\u003A\u003C-\u007E]*$/,t=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,r=/^[\u0020-\u003A\u003D-\u007E]*$/,s=Object.prototype.toString,a=(()=>{const E=function(){};return E.prototype=Object.create(null),E})();function u(E,S){const R=new a,N=E.length;if(N<2)return R;const O=S?.decode||y;let V=0;do{const K=E.indexOf("=",V);if(K===-1)break;const G=E.indexOf(";",V),J=G===-1?N:G;if(K>J){V=E.lastIndexOf(";",K-1)+1;continue}const ne=h(E,V,K),se=f(E,K,ne),D=E.slice(ne,se);if(R[D]===void 0){let A=h(E,K+1,J),k=f(E,J,A);const b=O(E.slice(A,k));R[D]=b}V=J+1}while(V<N);return R}function h(E,S,R){do{const N=E.charCodeAt(S);if(N!==32&&N!==9)return S}while(++S<R);return R}function f(E,S,R){for(;S>R;){const N=E.charCodeAt(--S);if(N!==32&&N!==9)return S+1}return R}function p(E,S,R){const N=R?.encode||encodeURIComponent;if(!n.test(E))throw new TypeError(`argument name is invalid: ${E}`);const O=N(S);if(!e.test(O))throw new TypeError(`argument val is invalid: ${S}`);let V=E+"="+O;if(!R)return V;if(R.maxAge!==void 0){if(!Number.isInteger(R.maxAge))throw new TypeError(`option maxAge is invalid: ${R.maxAge}`);V+="; Max-Age="+R.maxAge}if(R.domain){if(!t.test(R.domain))throw new TypeError(`option domain is invalid: ${R.domain}`);V+="; Domain="+R.domain}if(R.path){if(!r.test(R.path))throw new TypeError(`option path is invalid: ${R.path}`);V+="; Path="+R.path}if(R.expires){if(!v(R.expires)||!Number.isFinite(R.expires.valueOf()))throw new TypeError(`option expires is invalid: ${R.expires}`);V+="; Expires="+R.expires.toUTCString()}if(R.httpOnly&&(V+="; HttpOnly"),R.secure&&(V+="; Secure"),R.partitioned&&(V+="; Partitioned"),R.priority)switch(typeof R.priority=="string"?R.priority.toLowerCase():void 0){case"low":V+="; Priority=Low";break;case"medium":V+="; Priority=Medium";break;case"high":V+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${R.priority}`)}if(R.sameSite)switch(typeof R.sameSite=="string"?R.sameSite.toLowerCase():R.sameSite){case!0:case"strict":V+="; SameSite=Strict";break;case"lax":V+="; SameSite=Lax";break;case"none":V+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${R.sameSite}`)}return V}function y(E){if(E.indexOf("%")===-1)return E;try{return decodeURIComponent(E)}catch{return E}}function v(E){return s.call(E)==="[object Date]"}return iu}uk();var nw="popstate";function ck(n={}){function e(r,s){let{pathname:a,search:u,hash:h}=r.location;return mm("",{pathname:a,search:u,hash:h},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function t(r,s){return typeof s=="string"?s:ku(s)}return dk(e,t,null,n)}function pt(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function Mr(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function hk(){return Math.random().toString(36).substring(2,10)}function rw(n,e){return{usr:n.state,key:n.key,idx:e}}function mm(n,e,t=null,r){return{pathname:typeof n=="string"?n:n.pathname,search:"",hash:"",...typeof e=="string"?Ka(e):e,state:t,key:e&&e.key||r||hk()}}function ku({pathname:n="/",search:e="",hash:t=""}){return e&&e!=="?"&&(n+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(n+=t.charAt(0)==="#"?t:"#"+t),n}function Ka(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substring(t),n=n.substring(0,t));let r=n.indexOf("?");r>=0&&(e.search=n.substring(r),n=n.substring(0,r)),n&&(e.pathname=n)}return e}function dk(n,e,t,r={}){let{window:s=document.defaultView,v5Compat:a=!1}=r,u=s.history,h="POP",f=null,p=y();p==null&&(p=0,u.replaceState({...u.state,idx:p},""));function y(){return(u.state||{idx:null}).idx}function v(){h="POP";let O=y(),V=O==null?null:O-p;p=O,f&&f({action:h,location:N.location,delta:V})}function E(O,V){h="PUSH";let K=mm(N.location,O,V);p=y()+1;let G=rw(K,p),J=N.createHref(K);try{u.pushState(G,"",J)}catch(ne){if(ne instanceof DOMException&&ne.name==="DataCloneError")throw ne;s.location.assign(J)}a&&f&&f({action:h,location:N.location,delta:1})}function S(O,V){h="REPLACE";let K=mm(N.location,O,V);p=y();let G=rw(K,p),J=N.createHref(K);u.replaceState(G,"",J),a&&f&&f({action:h,location:N.location,delta:0})}function R(O){return fk(O)}let N={get action(){return h},get location(){return n(s,u)},listen(O){if(f)throw new Error("A history only accepts one active listener");return s.addEventListener(nw,v),f=O,()=>{s.removeEventListener(nw,v),f=null}},createHref(O){return e(s,O)},createURL:R,encodeLocation(O){let V=R(O);return{pathname:V.pathname,search:V.search,hash:V.hash}},push:E,replace:S,go(O){return u.go(O)}};return N}function fk(n,e=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),pt(t,"No window.location.(origin|href) available to create URL");let r=typeof n=="string"?n:ku(n);return r=r.replace(/ $/,"%20"),!e&&r.startsWith("//")&&(r=t+r),new URL(r,t)}function OE(n,e,t="/"){return pk(n,e,t,!1)}function pk(n,e,t,r){let s=typeof e=="string"?Ka(e):e,a=yi(s.pathname||"/",t);if(a==null)return null;let u=LE(n);mk(u);let h=null;for(let f=0;h==null&&f<u.length;++f){let p=Ak(a);h=Ck(u[f],p,r)}return h}function LE(n,e=[],t=[],r=""){let s=(a,u,h)=>{let f={relativePath:h===void 0?a.path||"":h,caseSensitive:a.caseSensitive===!0,childrenIndex:u,route:a};f.relativePath.startsWith("/")&&(pt(f.relativePath.startsWith(r),`Absolute route path "${f.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),f.relativePath=f.relativePath.slice(r.length));let p=pi([r,f.relativePath]),y=t.concat(f);a.children&&a.children.length>0&&(pt(a.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${p}".`),LE(a.children,e,y,p)),!(a.path==null&&!a.index)&&e.push({path:p,score:Tk(p,a.index),routesMeta:y})};return n.forEach((a,u)=>{if(a.path===""||!a.path?.includes("?"))s(a,u);else for(let h of ME(a.path))s(a,u,h)}),e}function ME(n){let e=n.split("/");if(e.length===0)return[];let[t,...r]=e,s=t.endsWith("?"),a=t.replace(/\?$/,"");if(r.length===0)return s?[a,""]:[a];let u=ME(r.join("/")),h=[];return h.push(...u.map(f=>f===""?a:[a,f].join("/"))),s&&h.push(...u),h.map(f=>n.startsWith("/")&&f===""?"/":f)}function mk(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:Ik(e.routesMeta.map(r=>r.childrenIndex),t.routesMeta.map(r=>r.childrenIndex)))}var gk=/^:[\w-]+$/,_k=3,yk=2,vk=1,wk=10,Ek=-2,iw=n=>n==="*";function Tk(n,e){let t=n.split("/"),r=t.length;return t.some(iw)&&(r+=Ek),e&&(r+=yk),t.filter(s=>!iw(s)).reduce((s,a)=>s+(gk.test(a)?_k:a===""?vk:wk),r)}function Ik(n,e){return n.length===e.length&&n.slice(0,-1).every((r,s)=>r===e[s])?n[n.length-1]-e[e.length-1]:0}function Ck(n,e,t=!1){let{routesMeta:r}=n,s={},a="/",u=[];for(let h=0;h<r.length;++h){let f=r[h],p=h===r.length-1,y=a==="/"?e:e.slice(a.length)||"/",v=Yh({path:f.relativePath,caseSensitive:f.caseSensitive,end:p},y),E=f.route;if(!v&&p&&t&&!r[r.length-1].route.index&&(v=Yh({path:f.relativePath,caseSensitive:f.caseSensitive,end:!1},y)),!v)return null;Object.assign(s,v.params),u.push({params:s,pathname:pi([a,v.pathname]),pathnameBase:Pk(pi([a,v.pathnameBase])),route:E}),v.pathnameBase!=="/"&&(a=pi([a,v.pathnameBase]))}return u}function Yh(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,r]=Sk(n.path,n.caseSensitive,n.end),s=e.match(t);if(!s)return null;let a=s[0],u=a.replace(/(.)\/+$/,"$1"),h=s.slice(1);return{params:r.reduce((p,{paramName:y,isOptional:v},E)=>{if(y==="*"){let R=h[E]||"";u=a.slice(0,a.length-R.length).replace(/(.)\/+$/,"$1")}const S=h[E];return v&&!S?p[y]=void 0:p[y]=(S||"").replace(/%2F/g,"/"),p},{}),pathname:a,pathnameBase:u,pattern:n}}function Sk(n,e=!1,t=!0){Mr(n==="*"||!n.endsWith("*")||n.endsWith("/*"),`Route path "${n}" will be treated as if it were "${n.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${n.replace(/\*$/,"/*")}".`);let r=[],s="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(u,h,f)=>(r.push({paramName:h,isOptional:f!=null}),f?"/?([^\\/]+)?":"/([^\\/]+)"));return n.endsWith("*")?(r.push({paramName:"*"}),s+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?s+="\\/*$":n!==""&&n!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),r]}function Ak(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Mr(!1,`The URL path "${n}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),n}}function yi(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,r=n.charAt(t);return r&&r!=="/"?null:n.slice(t)||"/"}function kk(n,e="/"){let{pathname:t,search:r="",hash:s=""}=typeof n=="string"?Ka(n):n;return{pathname:t?t.startsWith("/")?t:Rk(t,e):e,search:bk(r),hash:Nk(s)}}function Rk(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(s=>{s===".."?t.length>1&&t.pop():s!=="."&&t.push(s)}),t.length>1?t.join("/"):"/"}function Kp(n,e,t,r){return`Cannot include a '${n}' character in a manually specified \`to.${e}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function xk(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function VE(n){let e=xk(n);return e.map((t,r)=>r===e.length-1?t.pathname:t.pathnameBase)}function FE(n,e,t,r=!1){let s;typeof n=="string"?s=Ka(n):(s={...n},pt(!s.pathname||!s.pathname.includes("?"),Kp("?","pathname","search",s)),pt(!s.pathname||!s.pathname.includes("#"),Kp("#","pathname","hash",s)),pt(!s.search||!s.search.includes("#"),Kp("#","search","hash",s)));let a=n===""||s.pathname==="",u=a?"/":s.pathname,h;if(u==null)h=t;else{let v=e.length-1;if(!r&&u.startsWith("..")){let E=u.split("/");for(;E[0]==="..";)E.shift(),v-=1;s.pathname=E.join("/")}h=v>=0?e[v]:"/"}let f=kk(s,h),p=u&&u!=="/"&&u.endsWith("/"),y=(a||u===".")&&t.endsWith("/");return!f.pathname.endsWith("/")&&(p||y)&&(f.pathname+="/"),f}var pi=n=>n.join("/").replace(/\/\/+/g,"/"),Pk=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),bk=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,Nk=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n;function Dk(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}var jE=["POST","PUT","PATCH","DELETE"];new Set(jE);var Ok=["GET",...jE];new Set(Ok);var Qa=U.createContext(null);Qa.displayName="DataRouter";var Nd=U.createContext(null);Nd.displayName="DataRouterState";var UE=U.createContext({isTransitioning:!1});UE.displayName="ViewTransition";var Lk=U.createContext(new Map);Lk.displayName="Fetchers";var Mk=U.createContext(null);Mk.displayName="Await";var jr=U.createContext(null);jr.displayName="Navigation";var zu=U.createContext(null);zu.displayName="Location";var Ur=U.createContext({outlet:null,matches:[],isDataRoute:!1});Ur.displayName="Route";var og=U.createContext(null);og.displayName="RouteError";function Vk(n,{relative:e}={}){pt($u(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:r}=U.useContext(jr),{hash:s,pathname:a,search:u}=Wu(n,{relative:e}),h=a;return t!=="/"&&(h=a==="/"?t:pi([t,a])),r.createHref({pathname:h,search:u,hash:s})}function $u(){return U.useContext(zu)!=null}function Ts(){return pt($u(),"useLocation() may be used only in the context of a <Router> component."),U.useContext(zu).location}var BE="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function zE(n){U.useContext(jr).static||U.useLayoutEffect(n)}function mr(){let{isDataRoute:n}=U.useContext(Ur);return n?Yk():Fk()}function Fk(){pt($u(),"useNavigate() may be used only in the context of a <Router> component.");let n=U.useContext(Qa),{basename:e,navigator:t}=U.useContext(jr),{matches:r}=U.useContext(Ur),{pathname:s}=Ts(),a=JSON.stringify(VE(r)),u=U.useRef(!1);return zE(()=>{u.current=!0}),U.useCallback((f,p={})=>{if(Mr(u.current,BE),!u.current)return;if(typeof f=="number"){t.go(f);return}let y=FE(f,JSON.parse(a),s,p.relative==="path");n==null&&e!=="/"&&(y.pathname=y.pathname==="/"?e:pi([e,y.pathname])),(p.replace?t.replace:t.push)(y,p.state,p)},[e,t,a,s,n])}U.createContext(null);function $E(){let{matches:n}=U.useContext(Ur),e=n[n.length-1];return e?e.params:{}}function Wu(n,{relative:e}={}){let{matches:t}=U.useContext(Ur),{pathname:r}=Ts(),s=JSON.stringify(VE(t));return U.useMemo(()=>FE(n,JSON.parse(s),r,e==="path"),[n,s,r,e])}function jk(n,e){return WE(n,e)}function WE(n,e,t,r){pt($u(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:s}=U.useContext(jr),{matches:a}=U.useContext(Ur),u=a[a.length-1],h=u?u.params:{},f=u?u.pathname:"/",p=u?u.pathnameBase:"/",y=u&&u.route;{let V=y&&y.path||"";HE(f,!y||V.endsWith("*")||V.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${f}" (under <Route path="${V}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${V}"> to <Route path="${V==="/"?"*":`${V}/*`}">.`)}let v=Ts(),E;if(e){let V=typeof e=="string"?Ka(e):e;pt(p==="/"||V.pathname?.startsWith(p),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${p}" but pathname "${V.pathname}" was given in the \`location\` prop.`),E=V}else E=v;let S=E.pathname||"/",R=S;if(p!=="/"){let V=p.replace(/^\//,"").split("/");R="/"+S.replace(/^\//,"").split("/").slice(V.length).join("/")}let N=OE(n,{pathname:R});Mr(y||N!=null,`No routes matched location "${E.pathname}${E.search}${E.hash}" `),Mr(N==null||N[N.length-1].route.element!==void 0||N[N.length-1].route.Component!==void 0||N[N.length-1].route.lazy!==void 0,`Matched leaf route at location "${E.pathname}${E.search}${E.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let O=Wk(N&&N.map(V=>Object.assign({},V,{params:Object.assign({},h,V.params),pathname:pi([p,s.encodeLocation?s.encodeLocation(V.pathname).pathname:V.pathname]),pathnameBase:V.pathnameBase==="/"?p:pi([p,s.encodeLocation?s.encodeLocation(V.pathnameBase).pathname:V.pathnameBase])})),a,t,r);return e&&O?U.createElement(zu.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...E},navigationType:"POP"}},O):O}function Uk(){let n=Qk(),e=Dk(n)?`${n.status} ${n.statusText}`:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,r="rgba(200,200,200, 0.5)",s={padding:"0.5rem",backgroundColor:r},a={padding:"2px 4px",backgroundColor:r},u=null;return console.error("Error handled by React Router default ErrorBoundary:",n),u=U.createElement(U.Fragment,null,U.createElement("p",null,"💿 Hey developer 👋"),U.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",U.createElement("code",{style:a},"ErrorBoundary")," or"," ",U.createElement("code",{style:a},"errorElement")," prop on your route.")),U.createElement(U.Fragment,null,U.createElement("h2",null,"Unexpected Application Error!"),U.createElement("h3",{style:{fontStyle:"italic"}},e),t?U.createElement("pre",{style:s},t):null,u)}var Bk=U.createElement(Uk,null),zk=class extends U.Component{constructor(n){super(n),this.state={location:n.location,revalidation:n.revalidation,error:n.error}}static getDerivedStateFromError(n){return{error:n}}static getDerivedStateFromProps(n,e){return e.location!==n.location||e.revalidation!=="idle"&&n.revalidation==="idle"?{error:n.error,location:n.location,revalidation:n.revalidation}:{error:n.error!==void 0?n.error:e.error,location:e.location,revalidation:n.revalidation||e.revalidation}}componentDidCatch(n,e){console.error("React Router caught the following error during render",n,e)}render(){return this.state.error!==void 0?U.createElement(Ur.Provider,{value:this.props.routeContext},U.createElement(og.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function $k({routeContext:n,match:e,children:t}){let r=U.useContext(Qa);return r&&r.static&&r.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=e.route.id),U.createElement(Ur.Provider,{value:n},t)}function Wk(n,e=[],t=null,r=null){if(n==null){if(!t)return null;if(t.errors)n=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let s=n,a=t?.errors;if(a!=null){let f=s.findIndex(p=>p.route.id&&a?.[p.route.id]!==void 0);pt(f>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(a).join(",")}`),s=s.slice(0,Math.min(s.length,f+1))}let u=!1,h=-1;if(t)for(let f=0;f<s.length;f++){let p=s[f];if((p.route.HydrateFallback||p.route.hydrateFallbackElement)&&(h=f),p.route.id){let{loaderData:y,errors:v}=t,E=p.route.loader&&!y.hasOwnProperty(p.route.id)&&(!v||v[p.route.id]===void 0);if(p.route.lazy||E){u=!0,h>=0?s=s.slice(0,h+1):s=[s[0]];break}}}return s.reduceRight((f,p,y)=>{let v,E=!1,S=null,R=null;t&&(v=a&&p.route.id?a[p.route.id]:void 0,S=p.route.errorElement||Bk,u&&(h<0&&y===0?(HE("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),E=!0,R=null):h===y&&(E=!0,R=p.route.hydrateFallbackElement||null)));let N=e.concat(s.slice(0,y+1)),O=()=>{let V;return v?V=S:E?V=R:p.route.Component?V=U.createElement(p.route.Component,null):p.route.element?V=p.route.element:V=f,U.createElement($k,{match:p,routeContext:{outlet:f,matches:N,isDataRoute:t!=null},children:V})};return t&&(p.route.ErrorBoundary||p.route.errorElement||y===0)?U.createElement(zk,{location:t.location,revalidation:t.revalidation,component:S,error:v,children:O(),routeContext:{outlet:null,matches:N,isDataRoute:!0}}):O()},null)}function ag(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Hk(n){let e=U.useContext(Qa);return pt(e,ag(n)),e}function Gk(n){let e=U.useContext(Nd);return pt(e,ag(n)),e}function qk(n){let e=U.useContext(Ur);return pt(e,ag(n)),e}function lg(n){let e=qk(n),t=e.matches[e.matches.length-1];return pt(t.route.id,`${n} can only be used on routes that contain a unique "id"`),t.route.id}function Kk(){return lg("useRouteId")}function Qk(){let n=U.useContext(og),e=Gk("useRouteError"),t=lg("useRouteError");return n!==void 0?n:e.errors?.[t]}function Yk(){let{router:n}=Hk("useNavigate"),e=lg("useNavigate"),t=U.useRef(!1);return zE(()=>{t.current=!0}),U.useCallback(async(s,a={})=>{Mr(t.current,BE),t.current&&(typeof s=="number"?n.navigate(s):await n.navigate(s,{fromRouteId:e,...a}))},[n,e])}var sw={};function HE(n,e,t){!e&&!sw[n]&&(sw[n]=!0,Mr(!1,t))}U.memo(Jk);function Jk({routes:n,future:e,state:t}){return WE(n,void 0,t,e)}function ai(n){pt(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function Xk({basename:n="/",children:e=null,location:t,navigationType:r="POP",navigator:s,static:a=!1}){pt(!$u(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let u=n.replace(/^\/*/,"/"),h=U.useMemo(()=>({basename:u,navigator:s,static:a,future:{}}),[u,s,a]);typeof t=="string"&&(t=Ka(t));let{pathname:f="/",search:p="",hash:y="",state:v=null,key:E="default"}=t,S=U.useMemo(()=>{let R=yi(f,u);return R==null?null:{location:{pathname:R,search:p,hash:y,state:v,key:E},navigationType:r}},[u,f,p,y,v,E,r]);return Mr(S!=null,`<Router basename="${u}"> is not able to match the URL "${f}${p}${y}" because it does not start with the basename, so the <Router> won't render anything.`),S==null?null:U.createElement(jr.Provider,{value:h},U.createElement(zu.Provider,{children:e,value:S}))}function Zk({children:n,location:e}){return jk(gm(n),e)}function gm(n,e=[]){let t=[];return U.Children.forEach(n,(r,s)=>{if(!U.isValidElement(r))return;let a=[...e,s];if(r.type===U.Fragment){t.push.apply(t,gm(r.props.children,a));return}pt(r.type===ai,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),pt(!r.props.index||!r.props.children,"An index route cannot have child routes.");let u={id:r.props.id||a.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(u.children=gm(r.props.children,a)),t.push(u)}),t}var Vh="get",Fh="application/x-www-form-urlencoded";function Dd(n){return n!=null&&typeof n.tagName=="string"}function eR(n){return Dd(n)&&n.tagName.toLowerCase()==="button"}function tR(n){return Dd(n)&&n.tagName.toLowerCase()==="form"}function nR(n){return Dd(n)&&n.tagName.toLowerCase()==="input"}function rR(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function iR(n,e){return n.button===0&&(!e||e==="_self")&&!rR(n)}var Rh=null;function sR(){if(Rh===null)try{new FormData(document.createElement("form"),0),Rh=!1}catch{Rh=!0}return Rh}var oR=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Qp(n){return n!=null&&!oR.has(n)?(Mr(!1,`"${n}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Fh}"`),null):n}function aR(n,e){let t,r,s,a,u;if(tR(n)){let h=n.getAttribute("action");r=h?yi(h,e):null,t=n.getAttribute("method")||Vh,s=Qp(n.getAttribute("enctype"))||Fh,a=new FormData(n)}else if(eR(n)||nR(n)&&(n.type==="submit"||n.type==="image")){let h=n.form;if(h==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let f=n.getAttribute("formaction")||h.getAttribute("action");if(r=f?yi(f,e):null,t=n.getAttribute("formmethod")||h.getAttribute("method")||Vh,s=Qp(n.getAttribute("formenctype"))||Qp(h.getAttribute("enctype"))||Fh,a=new FormData(h,n),!sR()){let{name:p,type:y,value:v}=n;if(y==="image"){let E=p?`${p}.`:"";a.append(`${E}x`,"0"),a.append(`${E}y`,"0")}else p&&a.append(p,v)}}else{if(Dd(n))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=Vh,r=null,s=Fh,u=n}return a&&s==="text/plain"&&(u=a,a=void 0),{action:r,method:t.toLowerCase(),encType:s,formData:a,body:u}}function ug(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}async function lR(n,e){if(n.id in e)return e[n.id];try{let t=await import(n.module);return e[n.id]=t,t}catch(t){return console.error(`Error loading route module \`${n.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function uR(n){return n==null?!1:n.href==null?n.rel==="preload"&&typeof n.imageSrcSet=="string"&&typeof n.imageSizes=="string":typeof n.rel=="string"&&typeof n.href=="string"}async function cR(n,e,t){let r=await Promise.all(n.map(async s=>{let a=e.routes[s.route.id];if(a){let u=await lR(a,t);return u.links?u.links():[]}return[]}));return pR(r.flat(1).filter(uR).filter(s=>s.rel==="stylesheet"||s.rel==="preload").map(s=>s.rel==="stylesheet"?{...s,rel:"prefetch",as:"style"}:{...s,rel:"prefetch"}))}function ow(n,e,t,r,s,a){let u=(f,p)=>t[p]?f.route.id!==t[p].route.id:!0,h=(f,p)=>t[p].pathname!==f.pathname||t[p].route.path?.endsWith("*")&&t[p].params["*"]!==f.params["*"];return a==="assets"?e.filter((f,p)=>u(f,p)||h(f,p)):a==="data"?e.filter((f,p)=>{let y=r.routes[f.route.id];if(!y||!y.hasLoader)return!1;if(u(f,p)||h(f,p))return!0;if(f.route.shouldRevalidate){let v=f.route.shouldRevalidate({currentUrl:new URL(s.pathname+s.search+s.hash,window.origin),currentParams:t[0]?.params||{},nextUrl:new URL(n,window.origin),nextParams:f.params,defaultShouldRevalidate:!0});if(typeof v=="boolean")return v}return!0}):[]}function hR(n,e,{includeHydrateFallback:t}={}){return dR(n.map(r=>{let s=e.routes[r.route.id];if(!s)return[];let a=[s.module];return s.clientActionModule&&(a=a.concat(s.clientActionModule)),s.clientLoaderModule&&(a=a.concat(s.clientLoaderModule)),t&&s.hydrateFallbackModule&&(a=a.concat(s.hydrateFallbackModule)),s.imports&&(a=a.concat(s.imports)),a}).flat(1))}function dR(n){return[...new Set(n)]}function fR(n){let e={},t=Object.keys(n).sort();for(let r of t)e[r]=n[r];return e}function pR(n,e){let t=new Set;return new Set(e),n.reduce((r,s)=>{let a=JSON.stringify(fR(s));return t.has(a)||(t.add(a),r.push({key:a,link:s})),r},[])}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var mR=new Set([100,101,204,205]);function gR(n,e){let t=typeof n=="string"?new URL(n,typeof window>"u"?"server://singlefetch/":window.location.origin):n;return t.pathname==="/"?t.pathname="_root.data":e&&yi(t.pathname,e)==="/"?t.pathname=`${e.replace(/\/$/,"")}/_root.data`:t.pathname=`${t.pathname.replace(/\/$/,"")}.data`,t}function GE(){let n=U.useContext(Qa);return ug(n,"You must render this element inside a <DataRouterContext.Provider> element"),n}function _R(){let n=U.useContext(Nd);return ug(n,"You must render this element inside a <DataRouterStateContext.Provider> element"),n}var cg=U.createContext(void 0);cg.displayName="FrameworkContext";function qE(){let n=U.useContext(cg);return ug(n,"You must render this element inside a <HydratedRouter> element"),n}function yR(n,e){let t=U.useContext(cg),[r,s]=U.useState(!1),[a,u]=U.useState(!1),{onFocus:h,onBlur:f,onMouseEnter:p,onMouseLeave:y,onTouchStart:v}=e,E=U.useRef(null);U.useEffect(()=>{if(n==="render"&&u(!0),n==="viewport"){let N=V=>{V.forEach(K=>{u(K.isIntersecting)})},O=new IntersectionObserver(N,{threshold:.5});return E.current&&O.observe(E.current),()=>{O.disconnect()}}},[n]),U.useEffect(()=>{if(r){let N=setTimeout(()=>{u(!0)},100);return()=>{clearTimeout(N)}}},[r]);let S=()=>{s(!0)},R=()=>{s(!1),u(!1)};return t?n!=="intent"?[a,E,{}]:[a,E,{onFocus:su(h,S),onBlur:su(f,R),onMouseEnter:su(p,S),onMouseLeave:su(y,R),onTouchStart:su(v,S)}]:[!1,E,{}]}function su(n,e){return t=>{n&&n(t),t.defaultPrevented||e(t)}}function vR({page:n,...e}){let{router:t}=GE(),r=U.useMemo(()=>OE(t.routes,n,t.basename),[t.routes,n,t.basename]);return r?U.createElement(ER,{page:n,matches:r,...e}):null}function wR(n){let{manifest:e,routeModules:t}=qE(),[r,s]=U.useState([]);return U.useEffect(()=>{let a=!1;return cR(n,e,t).then(u=>{a||s(u)}),()=>{a=!0}},[n,e,t]),r}function ER({page:n,matches:e,...t}){let r=Ts(),{manifest:s,routeModules:a}=qE(),{basename:u}=GE(),{loaderData:h,matches:f}=_R(),p=U.useMemo(()=>ow(n,e,f,s,r,"data"),[n,e,f,s,r]),y=U.useMemo(()=>ow(n,e,f,s,r,"assets"),[n,e,f,s,r]),v=U.useMemo(()=>{if(n===r.pathname+r.search+r.hash)return[];let R=new Set,N=!1;if(e.forEach(V=>{let K=s.routes[V.route.id];!K||!K.hasLoader||(!p.some(G=>G.route.id===V.route.id)&&V.route.id in h&&a[V.route.id]?.shouldRevalidate||K.hasClientLoader?N=!0:R.add(V.route.id))}),R.size===0)return[];let O=gR(n,u);return N&&R.size>0&&O.searchParams.set("_routes",e.filter(V=>R.has(V.route.id)).map(V=>V.route.id).join(",")),[O.pathname+O.search]},[u,h,r,s,p,e,n,a]),E=U.useMemo(()=>hR(y,s),[y,s]),S=wR(y);return U.createElement(U.Fragment,null,v.map(R=>U.createElement("link",{key:R,rel:"prefetch",as:"fetch",href:R,...t})),E.map(R=>U.createElement("link",{key:R,rel:"modulepreload",href:R,...t})),S.map(({key:R,link:N})=>U.createElement("link",{key:R,...N})))}function TR(...n){return e=>{n.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var KE=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{KE&&(window.__reactRouterVersion="7.6.3")}catch{}function IR({basename:n,children:e,window:t}){let r=U.useRef();r.current==null&&(r.current=ck({window:t,v5Compat:!0}));let s=r.current,[a,u]=U.useState({action:s.action,location:s.location}),h=U.useCallback(f=>{U.startTransition(()=>u(f))},[u]);return U.useLayoutEffect(()=>s.listen(h),[s,h]),U.createElement(Xk,{basename:n,children:e,location:a.location,navigationType:a.action,navigator:s})}var QE=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Od=U.forwardRef(function({onClick:e,discover:t="render",prefetch:r="none",relative:s,reloadDocument:a,replace:u,state:h,target:f,to:p,preventScrollReset:y,viewTransition:v,...E},S){let{basename:R}=U.useContext(jr),N=typeof p=="string"&&QE.test(p),O,V=!1;if(typeof p=="string"&&N&&(O=p,KE))try{let k=new URL(window.location.href),b=p.startsWith("//")?new URL(k.protocol+p):new URL(p),L=yi(b.pathname,R);b.origin===k.origin&&L!=null?p=L+b.search+b.hash:V=!0}catch{Mr(!1,`<Link to="${p}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let K=Vk(p,{relative:s}),[G,J,ne]=yR(r,E),se=kR(p,{replace:u,state:h,target:f,preventScrollReset:y,relative:s,viewTransition:v});function D(k){e&&e(k),k.defaultPrevented||se(k)}let A=U.createElement("a",{...E,...ne,href:O||K,onClick:V||a?e:D,ref:TR(S,J),target:f,"data-discover":!N&&t==="render"?"true":void 0});return G&&!N?U.createElement(U.Fragment,null,A,U.createElement(vR,{page:K})):A});Od.displayName="Link";var CR=U.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:r="",end:s=!1,style:a,to:u,viewTransition:h,children:f,...p},y){let v=Wu(u,{relative:p.relative}),E=Ts(),S=U.useContext(Nd),{navigator:R,basename:N}=U.useContext(jr),O=S!=null&&NR(v)&&h===!0,V=R.encodeLocation?R.encodeLocation(v).pathname:v.pathname,K=E.pathname,G=S&&S.navigation&&S.navigation.location?S.navigation.location.pathname:null;t||(K=K.toLowerCase(),G=G?G.toLowerCase():null,V=V.toLowerCase()),G&&N&&(G=yi(G,N)||G);const J=V!=="/"&&V.endsWith("/")?V.length-1:V.length;let ne=K===V||!s&&K.startsWith(V)&&K.charAt(J)==="/",se=G!=null&&(G===V||!s&&G.startsWith(V)&&G.charAt(V.length)==="/"),D={isActive:ne,isPending:se,isTransitioning:O},A=ne?e:void 0,k;typeof r=="function"?k=r(D):k=[r,ne?"active":null,se?"pending":null,O?"transitioning":null].filter(Boolean).join(" ");let b=typeof a=="function"?a(D):a;return U.createElement(Od,{...p,"aria-current":A,className:k,ref:y,style:b,to:u,viewTransition:h},typeof f=="function"?f(D):f)});CR.displayName="NavLink";var SR=U.forwardRef(({discover:n="render",fetcherKey:e,navigate:t,reloadDocument:r,replace:s,state:a,method:u=Vh,action:h,onSubmit:f,relative:p,preventScrollReset:y,viewTransition:v,...E},S)=>{let R=PR(),N=bR(h,{relative:p}),O=u.toLowerCase()==="get"?"get":"post",V=typeof h=="string"&&QE.test(h),K=G=>{if(f&&f(G),G.defaultPrevented)return;G.preventDefault();let J=G.nativeEvent.submitter,ne=J?.getAttribute("formmethod")||u;R(J||G.currentTarget,{fetcherKey:e,method:ne,navigate:t,replace:s,state:a,relative:p,preventScrollReset:y,viewTransition:v})};return U.createElement("form",{ref:S,method:O,action:N,onSubmit:r?f:K,...E,"data-discover":!V&&n==="render"?"true":void 0})});SR.displayName="Form";function AR(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function YE(n){let e=U.useContext(Qa);return pt(e,AR(n)),e}function kR(n,{target:e,replace:t,state:r,preventScrollReset:s,relative:a,viewTransition:u}={}){let h=mr(),f=Ts(),p=Wu(n,{relative:a});return U.useCallback(y=>{if(iR(y,e)){y.preventDefault();let v=t!==void 0?t:ku(f)===ku(p);h(n,{replace:v,state:r,preventScrollReset:s,relative:a,viewTransition:u})}},[f,h,p,t,r,e,n,s,a,u])}var RR=0,xR=()=>`__${String(++RR)}__`;function PR(){let{router:n}=YE("useSubmit"),{basename:e}=U.useContext(jr),t=Kk();return U.useCallback(async(r,s={})=>{let{action:a,method:u,encType:h,formData:f,body:p}=aR(r,e);if(s.navigate===!1){let y=s.fetcherKey||xR();await n.fetch(y,t,s.action||a,{preventScrollReset:s.preventScrollReset,formData:f,body:p,formMethod:s.method||u,formEncType:s.encType||h,flushSync:s.flushSync})}else await n.navigate(s.action||a,{preventScrollReset:s.preventScrollReset,formData:f,body:p,formMethod:s.method||u,formEncType:s.encType||h,replace:s.replace,state:s.state,fromRouteId:t,flushSync:s.flushSync,viewTransition:s.viewTransition})},[n,e,t])}function bR(n,{relative:e}={}){let{basename:t}=U.useContext(jr),r=U.useContext(Ur);pt(r,"useFormAction must be used inside a RouteContext");let[s]=r.matches.slice(-1),a={...Wu(n||".",{relative:e})},u=Ts();if(n==null){a.search=u.search;let h=new URLSearchParams(a.search),f=h.getAll("index");if(f.some(y=>y==="")){h.delete("index"),f.filter(v=>v).forEach(v=>h.append("index",v));let y=h.toString();a.search=y?`?${y}`:""}}return(!n||n===".")&&s.route.index&&(a.search=a.search?a.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(a.pathname=a.pathname==="/"?t:pi([t,a.pathname])),ku(a)}function NR(n,e={}){let t=U.useContext(UE);pt(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=YE("useViewTransitionState"),s=Wu(n,{relative:e.relative});if(!t.isTransitioning)return!1;let a=yi(t.currentLocation.pathname,r)||t.currentLocation.pathname,u=yi(t.nextLocation.pathname,r)||t.nextLocation.pathname;return Yh(s.pathname,u)!=null||Yh(s.pathname,a)!=null}[...mR];const DR=()=>{};var aw={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JE={NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const le=function(n,e){if(!n)throw Ya(e)},Ya=function(n){return new Error("Firebase Database ("+JE.SDK_VERSION+") INTERNAL ASSERT FAILED: "+n)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XE=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let s=n.charCodeAt(r);s<128?e[t++]=s:s<2048?(e[t++]=s>>6|192,e[t++]=s&63|128):(s&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=s>>18|240,e[t++]=s>>12&63|128,e[t++]=s>>6&63|128,e[t++]=s&63|128):(e[t++]=s>>12|224,e[t++]=s>>6&63|128,e[t++]=s&63|128)}return e},OR=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const s=n[t++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const a=n[t++];e[r++]=String.fromCharCode((s&31)<<6|a&63)}else if(s>239&&s<365){const a=n[t++],u=n[t++],h=n[t++],f=((s&7)<<18|(a&63)<<12|(u&63)<<6|h&63)-65536;e[r++]=String.fromCharCode(55296+(f>>10)),e[r++]=String.fromCharCode(56320+(f&1023))}else{const a=n[t++],u=n[t++];e[r++]=String.fromCharCode((s&15)<<12|(a&63)<<6|u&63)}}return e.join("")},hg={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<n.length;s+=3){const a=n[s],u=s+1<n.length,h=u?n[s+1]:0,f=s+2<n.length,p=f?n[s+2]:0,y=a>>2,v=(a&3)<<4|h>>4;let E=(h&15)<<2|p>>6,S=p&63;f||(S=64,u||(E=64)),r.push(t[y],t[v],t[E],t[S])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(XE(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):OR(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<n.length;){const a=t[n.charAt(s++)],h=s<n.length?t[n.charAt(s)]:0;++s;const p=s<n.length?t[n.charAt(s)]:64;++s;const v=s<n.length?t[n.charAt(s)]:64;if(++s,a==null||h==null||p==null||v==null)throw new LR;const E=a<<2|h>>4;if(r.push(E),p!==64){const S=h<<4&240|p>>2;if(r.push(S),v!==64){const R=p<<6&192|v;r.push(R)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class LR extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const ZE=function(n){const e=XE(n);return hg.encodeByteArray(e,!0)},Jh=function(n){return ZE(n).replace(/\./g,"")},Xh=function(n){try{return hg.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MR(n){return eT(void 0,n)}function eT(n,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const t=e;return new Date(t.getTime());case Object:n===void 0&&(n={});break;case Array:n=[];break;default:return e}for(const t in e)!e.hasOwnProperty(t)||!VR(t)||(n[t]=eT(n[t],e[t]));return n}function VR(n){return n!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FR(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jR=()=>FR().__FIREBASE_DEFAULTS__,UR=()=>{if(typeof process>"u"||typeof aw>"u")return;const n=aw.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},BR=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&Xh(n[1]);return e&&JSON.parse(e)},Ld=()=>{try{return DR()||jR()||UR()||BR()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},tT=n=>{var e,t;return(t=(e=Ld())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},nT=n=>{const e=tT(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},rT=()=>{var n;return(n=Ld())===null||n===void 0?void 0:n.config},iT=n=>{var e;return(e=Ld())===null||e===void 0?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ui{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Is(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function dg(n){return(await fetch(n,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sT(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",s=n.iat||0,a=n.sub||n.user_id;if(!a)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const u=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:a,user_id:a,firebase:{sign_in_provider:"custom",identities:{}}},n);return[Jh(JSON.stringify(t)),Jh(JSON.stringify(u)),""].join(".")}const gu={};function zR(){const n={prod:[],emulator:[]};for(const e of Object.keys(gu))gu[e]?n.emulator.push(e):n.prod.push(e);return n}function $R(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let lw=!1;function fg(n,e){if(typeof window>"u"||typeof document>"u"||!Is(window.location.host)||gu[n]===e||gu[n]||lw)return;gu[n]=e;function t(E){return`__firebase__banner__${E}`}const r="__firebase__banner",a=zR().prod.length>0;function u(){const E=document.getElementById(r);E&&E.remove()}function h(E){E.style.display="flex",E.style.background="#7faaf0",E.style.position="fixed",E.style.bottom="5px",E.style.left="5px",E.style.padding=".5em",E.style.borderRadius="5px",E.style.alignItems="center"}function f(E,S){E.setAttribute("width","24"),E.setAttribute("id",S),E.setAttribute("height","24"),E.setAttribute("viewBox","0 0 24 24"),E.setAttribute("fill","none"),E.style.marginLeft="-6px"}function p(){const E=document.createElement("span");return E.style.cursor="pointer",E.style.marginLeft="16px",E.style.fontSize="24px",E.innerHTML=" &times;",E.onclick=()=>{lw=!0,u()},E}function y(E,S){E.setAttribute("id",S),E.innerText="Learn more",E.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",E.setAttribute("target","__blank"),E.style.paddingLeft="5px",E.style.textDecoration="underline"}function v(){const E=$R(r),S=t("text"),R=document.getElementById(S)||document.createElement("span"),N=t("learnmore"),O=document.getElementById(N)||document.createElement("a"),V=t("preprendIcon"),K=document.getElementById(V)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(E.created){const G=E.element;h(G),y(O,N);const J=p();f(K,V),G.append(K,R,O,J),document.body.appendChild(G)}a?(R.innerText="Preview backend disconnected.",K.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(K.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,R.innerText="Preview backend running in this workspace."),R.setAttribute("id",S)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",v):v()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function an(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function pg(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(an())}function WR(){var n;const e=(n=Ld())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function HR(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function GR(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function oT(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function qR(){const n=an();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function KR(){return JE.NODE_ADMIN===!0}function QR(){return!WR()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function YR(){try{return typeof indexedDB=="object"}catch{return!1}}function JR(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},s.onupgradeneeded=()=>{t=!1},s.onerror=()=>{var a;e(((a=s.error)===null||a===void 0?void 0:a.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XR="FirebaseError";class Si extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=XR,Object.setPrototypeOf(this,Si.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Hu.prototype.create)}}class Hu{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},s=`${this.service}/${e}`,a=this.errors[e],u=a?ZR(a,r):"Error",h=`${this.serviceName}: ${u} (${s}).`;return new Si(s,h,r)}}function ZR(n,e){return n.replace(ex,(t,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const ex=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ru(n){return JSON.parse(n)}function Yt(n){return JSON.stringify(n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aT=function(n){let e={},t={},r={},s="";try{const a=n.split(".");e=Ru(Xh(a[0])||""),t=Ru(Xh(a[1])||""),s=a[2],r=t.d||{},delete t.d}catch{}return{header:e,claims:t,data:r,signature:s}},tx=function(n){const e=aT(n),t=e.claims;return!!t&&typeof t=="object"&&t.hasOwnProperty("iat")},nx=function(n){const e=aT(n).claims;return typeof e=="object"&&e.admin===!0};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Br(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function Fa(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]}function Zh(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function ed(n,e,t){const r={};for(const s in n)Object.prototype.hasOwnProperty.call(n,s)&&(r[s]=e.call(t,n[s],s,n));return r}function ds(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const s of t){if(!r.includes(s))return!1;const a=n[s],u=e[s];if(uw(a)&&uw(u)){if(!ds(a,u))return!1}else if(a!==u)return!1}for(const s of r)if(!t.includes(s))return!1;return!0}function uw(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ja(n){const e=[];for(const[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function cu(n){const e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[s,a]=r.split("=");e[decodeURIComponent(s)]=decodeURIComponent(a)}}),e}function hu(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rx{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,t){t||(t=0);const r=this.W_;if(typeof e=="string")for(let v=0;v<16;v++)r[v]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(let v=0;v<16;v++)r[v]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(let v=16;v<80;v++){const E=r[v-3]^r[v-8]^r[v-14]^r[v-16];r[v]=(E<<1|E>>>31)&4294967295}let s=this.chain_[0],a=this.chain_[1],u=this.chain_[2],h=this.chain_[3],f=this.chain_[4],p,y;for(let v=0;v<80;v++){v<40?v<20?(p=h^a&(u^h),y=1518500249):(p=a^u^h,y=1859775393):v<60?(p=a&u|h&(a|u),y=2400959708):(p=a^u^h,y=3395469782);const E=(s<<5|s>>>27)+p+f+y+r[v]&4294967295;f=h,h=u,u=(a<<30|a>>>2)&4294967295,a=s,s=E}this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+a&4294967295,this.chain_[2]=this.chain_[2]+u&4294967295,this.chain_[3]=this.chain_[3]+h&4294967295,this.chain_[4]=this.chain_[4]+f&4294967295}update(e,t){if(e==null)return;t===void 0&&(t=e.length);const r=t-this.blockSize;let s=0;const a=this.buf_;let u=this.inbuf_;for(;s<t;){if(u===0)for(;s<=r;)this.compress_(e,s),s+=this.blockSize;if(typeof e=="string"){for(;s<t;)if(a[u]=e.charCodeAt(s),++u,++s,u===this.blockSize){this.compress_(a),u=0;break}}else for(;s<t;)if(a[u]=e[s],++u,++s,u===this.blockSize){this.compress_(a),u=0;break}}this.inbuf_=u,this.total_+=t}digest(){const e=[];let t=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let s=this.blockSize-1;s>=56;s--)this.buf_[s]=t&255,t/=256;this.compress_(this.buf_);let r=0;for(let s=0;s<5;s++)for(let a=24;a>=0;a-=8)e[r]=this.chain_[s]>>a&255,++r;return e}}function ix(n,e){const t=new sx(n,e);return t.subscribe.bind(t)}class sx{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let s;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");ox(e,["next","error","complete"])?s=e:s={next:e,error:t,complete:r},s.next===void 0&&(s.next=Yp),s.error===void 0&&(s.error=Yp),s.complete===void 0&&(s.complete=Yp);const a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),a}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function ox(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Yp(){}function ja(n,e){return`${n} failed: ${e} argument `}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ax=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let s=n.charCodeAt(r);if(s>=55296&&s<=56319){const a=s-55296;r++,le(r<n.length,"Surrogate pair missing trail surrogate.");const u=n.charCodeAt(r)-56320;s=65536+(a<<10)+u}s<128?e[t++]=s:s<2048?(e[t++]=s>>6|192,e[t++]=s&63|128):s<65536?(e[t++]=s>>12|224,e[t++]=s>>6&63|128,e[t++]=s&63|128):(e[t++]=s>>18|240,e[t++]=s>>12&63|128,e[t++]=s>>6&63|128,e[t++]=s&63|128)}return e},Md=function(n){let e=0;for(let t=0;t<n.length;t++){const r=n.charCodeAt(t);r<128?e++:r<2048?e+=2:r>=55296&&r<=56319?(e+=4,t++):e+=3}return e};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ze(n){return n&&n._delegate?n._delegate:n}class fs{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const no="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lx{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new ui;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:t});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const r=this.normalizeInstanceIdentifier(e?.identifier),s=(t=e?.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(a){if(s)return null;throw a}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(cx(e))try{this.getOrInitializeService({instanceIdentifier:no})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(t);try{const a=this.getOrInitializeService({instanceIdentifier:s});r.resolve(a)}catch{}}}}clearInstance(e=no){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=no){return this.instances.has(e)}getOptions(e=no){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[a,u]of this.instancesDeferred.entries()){const h=this.normalizeInstanceIdentifier(a);r===h&&u.resolve(s)}return s}onInit(e,t){var r;const s=this.normalizeInstanceIdentifier(t),a=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;a.add(e),this.onInitCallbacks.set(s,a);const u=this.instances.get(s);return u&&e(u,s),()=>{a.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const s of r)try{s(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:ux(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=no){return this.component?this.component.multipleInstances?e:no:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function ux(n){return n===no?void 0:n}function cx(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hx{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new lx(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var be;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(be||(be={}));const dx={debug:be.DEBUG,verbose:be.VERBOSE,info:be.INFO,warn:be.WARN,error:be.ERROR,silent:be.SILENT},fx=be.INFO,px={[be.DEBUG]:"log",[be.VERBOSE]:"log",[be.INFO]:"info",[be.WARN]:"warn",[be.ERROR]:"error"},mx=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),s=px[e];if(s)console[s](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Vd{constructor(e){this.name=e,this._logLevel=fx,this._logHandler=mx,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in be))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?dx[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,be.DEBUG,...e),this._logHandler(this,be.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,be.VERBOSE,...e),this._logHandler(this,be.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,be.INFO,...e),this._logHandler(this,be.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,be.WARN,...e),this._logHandler(this,be.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,be.ERROR,...e),this._logHandler(this,be.ERROR,...e)}}const gx=(n,e)=>e.some(t=>n instanceof t);let cw,hw;function _x(){return cw||(cw=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function yx(){return hw||(hw=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const lT=new WeakMap,_m=new WeakMap,uT=new WeakMap,Jp=new WeakMap,mg=new WeakMap;function vx(n){const e=new Promise((t,r)=>{const s=()=>{n.removeEventListener("success",a),n.removeEventListener("error",u)},a=()=>{t(ss(n.result)),s()},u=()=>{r(n.error),s()};n.addEventListener("success",a),n.addEventListener("error",u)});return e.then(t=>{t instanceof IDBCursor&&lT.set(t,n)}).catch(()=>{}),mg.set(e,n),e}function wx(n){if(_m.has(n))return;const e=new Promise((t,r)=>{const s=()=>{n.removeEventListener("complete",a),n.removeEventListener("error",u),n.removeEventListener("abort",u)},a=()=>{t(),s()},u=()=>{r(n.error||new DOMException("AbortError","AbortError")),s()};n.addEventListener("complete",a),n.addEventListener("error",u),n.addEventListener("abort",u)});_m.set(n,e)}let ym={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return _m.get(n);if(e==="objectStoreNames")return n.objectStoreNames||uT.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return ss(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function Ex(n){ym=n(ym)}function Tx(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(Xp(this),e,...t);return uT.set(r,e.sort?e.sort():[e]),ss(r)}:yx().includes(n)?function(...e){return n.apply(Xp(this),e),ss(lT.get(this))}:function(...e){return ss(n.apply(Xp(this),e))}}function Ix(n){return typeof n=="function"?Tx(n):(n instanceof IDBTransaction&&wx(n),gx(n,_x())?new Proxy(n,ym):n)}function ss(n){if(n instanceof IDBRequest)return vx(n);if(Jp.has(n))return Jp.get(n);const e=Ix(n);return e!==n&&(Jp.set(n,e),mg.set(e,n)),e}const Xp=n=>mg.get(n);function Cx(n,e,{blocked:t,upgrade:r,blocking:s,terminated:a}={}){const u=indexedDB.open(n,e),h=ss(u);return r&&u.addEventListener("upgradeneeded",f=>{r(ss(u.result),f.oldVersion,f.newVersion,ss(u.transaction),f)}),t&&u.addEventListener("blocked",f=>t(f.oldVersion,f.newVersion,f)),h.then(f=>{a&&f.addEventListener("close",()=>a()),s&&f.addEventListener("versionchange",p=>s(p.oldVersion,p.newVersion,p))}).catch(()=>{}),h}const Sx=["get","getKey","getAll","getAllKeys","count"],Ax=["put","add","delete","clear"],Zp=new Map;function dw(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Zp.get(e))return Zp.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,s=Ax.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(s||Sx.includes(t)))return;const a=async function(u,...h){const f=this.transaction(u,s?"readwrite":"readonly");let p=f.store;return r&&(p=p.index(h.shift())),(await Promise.all([p[t](...h),s&&f.done]))[0]};return Zp.set(e,a),a}Ex(n=>({...n,get:(e,t,r)=>dw(e,t)||n.get(e,t,r),has:(e,t)=>!!dw(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kx{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(Rx(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function Rx(n){const e=n.getComponent();return e?.type==="VERSION"}const vm="@firebase/app",fw="0.13.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vi=new Vd("@firebase/app"),xx="@firebase/app-compat",Px="@firebase/analytics-compat",bx="@firebase/analytics",Nx="@firebase/app-check-compat",Dx="@firebase/app-check",Ox="@firebase/auth",Lx="@firebase/auth-compat",Mx="@firebase/database",Vx="@firebase/data-connect",Fx="@firebase/database-compat",jx="@firebase/functions",Ux="@firebase/functions-compat",Bx="@firebase/installations",zx="@firebase/installations-compat",$x="@firebase/messaging",Wx="@firebase/messaging-compat",Hx="@firebase/performance",Gx="@firebase/performance-compat",qx="@firebase/remote-config",Kx="@firebase/remote-config-compat",Qx="@firebase/storage",Yx="@firebase/storage-compat",Jx="@firebase/firestore",Xx="@firebase/ai",Zx="@firebase/firestore-compat",e1="firebase",t1="11.10.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wm="[DEFAULT]",n1={[vm]:"fire-core",[xx]:"fire-core-compat",[bx]:"fire-analytics",[Px]:"fire-analytics-compat",[Dx]:"fire-app-check",[Nx]:"fire-app-check-compat",[Ox]:"fire-auth",[Lx]:"fire-auth-compat",[Mx]:"fire-rtdb",[Vx]:"fire-data-connect",[Fx]:"fire-rtdb-compat",[jx]:"fire-fn",[Ux]:"fire-fn-compat",[Bx]:"fire-iid",[zx]:"fire-iid-compat",[$x]:"fire-fcm",[Wx]:"fire-fcm-compat",[Hx]:"fire-perf",[Gx]:"fire-perf-compat",[qx]:"fire-rc",[Kx]:"fire-rc-compat",[Qx]:"fire-gcs",[Yx]:"fire-gcs-compat",[Jx]:"fire-fst",[Zx]:"fire-fst-compat",[Xx]:"fire-vertex","fire-js":"fire-js",[e1]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const td=new Map,r1=new Map,Em=new Map;function pw(n,e){try{n.container.addComponent(e)}catch(t){vi.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function co(n){const e=n.name;if(Em.has(e))return vi.debug(`There were multiple attempts to register component ${e}.`),!1;Em.set(e,n);for(const t of td.values())pw(t,n);for(const t of r1.values())pw(t,n);return!0}function Fd(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Dn(n){return n==null?!1:n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i1={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},os=new Hu("app","Firebase",i1);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s1{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new fs("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw os.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wo=t1;function cT(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r=Object.assign({name:wm,automaticDataCollectionEnabled:!0},e),s=r.name;if(typeof s!="string"||!s)throw os.create("bad-app-name",{appName:String(s)});if(t||(t=rT()),!t)throw os.create("no-options");const a=td.get(s);if(a){if(ds(t,a.options)&&ds(r,a.config))return a;throw os.create("duplicate-app",{appName:s})}const u=new hx(s);for(const f of Em.values())u.addComponent(f);const h=new s1(t,r,u);return td.set(s,h),h}function gg(n=wm){const e=td.get(n);if(!e&&n===wm&&rT())return cT();if(!e)throw os.create("no-app",{appName:n});return e}function Pr(n,e,t){var r;let s=(r=n1[n])!==null&&r!==void 0?r:n;t&&(s+=`-${t}`);const a=s.match(/\s|\//),u=e.match(/\s|\//);if(a||u){const h=[`Unable to register library "${s}" with version "${e}":`];a&&h.push(`library name "${s}" contains illegal characters (whitespace or "/")`),a&&u&&h.push("and"),u&&h.push(`version name "${e}" contains illegal characters (whitespace or "/")`),vi.warn(h.join(" "));return}co(new fs(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o1="firebase-heartbeat-database",a1=1,xu="firebase-heartbeat-store";let em=null;function hT(){return em||(em=Cx(o1,a1,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(xu)}catch(t){console.warn(t)}}}}).catch(n=>{throw os.create("idb-open",{originalErrorMessage:n.message})})),em}async function l1(n){try{const t=(await hT()).transaction(xu),r=await t.objectStore(xu).get(dT(n));return await t.done,r}catch(e){if(e instanceof Si)vi.warn(e.message);else{const t=os.create("idb-get",{originalErrorMessage:e?.message});vi.warn(t.message)}}}async function mw(n,e){try{const r=(await hT()).transaction(xu,"readwrite");await r.objectStore(xu).put(e,dT(n)),await r.done}catch(t){if(t instanceof Si)vi.warn(t.message);else{const r=os.create("idb-set",{originalErrorMessage:t?.message});vi.warn(r.message)}}}function dT(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u1=1024,c1=30;class h1{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new f1(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,t;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),a=gw();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===a||this._heartbeatsCache.heartbeats.some(u=>u.date===a))return;if(this._heartbeatsCache.heartbeats.push({date:a,agent:s}),this._heartbeatsCache.heartbeats.length>c1){const u=p1(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(u,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){vi.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=gw(),{heartbeatsToSend:r,unsentEntries:s}=d1(this._heartbeatsCache.heartbeats),a=Jh(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),a}catch(t){return vi.warn(t),""}}}function gw(){return new Date().toISOString().substring(0,10)}function d1(n,e=u1){const t=[];let r=n.slice();for(const s of n){const a=t.find(u=>u.agent===s.agent);if(a){if(a.dates.push(s.date),_w(t)>e){a.dates.pop();break}}else if(t.push({agent:s.agent,dates:[s.date]}),_w(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class f1{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return YR()?JR().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await l1(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const s=await this.read();return mw(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const s=await this.read();return mw(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function _w(n){return Jh(JSON.stringify({version:2,heartbeats:n})).length}function p1(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function m1(n){co(new fs("platform-logger",e=>new kx(e),"PRIVATE")),co(new fs("heartbeat",e=>new h1(e),"PRIVATE")),Pr(vm,fw,n),Pr(vm,fw,"esm2017"),Pr("fire-js","")}m1("");function _g(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(n);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(n,r[s])&&(t[r[s]]=n[r[s]]);return t}function fT(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const g1=fT,pT=new Hu("auth","Firebase",fT());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nd=new Vd("@firebase/auth");function _1(n,...e){nd.logLevel<=be.WARN&&nd.warn(`Auth (${wo}): ${n}`,...e)}function jh(n,...e){nd.logLevel<=be.ERROR&&nd.error(`Auth (${wo}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fr(n,...e){throw yg(n,...e)}function br(n,...e){return yg(n,...e)}function mT(n,e,t){const r=Object.assign(Object.assign({},g1()),{[e]:t});return new Hu("auth","Firebase",r).create(e,{appName:n.name})}function mi(n){return mT(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function yg(n,...e){if(typeof n!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return pT.create(n,...e)}function Ce(n,e,...t){if(!n)throw yg(e,...t)}function hi(n){const e="INTERNAL ASSERTION FAILED: "+n;throw jh(e),new Error(e)}function wi(n,e){n||hi(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tm(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function y1(){return yw()==="http:"||yw()==="https:"}function yw(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function v1(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(y1()||GR()||"connection"in navigator)?navigator.onLine:!0}function w1(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gu{constructor(e,t){this.shortDelay=e,this.longDelay=t,wi(t>e,"Short delay should be less than long delay!"),this.isMobile=pg()||oT()}get(){return v1()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vg(n,e){wi(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gT{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;hi("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;hi("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;hi("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E1={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T1=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],I1=new Gu(3e4,6e4);function Cs(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}async function Ss(n,e,t,r,s={}){return _T(n,s,async()=>{let a={},u={};r&&(e==="GET"?u=r:a={body:JSON.stringify(r)});const h=Ja(Object.assign({key:n.config.apiKey},u)).slice(1),f=await n._getAdditionalHeaders();f["Content-Type"]="application/json",n.languageCode&&(f["X-Firebase-Locale"]=n.languageCode);const p=Object.assign({method:e,headers:f},a);return HR()||(p.referrerPolicy="no-referrer"),n.emulatorConfig&&Is(n.emulatorConfig.host)&&(p.credentials="include"),gT.fetch()(await yT(n,n.config.apiHost,t,h),p)})}async function _T(n,e,t){n._canInitEmulator=!1;const r=Object.assign(Object.assign({},E1),e);try{const s=new S1(n),a=await Promise.race([t(),s.promise]);s.clearNetworkTimeout();const u=await a.json();if("needConfirmation"in u)throw xh(n,"account-exists-with-different-credential",u);if(a.ok&&!("errorMessage"in u))return u;{const h=a.ok?u.errorMessage:u.error.message,[f,p]=h.split(" : ");if(f==="FEDERATED_USER_ID_ALREADY_LINKED")throw xh(n,"credential-already-in-use",u);if(f==="EMAIL_EXISTS")throw xh(n,"email-already-in-use",u);if(f==="USER_DISABLED")throw xh(n,"user-disabled",u);const y=r[f]||f.toLowerCase().replace(/[_\s]+/g,"-");if(p)throw mT(n,y,p);fr(n,y)}}catch(s){if(s instanceof Si)throw s;fr(n,"network-request-failed",{message:String(s)})}}async function qu(n,e,t,r,s={}){const a=await Ss(n,e,t,r,s);return"mfaPendingCredential"in a&&fr(n,"multi-factor-auth-required",{_serverResponse:a}),a}async function yT(n,e,t,r){const s=`${e}${t}?${r}`,a=n,u=a.config.emulator?vg(n.config,s):`${n.config.apiScheme}://${s}`;return T1.includes(t)&&(await a._persistenceManagerAvailable,a._getPersistenceType()==="COOKIE")?a._getPersistence()._getFinalTarget(u).toString():u}function C1(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class S1{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(br(this.auth,"network-request-failed")),I1.get())})}}function xh(n,e,t){const r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const s=br(n,e,r);return s.customData._tokenResponse=t,s}function vw(n){return n!==void 0&&n.enterprise!==void 0}class A1{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return C1(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function k1(n,e){return Ss(n,"GET","/v2/recaptchaConfig",Cs(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function R1(n,e){return Ss(n,"POST","/v1/accounts:delete",e)}async function rd(n,e){return Ss(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _u(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function x1(n,e=!1){const t=Ze(n),r=await t.getIdToken(e),s=wg(r);Ce(s&&s.exp&&s.auth_time&&s.iat,t.auth,"internal-error");const a=typeof s.firebase=="object"?s.firebase:void 0,u=a?.sign_in_provider;return{claims:s,token:r,authTime:_u(tm(s.auth_time)),issuedAtTime:_u(tm(s.iat)),expirationTime:_u(tm(s.exp)),signInProvider:u||null,signInSecondFactor:a?.sign_in_second_factor||null}}function tm(n){return Number(n)*1e3}function wg(n){const[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return jh("JWT malformed, contained fewer than 3 sections"),null;try{const s=Xh(t);return s?JSON.parse(s):(jh("Failed to decode base64 JWT payload"),null)}catch(s){return jh("Caught error parsing JWT payload as JSON",s?.toString()),null}}function ww(n){const e=wg(n);return Ce(e,"internal-error"),Ce(typeof e.exp<"u","internal-error"),Ce(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Pu(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof Si&&P1(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function P1({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b1{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const s=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Im{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=_u(this.lastLoginAt),this.creationTime=_u(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function id(n){var e;const t=n.auth,r=await n.getIdToken(),s=await Pu(n,rd(t,{idToken:r}));Ce(s?.users.length,t,"internal-error");const a=s.users[0];n._notifyReloadListener(a);const u=!((e=a.providerUserInfo)===null||e===void 0)&&e.length?vT(a.providerUserInfo):[],h=D1(n.providerData,u),f=n.isAnonymous,p=!(n.email&&a.passwordHash)&&!h?.length,y=f?p:!1,v={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:h,metadata:new Im(a.createdAt,a.lastLoginAt),isAnonymous:y};Object.assign(n,v)}async function N1(n){const e=Ze(n);await id(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function D1(n,e){return[...n.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function vT(n){return n.map(e=>{var{providerId:t}=e,r=_g(e,["providerId"]);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function O1(n,e){const t=await _T(n,{},async()=>{const r=Ja({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:a}=n.config,u=await yT(n,s,"/v1/token",`key=${a}`),h=await n._getAdditionalHeaders();h["Content-Type"]="application/x-www-form-urlencoded";const f={method:"POST",headers:h,body:r};return n.emulatorConfig&&Is(n.emulatorConfig.host)&&(f.credentials="include"),gT.fetch()(u,f)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function L1(n,e){return Ss(n,"POST","/v2/accounts:revokeToken",Cs(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ba{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Ce(e.idToken,"internal-error"),Ce(typeof e.idToken<"u","internal-error"),Ce(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):ww(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Ce(e.length!==0,"internal-error");const t=ww(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Ce(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:s,expiresIn:a}=await O1(e,t);this.updateTokensAndExpiration(r,s,Number(a))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:s,expirationTime:a}=t,u=new ba;return r&&(Ce(typeof r=="string","internal-error",{appName:e}),u.refreshToken=r),s&&(Ce(typeof s=="string","internal-error",{appName:e}),u.accessToken=s),a&&(Ce(typeof a=="number","internal-error",{appName:e}),u.expirationTime=a),u}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new ba,this.toJSON())}_performRefresh(){return hi("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xi(n,e){Ce(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class hr{constructor(e){var{uid:t,auth:r,stsTokenManager:s}=e,a=_g(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new b1(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=a.displayName||null,this.email=a.email||null,this.emailVerified=a.emailVerified||!1,this.phoneNumber=a.phoneNumber||null,this.photoURL=a.photoURL||null,this.isAnonymous=a.isAnonymous||!1,this.tenantId=a.tenantId||null,this.providerData=a.providerData?[...a.providerData]:[],this.metadata=new Im(a.createdAt||void 0,a.lastLoginAt||void 0)}async getIdToken(e){const t=await Pu(this,this.stsTokenManager.getToken(this.auth,e));return Ce(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return x1(this,e)}reload(){return N1(this)}_assign(e){this!==e&&(Ce(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new hr(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){Ce(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await id(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Dn(this.auth.app))return Promise.reject(mi(this.auth));const e=await this.getIdToken();return await Pu(this,R1(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r,s,a,u,h,f,p,y;const v=(r=t.displayName)!==null&&r!==void 0?r:void 0,E=(s=t.email)!==null&&s!==void 0?s:void 0,S=(a=t.phoneNumber)!==null&&a!==void 0?a:void 0,R=(u=t.photoURL)!==null&&u!==void 0?u:void 0,N=(h=t.tenantId)!==null&&h!==void 0?h:void 0,O=(f=t._redirectEventId)!==null&&f!==void 0?f:void 0,V=(p=t.createdAt)!==null&&p!==void 0?p:void 0,K=(y=t.lastLoginAt)!==null&&y!==void 0?y:void 0,{uid:G,emailVerified:J,isAnonymous:ne,providerData:se,stsTokenManager:D}=t;Ce(G&&D,e,"internal-error");const A=ba.fromJSON(this.name,D);Ce(typeof G=="string",e,"internal-error"),Xi(v,e.name),Xi(E,e.name),Ce(typeof J=="boolean",e,"internal-error"),Ce(typeof ne=="boolean",e,"internal-error"),Xi(S,e.name),Xi(R,e.name),Xi(N,e.name),Xi(O,e.name),Xi(V,e.name),Xi(K,e.name);const k=new hr({uid:G,auth:e,email:E,emailVerified:J,displayName:v,isAnonymous:ne,photoURL:R,phoneNumber:S,tenantId:N,stsTokenManager:A,createdAt:V,lastLoginAt:K});return se&&Array.isArray(se)&&(k.providerData=se.map(b=>Object.assign({},b))),O&&(k._redirectEventId=O),k}static async _fromIdTokenResponse(e,t,r=!1){const s=new ba;s.updateFromServerResponse(t);const a=new hr({uid:t.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await id(a),a}static async _fromGetAccountInfoResponse(e,t,r){const s=t.users[0];Ce(s.localId!==void 0,"internal-error");const a=s.providerUserInfo!==void 0?vT(s.providerUserInfo):[],u=!(s.email&&s.passwordHash)&&!a?.length,h=new ba;h.updateFromIdToken(r);const f=new hr({uid:s.localId,auth:e,stsTokenManager:h,isAnonymous:u}),p={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new Im(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!a?.length};return Object.assign(f,p),f}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ew=new Map;function di(n){wi(n instanceof Function,"Expected a class definition");let e=Ew.get(n);return e?(wi(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,Ew.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wT{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}wT.type="NONE";const Tw=wT;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Uh(n,e,t){return`firebase:${n}:${e}:${t}`}class Na{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:s,name:a}=this.auth;this.fullUserKey=Uh(this.userKey,s.apiKey,a),this.fullPersistenceKey=Uh("persistence",s.apiKey,a),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await rd(this.auth,{idToken:e}).catch(()=>{});return t?hr._fromGetAccountInfoResponse(this.auth,t,e):null}return hr._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new Na(di(Tw),e,r);const s=(await Promise.all(t.map(async p=>{if(await p._isAvailable())return p}))).filter(p=>p);let a=s[0]||di(Tw);const u=Uh(r,e.config.apiKey,e.name);let h=null;for(const p of t)try{const y=await p._get(u);if(y){let v;if(typeof y=="string"){const E=await rd(e,{idToken:y}).catch(()=>{});if(!E)break;v=await hr._fromGetAccountInfoResponse(e,E,y)}else v=hr._fromJSON(e,y);p!==a&&(h=v),a=p;break}}catch{}const f=s.filter(p=>p._shouldAllowMigration);return!a._shouldAllowMigration||!f.length?new Na(a,e,r):(a=f[0],h&&await a._set(u,h.toJSON()),await Promise.all(t.map(async p=>{if(p!==a)try{await p._remove(u)}catch{}})),new Na(a,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Iw(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(CT(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(ET(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(AT(e))return"Blackberry";if(kT(e))return"Webos";if(TT(e))return"Safari";if((e.includes("chrome/")||IT(e))&&!e.includes("edge/"))return"Chrome";if(ST(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function ET(n=an()){return/firefox\//i.test(n)}function TT(n=an()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function IT(n=an()){return/crios\//i.test(n)}function CT(n=an()){return/iemobile/i.test(n)}function ST(n=an()){return/android/i.test(n)}function AT(n=an()){return/blackberry/i.test(n)}function kT(n=an()){return/webos/i.test(n)}function Eg(n=an()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function M1(n=an()){var e;return Eg(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function V1(){return qR()&&document.documentMode===10}function RT(n=an()){return Eg(n)||ST(n)||kT(n)||AT(n)||/windows phone/i.test(n)||CT(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xT(n,e=[]){let t;switch(n){case"Browser":t=Iw(an());break;case"Worker":t=`${Iw(an())}-${n}`;break;default:t=n}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${wo}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F1{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=a=>new Promise((u,h)=>{try{const f=e(a);u(f)}catch(f){h(f)}});r.onAbort=t,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const s of t)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function j1(n,e={}){return Ss(n,"GET","/v2/passwordPolicy",Cs(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const U1=6;class B1{constructor(e){var t,r,s,a;const u=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=u.minPasswordLength)!==null&&t!==void 0?t:U1,u.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=u.maxPasswordLength),u.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=u.containsLowercaseCharacter),u.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=u.containsUppercaseCharacter),u.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=u.containsNumericCharacter),u.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=u.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(s=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&s!==void 0?s:"",this.forceUpgradeOnSignin=(a=e.forceUpgradeOnSignin)!==null&&a!==void 0?a:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,r,s,a,u,h;const f={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,f),this.validatePasswordCharacterOptions(e,f),f.isValid&&(f.isValid=(t=f.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),f.isValid&&(f.isValid=(r=f.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),f.isValid&&(f.isValid=(s=f.containsLowercaseLetter)!==null&&s!==void 0?s:!0),f.isValid&&(f.isValid=(a=f.containsUppercaseLetter)!==null&&a!==void 0?a:!0),f.isValid&&(f.isValid=(u=f.containsNumericCharacter)!==null&&u!==void 0?u:!0),f.isValid&&(f.isValid=(h=f.containsNonAlphanumericCharacter)!==null&&h!==void 0?h:!0),f}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),s&&(t.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,s,a){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z1{constructor(e,t,r,s){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Cw(this),this.idTokenSubscription=new Cw(this),this.beforeStateQueue=new F1(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=pT,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(a=>this._resolvePersistenceManagerAvailable=a)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=di(t)),this._initializationPromise=this.queue(async()=>{var r,s,a;if(!this._deleted&&(this.persistenceManager=await Na.create(this,e),(r=this._resolvePersistenceManagerAvailable)===null||r===void 0||r.call(this),!this._deleted)){if(!((s=this._popupRedirectResolver)===null||s===void 0)&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((a=this.currentUser)===null||a===void 0?void 0:a.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await rd(this,{idToken:e}),r=await hr._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(Dn(this.app)){const u=this.app.settings.authIdToken;return u?new Promise(h=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(u).then(h,h))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let s=r,a=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const u=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,h=s?._redirectEventId,f=await this.tryRedirectSignIn(e);(!u||u===h)&&f?.user&&(s=f.user,a=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(a)try{await this.beforeStateQueue.runMiddleware(s)}catch(u){s=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(u))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return Ce(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await id(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=w1()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Dn(this.app))return Promise.reject(mi(this));const t=e?Ze(e):null;return t&&Ce(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Ce(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Dn(this.app)?Promise.reject(mi(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Dn(this.app)?Promise.reject(mi(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(di(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await j1(this),t=new B1(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Hu("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await L1(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&di(e)||this._popupRedirectResolver;Ce(t,this,"argument-error"),this.redirectPersistenceManager=await Na.create(this,[di(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,r;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,s){if(this._deleted)return()=>{};const a=typeof t=="function"?t:t.next.bind(t);let u=!1;const h=this._isInitialized?Promise.resolve():this._initializationPromise;if(Ce(h,this,"internal-error"),h.then(()=>{u||a(this.currentUser)}),typeof t=="function"){const f=e.addObserver(t,r,s);return()=>{u=!0,f()}}else{const f=e.addObserver(t);return()=>{u=!0,f()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Ce(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=xT(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(t["X-Firebase-Client"]=r);const s=await this._getAppCheckToken();return s&&(t["X-Firebase-AppCheck"]=s),t}async _getAppCheckToken(){var e;if(Dn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return t?.error&&_1(`Error while retrieving App Check token: ${t.error}`),t?.token}}function Eo(n){return Ze(n)}class Cw{constructor(e){this.auth=e,this.observer=null,this.addObserver=ix(t=>this.observer=t)}get next(){return Ce(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let jd={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function $1(n){jd=n}function PT(n){return jd.loadJS(n)}function W1(){return jd.recaptchaEnterpriseScript}function H1(){return jd.gapiScript}function G1(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class q1{constructor(){this.enterprise=new K1}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class K1{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const Q1="recaptcha-enterprise",bT="NO_RECAPTCHA";class Y1{constructor(e){this.type=Q1,this.auth=Eo(e)}async verify(e="verify",t=!1){async function r(a){if(!t){if(a.tenantId==null&&a._agentRecaptchaConfig!=null)return a._agentRecaptchaConfig.siteKey;if(a.tenantId!=null&&a._tenantRecaptchaConfigs[a.tenantId]!==void 0)return a._tenantRecaptchaConfigs[a.tenantId].siteKey}return new Promise(async(u,h)=>{k1(a,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(f=>{if(f.recaptchaKey===void 0)h(new Error("recaptcha Enterprise site key undefined"));else{const p=new A1(f);return a.tenantId==null?a._agentRecaptchaConfig=p:a._tenantRecaptchaConfigs[a.tenantId]=p,u(p.siteKey)}}).catch(f=>{h(f)})})}function s(a,u,h){const f=window.grecaptcha;vw(f)?f.enterprise.ready(()=>{f.enterprise.execute(a,{action:e}).then(p=>{u(p)}).catch(()=>{u(bT)})}):h(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new q1().execute("siteKey",{action:"verify"}):new Promise((a,u)=>{r(this.auth).then(h=>{if(!t&&vw(window.grecaptcha))s(h,a,u);else{if(typeof window>"u"){u(new Error("RecaptchaVerifier is only supported in browser"));return}let f=W1();f.length!==0&&(f+=h),PT(f).then(()=>{s(h,a,u)}).catch(p=>{u(p)})}}).catch(h=>{u(h)})})}}async function Sw(n,e,t,r=!1,s=!1){const a=new Y1(n);let u;if(s)u=bT;else try{u=await a.verify(t)}catch{u=await a.verify(t,!0)}const h=Object.assign({},e);if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in h){const f=h.phoneEnrollmentInfo.phoneNumber,p=h.phoneEnrollmentInfo.recaptchaToken;Object.assign(h,{phoneEnrollmentInfo:{phoneNumber:f,recaptchaToken:p,captchaResponse:u,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in h){const f=h.phoneSignInInfo.recaptchaToken;Object.assign(h,{phoneSignInInfo:{recaptchaToken:f,captchaResponse:u,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return h}return r?Object.assign(h,{captchaResp:u}):Object.assign(h,{captchaResponse:u}),Object.assign(h,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(h,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),h}async function Cm(n,e,t,r,s){var a;if(!((a=n._getRecaptchaConfig())===null||a===void 0)&&a.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const u=await Sw(n,e,t,t==="getOobCode");return r(n,u)}else return r(n,e).catch(async u=>{if(u.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const h=await Sw(n,e,t,t==="getOobCode");return r(n,h)}else return Promise.reject(u)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function J1(n,e){const t=Fd(n,"auth");if(t.isInitialized()){const s=t.getImmediate(),a=t.getOptions();if(ds(a,e??{}))return s;fr(s,"already-initialized")}return t.initialize({options:e})}function X1(n,e){const t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(di);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}function Z1(n,e,t){const r=Eo(n);Ce(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!1,a=NT(e),{host:u,port:h}=eP(e),f=h===null?"":`:${h}`,p={url:`${a}//${u}${f}/`},y=Object.freeze({host:u,port:h,protocol:a.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!r._canInitEmulator){Ce(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),Ce(ds(p,r.config.emulator)&&ds(y,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=p,r.emulatorConfig=y,r.settings.appVerificationDisabledForTesting=!0,Is(u)?(dg(`${a}//${u}${f}`),fg("Auth",!0)):tP()}function NT(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function eP(n){const e=NT(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const a=s[1];return{host:a,port:Aw(r.substr(a.length+1))}}else{const[a,u]=r.split(":");return{host:a,port:Aw(u)}}}function Aw(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function tP(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tg{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return hi("not implemented")}_getIdTokenResponse(e){return hi("not implemented")}_linkToIdToken(e,t){return hi("not implemented")}_getReauthenticationResolver(e){return hi("not implemented")}}async function nP(n,e){return Ss(n,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rP(n,e){return qu(n,"POST","/v1/accounts:signInWithPassword",Cs(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function iP(n,e){return qu(n,"POST","/v1/accounts:signInWithEmailLink",Cs(n,e))}async function sP(n,e){return qu(n,"POST","/v1/accounts:signInWithEmailLink",Cs(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bu extends Tg{constructor(e,t,r,s=null){super("password",r),this._email=e,this._password=t,this._tenantId=s}static _fromEmailAndPassword(e,t){return new bu(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new bu(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Cm(e,t,"signInWithPassword",rP);case"emailLink":return iP(e,{email:this._email,oobCode:this._password});default:fr(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Cm(e,r,"signUpPassword",nP);case"emailLink":return sP(e,{idToken:t,email:this._email,oobCode:this._password});default:fr(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Da(n,e){return qu(n,"POST","/v1/accounts:signInWithIdp",Cs(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oP="http://localhost";class ho extends Tg{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new ho(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):fr("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s}=t,a=_g(t,["providerId","signInMethod"]);if(!r||!s)return null;const u=new ho(r,s);return u.idToken=a.idToken||void 0,u.accessToken=a.accessToken||void 0,u.secret=a.secret,u.nonce=a.nonce,u.pendingToken=a.pendingToken||null,u}_getIdTokenResponse(e){const t=this.buildRequest();return Da(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,Da(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Da(e,t)}buildRequest(){const e={requestUri:oP,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Ja(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aP(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function lP(n){const e=cu(hu(n)).link,t=e?cu(hu(e)).deep_link_id:null,r=cu(hu(n)).deep_link_id;return(r?cu(hu(r)).link:null)||r||t||e||n}class Ig{constructor(e){var t,r,s,a,u,h;const f=cu(hu(e)),p=(t=f.apiKey)!==null&&t!==void 0?t:null,y=(r=f.oobCode)!==null&&r!==void 0?r:null,v=aP((s=f.mode)!==null&&s!==void 0?s:null);Ce(p&&y&&v,"argument-error"),this.apiKey=p,this.operation=v,this.code=y,this.continueUrl=(a=f.continueUrl)!==null&&a!==void 0?a:null,this.languageCode=(u=f.lang)!==null&&u!==void 0?u:null,this.tenantId=(h=f.tenantId)!==null&&h!==void 0?h:null}static parseLink(e){const t=lP(e);try{return new Ig(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xa{constructor(){this.providerId=Xa.PROVIDER_ID}static credential(e,t){return bu._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const r=Ig.parseLink(t);return Ce(r,"argument-error"),bu._fromEmailAndCode(e,r.code,r.tenantId)}}Xa.PROVIDER_ID="password";Xa.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Xa.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DT{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ku extends DT{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zi extends Ku{constructor(){super("facebook.com")}static credential(e){return ho._fromParams({providerId:Zi.PROVIDER_ID,signInMethod:Zi.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Zi.credentialFromTaggedObject(e)}static credentialFromError(e){return Zi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Zi.credential(e.oauthAccessToken)}catch{return null}}}Zi.FACEBOOK_SIGN_IN_METHOD="facebook.com";Zi.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class es extends Ku{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return ho._fromParams({providerId:es.PROVIDER_ID,signInMethod:es.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return es.credentialFromTaggedObject(e)}static credentialFromError(e){return es.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return es.credential(t,r)}catch{return null}}}es.GOOGLE_SIGN_IN_METHOD="google.com";es.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ts extends Ku{constructor(){super("github.com")}static credential(e){return ho._fromParams({providerId:ts.PROVIDER_ID,signInMethod:ts.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ts.credentialFromTaggedObject(e)}static credentialFromError(e){return ts.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ts.credential(e.oauthAccessToken)}catch{return null}}}ts.GITHUB_SIGN_IN_METHOD="github.com";ts.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ns extends Ku{constructor(){super("twitter.com")}static credential(e,t){return ho._fromParams({providerId:ns.PROVIDER_ID,signInMethod:ns.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return ns.credentialFromTaggedObject(e)}static credentialFromError(e){return ns.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return ns.credential(t,r)}catch{return null}}}ns.TWITTER_SIGN_IN_METHOD="twitter.com";ns.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function uP(n,e){return qu(n,"POST","/v1/accounts:signUp",Cs(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fo{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,s=!1){const a=await hr._fromIdTokenResponse(e,r,s),u=kw(r);return new fo({user:a,providerId:u,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const s=kw(r);return new fo({user:e,providerId:s,_tokenResponse:r,operationType:t})}}function kw(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sd extends Si{constructor(e,t,r,s){var a;super(t.code,t.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,sd.prototype),this.customData={appName:e.name,tenantId:(a=e.tenantId)!==null&&a!==void 0?a:void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,s){return new sd(e,t,r,s)}}function OT(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(a=>{throw a.code==="auth/multi-factor-auth-required"?sd._fromErrorAndOperation(n,a,e,r):a})}async function cP(n,e,t=!1){const r=await Pu(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return fo._forOperation(n,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function hP(n,e,t=!1){const{auth:r}=n;if(Dn(r.app))return Promise.reject(mi(r));const s="reauthenticate";try{const a=await Pu(n,OT(r,s,e,n),t);Ce(a.idToken,r,"internal-error");const u=wg(a.idToken);Ce(u,r,"internal-error");const{sub:h}=u;return Ce(n.uid===h,r,"user-mismatch"),fo._forOperation(n,s,a)}catch(a){throw a?.code==="auth/user-not-found"&&fr(r,"user-mismatch"),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function LT(n,e,t=!1){if(Dn(n.app))return Promise.reject(mi(n));const r="signIn",s=await OT(n,r,e),a=await fo._fromIdTokenResponse(n,r,s);return t||await n._updateCurrentUser(a.user),a}async function dP(n,e){return LT(Eo(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function MT(n){const e=Eo(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function fP(n,e,t){if(Dn(n.app))return Promise.reject(mi(n));const r=Eo(n),u=await Cm(r,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",uP).catch(f=>{throw f.code==="auth/password-does-not-meet-requirements"&&MT(n),f}),h=await fo._fromIdTokenResponse(r,"signIn",u);return await r._updateCurrentUser(h.user),h}function pP(n,e,t){return Dn(n.app)?Promise.reject(mi(n)):dP(Ze(n),Xa.credential(e,t)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&MT(n),r})}function mP(n,e,t,r){return Ze(n).onIdTokenChanged(e,t,r)}function gP(n,e,t){return Ze(n).beforeAuthStateChanged(e,t)}function Cg(n,e,t,r){return Ze(n).onAuthStateChanged(e,t,r)}function VT(n){return Ze(n).signOut()}const od="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FT{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(od,"1"),this.storage.removeItem(od),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _P=1e3,yP=10;class jT extends FT{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=RT(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),s=this.localCache[t];r!==s&&e(t,s,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((u,h,f)=>{this.notifyListeners(u,f)});return}const r=e.key;t?this.detachListener():this.stopPolling();const s=()=>{const u=this.storage.getItem(r);!t&&this.localCache[r]===u||this.notifyListeners(r,u)},a=this.storage.getItem(r);V1()&&a!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,yP):s()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},_P)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}jT.type="LOCAL";const vP=jT;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UT extends FT{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}UT.type="SESSION";const BT=UT;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wP(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ud{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(s=>s.isListeningto(e));if(t)return t;const r=new Ud(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:s,data:a}=t.data,u=this.handlersMap[s];if(!u?.size)return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const h=Array.from(u).map(async p=>p(t.origin,a)),f=await wP(h);t.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:f})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Ud.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sg(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EP{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let a,u;return new Promise((h,f)=>{const p=Sg("",20);s.port1.start();const y=setTimeout(()=>{f(new Error("unsupported_event"))},r);u={messageChannel:s,onMessage(v){const E=v;if(E.data.eventId===p)switch(E.data.status){case"ack":clearTimeout(y),a=setTimeout(()=>{f(new Error("timeout"))},3e3);break;case"done":clearTimeout(a),h(E.data.response);break;default:clearTimeout(y),clearTimeout(a),f(new Error("invalid_response"));break}}},this.handlers.add(u),s.port1.addEventListener("message",u.onMessage),this.target.postMessage({eventType:e,eventId:p,data:t},[s.port2])}).finally(()=>{u&&this.removeMessageHandler(u)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nr(){return window}function TP(n){Nr().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zT(){return typeof Nr().WorkerGlobalScope<"u"&&typeof Nr().importScripts=="function"}async function IP(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function CP(){var n;return((n=navigator?.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function SP(){return zT()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $T="firebaseLocalStorageDb",AP=1,ad="firebaseLocalStorage",WT="fbase_key";class Qu{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Bd(n,e){return n.transaction([ad],e?"readwrite":"readonly").objectStore(ad)}function kP(){const n=indexedDB.deleteDatabase($T);return new Qu(n).toPromise()}function Sm(){const n=indexedDB.open($T,AP);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(ad,{keyPath:WT})}catch(s){t(s)}}),n.addEventListener("success",async()=>{const r=n.result;r.objectStoreNames.contains(ad)?e(r):(r.close(),await kP(),e(await Sm()))})})}async function Rw(n,e,t){const r=Bd(n,!0).put({[WT]:e,value:t});return new Qu(r).toPromise()}async function RP(n,e){const t=Bd(n,!1).get(e),r=await new Qu(t).toPromise();return r===void 0?null:r.value}function xw(n,e){const t=Bd(n,!0).delete(e);return new Qu(t).toPromise()}const xP=800,PP=3;class HT{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Sm(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>PP)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return zT()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Ud._getInstance(SP()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await IP(),!this.activeServiceWorker)return;this.sender=new EP(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((t=r[0])===null||t===void 0)&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||CP()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Sm();return await Rw(e,od,"1"),await xw(e,od),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>Rw(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>RP(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>xw(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const a=Bd(s,!1).getAll();return new Qu(a).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:a}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(a)&&(this.notifyListeners(s,a),t.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),t.push(s));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),xP)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}HT.type="LOCAL";const bP=HT;new Gu(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NP(n,e){return e?di(e):(Ce(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ag extends Tg{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Da(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Da(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Da(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function DP(n){return LT(n.auth,new Ag(n),n.bypassAuthState)}function OP(n){const{auth:e,user:t}=n;return Ce(t,e,"internal-error"),hP(t,new Ag(n),n.bypassAuthState)}async function LP(n){const{auth:e,user:t}=n;return Ce(t,e,"internal-error"),cP(t,new Ag(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GT{constructor(e,t,r,s,a=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=a,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:s,tenantId:a,error:u,type:h}=e;if(u){this.reject(u);return}const f={auth:this.auth,requestUri:t,sessionId:r,tenantId:a||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(h)(f))}catch(p){this.reject(p)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return DP;case"linkViaPopup":case"linkViaRedirect":return LP;case"reauthViaPopup":case"reauthViaRedirect":return OP;default:fr(this.auth,"internal-error")}}resolve(e){wi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){wi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MP=new Gu(2e3,1e4);class Sa extends GT{constructor(e,t,r,s,a){super(e,t,s,a),this.provider=r,this.authWindow=null,this.pollId=null,Sa.currentPopupAction&&Sa.currentPopupAction.cancel(),Sa.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Ce(e,this.auth,"internal-error"),e}async onExecution(){wi(this.filter.length===1,"Popup operations only handle one event");const e=Sg();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(br(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(br(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Sa.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,r;if(!((r=(t=this.authWindow)===null||t===void 0?void 0:t.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(br(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,MP.get())};e()}}Sa.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VP="pendingRedirect",Bh=new Map;class FP extends GT{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=Bh.get(this.auth._key());if(!e){try{const r=await jP(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}Bh.set(this.auth._key(),e)}return this.bypassAuthState||Bh.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function jP(n,e){const t=zP(e),r=BP(n);if(!await r._isAvailable())return!1;const s=await r._get(t)==="true";return await r._remove(t),s}function UP(n,e){Bh.set(n._key(),e)}function BP(n){return di(n._redirectPersistence)}function zP(n){return Uh(VP,n.config.apiKey,n.name)}async function $P(n,e,t=!1){if(Dn(n.app))return Promise.reject(mi(n));const r=Eo(n),s=NP(r,e),u=await new FP(r,s,t).execute();return u&&!t&&(delete u.user._redirectEventId,await r._persistUserIfCurrent(u.user),await r._setRedirectUser(null,e)),u}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WP=10*60*1e3;class HP{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!GP(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!qT(e)){const s=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";t.onError(br(this.auth,s))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=WP&&this.cachedEventUids.clear(),this.cachedEventUids.has(Pw(e))}saveEventToCache(e){this.cachedEventUids.add(Pw(e)),this.lastProcessedEventTime=Date.now()}}function Pw(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function qT({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function GP(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return qT(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function qP(n,e={}){return Ss(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KP=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,QP=/^https?/;async function YP(n){if(n.config.emulator)return;const{authorizedDomains:e}=await qP(n);for(const t of e)try{if(JP(t))return}catch{}fr(n,"unauthorized-domain")}function JP(n){const e=Tm(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){const u=new URL(n);return u.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&u.hostname===r}if(!QP.test(t))return!1;if(KP.test(n))return r===n;const s=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XP=new Gu(3e4,6e4);function bw(){const n=Nr().___jsl;if(n?.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function ZP(n){return new Promise((e,t)=>{var r,s,a;function u(){bw(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{bw(),t(br(n,"network-request-failed"))},timeout:XP.get()})}if(!((s=(r=Nr().gapi)===null||r===void 0?void 0:r.iframes)===null||s===void 0)&&s.Iframe)e(gapi.iframes.getContext());else if(!((a=Nr().gapi)===null||a===void 0)&&a.load)u();else{const h=G1("iframefcb");return Nr()[h]=()=>{gapi.load?u():t(br(n,"network-request-failed"))},PT(`${H1()}?onload=${h}`).catch(f=>t(f))}}).catch(e=>{throw zh=null,e})}let zh=null;function eb(n){return zh=zh||ZP(n),zh}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tb=new Gu(5e3,15e3),nb="__/auth/iframe",rb="emulator/auth/iframe",ib={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},sb=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function ob(n){const e=n.config;Ce(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?vg(e,rb):`https://${n.config.authDomain}/${nb}`,r={apiKey:e.apiKey,appName:n.name,v:wo},s=sb.get(n.config.apiHost);s&&(r.eid=s);const a=n._getFrameworks();return a.length&&(r.fw=a.join(",")),`${t}?${Ja(r).slice(1)}`}async function ab(n){const e=await eb(n),t=Nr().gapi;return Ce(t,n,"internal-error"),e.open({where:document.body,url:ob(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:ib,dontclear:!0},r=>new Promise(async(s,a)=>{await r.restyle({setHideOnLeave:!1});const u=br(n,"network-request-failed"),h=Nr().setTimeout(()=>{a(u)},tb.get());function f(){Nr().clearTimeout(h),s(r)}r.ping(f).then(f,()=>{a(u)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lb={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},ub=500,cb=600,hb="_blank",db="http://localhost";class Nw{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function fb(n,e,t,r=ub,s=cb){const a=Math.max((window.screen.availHeight-s)/2,0).toString(),u=Math.max((window.screen.availWidth-r)/2,0).toString();let h="";const f=Object.assign(Object.assign({},lb),{width:r.toString(),height:s.toString(),top:a,left:u}),p=an().toLowerCase();t&&(h=IT(p)?hb:t),ET(p)&&(e=e||db,f.scrollbars="yes");const y=Object.entries(f).reduce((E,[S,R])=>`${E}${S}=${R},`,"");if(M1(p)&&h!=="_self")return pb(e||"",h),new Nw(null);const v=window.open(e||"",h,y);Ce(v,n,"popup-blocked");try{v.focus()}catch{}return new Nw(v)}function pb(n,e){const t=document.createElement("a");t.href=n,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mb="__/auth/handler",gb="emulator/auth/handler",_b=encodeURIComponent("fac");async function Dw(n,e,t,r,s,a){Ce(n.config.authDomain,n,"auth-domain-config-required"),Ce(n.config.apiKey,n,"invalid-api-key");const u={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:wo,eventId:s};if(e instanceof DT){e.setDefaultLanguage(n.languageCode),u.providerId=e.providerId||"",Zh(e.getCustomParameters())||(u.customParameters=JSON.stringify(e.getCustomParameters()));for(const[y,v]of Object.entries({}))u[y]=v}if(e instanceof Ku){const y=e.getScopes().filter(v=>v!=="");y.length>0&&(u.scopes=y.join(","))}n.tenantId&&(u.tid=n.tenantId);const h=u;for(const y of Object.keys(h))h[y]===void 0&&delete h[y];const f=await n._getAppCheckToken(),p=f?`#${_b}=${encodeURIComponent(f)}`:"";return`${yb(n)}?${Ja(h).slice(1)}${p}`}function yb({config:n}){return n.emulator?vg(n,gb):`https://${n.authDomain}/${mb}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nm="webStorageSupport";class vb{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=BT,this._completeRedirectFn=$P,this._overrideRedirectResult=UP}async _openPopup(e,t,r,s){var a;wi((a=this.eventManagers[e._key()])===null||a===void 0?void 0:a.manager,"_initialize() not called before _openPopup()");const u=await Dw(e,t,r,Tm(),s);return fb(e,u,Sg())}async _openRedirect(e,t,r,s){await this._originValidation(e);const a=await Dw(e,t,r,Tm(),s);return TP(a),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:s,promise:a}=this.eventManagers[t];return s?Promise.resolve(s):(wi(a,"If manager is not set, promise should be"),a)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await ab(e),r=new HP(e);return t.register("authEvent",s=>(Ce(s?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(nm,{type:nm},s=>{var a;const u=(a=s?.[0])===null||a===void 0?void 0:a[nm];u!==void 0&&t(!!u),fr(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=YP(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return RT()||TT()||Eg()}}const wb=vb;var Ow="@firebase/auth",Lw="1.10.8";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eb{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Ce(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tb(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function Ib(n){co(new fs("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),a=e.getProvider("app-check-internal"),{apiKey:u,authDomain:h}=r.options;Ce(u&&!u.includes(":"),"invalid-api-key",{appName:r.name});const f={apiKey:u,authDomain:h,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:xT(n)},p=new z1(r,s,a,f);return X1(p,t),p},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),co(new fs("auth-internal",e=>{const t=Eo(e.getProvider("auth").getImmediate());return(r=>new Eb(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Pr(Ow,Lw,Tb(n)),Pr(Ow,Lw,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cb=5*60,Sb=iT("authIdTokenMaxAge")||Cb;let Mw=null;const Ab=n=>async e=>{const t=e&&await e.getIdTokenResult(),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>Sb)return;const s=t?.token;Mw!==s&&(Mw=s,await fetch(n,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function kb(n=gg()){const e=Fd(n,"auth");if(e.isInitialized())return e.getImmediate();const t=J1(n,{popupRedirectResolver:wb,persistence:[bP,vP,BT]}),r=iT("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const a=new URL(r,location.origin);if(location.origin===a.origin){const u=Ab(a.toString());gP(t,u,()=>u(t.currentUser)),mP(t,h=>u(h))}}const s=tT("auth");return s&&Z1(t,`http://${s}`),t}function Rb(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}$1({loadJS(n){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=s=>{const a=br("internal-error");a.customData=s,t(a)},r.type="text/javascript",r.charset="UTF-8",Rb().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});Ib("Browser");/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function xb(n,e,t,r){function s(a){return a instanceof t?a:new t(function(u){u(a)})}return new(t||(t=Promise))(function(a,u){function h(y){try{p(r.next(y))}catch(v){u(v)}}function f(y){try{p(r.throw(y))}catch(v){u(v)}}function p(y){y.done?a(y.value):s(y.value).then(h,f)}p((r=r.apply(n,[])).next())})}function Pb(n,e){var t={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},r,s,a,u;return u={next:h(0),throw:h(1),return:h(2)},typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function h(p){return function(y){return f([p,y])}}function f(p){if(r)throw new TypeError("Generator is already executing.");for(;t;)try{if(r=1,s&&(a=p[0]&2?s.return:p[0]?s.throw||((a=s.return)&&a.call(s),0):s.next)&&!(a=a.call(s,p[1])).done)return a;switch(s=0,a&&(p=[p[0]&2,a.value]),p[0]){case 0:case 1:a=p;break;case 4:return t.label++,{value:p[1],done:!1};case 5:t.label++,s=p[1],p=[0];continue;case 7:p=t.ops.pop(),t.trys.pop();continue;default:if(a=t.trys,!(a=a.length>0&&a[a.length-1])&&(p[0]===6||p[0]===2)){t=0;continue}if(p[0]===3&&(!a||p[1]>a[0]&&p[1]<a[3])){t.label=p[1];break}if(p[0]===6&&t.label<a[1]){t.label=a[1],a=p;break}if(a&&t.label<a[2]){t.label=a[2],t.ops.push(p);break}a[2]&&t.ops.pop(),t.trys.pop();continue}p=e.call(n,t)}catch(y){p=[6,y],s=0}finally{r=a=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Aa=function(){return Aa=Object.assign||function(e){for(var t,r=1,s=arguments.length;r<s;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},Aa.apply(this,arguments)},KT=function(n){return{loading:n==null,value:n}},bb=function(){return function(n,e){switch(e.type){case"error":return Aa(Aa({},n),{error:e.error,loading:!1,value:void 0});case"reset":return KT(e.defaultValue);case"value":return Aa(Aa({},n),{error:void 0,loading:!1,value:e.value});default:return n}}},Nb=function(n){var e=n?n():void 0,t=U.useReducer(bb(),KT(e)),r=t[0],s=t[1],a=U.useCallback(function(){var f=n?n():void 0;s({type:"reset",defaultValue:f})},[n]),u=U.useCallback(function(f){s({type:"error",error:f})},[]),h=U.useCallback(function(f){s({type:"value",value:f})},[]);return U.useMemo(function(){return{error:r.error,loading:r.loading,reset:a,setError:u,setValue:h,value:r.value}},[r.error,r.loading,a,u,h,r.value])},zd=function(n,e){var t=Nb(function(){return n.currentUser}),r=t.error,s=t.loading,a=t.setError,u=t.setValue,h=t.value;return U.useEffect(function(){var f=Cg(n,function(p){return xb(void 0,void 0,void 0,function(){var y;return Pb(this,function(v){switch(v.label){case 0:return[3,4];case 1:return v.trys.push([1,3,,4]),[4,e.onUserChanged(p)];case 2:return v.sent(),[3,4];case 3:return y=v.sent(),a(y),[3,4];case 4:return u(p),[2]}})})},a);return function(){f()}},[n]),[h,s,r]},Db="firebase",Ob="11.10.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Pr(Db,Ob,"app");var Vw=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var as,QT;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(D,A){function k(){}k.prototype=A.prototype,D.D=A.prototype,D.prototype=new k,D.prototype.constructor=D,D.C=function(b,L,j){for(var x=Array(arguments.length-2),De=2;De<arguments.length;De++)x[De-2]=arguments[De];return A.prototype[L].apply(b,x)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(D,A,k){k||(k=0);var b=Array(16);if(typeof A=="string")for(var L=0;16>L;++L)b[L]=A.charCodeAt(k++)|A.charCodeAt(k++)<<8|A.charCodeAt(k++)<<16|A.charCodeAt(k++)<<24;else for(L=0;16>L;++L)b[L]=A[k++]|A[k++]<<8|A[k++]<<16|A[k++]<<24;A=D.g[0],k=D.g[1],L=D.g[2];var j=D.g[3],x=A+(j^k&(L^j))+b[0]+3614090360&4294967295;A=k+(x<<7&4294967295|x>>>25),x=j+(L^A&(k^L))+b[1]+3905402710&4294967295,j=A+(x<<12&4294967295|x>>>20),x=L+(k^j&(A^k))+b[2]+606105819&4294967295,L=j+(x<<17&4294967295|x>>>15),x=k+(A^L&(j^A))+b[3]+3250441966&4294967295,k=L+(x<<22&4294967295|x>>>10),x=A+(j^k&(L^j))+b[4]+4118548399&4294967295,A=k+(x<<7&4294967295|x>>>25),x=j+(L^A&(k^L))+b[5]+1200080426&4294967295,j=A+(x<<12&4294967295|x>>>20),x=L+(k^j&(A^k))+b[6]+2821735955&4294967295,L=j+(x<<17&4294967295|x>>>15),x=k+(A^L&(j^A))+b[7]+4249261313&4294967295,k=L+(x<<22&4294967295|x>>>10),x=A+(j^k&(L^j))+b[8]+1770035416&4294967295,A=k+(x<<7&4294967295|x>>>25),x=j+(L^A&(k^L))+b[9]+2336552879&4294967295,j=A+(x<<12&4294967295|x>>>20),x=L+(k^j&(A^k))+b[10]+4294925233&4294967295,L=j+(x<<17&4294967295|x>>>15),x=k+(A^L&(j^A))+b[11]+2304563134&4294967295,k=L+(x<<22&4294967295|x>>>10),x=A+(j^k&(L^j))+b[12]+1804603682&4294967295,A=k+(x<<7&4294967295|x>>>25),x=j+(L^A&(k^L))+b[13]+4254626195&4294967295,j=A+(x<<12&4294967295|x>>>20),x=L+(k^j&(A^k))+b[14]+2792965006&4294967295,L=j+(x<<17&4294967295|x>>>15),x=k+(A^L&(j^A))+b[15]+1236535329&4294967295,k=L+(x<<22&4294967295|x>>>10),x=A+(L^j&(k^L))+b[1]+4129170786&4294967295,A=k+(x<<5&4294967295|x>>>27),x=j+(k^L&(A^k))+b[6]+3225465664&4294967295,j=A+(x<<9&4294967295|x>>>23),x=L+(A^k&(j^A))+b[11]+643717713&4294967295,L=j+(x<<14&4294967295|x>>>18),x=k+(j^A&(L^j))+b[0]+3921069994&4294967295,k=L+(x<<20&4294967295|x>>>12),x=A+(L^j&(k^L))+b[5]+3593408605&4294967295,A=k+(x<<5&4294967295|x>>>27),x=j+(k^L&(A^k))+b[10]+38016083&4294967295,j=A+(x<<9&4294967295|x>>>23),x=L+(A^k&(j^A))+b[15]+3634488961&4294967295,L=j+(x<<14&4294967295|x>>>18),x=k+(j^A&(L^j))+b[4]+3889429448&4294967295,k=L+(x<<20&4294967295|x>>>12),x=A+(L^j&(k^L))+b[9]+568446438&4294967295,A=k+(x<<5&4294967295|x>>>27),x=j+(k^L&(A^k))+b[14]+3275163606&4294967295,j=A+(x<<9&4294967295|x>>>23),x=L+(A^k&(j^A))+b[3]+4107603335&4294967295,L=j+(x<<14&4294967295|x>>>18),x=k+(j^A&(L^j))+b[8]+1163531501&4294967295,k=L+(x<<20&4294967295|x>>>12),x=A+(L^j&(k^L))+b[13]+2850285829&4294967295,A=k+(x<<5&4294967295|x>>>27),x=j+(k^L&(A^k))+b[2]+4243563512&4294967295,j=A+(x<<9&4294967295|x>>>23),x=L+(A^k&(j^A))+b[7]+1735328473&4294967295,L=j+(x<<14&4294967295|x>>>18),x=k+(j^A&(L^j))+b[12]+2368359562&4294967295,k=L+(x<<20&4294967295|x>>>12),x=A+(k^L^j)+b[5]+4294588738&4294967295,A=k+(x<<4&4294967295|x>>>28),x=j+(A^k^L)+b[8]+2272392833&4294967295,j=A+(x<<11&4294967295|x>>>21),x=L+(j^A^k)+b[11]+1839030562&4294967295,L=j+(x<<16&4294967295|x>>>16),x=k+(L^j^A)+b[14]+4259657740&4294967295,k=L+(x<<23&4294967295|x>>>9),x=A+(k^L^j)+b[1]+2763975236&4294967295,A=k+(x<<4&4294967295|x>>>28),x=j+(A^k^L)+b[4]+1272893353&4294967295,j=A+(x<<11&4294967295|x>>>21),x=L+(j^A^k)+b[7]+4139469664&4294967295,L=j+(x<<16&4294967295|x>>>16),x=k+(L^j^A)+b[10]+3200236656&4294967295,k=L+(x<<23&4294967295|x>>>9),x=A+(k^L^j)+b[13]+681279174&4294967295,A=k+(x<<4&4294967295|x>>>28),x=j+(A^k^L)+b[0]+3936430074&4294967295,j=A+(x<<11&4294967295|x>>>21),x=L+(j^A^k)+b[3]+3572445317&4294967295,L=j+(x<<16&4294967295|x>>>16),x=k+(L^j^A)+b[6]+76029189&4294967295,k=L+(x<<23&4294967295|x>>>9),x=A+(k^L^j)+b[9]+3654602809&4294967295,A=k+(x<<4&4294967295|x>>>28),x=j+(A^k^L)+b[12]+3873151461&4294967295,j=A+(x<<11&4294967295|x>>>21),x=L+(j^A^k)+b[15]+530742520&4294967295,L=j+(x<<16&4294967295|x>>>16),x=k+(L^j^A)+b[2]+3299628645&4294967295,k=L+(x<<23&4294967295|x>>>9),x=A+(L^(k|~j))+b[0]+4096336452&4294967295,A=k+(x<<6&4294967295|x>>>26),x=j+(k^(A|~L))+b[7]+1126891415&4294967295,j=A+(x<<10&4294967295|x>>>22),x=L+(A^(j|~k))+b[14]+2878612391&4294967295,L=j+(x<<15&4294967295|x>>>17),x=k+(j^(L|~A))+b[5]+4237533241&4294967295,k=L+(x<<21&4294967295|x>>>11),x=A+(L^(k|~j))+b[12]+1700485571&4294967295,A=k+(x<<6&4294967295|x>>>26),x=j+(k^(A|~L))+b[3]+2399980690&4294967295,j=A+(x<<10&4294967295|x>>>22),x=L+(A^(j|~k))+b[10]+4293915773&4294967295,L=j+(x<<15&4294967295|x>>>17),x=k+(j^(L|~A))+b[1]+2240044497&4294967295,k=L+(x<<21&4294967295|x>>>11),x=A+(L^(k|~j))+b[8]+1873313359&4294967295,A=k+(x<<6&4294967295|x>>>26),x=j+(k^(A|~L))+b[15]+4264355552&4294967295,j=A+(x<<10&4294967295|x>>>22),x=L+(A^(j|~k))+b[6]+2734768916&4294967295,L=j+(x<<15&4294967295|x>>>17),x=k+(j^(L|~A))+b[13]+1309151649&4294967295,k=L+(x<<21&4294967295|x>>>11),x=A+(L^(k|~j))+b[4]+4149444226&4294967295,A=k+(x<<6&4294967295|x>>>26),x=j+(k^(A|~L))+b[11]+3174756917&4294967295,j=A+(x<<10&4294967295|x>>>22),x=L+(A^(j|~k))+b[2]+718787259&4294967295,L=j+(x<<15&4294967295|x>>>17),x=k+(j^(L|~A))+b[9]+3951481745&4294967295,D.g[0]=D.g[0]+A&4294967295,D.g[1]=D.g[1]+(L+(x<<21&4294967295|x>>>11))&4294967295,D.g[2]=D.g[2]+L&4294967295,D.g[3]=D.g[3]+j&4294967295}r.prototype.u=function(D,A){A===void 0&&(A=D.length);for(var k=A-this.blockSize,b=this.B,L=this.h,j=0;j<A;){if(L==0)for(;j<=k;)s(this,D,j),j+=this.blockSize;if(typeof D=="string"){for(;j<A;)if(b[L++]=D.charCodeAt(j++),L==this.blockSize){s(this,b),L=0;break}}else for(;j<A;)if(b[L++]=D[j++],L==this.blockSize){s(this,b),L=0;break}}this.h=L,this.o+=A},r.prototype.v=function(){var D=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);D[0]=128;for(var A=1;A<D.length-8;++A)D[A]=0;var k=8*this.o;for(A=D.length-8;A<D.length;++A)D[A]=k&255,k/=256;for(this.u(D),D=Array(16),A=k=0;4>A;++A)for(var b=0;32>b;b+=8)D[k++]=this.g[A]>>>b&255;return D};function a(D,A){var k=h;return Object.prototype.hasOwnProperty.call(k,D)?k[D]:k[D]=A(D)}function u(D,A){this.h=A;for(var k=[],b=!0,L=D.length-1;0<=L;L--){var j=D[L]|0;b&&j==A||(k[L]=j,b=!1)}this.g=k}var h={};function f(D){return-128<=D&&128>D?a(D,function(A){return new u([A|0],0>A?-1:0)}):new u([D|0],0>D?-1:0)}function p(D){if(isNaN(D)||!isFinite(D))return v;if(0>D)return O(p(-D));for(var A=[],k=1,b=0;D>=k;b++)A[b]=D/k|0,k*=4294967296;return new u(A,0)}function y(D,A){if(D.length==0)throw Error("number format error: empty string");if(A=A||10,2>A||36<A)throw Error("radix out of range: "+A);if(D.charAt(0)=="-")return O(y(D.substring(1),A));if(0<=D.indexOf("-"))throw Error('number format error: interior "-" character');for(var k=p(Math.pow(A,8)),b=v,L=0;L<D.length;L+=8){var j=Math.min(8,D.length-L),x=parseInt(D.substring(L,L+j),A);8>j?(j=p(Math.pow(A,j)),b=b.j(j).add(p(x))):(b=b.j(k),b=b.add(p(x)))}return b}var v=f(0),E=f(1),S=f(16777216);n=u.prototype,n.m=function(){if(N(this))return-O(this).m();for(var D=0,A=1,k=0;k<this.g.length;k++){var b=this.i(k);D+=(0<=b?b:4294967296+b)*A,A*=4294967296}return D},n.toString=function(D){if(D=D||10,2>D||36<D)throw Error("radix out of range: "+D);if(R(this))return"0";if(N(this))return"-"+O(this).toString(D);for(var A=p(Math.pow(D,6)),k=this,b="";;){var L=J(k,A).g;k=V(k,L.j(A));var j=((0<k.g.length?k.g[0]:k.h)>>>0).toString(D);if(k=L,R(k))return j+b;for(;6>j.length;)j="0"+j;b=j+b}},n.i=function(D){return 0>D?0:D<this.g.length?this.g[D]:this.h};function R(D){if(D.h!=0)return!1;for(var A=0;A<D.g.length;A++)if(D.g[A]!=0)return!1;return!0}function N(D){return D.h==-1}n.l=function(D){return D=V(this,D),N(D)?-1:R(D)?0:1};function O(D){for(var A=D.g.length,k=[],b=0;b<A;b++)k[b]=~D.g[b];return new u(k,~D.h).add(E)}n.abs=function(){return N(this)?O(this):this},n.add=function(D){for(var A=Math.max(this.g.length,D.g.length),k=[],b=0,L=0;L<=A;L++){var j=b+(this.i(L)&65535)+(D.i(L)&65535),x=(j>>>16)+(this.i(L)>>>16)+(D.i(L)>>>16);b=x>>>16,j&=65535,x&=65535,k[L]=x<<16|j}return new u(k,k[k.length-1]&-2147483648?-1:0)};function V(D,A){return D.add(O(A))}n.j=function(D){if(R(this)||R(D))return v;if(N(this))return N(D)?O(this).j(O(D)):O(O(this).j(D));if(N(D))return O(this.j(O(D)));if(0>this.l(S)&&0>D.l(S))return p(this.m()*D.m());for(var A=this.g.length+D.g.length,k=[],b=0;b<2*A;b++)k[b]=0;for(b=0;b<this.g.length;b++)for(var L=0;L<D.g.length;L++){var j=this.i(b)>>>16,x=this.i(b)&65535,De=D.i(L)>>>16,Ke=D.i(L)&65535;k[2*b+2*L]+=x*Ke,K(k,2*b+2*L),k[2*b+2*L+1]+=j*Ke,K(k,2*b+2*L+1),k[2*b+2*L+1]+=x*De,K(k,2*b+2*L+1),k[2*b+2*L+2]+=j*De,K(k,2*b+2*L+2)}for(b=0;b<A;b++)k[b]=k[2*b+1]<<16|k[2*b];for(b=A;b<2*A;b++)k[b]=0;return new u(k,0)};function K(D,A){for(;(D[A]&65535)!=D[A];)D[A+1]+=D[A]>>>16,D[A]&=65535,A++}function G(D,A){this.g=D,this.h=A}function J(D,A){if(R(A))throw Error("division by zero");if(R(D))return new G(v,v);if(N(D))return A=J(O(D),A),new G(O(A.g),O(A.h));if(N(A))return A=J(D,O(A)),new G(O(A.g),A.h);if(30<D.g.length){if(N(D)||N(A))throw Error("slowDivide_ only works with positive integers.");for(var k=E,b=A;0>=b.l(D);)k=ne(k),b=ne(b);var L=se(k,1),j=se(b,1);for(b=se(b,2),k=se(k,2);!R(b);){var x=j.add(b);0>=x.l(D)&&(L=L.add(k),j=x),b=se(b,1),k=se(k,1)}return A=V(D,L.j(A)),new G(L,A)}for(L=v;0<=D.l(A);){for(k=Math.max(1,Math.floor(D.m()/A.m())),b=Math.ceil(Math.log(k)/Math.LN2),b=48>=b?1:Math.pow(2,b-48),j=p(k),x=j.j(A);N(x)||0<x.l(D);)k-=b,j=p(k),x=j.j(A);R(j)&&(j=E),L=L.add(j),D=V(D,x)}return new G(L,D)}n.A=function(D){return J(this,D).h},n.and=function(D){for(var A=Math.max(this.g.length,D.g.length),k=[],b=0;b<A;b++)k[b]=this.i(b)&D.i(b);return new u(k,this.h&D.h)},n.or=function(D){for(var A=Math.max(this.g.length,D.g.length),k=[],b=0;b<A;b++)k[b]=this.i(b)|D.i(b);return new u(k,this.h|D.h)},n.xor=function(D){for(var A=Math.max(this.g.length,D.g.length),k=[],b=0;b<A;b++)k[b]=this.i(b)^D.i(b);return new u(k,this.h^D.h)};function ne(D){for(var A=D.g.length+1,k=[],b=0;b<A;b++)k[b]=D.i(b)<<1|D.i(b-1)>>>31;return new u(k,D.h)}function se(D,A){var k=A>>5;A%=32;for(var b=D.g.length-k,L=[],j=0;j<b;j++)L[j]=0<A?D.i(j+k)>>>A|D.i(j+k+1)<<32-A:D.i(j+k);return new u(L,D.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,QT=r,u.prototype.add=u.prototype.add,u.prototype.multiply=u.prototype.j,u.prototype.modulo=u.prototype.A,u.prototype.compare=u.prototype.l,u.prototype.toNumber=u.prototype.m,u.prototype.toString=u.prototype.toString,u.prototype.getBits=u.prototype.i,u.fromNumber=p,u.fromString=y,as=u}).apply(typeof Vw<"u"?Vw:typeof self<"u"?self:typeof window<"u"?window:{});var Ph=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var YT,du,JT,$h,Am,XT,ZT,eI;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(c,g,w){return c==Array.prototype||c==Object.prototype||(c[g]=w.value),c};function t(c){c=[typeof globalThis=="object"&&globalThis,c,typeof window=="object"&&window,typeof self=="object"&&self,typeof Ph=="object"&&Ph];for(var g=0;g<c.length;++g){var w=c[g];if(w&&w.Math==Math)return w}throw Error("Cannot find global object")}var r=t(this);function s(c,g){if(g)e:{var w=r;c=c.split(".");for(var C=0;C<c.length-1;C++){var z=c[C];if(!(z in w))break e;w=w[z]}c=c[c.length-1],C=w[c],g=g(C),g!=C&&g!=null&&e(w,c,{configurable:!0,writable:!0,value:g})}}function a(c,g){c instanceof String&&(c+="");var w=0,C=!1,z={next:function(){if(!C&&w<c.length){var q=w++;return{value:g(q,c[q]),done:!1}}return C=!0,{done:!0,value:void 0}}};return z[Symbol.iterator]=function(){return z},z}s("Array.prototype.values",function(c){return c||function(){return a(this,function(g,w){return w})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var u=u||{},h=this||self;function f(c){var g=typeof c;return g=g!="object"?g:c?Array.isArray(c)?"array":g:"null",g=="array"||g=="object"&&typeof c.length=="number"}function p(c){var g=typeof c;return g=="object"&&c!=null||g=="function"}function y(c,g,w){return c.call.apply(c.bind,arguments)}function v(c,g,w){if(!c)throw Error();if(2<arguments.length){var C=Array.prototype.slice.call(arguments,2);return function(){var z=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(z,C),c.apply(g,z)}}return function(){return c.apply(g,arguments)}}function E(c,g,w){return E=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?y:v,E.apply(null,arguments)}function S(c,g){var w=Array.prototype.slice.call(arguments,1);return function(){var C=w.slice();return C.push.apply(C,arguments),c.apply(this,C)}}function R(c,g){function w(){}w.prototype=g.prototype,c.aa=g.prototype,c.prototype=new w,c.prototype.constructor=c,c.Qb=function(C,z,q){for(var oe=Array(arguments.length-2),Ye=2;Ye<arguments.length;Ye++)oe[Ye-2]=arguments[Ye];return g.prototype[z].apply(C,oe)}}function N(c){const g=c.length;if(0<g){const w=Array(g);for(let C=0;C<g;C++)w[C]=c[C];return w}return[]}function O(c,g){for(let w=1;w<arguments.length;w++){const C=arguments[w];if(f(C)){const z=c.length||0,q=C.length||0;c.length=z+q;for(let oe=0;oe<q;oe++)c[z+oe]=C[oe]}else c.push(C)}}class V{constructor(g,w){this.i=g,this.j=w,this.h=0,this.g=null}get(){let g;return 0<this.h?(this.h--,g=this.g,this.g=g.next,g.next=null):g=this.i(),g}}function K(c){return/^[\s\xa0]*$/.test(c)}function G(){var c=h.navigator;return c&&(c=c.userAgent)?c:""}function J(c){return J[" "](c),c}J[" "]=function(){};var ne=G().indexOf("Gecko")!=-1&&!(G().toLowerCase().indexOf("webkit")!=-1&&G().indexOf("Edge")==-1)&&!(G().indexOf("Trident")!=-1||G().indexOf("MSIE")!=-1)&&G().indexOf("Edge")==-1;function se(c,g,w){for(const C in c)g.call(w,c[C],C,c)}function D(c,g){for(const w in c)g.call(void 0,c[w],w,c)}function A(c){const g={};for(const w in c)g[w]=c[w];return g}const k="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function b(c,g){let w,C;for(let z=1;z<arguments.length;z++){C=arguments[z];for(w in C)c[w]=C[w];for(let q=0;q<k.length;q++)w=k[q],Object.prototype.hasOwnProperty.call(C,w)&&(c[w]=C[w])}}function L(c){var g=1;c=c.split(":");const w=[];for(;0<g&&c.length;)w.push(c.shift()),g--;return c.length&&w.push(c.join(":")),w}function j(c){h.setTimeout(()=>{throw c},0)}function x(){var c=ce;let g=null;return c.g&&(g=c.g,c.g=c.g.next,c.g||(c.h=null),g.next=null),g}class De{constructor(){this.h=this.g=null}add(g,w){const C=Ke.get();C.set(g,w),this.h?this.h.next=C:this.g=C,this.h=C}}var Ke=new V(()=>new Oe,c=>c.reset());class Oe{constructor(){this.next=this.g=this.h=null}set(g,w){this.h=g,this.g=w,this.next=null}reset(){this.next=this.g=this.h=null}}let xe,ie=!1,ce=new De,ae=()=>{const c=h.Promise.resolve(void 0);xe=()=>{c.then(B)}};var B=()=>{for(var c;c=x();){try{c.h.call(c.g)}catch(w){j(w)}var g=Ke;g.j(c),100>g.h&&(g.h++,c.next=g.g,g.g=c)}ie=!1};function Q(){this.s=this.s,this.C=this.C}Q.prototype.s=!1,Q.prototype.ma=function(){this.s||(this.s=!0,this.N())},Q.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function fe(c,g){this.type=c,this.g=this.target=g,this.defaultPrevented=!1}fe.prototype.h=function(){this.defaultPrevented=!0};var ke=function(){if(!h.addEventListener||!Object.defineProperty)return!1;var c=!1,g=Object.defineProperty({},"passive",{get:function(){c=!0}});try{const w=()=>{};h.addEventListener("test",w,g),h.removeEventListener("test",w,g)}catch{}return c}();function Te(c,g){if(fe.call(this,c?c.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,c){var w=this.type=c.type,C=c.changedTouches&&c.changedTouches.length?c.changedTouches[0]:null;if(this.target=c.target||c.srcElement,this.g=g,g=c.relatedTarget){if(ne){e:{try{J(g.nodeName);var z=!0;break e}catch{}z=!1}z||(g=null)}}else w=="mouseover"?g=c.fromElement:w=="mouseout"&&(g=c.toElement);this.relatedTarget=g,C?(this.clientX=C.clientX!==void 0?C.clientX:C.pageX,this.clientY=C.clientY!==void 0?C.clientY:C.pageY,this.screenX=C.screenX||0,this.screenY=C.screenY||0):(this.clientX=c.clientX!==void 0?c.clientX:c.pageX,this.clientY=c.clientY!==void 0?c.clientY:c.pageY,this.screenX=c.screenX||0,this.screenY=c.screenY||0),this.button=c.button,this.key=c.key||"",this.ctrlKey=c.ctrlKey,this.altKey=c.altKey,this.shiftKey=c.shiftKey,this.metaKey=c.metaKey,this.pointerId=c.pointerId||0,this.pointerType=typeof c.pointerType=="string"?c.pointerType:Fe[c.pointerType]||"",this.state=c.state,this.i=c,c.defaultPrevented&&Te.aa.h.call(this)}}R(Te,fe);var Fe={2:"touch",3:"pen",4:"mouse"};Te.prototype.h=function(){Te.aa.h.call(this);var c=this.i;c.preventDefault?c.preventDefault():c.returnValue=!1};var Ge="closure_listenable_"+(1e6*Math.random()|0),qe=0;function nt(c,g,w,C,z){this.listener=c,this.proxy=null,this.src=g,this.type=w,this.capture=!!C,this.ha=z,this.key=++qe,this.da=this.fa=!1}function Mt(c){c.da=!0,c.listener=null,c.proxy=null,c.src=null,c.ha=null}function $r(c){this.src=c,this.g={},this.h=0}$r.prototype.add=function(c,g,w,C,z){var q=c.toString();c=this.g[q],c||(c=this.g[q]=[],this.h++);var oe=ki(c,g,C,z);return-1<oe?(g=c[oe],w||(g.fa=!1)):(g=new nt(g,this.src,q,!!C,z),g.fa=w,c.push(g)),g};function Ro(c,g){var w=g.type;if(w in c.g){var C=c.g[w],z=Array.prototype.indexOf.call(C,g,void 0),q;(q=0<=z)&&Array.prototype.splice.call(C,z,1),q&&(Mt(g),c.g[w].length==0&&(delete c.g[w],c.h--))}}function ki(c,g,w,C){for(var z=0;z<c.length;++z){var q=c[z];if(!q.da&&q.listener==g&&q.capture==!!w&&q.ha==C)return z}return-1}var Rs="closure_lm_"+(1e6*Math.random()|0),xo={};function ul(c,g,w,C,z){if(Array.isArray(g)){for(var q=0;q<g.length;q++)ul(c,g[q],w,C,z);return null}return w=dl(w),c&&c[Ge]?c.K(g,w,p(C)?!!C.capture:!1,z):cl(c,g,w,!1,C,z)}function cl(c,g,w,C,z,q){if(!g)throw Error("Invalid event type");var oe=p(z)?!!z.capture:!!z,Ye=bo(c);if(Ye||(c[Rs]=Ye=new $r(c)),w=Ye.add(g,w,C,oe,q),w.proxy)return w;if(C=dc(),w.proxy=C,C.src=c,C.listener=w,c.addEventListener)ke||(z=oe),z===void 0&&(z=!1),c.addEventListener(g.toString(),C,z);else if(c.attachEvent)c.attachEvent(Hr(g.toString()),C);else if(c.addListener&&c.removeListener)c.addListener(C);else throw Error("addEventListener and attachEvent are unavailable.");return w}function dc(){function c(w){return g.call(c.src,c.listener,w)}const g=hl;return c}function Po(c,g,w,C,z){if(Array.isArray(g))for(var q=0;q<g.length;q++)Po(c,g[q],w,C,z);else C=p(C)?!!C.capture:!!C,w=dl(w),c&&c[Ge]?(c=c.i,g=String(g).toString(),g in c.g&&(q=c.g[g],w=ki(q,w,C,z),-1<w&&(Mt(q[w]),Array.prototype.splice.call(q,w,1),q.length==0&&(delete c.g[g],c.h--)))):c&&(c=bo(c))&&(g=c.g[g.toString()],c=-1,g&&(c=ki(g,w,C,z)),(w=-1<c?g[c]:null)&&Wr(w))}function Wr(c){if(typeof c!="number"&&c&&!c.da){var g=c.src;if(g&&g[Ge])Ro(g.i,c);else{var w=c.type,C=c.proxy;g.removeEventListener?g.removeEventListener(w,C,c.capture):g.detachEvent?g.detachEvent(Hr(w),C):g.addListener&&g.removeListener&&g.removeListener(C),(w=bo(g))?(Ro(w,c),w.h==0&&(w.src=null,g[Rs]=null)):Mt(c)}}}function Hr(c){return c in xo?xo[c]:xo[c]="on"+c}function hl(c,g){if(c.da)c=!0;else{g=new Te(g,this);var w=c.listener,C=c.ha||c.src;c.fa&&Wr(c),c=w.call(C,g)}return c}function bo(c){return c=c[Rs],c instanceof $r?c:null}var No="__closure_events_fn_"+(1e9*Math.random()>>>0);function dl(c){return typeof c=="function"?c:(c[No]||(c[No]=function(g){return c.handleEvent(g)}),c[No])}function Pt(){Q.call(this),this.i=new $r(this),this.M=this,this.F=null}R(Pt,Q),Pt.prototype[Ge]=!0,Pt.prototype.removeEventListener=function(c,g,w,C){Po(this,c,g,w,C)};function bt(c,g){var w,C=c.F;if(C)for(w=[];C;C=C.F)w.push(C);if(c=c.M,C=g.type||g,typeof g=="string")g=new fe(g,c);else if(g instanceof fe)g.target=g.target||c;else{var z=g;g=new fe(C,c),b(g,z)}if(z=!0,w)for(var q=w.length-1;0<=q;q--){var oe=g.g=w[q];z=Gr(oe,C,!0,g)&&z}if(oe=g.g=c,z=Gr(oe,C,!0,g)&&z,z=Gr(oe,C,!1,g)&&z,w)for(q=0;q<w.length;q++)oe=g.g=w[q],z=Gr(oe,C,!1,g)&&z}Pt.prototype.N=function(){if(Pt.aa.N.call(this),this.i){var c=this.i,g;for(g in c.g){for(var w=c.g[g],C=0;C<w.length;C++)Mt(w[C]);delete c.g[g],c.h--}}this.F=null},Pt.prototype.K=function(c,g,w,C){return this.i.add(String(c),g,!1,w,C)},Pt.prototype.L=function(c,g,w,C){return this.i.add(String(c),g,!0,w,C)};function Gr(c,g,w,C){if(g=c.i.g[String(g)],!g)return!0;g=g.concat();for(var z=!0,q=0;q<g.length;++q){var oe=g[q];if(oe&&!oe.da&&oe.capture==w){var Ye=oe.listener,Nt=oe.ha||oe.src;oe.fa&&Ro(c.i,oe),z=Ye.call(Nt,C)!==!1&&z}}return z&&!C.defaultPrevented}function fl(c,g,w){if(typeof c=="function")w&&(c=E(c,w));else if(c&&typeof c.handleEvent=="function")c=E(c.handleEvent,c);else throw Error("Invalid listener argument");return 2147483647<Number(g)?-1:h.setTimeout(c,g||0)}function Ri(c){c.g=fl(()=>{c.g=null,c.i&&(c.i=!1,Ri(c))},c.l);const g=c.h;c.h=null,c.m.apply(null,g)}class xs extends Q{constructor(g,w){super(),this.m=g,this.l=w,this.h=null,this.i=!1,this.g=null}j(g){this.h=arguments,this.g?this.i=!0:Ri(this)}N(){super.N(),this.g&&(h.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ps(c){Q.call(this),this.h=c,this.g={}}R(Ps,Q);var pl=[];function ml(c){se(c.g,function(g,w){this.g.hasOwnProperty(w)&&Wr(g)},c),c.g={}}Ps.prototype.N=function(){Ps.aa.N.call(this),ml(this)},Ps.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var gl=h.JSON.stringify,_l=h.JSON.parse,yl=class{stringify(c){return h.JSON.stringify(c,void 0)}parse(c){return h.JSON.parse(c,void 0)}};function bs(){}bs.prototype.h=null;function Do(c){return c.h||(c.h=c.i())}function Oo(){}var Vn={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function gr(){fe.call(this,"d")}R(gr,fe);function Lo(){fe.call(this,"c")}R(Lo,fe);var _r={},vl=null;function Ns(){return vl=vl||new Pt}_r.La="serverreachability";function wl(c){fe.call(this,_r.La,c)}R(wl,fe);function qr(c){const g=Ns();bt(g,new wl(g))}_r.STAT_EVENT="statevent";function El(c,g){fe.call(this,_r.STAT_EVENT,c),this.stat=g}R(El,fe);function _t(c){const g=Ns();bt(g,new El(g,c))}_r.Ma="timingevent";function Mo(c,g){fe.call(this,_r.Ma,c),this.size=g}R(Mo,fe);function Qn(c,g){if(typeof c!="function")throw Error("Fn must not be null and must be a function");return h.setTimeout(function(){c()},g)}function Ds(){this.g=!0}Ds.prototype.xa=function(){this.g=!1};function Os(c,g,w,C,z,q){c.info(function(){if(c.g)if(q)for(var oe="",Ye=q.split("&"),Nt=0;Nt<Ye.length;Nt++){var je=Ye[Nt].split("=");if(1<je.length){var Vt=je[0];je=je[1];var Tt=Vt.split("_");oe=2<=Tt.length&&Tt[1]=="type"?oe+(Vt+"="+je+"&"):oe+(Vt+"=redacted&")}}else oe=null;else oe=q;return"XMLHTTP REQ ("+C+") [attempt "+z+"]: "+g+`
`+w+`
`+oe})}function Vo(c,g,w,C,z,q,oe){c.info(function(){return"XMLHTTP RESP ("+C+") [ attempt "+z+"]: "+g+`
`+w+`
`+q+" "+oe})}function Yn(c,g,w,C){c.info(function(){return"XMLHTTP TEXT ("+g+"): "+_f(c,w)+(C?" "+C:"")})}function Tl(c,g){c.info(function(){return"TIMEOUT: "+g})}Ds.prototype.info=function(){};function _f(c,g){if(!c.g)return g;if(!g)return null;try{var w=JSON.parse(g);if(w){for(c=0;c<w.length;c++)if(Array.isArray(w[c])){var C=w[c];if(!(2>C.length)){var z=C[1];if(Array.isArray(z)&&!(1>z.length)){var q=z[0];if(q!="noop"&&q!="stop"&&q!="close")for(var oe=1;oe<z.length;oe++)z[oe]=""}}}}return gl(w)}catch{return g}}var Fo={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},fc={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Jn;function Ls(){}R(Ls,bs),Ls.prototype.g=function(){return new XMLHttpRequest},Ls.prototype.i=function(){return{}},Jn=new Ls;function Xn(c,g,w,C){this.j=c,this.i=g,this.l=w,this.R=C||1,this.U=new Ps(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new pc}function pc(){this.i=null,this.g="",this.h=!1}var Il={},jo={};function Uo(c,g,w){c.L=1,c.v=Di(kn(g)),c.m=w,c.P=!0,Cl(c,null)}function Cl(c,g){c.F=Date.now(),rt(c),c.A=kn(c.v);var w=c.A,C=c.R;Array.isArray(C)||(C=[String(C)]),Li(w.i,"t",C),c.C=0,w=c.j.J,c.h=new pc,c.g=Nc(c.j,w?g:null,!c.m),0<c.O&&(c.M=new xs(E(c.Y,c,c.g),c.O)),g=c.U,w=c.g,C=c.ca;var z="readystatechange";Array.isArray(z)||(z&&(pl[0]=z.toString()),z=pl);for(var q=0;q<z.length;q++){var oe=ul(w,z[q],C||g.handleEvent,!1,g.h||g);if(!oe)break;g.g[oe.key]=oe}g=c.H?A(c.H):{},c.m?(c.u||(c.u="POST"),g["Content-Type"]="application/x-www-form-urlencoded",c.g.ea(c.A,c.u,c.m,g)):(c.u="GET",c.g.ea(c.A,c.u,null,g)),qr(),Os(c.i,c.u,c.A,c.l,c.R,c.m)}Xn.prototype.ca=function(c){c=c.target;const g=this.M;g&&pn(c)==3?g.j():this.Y(c)},Xn.prototype.Y=function(c){try{if(c==this.g)e:{const Tt=pn(this.g);var g=this.g.Ba();const Un=this.g.Z();if(!(3>Tt)&&(Tt!=3||this.g&&(this.h.h||this.g.oa()||Pl(this.g)))){this.J||Tt!=4||g==7||(g==8||0>=Un?qr(3):qr(2)),Ms(this);var w=this.g.Z();this.X=w;t:if(mc(this)){var C=Pl(this.g);c="";var z=C.length,q=pn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Fn(this),xi(this);var oe="";break t}this.h.i=new h.TextDecoder}for(g=0;g<z;g++)this.h.h=!0,c+=this.h.i.decode(C[g],{stream:!(q&&g==z-1)});C.length=0,this.h.g+=c,this.C=0,oe=this.h.g}else oe=this.g.oa();if(this.o=w==200,Vo(this.i,this.u,this.A,this.l,this.R,Tt,w),this.o){if(this.T&&!this.K){t:{if(this.g){var Ye,Nt=this.g;if((Ye=Nt.g?Nt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!K(Ye)){var je=Ye;break t}}je=null}if(w=je)Yn(this.i,this.l,w,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Sl(this,w);else{this.o=!1,this.s=3,_t(12),Fn(this),xi(this);break e}}if(this.P){w=!0;let xn;for(;!this.J&&this.C<oe.length;)if(xn=yf(this,oe),xn==jo){Tt==4&&(this.s=4,_t(14),w=!1),Yn(this.i,this.l,null,"[Incomplete Response]");break}else if(xn==Il){this.s=4,_t(15),Yn(this.i,this.l,oe,"[Invalid Chunk]"),w=!1;break}else Yn(this.i,this.l,xn,null),Sl(this,xn);if(mc(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Tt!=4||oe.length!=0||this.h.h||(this.s=1,_t(16),w=!1),this.o=this.o&&w,!w)Yn(this.i,this.l,oe,"[Invalid Chunked Response]"),Fn(this),xi(this);else if(0<oe.length&&!this.W){this.W=!0;var Vt=this.j;Vt.g==this&&Vt.ba&&!Vt.M&&(Vt.j.info("Great, no buffering proxy detected. Bytes received: "+oe.length),Nl(Vt),Vt.M=!0,_t(11))}}else Yn(this.i,this.l,oe,null),Sl(this,oe);Tt==4&&Fn(this),this.o&&!this.J&&(Tt==4?Jo(this.j,this):(this.o=!1,rt(this)))}else Go(this.g),w==400&&0<oe.indexOf("Unknown SID")?(this.s=3,_t(12)):(this.s=0,_t(13)),Fn(this),xi(this)}}}catch{}finally{}};function mc(c){return c.g?c.u=="GET"&&c.L!=2&&c.j.Ca:!1}function yf(c,g){var w=c.C,C=g.indexOf(`
`,w);return C==-1?jo:(w=Number(g.substring(w,C)),isNaN(w)?Il:(C+=1,C+w>g.length?jo:(g=g.slice(C,C+w),c.C=C+w,g)))}Xn.prototype.cancel=function(){this.J=!0,Fn(this)};function rt(c){c.S=Date.now()+c.I,gc(c,c.I)}function gc(c,g){if(c.B!=null)throw Error("WatchDog timer not null");c.B=Qn(E(c.ba,c),g)}function Ms(c){c.B&&(h.clearTimeout(c.B),c.B=null)}Xn.prototype.ba=function(){this.B=null;const c=Date.now();0<=c-this.S?(Tl(this.i,this.A),this.L!=2&&(qr(),_t(17)),Fn(this),this.s=2,xi(this)):gc(this,this.S-c)};function xi(c){c.j.G==0||c.J||Jo(c.j,c)}function Fn(c){Ms(c);var g=c.M;g&&typeof g.ma=="function"&&g.ma(),c.M=null,ml(c.U),c.g&&(g=c.g,c.g=null,g.abort(),g.ma())}function Sl(c,g){try{var w=c.j;if(w.G!=0&&(w.g==c||ln(w.h,c))){if(!c.K&&ln(w.h,c)&&w.G==3){try{var C=w.Da.g.parse(g)}catch{C=null}if(Array.isArray(C)&&C.length==3){var z=C;if(z[0]==0){e:if(!w.u){if(w.g)if(w.g.F+3e3<c.F)Yo(w),rr(w);else break e;Qo(w),_t(18)}}else w.za=z[1],0<w.za-w.T&&37500>z[2]&&w.F&&w.v==0&&!w.C&&(w.C=Qn(E(w.Za,w),6e3));if(1>=yc(w.h)&&w.ca){try{w.ca()}catch{}w.ca=void 0}}else Xr(w,11)}else if((c.K||w.g==c)&&Yo(w),!K(g))for(z=w.Da.g.parse(g),g=0;g<z.length;g++){let je=z[g];if(w.T=je[0],je=je[1],w.G==2)if(je[0]=="c"){w.K=je[1],w.ia=je[2];const Vt=je[3];Vt!=null&&(w.la=Vt,w.j.info("VER="+w.la));const Tt=je[4];Tt!=null&&(w.Aa=Tt,w.j.info("SVER="+w.Aa));const Un=je[5];Un!=null&&typeof Un=="number"&&0<Un&&(C=1.5*Un,w.L=C,w.j.info("backChannelRequestTimeoutMs_="+C)),C=w;const xn=c.g;if(xn){const $s=xn.g?xn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if($s){var q=C.h;q.g||$s.indexOf("spdy")==-1&&$s.indexOf("quic")==-1&&$s.indexOf("h2")==-1||(q.j=q.l,q.g=new Set,q.h&&(Al(q,q.h),q.h=null))}if(C.D){const Zo=xn.g?xn.g.getResponseHeader("X-HTTP-Session-Id"):null;Zo&&(C.ya=Zo,et(C.I,C.D,Zo))}}w.G=3,w.l&&w.l.ua(),w.ba&&(w.R=Date.now()-c.F,w.j.info("Handshake RTT: "+w.R+"ms")),C=w;var oe=c;if(C.qa=bc(C,C.J?C.ia:null,C.W),oe.K){vc(C.h,oe);var Ye=oe,Nt=C.L;Nt&&(Ye.I=Nt),Ye.B&&(Ms(Ye),rt(Ye)),C.g=oe}else zs(C);0<w.i.length&&Er(w)}else je[0]!="stop"&&je[0]!="close"||Xr(w,7);else w.G==3&&(je[0]=="stop"||je[0]=="close"?je[0]=="stop"?Xr(w,7):Gt(w):je[0]!="noop"&&w.l&&w.l.ta(je),w.v=0)}}qr(4)}catch{}}var _c=class{constructor(c,g){this.g=c,this.map=g}};function Vs(c){this.l=c||10,h.PerformanceNavigationTiming?(c=h.performance.getEntriesByType("navigation"),c=0<c.length&&(c[0].nextHopProtocol=="hq"||c[0].nextHopProtocol=="h2")):c=!!(h.chrome&&h.chrome.loadTimes&&h.chrome.loadTimes()&&h.chrome.loadTimes().wasFetchedViaSpdy),this.j=c?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function An(c){return c.h?!0:c.g?c.g.size>=c.j:!1}function yc(c){return c.h?1:c.g?c.g.size:0}function ln(c,g){return c.h?c.h==g:c.g?c.g.has(g):!1}function Al(c,g){c.g?c.g.add(g):c.h=g}function vc(c,g){c.h&&c.h==g?c.h=null:c.g&&c.g.has(g)&&c.g.delete(g)}Vs.prototype.cancel=function(){if(this.i=wc(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const c of this.g.values())c.cancel();this.g.clear()}};function wc(c){if(c.h!=null)return c.i.concat(c.h.D);if(c.g!=null&&c.g.size!==0){let g=c.i;for(const w of c.g.values())g=g.concat(w.D);return g}return N(c.i)}function Bo(c){if(c.V&&typeof c.V=="function")return c.V();if(typeof Map<"u"&&c instanceof Map||typeof Set<"u"&&c instanceof Set)return Array.from(c.values());if(typeof c=="string")return c.split("");if(f(c)){for(var g=[],w=c.length,C=0;C<w;C++)g.push(c[C]);return g}g=[],w=0;for(C in c)g[w++]=c[C];return g}function zo(c){if(c.na&&typeof c.na=="function")return c.na();if(!c.V||typeof c.V!="function"){if(typeof Map<"u"&&c instanceof Map)return Array.from(c.keys());if(!(typeof Set<"u"&&c instanceof Set)){if(f(c)||typeof c=="string"){var g=[];c=c.length;for(var w=0;w<c;w++)g.push(w);return g}g=[],w=0;for(const C in c)g[w++]=C;return g}}}function Pi(c,g){if(c.forEach&&typeof c.forEach=="function")c.forEach(g,void 0);else if(f(c)||typeof c=="string")Array.prototype.forEach.call(c,g,void 0);else for(var w=zo(c),C=Bo(c),z=C.length,q=0;q<z;q++)g.call(void 0,C[q],w&&w[q],c)}var Fs=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function vf(c,g){if(c){c=c.split("&");for(var w=0;w<c.length;w++){var C=c[w].indexOf("="),z=null;if(0<=C){var q=c[w].substring(0,C);z=c[w].substring(C+1)}else q=c[w];g(q,z?decodeURIComponent(z.replace(/\+/g," ")):"")}}}function Kr(c){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,c instanceof Kr){this.h=c.h,js(this,c.j),this.o=c.o,this.g=c.g,bi(this,c.s),this.l=c.l;var g=c.i,w=new yr;w.i=g.i,g.g&&(w.g=new Map(g.g),w.h=g.h),Ni(this,w),this.m=c.m}else c&&(g=String(c).match(Fs))?(this.h=!1,js(this,g[1]||"",!0),this.o=Ve(g[2]||""),this.g=Ve(g[3]||"",!0),bi(this,g[4]),this.l=Ve(g[5]||"",!0),Ni(this,g[6]||"",!0),this.m=Ve(g[7]||"")):(this.h=!1,this.i=new yr(null,this.h))}Kr.prototype.toString=function(){var c=[],g=this.j;g&&c.push(Oi(g,$o,!0),":");var w=this.g;return(w||g=="file")&&(c.push("//"),(g=this.o)&&c.push(Oi(g,$o,!0),"@"),c.push(encodeURIComponent(String(w)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),w=this.s,w!=null&&c.push(":",String(w))),(w=this.l)&&(this.g&&w.charAt(0)!="/"&&c.push("/"),c.push(Oi(w,w.charAt(0)=="/"?Ic:Tc,!0))),(w=this.i.toString())&&c.push("?",w),(w=this.m)&&c.push("#",Oi(w,kl)),c.join("")};function kn(c){return new Kr(c)}function js(c,g,w){c.j=w?Ve(g,!0):g,c.j&&(c.j=c.j.replace(/:$/,""))}function bi(c,g){if(g){if(g=Number(g),isNaN(g)||0>g)throw Error("Bad port number "+g);c.s=g}else c.s=null}function Ni(c,g,w){g instanceof yr?(c.i=g,vr(c.i,c.h)):(w||(g=Oi(g,Cc)),c.i=new yr(g,c.h))}function et(c,g,w){c.i.set(g,w)}function Di(c){return et(c,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),c}function Ve(c,g){return c?g?decodeURI(c.replace(/%25/g,"%2525")):decodeURIComponent(c):""}function Oi(c,g,w){return typeof c=="string"?(c=encodeURI(c).replace(g,Ec),w&&(c=c.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),c):null}function Ec(c){return c=c.charCodeAt(0),"%"+(c>>4&15).toString(16)+(c&15).toString(16)}var $o=/[#\/\?@]/g,Tc=/[#\?:]/g,Ic=/[#\?]/g,Cc=/[#\?@]/g,kl=/#/g;function yr(c,g){this.h=this.g=null,this.i=c||null,this.j=!!g}function Ht(c){c.g||(c.g=new Map,c.h=0,c.i&&vf(c.i,function(g,w){c.add(decodeURIComponent(g.replace(/\+/g," ")),w)}))}n=yr.prototype,n.add=function(c,g){Ht(this),this.i=null,c=jn(this,c);var w=this.g.get(c);return w||this.g.set(c,w=[]),w.push(g),this.h+=1,this};function Zn(c,g){Ht(c),g=jn(c,g),c.g.has(g)&&(c.i=null,c.h-=c.g.get(g).length,c.g.delete(g))}function er(c,g){return Ht(c),g=jn(c,g),c.g.has(g)}n.forEach=function(c,g){Ht(this),this.g.forEach(function(w,C){w.forEach(function(z){c.call(g,z,C,this)},this)},this)},n.na=function(){Ht(this);const c=Array.from(this.g.values()),g=Array.from(this.g.keys()),w=[];for(let C=0;C<g.length;C++){const z=c[C];for(let q=0;q<z.length;q++)w.push(g[C])}return w},n.V=function(c){Ht(this);let g=[];if(typeof c=="string")er(this,c)&&(g=g.concat(this.g.get(jn(this,c))));else{c=Array.from(this.g.values());for(let w=0;w<c.length;w++)g=g.concat(c[w])}return g},n.set=function(c,g){return Ht(this),this.i=null,c=jn(this,c),er(this,c)&&(this.h-=this.g.get(c).length),this.g.set(c,[g]),this.h+=1,this},n.get=function(c,g){return c?(c=this.V(c),0<c.length?String(c[0]):g):g};function Li(c,g,w){Zn(c,g),0<w.length&&(c.i=null,c.g.set(jn(c,g),N(w)),c.h+=w.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const c=[],g=Array.from(this.g.keys());for(var w=0;w<g.length;w++){var C=g[w];const q=encodeURIComponent(String(C)),oe=this.V(C);for(C=0;C<oe.length;C++){var z=q;oe[C]!==""&&(z+="="+encodeURIComponent(String(oe[C]))),c.push(z)}}return this.i=c.join("&")};function jn(c,g){return g=String(g),c.j&&(g=g.toLowerCase()),g}function vr(c,g){g&&!c.j&&(Ht(c),c.i=null,c.g.forEach(function(w,C){var z=C.toLowerCase();C!=z&&(Zn(this,C),Li(this,z,w))},c)),c.j=g}function wf(c,g){const w=new Ds;if(h.Image){const C=new Image;C.onload=S(fn,w,"TestLoadImage: loaded",!0,g,C),C.onerror=S(fn,w,"TestLoadImage: error",!1,g,C),C.onabort=S(fn,w,"TestLoadImage: abort",!1,g,C),C.ontimeout=S(fn,w,"TestLoadImage: timeout",!1,g,C),h.setTimeout(function(){C.ontimeout&&C.ontimeout()},1e4),C.src=c}else g(!1)}function Sc(c,g){const w=new Ds,C=new AbortController,z=setTimeout(()=>{C.abort(),fn(w,"TestPingServer: timeout",!1,g)},1e4);fetch(c,{signal:C.signal}).then(q=>{clearTimeout(z),q.ok?fn(w,"TestPingServer: ok",!0,g):fn(w,"TestPingServer: server error",!1,g)}).catch(()=>{clearTimeout(z),fn(w,"TestPingServer: error",!1,g)})}function fn(c,g,w,C,z){try{z&&(z.onload=null,z.onerror=null,z.onabort=null,z.ontimeout=null),C(w)}catch{}}function Ef(){this.g=new yl}function Ac(c,g,w){const C=w||"";try{Pi(c,function(z,q){let oe=z;p(z)&&(oe=gl(z)),g.push(C+q+"="+encodeURIComponent(oe))})}catch(z){throw g.push(C+"type="+encodeURIComponent("_badmap")),z}}function Qr(c){this.l=c.Ub||null,this.j=c.eb||!1}R(Qr,bs),Qr.prototype.g=function(){return new Us(this.l,this.j)},Qr.prototype.i=function(c){return function(){return c}}({});function Us(c,g){Pt.call(this),this.D=c,this.o=g,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}R(Us,Pt),n=Us.prototype,n.open=function(c,g){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=c,this.A=g,this.readyState=1,nr(this)},n.send=function(c){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const g={headers:this.u,method:this.B,credentials:this.m,cache:void 0};c&&(g.body=c),(this.D||h).fetch(new Request(this.A,g)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,tr(this)),this.readyState=0},n.Sa=function(c){if(this.g&&(this.l=c,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=c.headers,this.readyState=2,nr(this)),this.g&&(this.readyState=3,nr(this),this.g)))if(this.responseType==="arraybuffer")c.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof h.ReadableStream<"u"&&"body"in c){if(this.j=c.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;kc(this)}else c.text().then(this.Ra.bind(this),this.ga.bind(this))};function kc(c){c.j.read().then(c.Pa.bind(c)).catch(c.ga.bind(c))}n.Pa=function(c){if(this.g){if(this.o&&c.value)this.response.push(c.value);else if(!this.o){var g=c.value?c.value:new Uint8Array(0);(g=this.v.decode(g,{stream:!c.done}))&&(this.response=this.responseText+=g)}c.done?tr(this):nr(this),this.readyState==3&&kc(this)}},n.Ra=function(c){this.g&&(this.response=this.responseText=c,tr(this))},n.Qa=function(c){this.g&&(this.response=c,tr(this))},n.ga=function(){this.g&&tr(this)};function tr(c){c.readyState=4,c.l=null,c.j=null,c.v=null,nr(c)}n.setRequestHeader=function(c,g){this.u.append(c,g)},n.getResponseHeader=function(c){return this.h&&this.h.get(c.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const c=[],g=this.h.entries();for(var w=g.next();!w.done;)w=w.value,c.push(w[0]+": "+w[1]),w=g.next();return c.join(`\r
`)};function nr(c){c.onreadystatechange&&c.onreadystatechange.call(c)}Object.defineProperty(Us.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(c){this.m=c?"include":"same-origin"}});function Yr(c){let g="";return se(c,function(w,C){g+=C,g+=":",g+=w,g+=`\r
`}),g}function Mi(c,g,w){e:{for(C in w){var C=!1;break e}C=!0}C||(w=Yr(w),typeof c=="string"?w!=null&&encodeURIComponent(String(w)):et(c,g,w))}function ct(c){Pt.call(this),this.headers=new Map,this.o=c||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}R(ct,Pt);var Tf=/^https?$/i,Rl=["POST","PUT"];n=ct.prototype,n.Ha=function(c){this.J=c},n.ea=function(c,g,w,C){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+c);g=g?g.toUpperCase():"GET",this.D=c,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Jn.g(),this.v=this.o?Do(this.o):Do(Jn),this.g.onreadystatechange=E(this.Ea,this);try{this.B=!0,this.g.open(g,String(c),!0),this.B=!1}catch(q){Bs(this,q);return}if(c=w||"",w=new Map(this.headers),C)if(Object.getPrototypeOf(C)===Object.prototype)for(var z in C)w.set(z,C[z]);else if(typeof C.keys=="function"&&typeof C.get=="function")for(const q of C.keys())w.set(q,C.get(q));else throw Error("Unknown input type for opt_headers: "+String(C));C=Array.from(w.keys()).find(q=>q.toLowerCase()=="content-type"),z=h.FormData&&c instanceof h.FormData,!(0<=Array.prototype.indexOf.call(Rl,g,void 0))||C||z||w.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[q,oe]of w)this.g.setRequestHeader(q,oe);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Ho(this),this.u=!0,this.g.send(c),this.u=!1}catch(q){Bs(this,q)}};function Bs(c,g){c.h=!1,c.g&&(c.j=!0,c.g.abort(),c.j=!1),c.l=g,c.m=5,Wo(c),Rn(c)}function Wo(c){c.A||(c.A=!0,bt(c,"complete"),bt(c,"error"))}n.abort=function(c){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=c||7,bt(this,"complete"),bt(this,"abort"),Rn(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Rn(this,!0)),ct.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?xl(this):this.bb())},n.bb=function(){xl(this)};function xl(c){if(c.h&&typeof u<"u"&&(!c.v[1]||pn(c)!=4||c.Z()!=2)){if(c.u&&pn(c)==4)fl(c.Ea,0,c);else if(bt(c,"readystatechange"),pn(c)==4){c.h=!1;try{const oe=c.Z();e:switch(oe){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var g=!0;break e;default:g=!1}var w;if(!(w=g)){var C;if(C=oe===0){var z=String(c.D).match(Fs)[1]||null;!z&&h.self&&h.self.location&&(z=h.self.location.protocol.slice(0,-1)),C=!Tf.test(z?z.toLowerCase():"")}w=C}if(w)bt(c,"complete"),bt(c,"success");else{c.m=6;try{var q=2<pn(c)?c.g.statusText:""}catch{q=""}c.l=q+" ["+c.Z()+"]",Wo(c)}}finally{Rn(c)}}}}function Rn(c,g){if(c.g){Ho(c);const w=c.g,C=c.v[0]?()=>{}:null;c.g=null,c.v=null,g||bt(c,"ready");try{w.onreadystatechange=C}catch{}}}function Ho(c){c.I&&(h.clearTimeout(c.I),c.I=null)}n.isActive=function(){return!!this.g};function pn(c){return c.g?c.g.readyState:0}n.Z=function(){try{return 2<pn(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(c){if(this.g){var g=this.g.responseText;return c&&g.indexOf(c)==0&&(g=g.substring(c.length)),_l(g)}};function Pl(c){try{if(!c.g)return null;if("response"in c.g)return c.g.response;switch(c.H){case"":case"text":return c.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in c.g)return c.g.mozResponseArrayBuffer}return null}catch{return null}}function Go(c){const g={};c=(c.g&&2<=pn(c)&&c.g.getAllResponseHeaders()||"").split(`\r
`);for(let C=0;C<c.length;C++){if(K(c[C]))continue;var w=L(c[C]);const z=w[0];if(w=w[1],typeof w!="string")continue;w=w.trim();const q=g[z]||[];g[z]=q,q.push(w)}D(g,function(C){return C.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function wr(c,g,w){return w&&w.internalChannelParams&&w.internalChannelParams[c]||g}function bl(c){this.Aa=0,this.i=[],this.j=new Ds,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=wr("failFast",!1,c),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=wr("baseRetryDelayMs",5e3,c),this.cb=wr("retryDelaySeedMs",1e4,c),this.Wa=wr("forwardChannelMaxRetries",2,c),this.wa=wr("forwardChannelRequestTimeoutMs",2e4,c),this.pa=c&&c.xmlHttpFactory||void 0,this.Xa=c&&c.Tb||void 0,this.Ca=c&&c.useFetchStreams||!1,this.L=void 0,this.J=c&&c.supportsCrossDomainXhr||!1,this.K="",this.h=new Vs(c&&c.concurrentRequestLimit),this.Da=new Ef,this.P=c&&c.fastHandshake||!1,this.O=c&&c.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=c&&c.Rb||!1,c&&c.xa&&this.j.xa(),c&&c.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&c&&c.detectBufferingProxy||!1,this.ja=void 0,c&&c.longPollingTimeout&&0<c.longPollingTimeout&&(this.ja=c.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=bl.prototype,n.la=8,n.G=1,n.connect=function(c,g,w,C){_t(0),this.W=c,this.H=g||{},w&&C!==void 0&&(this.H.OSID=w,this.H.OAID=C),this.F=this.X,this.I=bc(this,null,this.W),Er(this)};function Gt(c){if(qo(c),c.G==3){var g=c.U++,w=kn(c.I);if(et(w,"SID",c.K),et(w,"RID",g),et(w,"TYPE","terminate"),Jr(c,w),g=new Xn(c,c.j,g),g.L=2,g.v=Di(kn(w)),w=!1,h.navigator&&h.navigator.sendBeacon)try{w=h.navigator.sendBeacon(g.v.toString(),"")}catch{}!w&&h.Image&&(new Image().src=g.v,w=!0),w||(g.g=Nc(g.j,null),g.g.ea(g.v)),g.F=Date.now(),rt(g)}Pc(c)}function rr(c){c.g&&(Nl(c),c.g.cancel(),c.g=null)}function qo(c){rr(c),c.u&&(h.clearTimeout(c.u),c.u=null),Yo(c),c.h.cancel(),c.s&&(typeof c.s=="number"&&h.clearTimeout(c.s),c.s=null)}function Er(c){if(!An(c.h)&&!c.s){c.s=!0;var g=c.Ga;xe||ae(),ie||(xe(),ie=!0),ce.add(g,c),c.B=0}}function If(c,g){return yc(c.h)>=c.h.j-(c.s?1:0)?!1:c.s?(c.i=g.D.concat(c.i),!0):c.G==1||c.G==2||c.B>=(c.Va?0:c.Wa)?!1:(c.s=Qn(E(c.Ga,c,g),xc(c,c.B)),c.B++,!0)}n.Ga=function(c){if(this.s)if(this.s=null,this.G==1){if(!c){this.U=Math.floor(1e5*Math.random()),c=this.U++;const z=new Xn(this,this.j,c);let q=this.o;if(this.S&&(q?(q=A(q),b(q,this.S)):q=this.S),this.m!==null||this.O||(z.H=q,q=null),this.P)e:{for(var g=0,w=0;w<this.i.length;w++){t:{var C=this.i[w];if("__data__"in C.map&&(C=C.map.__data__,typeof C=="string")){C=C.length;break t}C=void 0}if(C===void 0)break;if(g+=C,4096<g){g=w;break e}if(g===4096||w===this.i.length-1){g=w+1;break e}}g=1e3}else g=1e3;g=Vi(this,z,g),w=kn(this.I),et(w,"RID",c),et(w,"CVER",22),this.D&&et(w,"X-HTTP-Session-Id",this.D),Jr(this,w),q&&(this.O?g="headers="+encodeURIComponent(String(Yr(q)))+"&"+g:this.m&&Mi(w,this.m,q)),Al(this.h,z),this.Ua&&et(w,"TYPE","init"),this.P?(et(w,"$req",g),et(w,"SID","null"),z.T=!0,Uo(z,w,null)):Uo(z,w,g),this.G=2}}else this.G==3&&(c?Ko(this,c):this.i.length==0||An(this.h)||Ko(this))};function Ko(c,g){var w;g?w=g.l:w=c.U++;const C=kn(c.I);et(C,"SID",c.K),et(C,"RID",w),et(C,"AID",c.T),Jr(c,C),c.m&&c.o&&Mi(C,c.m,c.o),w=new Xn(c,c.j,w,c.B+1),c.m===null&&(w.H=c.o),g&&(c.i=g.D.concat(c.i)),g=Vi(c,w,1e3),w.I=Math.round(.5*c.wa)+Math.round(.5*c.wa*Math.random()),Al(c.h,w),Uo(w,C,g)}function Jr(c,g){c.H&&se(c.H,function(w,C){et(g,C,w)}),c.l&&Pi({},function(w,C){et(g,C,w)})}function Vi(c,g,w){w=Math.min(c.i.length,w);var C=c.l?E(c.l.Na,c.l,c):null;e:{var z=c.i;let q=-1;for(;;){const oe=["count="+w];q==-1?0<w?(q=z[0].g,oe.push("ofs="+q)):q=0:oe.push("ofs="+q);let Ye=!0;for(let Nt=0;Nt<w;Nt++){let je=z[Nt].g;const Vt=z[Nt].map;if(je-=q,0>je)q=Math.max(0,z[Nt].g-100),Ye=!1;else try{Ac(Vt,oe,"req"+je+"_")}catch{C&&C(Vt)}}if(Ye){C=oe.join("&");break e}}}return c=c.i.splice(0,w),g.D=c,C}function zs(c){if(!c.g&&!c.u){c.Y=1;var g=c.Fa;xe||ae(),ie||(xe(),ie=!0),ce.add(g,c),c.v=0}}function Qo(c){return c.g||c.u||3<=c.v?!1:(c.Y++,c.u=Qn(E(c.Fa,c),xc(c,c.v)),c.v++,!0)}n.Fa=function(){if(this.u=null,Rc(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var c=2*this.R;this.j.info("BP detection timer enabled: "+c),this.A=Qn(E(this.ab,this),c)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,_t(10),rr(this),Rc(this))};function Nl(c){c.A!=null&&(h.clearTimeout(c.A),c.A=null)}function Rc(c){c.g=new Xn(c,c.j,"rpc",c.Y),c.m===null&&(c.g.H=c.o),c.g.O=0;var g=kn(c.qa);et(g,"RID","rpc"),et(g,"SID",c.K),et(g,"AID",c.T),et(g,"CI",c.F?"0":"1"),!c.F&&c.ja&&et(g,"TO",c.ja),et(g,"TYPE","xmlhttp"),Jr(c,g),c.m&&c.o&&Mi(g,c.m,c.o),c.L&&(c.g.I=c.L);var w=c.g;c=c.ia,w.L=1,w.v=Di(kn(g)),w.m=null,w.P=!0,Cl(w,c)}n.Za=function(){this.C!=null&&(this.C=null,rr(this),Qo(this),_t(19))};function Yo(c){c.C!=null&&(h.clearTimeout(c.C),c.C=null)}function Jo(c,g){var w=null;if(c.g==g){Yo(c),Nl(c),c.g=null;var C=2}else if(ln(c.h,g))w=g.D,vc(c.h,g),C=1;else return;if(c.G!=0){if(g.o)if(C==1){w=g.m?g.m.length:0,g=Date.now()-g.F;var z=c.B;C=Ns(),bt(C,new Mo(C,w)),Er(c)}else zs(c);else if(z=g.s,z==3||z==0&&0<g.X||!(C==1&&If(c,g)||C==2&&Qo(c)))switch(w&&0<w.length&&(g=c.h,g.i=g.i.concat(w)),z){case 1:Xr(c,5);break;case 4:Xr(c,10);break;case 3:Xr(c,6);break;default:Xr(c,2)}}}function xc(c,g){let w=c.Ta+Math.floor(Math.random()*c.cb);return c.isActive()||(w*=2),w*g}function Xr(c,g){if(c.j.info("Error code "+g),g==2){var w=E(c.fb,c),C=c.Xa;const z=!C;C=new Kr(C||"//www.google.com/images/cleardot.gif"),h.location&&h.location.protocol=="http"||js(C,"https"),Di(C),z?wf(C.toString(),w):Sc(C.toString(),w)}else _t(2);c.G=0,c.l&&c.l.sa(g),Pc(c),qo(c)}n.fb=function(c){c?(this.j.info("Successfully pinged google.com"),_t(2)):(this.j.info("Failed to ping google.com"),_t(1))};function Pc(c){if(c.G=0,c.ka=[],c.l){const g=wc(c.h);(g.length!=0||c.i.length!=0)&&(O(c.ka,g),O(c.ka,c.i),c.h.i.length=0,N(c.i),c.i.length=0),c.l.ra()}}function bc(c,g,w){var C=w instanceof Kr?kn(w):new Kr(w);if(C.g!="")g&&(C.g=g+"."+C.g),bi(C,C.s);else{var z=h.location;C=z.protocol,g=g?g+"."+z.hostname:z.hostname,z=+z.port;var q=new Kr(null);C&&js(q,C),g&&(q.g=g),z&&bi(q,z),w&&(q.l=w),C=q}return w=c.D,g=c.ya,w&&g&&et(C,w,g),et(C,"VER",c.la),Jr(c,C),C}function Nc(c,g,w){if(g&&!c.J)throw Error("Can't create secondary domain capable XhrIo object.");return g=c.Ca&&!c.pa?new ct(new Qr({eb:w})):new ct(c.pa),g.Ha(c.J),g}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Dl(){}n=Dl.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function Xo(){}Xo.prototype.g=function(c,g){return new un(c,g)};function un(c,g){Pt.call(this),this.g=new bl(g),this.l=c,this.h=g&&g.messageUrlParams||null,c=g&&g.messageHeaders||null,g&&g.clientProtocolHeaderRequired&&(c?c["X-Client-Protocol"]="webchannel":c={"X-Client-Protocol":"webchannel"}),this.g.o=c,c=g&&g.initMessageHeaders||null,g&&g.messageContentType&&(c?c["X-WebChannel-Content-Type"]=g.messageContentType:c={"X-WebChannel-Content-Type":g.messageContentType}),g&&g.va&&(c?c["X-WebChannel-Client-Profile"]=g.va:c={"X-WebChannel-Client-Profile":g.va}),this.g.S=c,(c=g&&g.Sb)&&!K(c)&&(this.g.m=c),this.v=g&&g.supportsCrossDomainXhr||!1,this.u=g&&g.sendRawJson||!1,(g=g&&g.httpSessionIdParam)&&!K(g)&&(this.g.D=g,c=this.h,c!==null&&g in c&&(c=this.h,g in c&&delete c[g])),this.j=new Tr(this)}R(un,Pt),un.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},un.prototype.close=function(){Gt(this.g)},un.prototype.o=function(c){var g=this.g;if(typeof c=="string"){var w={};w.__data__=c,c=w}else this.u&&(w={},w.__data__=gl(c),c=w);g.i.push(new _c(g.Ya++,c)),g.G==3&&Er(g)},un.prototype.N=function(){this.g.l=null,delete this.j,Gt(this.g),delete this.g,un.aa.N.call(this)};function Dc(c){gr.call(this),c.__headers__&&(this.headers=c.__headers__,this.statusCode=c.__status__,delete c.__headers__,delete c.__status__);var g=c.__sm__;if(g){e:{for(const w in g){c=w;break e}c=void 0}(this.i=c)&&(c=this.i,g=g!==null&&c in g?g[c]:void 0),this.data=g}else this.data=c}R(Dc,gr);function Oc(){Lo.call(this),this.status=1}R(Oc,Lo);function Tr(c){this.g=c}R(Tr,Dl),Tr.prototype.ua=function(){bt(this.g,"a")},Tr.prototype.ta=function(c){bt(this.g,new Dc(c))},Tr.prototype.sa=function(c){bt(this.g,new Oc)},Tr.prototype.ra=function(){bt(this.g,"b")},Xo.prototype.createWebChannel=Xo.prototype.g,un.prototype.send=un.prototype.o,un.prototype.open=un.prototype.m,un.prototype.close=un.prototype.close,eI=function(){return new Xo},ZT=function(){return Ns()},XT=_r,Am={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Fo.NO_ERROR=0,Fo.TIMEOUT=8,Fo.HTTP_ERROR=6,$h=Fo,fc.COMPLETE="complete",JT=fc,Oo.EventType=Vn,Vn.OPEN="a",Vn.CLOSE="b",Vn.ERROR="c",Vn.MESSAGE="d",Pt.prototype.listen=Pt.prototype.K,du=Oo,ct.prototype.listenOnce=ct.prototype.L,ct.prototype.getLastError=ct.prototype.Ka,ct.prototype.getLastErrorCode=ct.prototype.Ba,ct.prototype.getStatus=ct.prototype.Z,ct.prototype.getResponseJson=ct.prototype.Oa,ct.prototype.getResponseText=ct.prototype.oa,ct.prototype.send=ct.prototype.ea,ct.prototype.setWithCredentials=ct.prototype.Ha,YT=ct}).apply(typeof Ph<"u"?Ph:typeof self<"u"?self:typeof window<"u"?window:{});const Fw="@firebase/firestore",jw="4.8.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class on{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}on.UNAUTHENTICATED=new on(null),on.GOOGLE_CREDENTIALS=new on("google-credentials-uid"),on.FIRST_PARTY=new on("first-party-uid"),on.MOCK_USER=new on("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Za="11.10.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const po=new Vd("@firebase/firestore");function Ea(){return po.logLevel}function de(n,...e){if(po.logLevel<=be.DEBUG){const t=e.map(kg);po.debug(`Firestore (${Za}): ${n}`,...t)}}function Ei(n,...e){if(po.logLevel<=be.ERROR){const t=e.map(kg);po.error(`Firestore (${Za}): ${n}`,...t)}}function ps(n,...e){if(po.logLevel<=be.WARN){const t=e.map(kg);po.warn(`Firestore (${Za}): ${n}`,...t)}}function kg(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ve(n,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,tI(n,r,t)}function tI(n,e,t){let r=`FIRESTORE (${Za}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw Ei(r),new Error(r)}function ze(n,e,t,r){let s="Unexpected state";typeof t=="string"?s=t:r=t,n||tI(e,s,r)}function Ae(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ue extends Si{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gi{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nI{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class Lb{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(on.UNAUTHENTICATED))}shutdown(){}}class Mb{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class Vb{constructor(e){this.t=e,this.currentUser=on.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){ze(this.o===void 0,42304);let r=this.i;const s=f=>this.i!==r?(r=this.i,t(f)):Promise.resolve();let a=new gi;this.o=()=>{this.i++,this.currentUser=this.u(),a.resolve(),a=new gi,e.enqueueRetryable(()=>s(this.currentUser))};const u=()=>{const f=a;e.enqueueRetryable(async()=>{await f.promise,await s(this.currentUser)})},h=f=>{de("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=f,this.o&&(this.auth.addAuthTokenListener(this.o),u())};this.t.onInit(f=>h(f)),setTimeout(()=>{if(!this.auth){const f=this.t.getImmediate({optional:!0});f?h(f):(de("FirebaseAuthCredentialsProvider","Auth not yet detected"),a.resolve(),a=new gi)}},0),u()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(de("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(ze(typeof r.accessToken=="string",31837,{l:r}),new nI(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return ze(e===null||typeof e=="string",2055,{h:e}),new on(e)}}class Fb{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=on.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class jb{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new Fb(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(on.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class Uw{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Ub{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Dn(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){ze(this.o===void 0,3512);const r=a=>{a.error!=null&&de("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${a.error.message}`);const u=a.token!==this.m;return this.m=a.token,de("FirebaseAppCheckTokenProvider",`Received ${u?"new":"existing"} token.`),u?t(a.token):Promise.resolve()};this.o=a=>{e.enqueueRetryable(()=>r(a))};const s=a=>{de("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=a,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(a=>s(a)),setTimeout(()=>{if(!this.appCheck){const a=this.V.getImmediate({optional:!0});a?s(a):de("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new Uw(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(ze(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new Uw(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bb(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rI(){return new TextEncoder}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rg{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const s=Bb(40);for(let a=0;a<s.length;++a)r.length<20&&s[a]<t&&(r+=e.charAt(s[a]%62))}return r}}function Re(n,e){return n<e?-1:n>e?1:0}function km(n,e){let t=0;for(;t<n.length&&t<e.length;){const r=n.codePointAt(t),s=e.codePointAt(t);if(r!==s){if(r<128&&s<128)return Re(r,s);{const a=rI(),u=zb(a.encode(Bw(n,t)),a.encode(Bw(e,t)));return u!==0?u:Re(r,s)}}t+=r>65535?2:1}return Re(n.length,e.length)}function Bw(n,e){return n.codePointAt(e)>65535?n.substring(e,e+2):n.substring(e,e+1)}function zb(n,e){for(let t=0;t<n.length&&t<e.length;++t)if(n[t]!==e[t])return Re(n[t],e[t]);return Re(n.length,e.length)}function Ua(n,e,t){return n.length===e.length&&n.every((r,s)=>t(r,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zw="__name__";class kr{constructor(e,t,r){t===void 0?t=0:t>e.length&&ve(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&ve(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return kr.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof kr?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let s=0;s<r;s++){const a=kr.compareSegments(e.get(s),t.get(s));if(a!==0)return a}return Re(e.length,t.length)}static compareSegments(e,t){const r=kr.isNumericId(e),s=kr.isNumericId(t);return r&&!s?-1:!r&&s?1:r&&s?kr.extractNumericId(e).compare(kr.extractNumericId(t)):km(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return as.fromString(e.substring(4,e.length-2))}}class Je extends kr{construct(e,t,r){return new Je(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new ue(Y.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(s=>s.length>0))}return new Je(t)}static emptyPath(){return new Je([])}}const $b=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Jt extends kr{construct(e,t,r){return new Jt(e,t,r)}static isValidIdentifier(e){return $b.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Jt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===zw}static keyField(){return new Jt([zw])}static fromServerFormat(e){const t=[];let r="",s=0;const a=()=>{if(r.length===0)throw new ue(Y.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let u=!1;for(;s<e.length;){const h=e[s];if(h==="\\"){if(s+1===e.length)throw new ue(Y.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const f=e[s+1];if(f!=="\\"&&f!=="."&&f!=="`")throw new ue(Y.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=f,s+=2}else h==="`"?(u=!u,s++):h!=="."||u?(r+=h,s++):(a(),s++)}if(a(),u)throw new ue(Y.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Jt(t)}static emptyPath(){return new Jt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ye{constructor(e){this.path=e}static fromPath(e){return new ye(Je.fromString(e))}static fromName(e){return new ye(Je.fromString(e).popFirst(5))}static empty(){return new ye(Je.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Je.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Je.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ye(new Je(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iI(n,e,t){if(!t)throw new ue(Y.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function Wb(n,e,t,r){if(e===!0&&r===!0)throw new ue(Y.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function $w(n){if(!ye.isDocumentKey(n))throw new ue(Y.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function Ww(n){if(ye.isDocumentKey(n))throw new ue(Y.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function sI(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function $d(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":ve(12329,{type:typeof n})}function In(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new ue(Y.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=$d(n);throw new ue(Y.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rt(n,e){const t={typeString:n};return e&&(t.value=e),t}function Yu(n,e){if(!sI(n))throw new ue(Y.INVALID_ARGUMENT,"JSON must be an object");let t;for(const r in e)if(e[r]){const s=e[r].typeString,a="value"in e[r]?{value:e[r].value}:void 0;if(!(r in n)){t=`JSON missing required field: '${r}'`;break}const u=n[r];if(s&&typeof u!==s){t=`JSON field '${r}' must be a ${s}.`;break}if(a!==void 0&&u!==a.value){t=`Expected '${r}' field to equal '${a.value}'`;break}}if(t)throw new ue(Y.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hw=-62135596800,Gw=1e6;class ut{static now(){return ut.fromMillis(Date.now())}static fromDate(e){return ut.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*Gw);return new ut(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new ue(Y.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new ue(Y.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<Hw)throw new ue(Y.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ue(Y.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Gw}_compareTo(e){return this.seconds===e.seconds?Re(this.nanoseconds,e.nanoseconds):Re(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:ut._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Yu(e,ut._jsonSchema))return new ut(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-Hw;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}ut._jsonSchemaVersion="firestore/timestamp/1.0",ut._jsonSchema={type:Rt("string",ut._jsonSchemaVersion),seconds:Rt("number"),nanoseconds:Rt("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ie{static fromTimestamp(e){return new Ie(e)}static min(){return new Ie(new ut(0,0))}static max(){return new Ie(new ut(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nu=-1;function Hb(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,s=Ie.fromTimestamp(r===1e9?new ut(t+1,0):new ut(t,r));return new ms(s,ye.empty(),e)}function Gb(n){return new ms(n.readTime,n.key,Nu)}class ms{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new ms(Ie.min(),ye.empty(),Nu)}static max(){return new ms(Ie.max(),ye.empty(),Nu)}}function qb(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=ye.comparator(n.documentKey,e.documentKey),t!==0?t:Re(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kb="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Qb{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function el(n){if(n.code!==Y.FAILED_PRECONDITION||n.message!==Kb)throw n;de("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&ve(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new X((r,s)=>{this.nextCallback=a=>{this.wrapSuccess(e,a).next(r,s)},this.catchCallback=a=>{this.wrapFailure(t,a).next(r,s)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof X?t:X.resolve(t)}catch(t){return X.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):X.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):X.reject(t)}static resolve(e){return new X((t,r)=>{t(e)})}static reject(e){return new X((t,r)=>{r(e)})}static waitFor(e){return new X((t,r)=>{let s=0,a=0,u=!1;e.forEach(h=>{++s,h.next(()=>{++a,u&&a===s&&t()},f=>r(f))}),u=!0,a===s&&t()})}static or(e){let t=X.resolve(!1);for(const r of e)t=t.next(s=>s?X.resolve(s):r());return t}static forEach(e,t){const r=[];return e.forEach((s,a)=>{r.push(t.call(this,s,a))}),this.waitFor(r)}static mapArray(e,t){return new X((r,s)=>{const a=e.length,u=new Array(a);let h=0;for(let f=0;f<a;f++){const p=f;t(e[p]).next(y=>{u[p]=y,++h,h===a&&r(u)},y=>s(y))}})}static doWhile(e,t){return new X((r,s)=>{const a=()=>{e()===!0?t().next(()=>{a()},s):r()};a()})}}function Yb(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function tl(n){return n.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wd{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this._e(r),this.ae=r=>t.writeSequenceNumber(r))}_e(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ae&&this.ae(e),e}}Wd.ue=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xg=-1;function Ju(n){return n==null}function ld(n){return n===0&&1/n==-1/0}function Jb(n){return typeof n=="number"&&Number.isInteger(n)&&!ld(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oI="";function Xb(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=qw(e)),e=Zb(n.get(t),e);return qw(e)}function Zb(n,e){let t=e;const r=n.length;for(let s=0;s<r;s++){const a=n.charAt(s);switch(a){case"\0":t+="";break;case oI:t+="";break;default:t+=a}}return t}function qw(n){return n+oI+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kw(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function As(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function aI(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let xt=class Rm{constructor(e,t){this.comparator=e,this.root=t||ls.EMPTY}insert(e,t){return new Rm(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,ls.BLACK,null,null))}remove(e){return new Rm(this.comparator,this.root.remove(e,this.comparator).copy(null,null,ls.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return t+r.left.size;s<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){const e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new bh(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new bh(this.root,e,this.comparator,!1)}getReverseIterator(){return new bh(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new bh(this.root,e,this.comparator,!0)}},bh=class{constructor(e,t,r,s){this.isReverse=s,this.nodeStack=[];let a=1;for(;!e.isEmpty();)if(a=t?r(e.key,t):1,t&&s&&(a*=-1),a<0)e=this.isReverse?e.left:e.right;else{if(a===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},ls=class li{constructor(e,t,r,s,a){this.key=e,this.value=t,this.color=r??li.RED,this.left=s??li.EMPTY,this.right=a??li.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,s,a){return new li(e??this.key,t??this.value,r??this.color,s??this.left,a??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let s=this;const a=r(e,s.key);return s=a<0?s.copy(null,null,null,s.left.insert(e,t,r),null):a===0?s.copy(null,t,null,null,null):s.copy(null,null,null,null,s.right.insert(e,t,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return li.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,s=this;if(t(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,t),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),t(e,s.key)===0){if(s.right.isEmpty())return li.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,t))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,li.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,li.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw ve(43730,{key:this.key,value:this.value});if(this.right.isRed())throw ve(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw ve(27949);return e+(this.isRed()?0:1)}};ls.EMPTY=null,ls.RED=!0,ls.BLACK=!1;ls.EMPTY=new class{constructor(){this.size=0}get key(){throw ve(57766)}get value(){throw ve(16141)}get color(){throw ve(16727)}get left(){throw ve(29726)}get right(){throw ve(36894)}copy(e,t,r,s,a){return this}insert(e,t,r){return new ls(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lt{constructor(e){this.comparator=e,this.data=new xt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;t(s.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Qw(this.data.getIterator())}getIteratorFrom(e){return new Qw(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof Lt)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const s=t.getNext().key,a=r.getNext().key;if(this.comparator(s,a)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new Lt(this.comparator);return t.data=e,t}}class Qw{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ln{constructor(e){this.fields=e,e.sort(Jt.comparator)}static empty(){return new Ln([])}unionWith(e){let t=new Lt(Jt.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new Ln(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Ua(this.fields,e.fields,(t,r)=>t.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lI extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zt{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(s){try{return atob(s)}catch(a){throw typeof DOMException<"u"&&a instanceof DOMException?new lI("Invalid base64 string: "+a):a}}(e);return new Zt(t)}static fromUint8Array(e){const t=function(s){let a="";for(let u=0;u<s.length;++u)a+=String.fromCharCode(s[u]);return a}(e);return new Zt(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const r=new Uint8Array(t.length);for(let s=0;s<t.length;s++)r[s]=t.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Re(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Zt.EMPTY_BYTE_STRING=new Zt("");const eN=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function gs(n){if(ze(!!n,39018),typeof n=="string"){let e=0;const t=eN.exec(n);if(ze(!!t,46558,{timestamp:n}),t[1]){let s=t[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:vt(n.seconds),nanos:vt(n.nanos)}}function vt(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function _s(n){return typeof n=="string"?Zt.fromBase64String(n):Zt.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uI="server_timestamp",cI="__type__",hI="__previous_value__",dI="__local_write_time__";function Pg(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{})[cI])===null||t===void 0?void 0:t.stringValue)===uI}function Hd(n){const e=n.mapValue.fields[hI];return Pg(e)?Hd(e):e}function Du(n){const e=gs(n.mapValue.fields[dI].timestampValue);return new ut(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tN{constructor(e,t,r,s,a,u,h,f,p,y){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=s,this.ssl=a,this.forceLongPolling=u,this.autoDetectLongPolling=h,this.longPollingOptions=f,this.useFetchStreams=p,this.isUsingEmulator=y}}const ud="(default)";class Ou{constructor(e,t){this.projectId=e,this.database=t||ud}static empty(){return new Ou("","")}get isDefaultDatabase(){return this.database===ud}isEqual(e){return e instanceof Ou&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fI="__type__",nN="__max__",Nh={mapValue:{}},pI="__vector__",cd="value";function ys(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Pg(n)?4:iN(n)?9007199254740991:rN(n)?10:11:ve(28295,{value:n})}function Vr(n,e){if(n===e)return!0;const t=ys(n);if(t!==ys(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Du(n).isEqual(Du(e));case 3:return function(s,a){if(typeof s.timestampValue=="string"&&typeof a.timestampValue=="string"&&s.timestampValue.length===a.timestampValue.length)return s.timestampValue===a.timestampValue;const u=gs(s.timestampValue),h=gs(a.timestampValue);return u.seconds===h.seconds&&u.nanos===h.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(s,a){return _s(s.bytesValue).isEqual(_s(a.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(s,a){return vt(s.geoPointValue.latitude)===vt(a.geoPointValue.latitude)&&vt(s.geoPointValue.longitude)===vt(a.geoPointValue.longitude)}(n,e);case 2:return function(s,a){if("integerValue"in s&&"integerValue"in a)return vt(s.integerValue)===vt(a.integerValue);if("doubleValue"in s&&"doubleValue"in a){const u=vt(s.doubleValue),h=vt(a.doubleValue);return u===h?ld(u)===ld(h):isNaN(u)&&isNaN(h)}return!1}(n,e);case 9:return Ua(n.arrayValue.values||[],e.arrayValue.values||[],Vr);case 10:case 11:return function(s,a){const u=s.mapValue.fields||{},h=a.mapValue.fields||{};if(Kw(u)!==Kw(h))return!1;for(const f in u)if(u.hasOwnProperty(f)&&(h[f]===void 0||!Vr(u[f],h[f])))return!1;return!0}(n,e);default:return ve(52216,{left:n})}}function Lu(n,e){return(n.values||[]).find(t=>Vr(t,e))!==void 0}function Ba(n,e){if(n===e)return 0;const t=ys(n),r=ys(e);if(t!==r)return Re(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return Re(n.booleanValue,e.booleanValue);case 2:return function(a,u){const h=vt(a.integerValue||a.doubleValue),f=vt(u.integerValue||u.doubleValue);return h<f?-1:h>f?1:h===f?0:isNaN(h)?isNaN(f)?0:-1:1}(n,e);case 3:return Yw(n.timestampValue,e.timestampValue);case 4:return Yw(Du(n),Du(e));case 5:return km(n.stringValue,e.stringValue);case 6:return function(a,u){const h=_s(a),f=_s(u);return h.compareTo(f)}(n.bytesValue,e.bytesValue);case 7:return function(a,u){const h=a.split("/"),f=u.split("/");for(let p=0;p<h.length&&p<f.length;p++){const y=Re(h[p],f[p]);if(y!==0)return y}return Re(h.length,f.length)}(n.referenceValue,e.referenceValue);case 8:return function(a,u){const h=Re(vt(a.latitude),vt(u.latitude));return h!==0?h:Re(vt(a.longitude),vt(u.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return Jw(n.arrayValue,e.arrayValue);case 10:return function(a,u){var h,f,p,y;const v=a.fields||{},E=u.fields||{},S=(h=v[cd])===null||h===void 0?void 0:h.arrayValue,R=(f=E[cd])===null||f===void 0?void 0:f.arrayValue,N=Re(((p=S?.values)===null||p===void 0?void 0:p.length)||0,((y=R?.values)===null||y===void 0?void 0:y.length)||0);return N!==0?N:Jw(S,R)}(n.mapValue,e.mapValue);case 11:return function(a,u){if(a===Nh.mapValue&&u===Nh.mapValue)return 0;if(a===Nh.mapValue)return 1;if(u===Nh.mapValue)return-1;const h=a.fields||{},f=Object.keys(h),p=u.fields||{},y=Object.keys(p);f.sort(),y.sort();for(let v=0;v<f.length&&v<y.length;++v){const E=km(f[v],y[v]);if(E!==0)return E;const S=Ba(h[f[v]],p[y[v]]);if(S!==0)return S}return Re(f.length,y.length)}(n.mapValue,e.mapValue);default:throw ve(23264,{le:t})}}function Yw(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return Re(n,e);const t=gs(n),r=gs(e),s=Re(t.seconds,r.seconds);return s!==0?s:Re(t.nanos,r.nanos)}function Jw(n,e){const t=n.values||[],r=e.values||[];for(let s=0;s<t.length&&s<r.length;++s){const a=Ba(t[s],r[s]);if(a)return a}return Re(t.length,r.length)}function za(n){return xm(n)}function xm(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){const r=gs(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return _s(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return ye.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",s=!0;for(const a of t.values||[])s?s=!1:r+=",",r+=xm(a);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){const r=Object.keys(t.fields||{}).sort();let s="{",a=!0;for(const u of r)a?a=!1:s+=",",s+=`${u}:${xm(t.fields[u])}`;return s+"}"}(n.mapValue):ve(61005,{value:n})}function Wh(n){switch(ys(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Hd(n);return e?16+Wh(e):16;case 5:return 2*n.stringValue.length;case 6:return _s(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((s,a)=>s+Wh(a),0)}(n.arrayValue);case 10:case 11:return function(r){let s=0;return As(r.fields,(a,u)=>{s+=a.length+Wh(u)}),s}(n.mapValue);default:throw ve(13486,{value:n})}}function Xw(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function Pm(n){return!!n&&"integerValue"in n}function bg(n){return!!n&&"arrayValue"in n}function Zw(n){return!!n&&"nullValue"in n}function e0(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Hh(n){return!!n&&"mapValue"in n}function rN(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{})[fI])===null||t===void 0?void 0:t.stringValue)===pI}function yu(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return As(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=yu(r)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=yu(n.arrayValue.values[t]);return e}return Object.assign({},n)}function iN(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===nN}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dn{constructor(e){this.value=e}static empty(){return new dn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!Hh(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=yu(t)}setAll(e){let t=Jt.emptyPath(),r={},s=[];e.forEach((u,h)=>{if(!t.isImmediateParentOf(h)){const f=this.getFieldsMap(t);this.applyChanges(f,r,s),r={},s=[],t=h.popLast()}u?r[h.lastSegment()]=yu(u):s.push(h.lastSegment())});const a=this.getFieldsMap(t);this.applyChanges(a,r,s)}delete(e){const t=this.field(e.popLast());Hh(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Vr(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=t.mapValue.fields[e.get(r)];Hh(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=s),t=s}return t.mapValue.fields}applyChanges(e,t,r){As(t,(s,a)=>e[s]=a);for(const s of r)delete e[s]}clone(){return new dn(yu(this.value))}}function mI(n){const e=[];return As(n.fields,(t,r)=>{const s=new Jt([t]);if(Hh(r)){const a=mI(r.mapValue).fields;if(a.length===0)e.push(s);else for(const u of a)e.push(s.child(u))}else e.push(s)}),new Ln(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wt{constructor(e,t,r,s,a,u,h){this.key=e,this.documentType=t,this.version=r,this.readTime=s,this.createTime=a,this.data=u,this.documentState=h}static newInvalidDocument(e){return new Wt(e,0,Ie.min(),Ie.min(),Ie.min(),dn.empty(),0)}static newFoundDocument(e,t,r,s){return new Wt(e,1,t,Ie.min(),r,s,0)}static newNoDocument(e,t){return new Wt(e,2,t,Ie.min(),Ie.min(),dn.empty(),0)}static newUnknownDocument(e,t){return new Wt(e,3,t,Ie.min(),Ie.min(),dn.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Ie.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=dn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=dn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ie.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Wt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Wt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hd{constructor(e,t){this.position=e,this.inclusive=t}}function t0(n,e,t){let r=0;for(let s=0;s<n.position.length;s++){const a=e[s],u=n.position[s];if(a.field.isKeyField()?r=ye.comparator(ye.fromName(u.referenceValue),t.key):r=Ba(u,t.data.field(a.field)),a.dir==="desc"&&(r*=-1),r!==0)break}return r}function n0(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Vr(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dd{constructor(e,t="asc"){this.field=e,this.dir=t}}function sN(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gI{}class At extends gI{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new aN(e,t,r):t==="array-contains"?new cN(e,r):t==="in"?new hN(e,r):t==="not-in"?new dN(e,r):t==="array-contains-any"?new fN(e,r):new At(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new lN(e,r):new uN(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Ba(t,this.value)):t!==null&&ys(this.value)===ys(t)&&this.matchesComparison(Ba(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ve(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class pr extends gI{constructor(e,t){super(),this.filters=e,this.op=t,this.he=null}static create(e,t){return new pr(e,t)}matches(e){return _I(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.he!==null||(this.he=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.he}getFilters(){return Object.assign([],this.filters)}}function _I(n){return n.op==="and"}function yI(n){return oN(n)&&_I(n)}function oN(n){for(const e of n.filters)if(e instanceof pr)return!1;return!0}function bm(n){if(n instanceof At)return n.field.canonicalString()+n.op.toString()+za(n.value);if(yI(n))return n.filters.map(e=>bm(e)).join(",");{const e=n.filters.map(t=>bm(t)).join(",");return`${n.op}(${e})`}}function vI(n,e){return n instanceof At?function(r,s){return s instanceof At&&r.op===s.op&&r.field.isEqual(s.field)&&Vr(r.value,s.value)}(n,e):n instanceof pr?function(r,s){return s instanceof pr&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((a,u,h)=>a&&vI(u,s.filters[h]),!0):!1}(n,e):void ve(19439)}function wI(n){return n instanceof At?function(t){return`${t.field.canonicalString()} ${t.op} ${za(t.value)}`}(n):n instanceof pr?function(t){return t.op.toString()+" {"+t.getFilters().map(wI).join(" ,")+"}"}(n):"Filter"}class aN extends At{constructor(e,t,r){super(e,t,r),this.key=ye.fromName(r.referenceValue)}matches(e){const t=ye.comparator(e.key,this.key);return this.matchesComparison(t)}}class lN extends At{constructor(e,t){super(e,"in",t),this.keys=EI("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class uN extends At{constructor(e,t){super(e,"not-in",t),this.keys=EI("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function EI(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>ye.fromName(r.referenceValue))}class cN extends At{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return bg(t)&&Lu(t.arrayValue,this.value)}}class hN extends At{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Lu(this.value.arrayValue,t)}}class dN extends At{constructor(e,t){super(e,"not-in",t)}matches(e){if(Lu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Lu(this.value.arrayValue,t)}}class fN extends At{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!bg(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>Lu(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pN{constructor(e,t=null,r=[],s=[],a=null,u=null,h=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=s,this.limit=a,this.startAt=u,this.endAt=h,this.Pe=null}}function r0(n,e=null,t=[],r=[],s=null,a=null,u=null){return new pN(n,e,t,r,s,a,u)}function Ng(n){const e=Ae(n);if(e.Pe===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>bm(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(a){return a.field.canonicalString()+a.dir}(r)).join(","),Ju(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>za(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>za(r)).join(",")),e.Pe=t}return e.Pe}function Dg(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!sN(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!vI(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!n0(n.startAt,e.startAt)&&n0(n.endAt,e.endAt)}function Nm(n){return ye.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xu{constructor(e,t=null,r=[],s=[],a=null,u="F",h=null,f=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=s,this.limit=a,this.limitType=u,this.startAt=h,this.endAt=f,this.Te=null,this.Ie=null,this.de=null,this.startAt,this.endAt}}function mN(n,e,t,r,s,a,u,h){return new Xu(n,e,t,r,s,a,u,h)}function Og(n){return new Xu(n)}function i0(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function TI(n){return n.collectionGroup!==null}function vu(n){const e=Ae(n);if(e.Te===null){e.Te=[];const t=new Set;for(const a of e.explicitOrderBy)e.Te.push(a),t.add(a.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(u){let h=new Lt(Jt.comparator);return u.filters.forEach(f=>{f.getFlattenedFilters().forEach(p=>{p.isInequality()&&(h=h.add(p.field))})}),h})(e).forEach(a=>{t.has(a.canonicalString())||a.isKeyField()||e.Te.push(new dd(a,r))}),t.has(Jt.keyField().canonicalString())||e.Te.push(new dd(Jt.keyField(),r))}return e.Te}function Dr(n){const e=Ae(n);return e.Ie||(e.Ie=gN(e,vu(n))),e.Ie}function gN(n,e){if(n.limitType==="F")return r0(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(s=>{const a=s.dir==="desc"?"asc":"desc";return new dd(s.field,a)});const t=n.endAt?new hd(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new hd(n.startAt.position,n.startAt.inclusive):null;return r0(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function Dm(n,e){const t=n.filters.concat([e]);return new Xu(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function Om(n,e,t){return new Xu(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Gd(n,e){return Dg(Dr(n),Dr(e))&&n.limitType===e.limitType}function II(n){return`${Ng(Dr(n))}|lt:${n.limitType}`}function Ta(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(s=>wI(s)).join(", ")}]`),Ju(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(s=>function(u){return`${u.field.canonicalString()} (${u.dir})`}(s)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(s=>za(s)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(s=>za(s)).join(",")),`Target(${r})`}(Dr(n))}; limitType=${n.limitType})`}function qd(n,e){return e.isFoundDocument()&&function(r,s){const a=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(a):ye.isDocumentKey(r.path)?r.path.isEqual(a):r.path.isImmediateParentOf(a)}(n,e)&&function(r,s){for(const a of vu(r))if(!a.field.isKeyField()&&s.data.field(a.field)===null)return!1;return!0}(n,e)&&function(r,s){for(const a of r.filters)if(!a.matches(s))return!1;return!0}(n,e)&&function(r,s){return!(r.startAt&&!function(u,h,f){const p=t0(u,h,f);return u.inclusive?p<=0:p<0}(r.startAt,vu(r),s)||r.endAt&&!function(u,h,f){const p=t0(u,h,f);return u.inclusive?p>=0:p>0}(r.endAt,vu(r),s))}(n,e)}function _N(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function CI(n){return(e,t)=>{let r=!1;for(const s of vu(n)){const a=yN(s,e,t);if(a!==0)return a;r=r||s.field.isKeyField()}return 0}}function yN(n,e,t){const r=n.field.isKeyField()?ye.comparator(e.key,t.key):function(a,u,h){const f=u.data.field(a),p=h.data.field(a);return f!==null&&p!==null?Ba(f,p):ve(42886)}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return ve(19790,{direction:n.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class To{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[s,a]of r)if(this.equalsFn(s,e))return a}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let a=0;a<s.length;a++)if(this.equalsFn(s[a][0],e))return void(s[a]=[e,t]);s.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[t]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){As(this.inner,(t,r)=>{for(const[s,a]of r)e(s,a)})}isEmpty(){return aI(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vN=new xt(ye.comparator);function Ti(){return vN}const SI=new xt(ye.comparator);function fu(...n){let e=SI;for(const t of n)e=e.insert(t.key,t);return e}function AI(n){let e=SI;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function io(){return wu()}function kI(){return wu()}function wu(){return new To(n=>n.toString(),(n,e)=>n.isEqual(e))}const wN=new xt(ye.comparator),EN=new Lt(ye.comparator);function Me(...n){let e=EN;for(const t of n)e=e.add(t);return e}const TN=new Lt(Re);function IN(){return TN}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lg(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ld(e)?"-0":e}}function RI(n){return{integerValue:""+n}}function CN(n,e){return Jb(e)?RI(e):Lg(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kd{constructor(){this._=void 0}}function SN(n,e,t){return n instanceof Mu?function(s,a){const u={fields:{[cI]:{stringValue:uI},[dI]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return a&&Pg(a)&&(a=Hd(a)),a&&(u.fields[hI]=a),{mapValue:u}}(t,e):n instanceof Vu?PI(n,e):n instanceof Fu?bI(n,e):function(s,a){const u=xI(s,a),h=s0(u)+s0(s.Ee);return Pm(u)&&Pm(s.Ee)?RI(h):Lg(s.serializer,h)}(n,e)}function AN(n,e,t){return n instanceof Vu?PI(n,e):n instanceof Fu?bI(n,e):t}function xI(n,e){return n instanceof fd?function(r){return Pm(r)||function(a){return!!a&&"doubleValue"in a}(r)}(e)?e:{integerValue:0}:null}class Mu extends Kd{}class Vu extends Kd{constructor(e){super(),this.elements=e}}function PI(n,e){const t=NI(e);for(const r of n.elements)t.some(s=>Vr(s,r))||t.push(r);return{arrayValue:{values:t}}}class Fu extends Kd{constructor(e){super(),this.elements=e}}function bI(n,e){let t=NI(e);for(const r of n.elements)t=t.filter(s=>!Vr(s,r));return{arrayValue:{values:t}}}class fd extends Kd{constructor(e,t){super(),this.serializer=e,this.Ee=t}}function s0(n){return vt(n.integerValue||n.doubleValue)}function NI(n){return bg(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kN{constructor(e,t){this.field=e,this.transform=t}}function RN(n,e){return n.field.isEqual(e.field)&&function(r,s){return r instanceof Vu&&s instanceof Vu||r instanceof Fu&&s instanceof Fu?Ua(r.elements,s.elements,Vr):r instanceof fd&&s instanceof fd?Vr(r.Ee,s.Ee):r instanceof Mu&&s instanceof Mu}(n.transform,e.transform)}class xN{constructor(e,t){this.version=e,this.transformResults=t}}class kt{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new kt}static exists(e){return new kt(void 0,e)}static updateTime(e){return new kt(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Gh(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class Qd{}function DI(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new ec(n.key,kt.none()):new Zu(n.key,n.data,kt.none());{const t=n.data,r=dn.empty();let s=new Lt(Jt.comparator);for(let a of e.fields)if(!s.has(a)){let u=t.field(a);u===null&&a.length>1&&(a=a.popLast(),u=t.field(a)),u===null?r.delete(a):r.set(a,u),s=s.add(a)}return new ks(n.key,r,new Ln(s.toArray()),kt.none())}}function PN(n,e,t){n instanceof Zu?function(s,a,u){const h=s.value.clone(),f=a0(s.fieldTransforms,a,u.transformResults);h.setAll(f),a.convertToFoundDocument(u.version,h).setHasCommittedMutations()}(n,e,t):n instanceof ks?function(s,a,u){if(!Gh(s.precondition,a))return void a.convertToUnknownDocument(u.version);const h=a0(s.fieldTransforms,a,u.transformResults),f=a.data;f.setAll(OI(s)),f.setAll(h),a.convertToFoundDocument(u.version,f).setHasCommittedMutations()}(n,e,t):function(s,a,u){a.convertToNoDocument(u.version).setHasCommittedMutations()}(0,e,t)}function Eu(n,e,t,r){return n instanceof Zu?function(a,u,h,f){if(!Gh(a.precondition,u))return h;const p=a.value.clone(),y=l0(a.fieldTransforms,f,u);return p.setAll(y),u.convertToFoundDocument(u.version,p).setHasLocalMutations(),null}(n,e,t,r):n instanceof ks?function(a,u,h,f){if(!Gh(a.precondition,u))return h;const p=l0(a.fieldTransforms,f,u),y=u.data;return y.setAll(OI(a)),y.setAll(p),u.convertToFoundDocument(u.version,y).setHasLocalMutations(),h===null?null:h.unionWith(a.fieldMask.fields).unionWith(a.fieldTransforms.map(v=>v.field))}(n,e,t,r):function(a,u,h){return Gh(a.precondition,u)?(u.convertToNoDocument(u.version).setHasLocalMutations(),null):h}(n,e,t)}function bN(n,e){let t=null;for(const r of n.fieldTransforms){const s=e.data.field(r.field),a=xI(r.transform,s||null);a!=null&&(t===null&&(t=dn.empty()),t.set(r.field,a))}return t||null}function o0(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&Ua(r,s,(a,u)=>RN(a,u))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class Zu extends Qd{constructor(e,t,r,s=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class ks extends Qd{constructor(e,t,r,s,a=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=s,this.fieldTransforms=a,this.type=1}getFieldMask(){return this.fieldMask}}function OI(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}}),e}function a0(n,e,t){const r=new Map;ze(n.length===t.length,32656,{Ae:t.length,Re:n.length});for(let s=0;s<t.length;s++){const a=n[s],u=a.transform,h=e.data.field(a.field);r.set(a.field,AN(u,h,t[s]))}return r}function l0(n,e,t){const r=new Map;for(const s of n){const a=s.transform,u=t.data.field(s.field);r.set(s.field,SN(a,u,e))}return r}class ec extends Qd{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class LI extends Qd{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NN{constructor(e,t,r,s){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let s=0;s<this.mutations.length;s++){const a=this.mutations[s];a.key.isEqual(e.key)&&PN(a,e,r[s])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=Eu(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=Eu(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=kI();return this.mutations.forEach(s=>{const a=e.get(s.key),u=a.overlayedDocument;let h=this.applyToLocalView(u,a.mutatedFields);h=t.has(s.key)?null:h;const f=DI(u,h);f!==null&&r.set(s.key,f),u.isValidDocument()||u.convertToNoDocument(Ie.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),Me())}isEqual(e){return this.batchId===e.batchId&&Ua(this.mutations,e.mutations,(t,r)=>o0(t,r))&&Ua(this.baseMutations,e.baseMutations,(t,r)=>o0(t,r))}}class Mg{constructor(e,t,r,s){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=s}static from(e,t,r){ze(e.mutations.length===r.length,58842,{Ve:e.mutations.length,me:r.length});let s=function(){return wN}();const a=e.mutations;for(let u=0;u<a.length;u++)s=s.insert(a[u].key,r[u].version);return new Mg(e,t,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DN{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ON{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ct,Ue;function MI(n){switch(n){case Y.OK:return ve(64938);case Y.CANCELLED:case Y.UNKNOWN:case Y.DEADLINE_EXCEEDED:case Y.RESOURCE_EXHAUSTED:case Y.INTERNAL:case Y.UNAVAILABLE:case Y.UNAUTHENTICATED:return!1;case Y.INVALID_ARGUMENT:case Y.NOT_FOUND:case Y.ALREADY_EXISTS:case Y.PERMISSION_DENIED:case Y.FAILED_PRECONDITION:case Y.ABORTED:case Y.OUT_OF_RANGE:case Y.UNIMPLEMENTED:case Y.DATA_LOSS:return!0;default:return ve(15467,{code:n})}}function VI(n){if(n===void 0)return Ei("GRPC error has no .code"),Y.UNKNOWN;switch(n){case Ct.OK:return Y.OK;case Ct.CANCELLED:return Y.CANCELLED;case Ct.UNKNOWN:return Y.UNKNOWN;case Ct.DEADLINE_EXCEEDED:return Y.DEADLINE_EXCEEDED;case Ct.RESOURCE_EXHAUSTED:return Y.RESOURCE_EXHAUSTED;case Ct.INTERNAL:return Y.INTERNAL;case Ct.UNAVAILABLE:return Y.UNAVAILABLE;case Ct.UNAUTHENTICATED:return Y.UNAUTHENTICATED;case Ct.INVALID_ARGUMENT:return Y.INVALID_ARGUMENT;case Ct.NOT_FOUND:return Y.NOT_FOUND;case Ct.ALREADY_EXISTS:return Y.ALREADY_EXISTS;case Ct.PERMISSION_DENIED:return Y.PERMISSION_DENIED;case Ct.FAILED_PRECONDITION:return Y.FAILED_PRECONDITION;case Ct.ABORTED:return Y.ABORTED;case Ct.OUT_OF_RANGE:return Y.OUT_OF_RANGE;case Ct.UNIMPLEMENTED:return Y.UNIMPLEMENTED;case Ct.DATA_LOSS:return Y.DATA_LOSS;default:return ve(39323,{code:n})}}(Ue=Ct||(Ct={}))[Ue.OK=0]="OK",Ue[Ue.CANCELLED=1]="CANCELLED",Ue[Ue.UNKNOWN=2]="UNKNOWN",Ue[Ue.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ue[Ue.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ue[Ue.NOT_FOUND=5]="NOT_FOUND",Ue[Ue.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ue[Ue.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ue[Ue.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ue[Ue.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ue[Ue.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ue[Ue.ABORTED=10]="ABORTED",Ue[Ue.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ue[Ue.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ue[Ue.INTERNAL=13]="INTERNAL",Ue[Ue.UNAVAILABLE=14]="UNAVAILABLE",Ue[Ue.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LN=new as([4294967295,4294967295],0);function u0(n){const e=rI().encode(n),t=new QT;return t.update(e),new Uint8Array(t.digest())}function c0(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),a=e.getUint32(12,!0);return[new as([t,r],0),new as([s,a],0)]}class Vg{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new pu(`Invalid padding: ${t}`);if(r<0)throw new pu(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new pu(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new pu(`Invalid padding when bitmap length is 0: ${t}`);this.fe=8*e.length-t,this.ge=as.fromNumber(this.fe)}pe(e,t,r){let s=e.add(t.multiply(as.fromNumber(r)));return s.compare(LN)===1&&(s=new as([s.getBits(0),s.getBits(1)],0)),s.modulo(this.ge).toNumber()}ye(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.fe===0)return!1;const t=u0(e),[r,s]=c0(t);for(let a=0;a<this.hashCount;a++){const u=this.pe(r,s,a);if(!this.ye(u))return!1}return!0}static create(e,t,r){const s=e%8==0?0:8-e%8,a=new Uint8Array(Math.ceil(e/8)),u=new Vg(a,s,t);return r.forEach(h=>u.insert(h)),u}insert(e){if(this.fe===0)return;const t=u0(e),[r,s]=c0(t);for(let a=0;a<this.hashCount;a++){const u=this.pe(r,s,a);this.we(u)}}we(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class pu extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yd{constructor(e,t,r,s,a){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=a}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const s=new Map;return s.set(e,tc.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new Yd(Ie.min(),s,new xt(Re),Ti(),Me())}}class tc{constructor(e,t,r,s,a){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=a}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new tc(r,t,Me(),Me(),Me())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qh{constructor(e,t,r,s){this.Se=e,this.removedTargetIds=t,this.key=r,this.be=s}}class FI{constructor(e,t){this.targetId=e,this.De=t}}class jI{constructor(e,t,r=Zt.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=s}}class h0{constructor(){this.ve=0,this.Ce=d0(),this.Fe=Zt.EMPTY_BYTE_STRING,this.Me=!1,this.xe=!0}get current(){return this.Me}get resumeToken(){return this.Fe}get Oe(){return this.ve!==0}get Ne(){return this.xe}Be(e){e.approximateByteSize()>0&&(this.xe=!0,this.Fe=e)}Le(){let e=Me(),t=Me(),r=Me();return this.Ce.forEach((s,a)=>{switch(a){case 0:e=e.add(s);break;case 2:t=t.add(s);break;case 1:r=r.add(s);break;default:ve(38017,{changeType:a})}}),new tc(this.Fe,this.Me,e,t,r)}ke(){this.xe=!1,this.Ce=d0()}qe(e,t){this.xe=!0,this.Ce=this.Ce.insert(e,t)}Qe(e){this.xe=!0,this.Ce=this.Ce.remove(e)}$e(){this.ve+=1}Ue(){this.ve-=1,ze(this.ve>=0,3241,{ve:this.ve})}Ke(){this.xe=!0,this.Me=!0}}class MN{constructor(e){this.We=e,this.Ge=new Map,this.ze=Ti(),this.je=Dh(),this.Je=Dh(),this.He=new xt(Re)}Ye(e){for(const t of e.Se)e.be&&e.be.isFoundDocument()?this.Ze(t,e.be):this.Xe(t,e.key,e.be);for(const t of e.removedTargetIds)this.Xe(t,e.key,e.be)}et(e){this.forEachTarget(e,t=>{const r=this.tt(t);switch(e.state){case 0:this.nt(t)&&r.Be(e.resumeToken);break;case 1:r.Ue(),r.Oe||r.ke(),r.Be(e.resumeToken);break;case 2:r.Ue(),r.Oe||this.removeTarget(t);break;case 3:this.nt(t)&&(r.Ke(),r.Be(e.resumeToken));break;case 4:this.nt(t)&&(this.rt(t),r.Be(e.resumeToken));break;default:ve(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Ge.forEach((r,s)=>{this.nt(s)&&t(s)})}it(e){const t=e.targetId,r=e.De.count,s=this.st(t);if(s){const a=s.target;if(Nm(a))if(r===0){const u=new ye(a.path);this.Xe(t,u,Wt.newNoDocument(u,Ie.min()))}else ze(r===1,20013,{expectedCount:r});else{const u=this.ot(t);if(u!==r){const h=this._t(e),f=h?this.ut(h,e,u):1;if(f!==0){this.rt(t);const p=f===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.He=this.He.insert(t,p)}}}}}_t(e){const t=e.De.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:a=0}=t;let u,h;try{u=_s(r).toUint8Array()}catch(f){if(f instanceof lI)return ps("Decoding the base64 bloom filter in existence filter failed ("+f.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw f}try{h=new Vg(u,s,a)}catch(f){return ps(f instanceof pu?"BloomFilter error: ":"Applying bloom filter failed: ",f),null}return h.fe===0?null:h}ut(e,t,r){return t.De.count===r-this.ht(e,t.targetId)?0:2}ht(e,t){const r=this.We.getRemoteKeysForTarget(t);let s=0;return r.forEach(a=>{const u=this.We.lt(),h=`projects/${u.projectId}/databases/${u.database}/documents/${a.path.canonicalString()}`;e.mightContain(h)||(this.Xe(t,a,null),s++)}),s}Pt(e){const t=new Map;this.Ge.forEach((a,u)=>{const h=this.st(u);if(h){if(a.current&&Nm(h.target)){const f=new ye(h.target.path);this.Tt(f).has(u)||this.It(u,f)||this.Xe(u,f,Wt.newNoDocument(f,e))}a.Ne&&(t.set(u,a.Le()),a.ke())}});let r=Me();this.Je.forEach((a,u)=>{let h=!0;u.forEachWhile(f=>{const p=this.st(f);return!p||p.purpose==="TargetPurposeLimboResolution"||(h=!1,!1)}),h&&(r=r.add(a))}),this.ze.forEach((a,u)=>u.setReadTime(e));const s=new Yd(e,t,this.He,this.ze,r);return this.ze=Ti(),this.je=Dh(),this.Je=Dh(),this.He=new xt(Re),s}Ze(e,t){if(!this.nt(e))return;const r=this.It(e,t.key)?2:0;this.tt(e).qe(t.key,r),this.ze=this.ze.insert(t.key,t),this.je=this.je.insert(t.key,this.Tt(t.key).add(e)),this.Je=this.Je.insert(t.key,this.dt(t.key).add(e))}Xe(e,t,r){if(!this.nt(e))return;const s=this.tt(e);this.It(e,t)?s.qe(t,1):s.Qe(t),this.Je=this.Je.insert(t,this.dt(t).delete(e)),this.Je=this.Je.insert(t,this.dt(t).add(e)),r&&(this.ze=this.ze.insert(t,r))}removeTarget(e){this.Ge.delete(e)}ot(e){const t=this.tt(e).Le();return this.We.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.tt(e).$e()}tt(e){let t=this.Ge.get(e);return t||(t=new h0,this.Ge.set(e,t)),t}dt(e){let t=this.Je.get(e);return t||(t=new Lt(Re),this.Je=this.Je.insert(e,t)),t}Tt(e){let t=this.je.get(e);return t||(t=new Lt(Re),this.je=this.je.insert(e,t)),t}nt(e){const t=this.st(e)!==null;return t||de("WatchChangeAggregator","Detected inactive target",e),t}st(e){const t=this.Ge.get(e);return t&&t.Oe?null:this.We.Et(e)}rt(e){this.Ge.set(e,new h0),this.We.getRemoteKeysForTarget(e).forEach(t=>{this.Xe(e,t,null)})}It(e,t){return this.We.getRemoteKeysForTarget(e).has(t)}}function Dh(){return new xt(ye.comparator)}function d0(){return new xt(ye.comparator)}const VN={asc:"ASCENDING",desc:"DESCENDING"},FN={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},jN={and:"AND",or:"OR"};class UN{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Lm(n,e){return n.useProto3Json||Ju(e)?e:{value:e}}function pd(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function UI(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function BN(n,e){return pd(n,e.toTimestamp())}function Mn(n){return ze(!!n,49232),Ie.fromTimestamp(function(t){const r=gs(t);return new ut(r.seconds,r.nanos)}(n))}function Fg(n,e){return Mm(n,e).canonicalString()}function Mm(n,e){const t=function(s){return new Je(["projects",s.projectId,"databases",s.database])}(n).child("documents");return e===void 0?t:t.child(e)}function BI(n){const e=Je.fromString(n);return ze(qI(e),10190,{key:e.toString()}),e}function md(n,e){return Fg(n.databaseId,e.path)}function Tu(n,e){const t=BI(e);if(t.get(1)!==n.databaseId.projectId)throw new ue(Y.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new ue(Y.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new ye($I(t))}function zI(n,e){return Fg(n.databaseId,e)}function zN(n){const e=BI(n);return e.length===4?Je.emptyPath():$I(e)}function Vm(n){return new Je(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function $I(n){return ze(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function f0(n,e,t){return{name:md(n,e),fields:t.value.mapValue.fields}}function $N(n,e){return"found"in e?function(r,s){ze(!!s.found,43571),s.found.name,s.found.updateTime;const a=Tu(r,s.found.name),u=Mn(s.found.updateTime),h=s.found.createTime?Mn(s.found.createTime):Ie.min(),f=new dn({mapValue:{fields:s.found.fields}});return Wt.newFoundDocument(a,u,h,f)}(n,e):"missing"in e?function(r,s){ze(!!s.missing,3894),ze(!!s.readTime,22933);const a=Tu(r,s.missing),u=Mn(s.readTime);return Wt.newNoDocument(a,u)}(n,e):ve(7234,{result:e})}function WN(n,e){let t;if("targetChange"in e){e.targetChange;const r=function(p){return p==="NO_CHANGE"?0:p==="ADD"?1:p==="REMOVE"?2:p==="CURRENT"?3:p==="RESET"?4:ve(39313,{state:p})}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],a=function(p,y){return p.useProto3Json?(ze(y===void 0||typeof y=="string",58123),Zt.fromBase64String(y||"")):(ze(y===void 0||y instanceof Buffer||y instanceof Uint8Array,16193),Zt.fromUint8Array(y||new Uint8Array))}(n,e.targetChange.resumeToken),u=e.targetChange.cause,h=u&&function(p){const y=p.code===void 0?Y.UNKNOWN:VI(p.code);return new ue(y,p.message||"")}(u);t=new jI(r,s,a,h||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=Tu(n,r.document.name),a=Mn(r.document.updateTime),u=r.document.createTime?Mn(r.document.createTime):Ie.min(),h=new dn({mapValue:{fields:r.document.fields}}),f=Wt.newFoundDocument(s,a,u,h),p=r.targetIds||[],y=r.removedTargetIds||[];t=new qh(p,y,f.key,f)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=Tu(n,r.document),a=r.readTime?Mn(r.readTime):Ie.min(),u=Wt.newNoDocument(s,a),h=r.removedTargetIds||[];t=new qh([],h,u.key,u)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=Tu(n,r.document),a=r.removedTargetIds||[];t=new qh([],a,s,null)}else{if(!("filter"in e))return ve(11601,{At:e});{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:a}=r,u=new ON(s,a),h=r.targetId;t=new FI(h,u)}}return t}function WI(n,e){let t;if(e instanceof Zu)t={update:f0(n,e.key,e.value)};else if(e instanceof ec)t={delete:md(n,e.key)};else if(e instanceof ks)t={update:f0(n,e.key,e.data),updateMask:ZN(e.fieldMask)};else{if(!(e instanceof LI))return ve(16599,{Rt:e.type});t={verify:md(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(a,u){const h=u.transform;if(h instanceof Mu)return{fieldPath:u.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(h instanceof Vu)return{fieldPath:u.field.canonicalString(),appendMissingElements:{values:h.elements}};if(h instanceof Fu)return{fieldPath:u.field.canonicalString(),removeAllFromArray:{values:h.elements}};if(h instanceof fd)return{fieldPath:u.field.canonicalString(),increment:h.Ee};throw ve(20930,{transform:u.transform})}(0,r))),e.precondition.isNone||(t.currentDocument=function(s,a){return a.updateTime!==void 0?{updateTime:BN(s,a.updateTime)}:a.exists!==void 0?{exists:a.exists}:ve(27497)}(n,e.precondition)),t}function HN(n,e){return n&&n.length>0?(ze(e!==void 0,14353),n.map(t=>function(s,a){let u=s.updateTime?Mn(s.updateTime):Mn(a);return u.isEqual(Ie.min())&&(u=Mn(a)),new xN(u,s.transformResults||[])}(t,e))):[]}function GN(n,e){return{documents:[zI(n,e.path)]}}function qN(n,e){const t={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=zI(n,s);const a=function(p){if(p.length!==0)return GI(pr.create(p,"and"))}(e.filters);a&&(t.structuredQuery.where=a);const u=function(p){if(p.length!==0)return p.map(y=>function(E){return{field:Ia(E.field),direction:YN(E.dir)}}(y))}(e.orderBy);u&&(t.structuredQuery.orderBy=u);const h=Lm(n,e.limit);return h!==null&&(t.structuredQuery.limit=h),e.startAt&&(t.structuredQuery.startAt=function(p){return{before:p.inclusive,values:p.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(p){return{before:!p.inclusive,values:p.position}}(e.endAt)),{Vt:t,parent:s}}function KN(n){let e=zN(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let s=null;if(r>0){ze(r===1,65062);const y=t.from[0];y.allDescendants?s=y.collectionId:e=e.child(y.collectionId)}let a=[];t.where&&(a=function(v){const E=HI(v);return E instanceof pr&&yI(E)?E.getFilters():[E]}(t.where));let u=[];t.orderBy&&(u=function(v){return v.map(E=>function(R){return new dd(Ca(R.field),function(O){switch(O){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(R.direction))}(E))}(t.orderBy));let h=null;t.limit&&(h=function(v){let E;return E=typeof v=="object"?v.value:v,Ju(E)?null:E}(t.limit));let f=null;t.startAt&&(f=function(v){const E=!!v.before,S=v.values||[];return new hd(S,E)}(t.startAt));let p=null;return t.endAt&&(p=function(v){const E=!v.before,S=v.values||[];return new hd(S,E)}(t.endAt)),mN(e,s,u,a,h,"F",f,p)}function QN(n,e){const t=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ve(28987,{purpose:s})}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function HI(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=Ca(t.unaryFilter.field);return At.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=Ca(t.unaryFilter.field);return At.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const a=Ca(t.unaryFilter.field);return At.create(a,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const u=Ca(t.unaryFilter.field);return At.create(u,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return ve(61313);default:return ve(60726)}}(n):n.fieldFilter!==void 0?function(t){return At.create(Ca(t.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return ve(58110);default:return ve(50506)}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return pr.create(t.compositeFilter.filters.map(r=>HI(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return ve(1026)}}(t.compositeFilter.op))}(n):ve(30097,{filter:n})}function YN(n){return VN[n]}function JN(n){return FN[n]}function XN(n){return jN[n]}function Ia(n){return{fieldPath:n.canonicalString()}}function Ca(n){return Jt.fromServerFormat(n.fieldPath)}function GI(n){return n instanceof At?function(t){if(t.op==="=="){if(e0(t.value))return{unaryFilter:{field:Ia(t.field),op:"IS_NAN"}};if(Zw(t.value))return{unaryFilter:{field:Ia(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(e0(t.value))return{unaryFilter:{field:Ia(t.field),op:"IS_NOT_NAN"}};if(Zw(t.value))return{unaryFilter:{field:Ia(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ia(t.field),op:JN(t.op),value:t.value}}}(n):n instanceof pr?function(t){const r=t.getFilters().map(s=>GI(s));return r.length===1?r[0]:{compositeFilter:{op:XN(t.op),filters:r}}}(n):ve(54877,{filter:n})}function ZN(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function qI(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rs{constructor(e,t,r,s,a=Ie.min(),u=Ie.min(),h=Zt.EMPTY_BYTE_STRING,f=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=u,this.resumeToken=h,this.expectedCount=f}withSequenceNumber(e){return new rs(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new rs(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new rs(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new rs(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e2{constructor(e){this.gt=e}}function t2(n){const e=KN({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Om(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n2{constructor(){this.Dn=new r2}addToCollectionParentIndex(e,t){return this.Dn.add(t),X.resolve()}getCollectionParents(e,t){return X.resolve(this.Dn.getEntries(t))}addFieldIndex(e,t){return X.resolve()}deleteFieldIndex(e,t){return X.resolve()}deleteAllFieldIndexes(e){return X.resolve()}createTargetIndexes(e,t){return X.resolve()}getDocumentsMatchingTarget(e,t){return X.resolve(null)}getIndexType(e,t){return X.resolve(0)}getFieldIndexes(e,t){return X.resolve([])}getNextCollectionGroupToUpdate(e){return X.resolve(null)}getMinOffset(e,t){return X.resolve(ms.min())}getMinOffsetFromCollectionGroup(e,t){return X.resolve(ms.min())}updateCollectionGroup(e,t,r){return X.resolve()}updateIndexEntries(e,t){return X.resolve()}}class r2{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),s=this.index[t]||new Lt(Je.comparator),a=!s.has(r);return this.index[t]=s.add(r),a}has(e){const t=e.lastSegment(),r=e.popLast(),s=this.index[t];return s&&s.has(r)}getEntries(e){return(this.index[e]||new Lt(Je.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p0={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},KI=41943040;class En{static withCacheSize(e){return new En(e,En.DEFAULT_COLLECTION_PERCENTILE,En.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */En.DEFAULT_COLLECTION_PERCENTILE=10,En.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,En.DEFAULT=new En(KI,En.DEFAULT_COLLECTION_PERCENTILE,En.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),En.DISABLED=new En(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $a{constructor(e){this._r=e}next(){return this._r+=2,this._r}static ar(){return new $a(0)}static ur(){return new $a(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m0="LruGarbageCollector",i2=1048576;function g0([n,e],[t,r]){const s=Re(n,t);return s===0?Re(e,r):s}class s2{constructor(e){this.Tr=e,this.buffer=new Lt(g0),this.Ir=0}dr(){return++this.Ir}Er(e){const t=[e,this.dr()];if(this.buffer.size<this.Tr)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();g0(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class o2{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Ar=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Rr(6e4)}stop(){this.Ar&&(this.Ar.cancel(),this.Ar=null)}get started(){return this.Ar!==null}Rr(e){de(m0,`Garbage collection scheduled in ${e}ms`),this.Ar=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Ar=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){tl(t)?de(m0,"Ignoring IndexedDB error during garbage collection: ",t):await el(t)}await this.Rr(3e5)})}}class a2{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.mr(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(t===0)return X.resolve(Wd.ue);const r=new s2(t);return this.Vr.forEachTarget(e,s=>r.Er(s.sequenceNumber)).next(()=>this.Vr.gr(e,s=>r.Er(s))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.Vr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(de("LruGarbageCollector","Garbage collection skipped; disabled"),X.resolve(p0)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(de("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),p0):this.pr(e,t))}getCacheSize(e){return this.Vr.getCacheSize(e)}pr(e,t){let r,s,a,u,h,f,p;const y=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(v=>(v>this.params.maximumSequenceNumbersToCollect?(de("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${v}`),s=this.params.maximumSequenceNumbersToCollect):s=v,u=Date.now(),this.nthSequenceNumber(e,s))).next(v=>(r=v,h=Date.now(),this.removeTargets(e,r,t))).next(v=>(a=v,f=Date.now(),this.removeOrphanedDocuments(e,r))).next(v=>(p=Date.now(),Ea()<=be.DEBUG&&de("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${u-y}ms
	Determined least recently used ${s} in `+(h-u)+`ms
	Removed ${a} targets in `+(f-h)+`ms
	Removed ${v} documents in `+(p-f)+`ms
Total Duration: ${p-y}ms`),X.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:a,documentsRemoved:v})))}}function l2(n,e){return new a2(n,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u2{constructor(){this.changes=new To(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Wt.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?X.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c2{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h2{constructor(e,t,r,s){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,t))).next(s=>(r!==null&&Eu(r.mutation,s,Ln.empty(),ut.now()),s))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,Me()).next(()=>r))}getLocalViewOfDocuments(e,t,r=Me()){const s=io();return this.populateOverlays(e,s,t).next(()=>this.computeViews(e,t,s,r).next(a=>{let u=fu();return a.forEach((h,f)=>{u=u.insert(h,f.overlayedDocument)}),u}))}getOverlayedDocuments(e,t){const r=io();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,Me()))}populateOverlays(e,t,r){const s=[];return r.forEach(a=>{t.has(a)||s.push(a)}),this.documentOverlayCache.getOverlays(e,s).next(a=>{a.forEach((u,h)=>{t.set(u,h)})})}computeViews(e,t,r,s){let a=Ti();const u=wu(),h=function(){return wu()}();return t.forEach((f,p)=>{const y=r.get(p.key);s.has(p.key)&&(y===void 0||y.mutation instanceof ks)?a=a.insert(p.key,p):y!==void 0?(u.set(p.key,y.mutation.getFieldMask()),Eu(y.mutation,p,y.mutation.getFieldMask(),ut.now())):u.set(p.key,Ln.empty())}),this.recalculateAndSaveOverlays(e,a).next(f=>(f.forEach((p,y)=>u.set(p,y)),t.forEach((p,y)=>{var v;return h.set(p,new c2(y,(v=u.get(p))!==null&&v!==void 0?v:null))}),h))}recalculateAndSaveOverlays(e,t){const r=wu();let s=new xt((u,h)=>u-h),a=Me();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(u=>{for(const h of u)h.keys().forEach(f=>{const p=t.get(f);if(p===null)return;let y=r.get(f)||Ln.empty();y=h.applyToLocalView(p,y),r.set(f,y);const v=(s.get(h.batchId)||Me()).add(f);s=s.insert(h.batchId,v)})}).next(()=>{const u=[],h=s.getReverseIterator();for(;h.hasNext();){const f=h.getNext(),p=f.key,y=f.value,v=kI();y.forEach(E=>{if(!a.has(E)){const S=DI(t.get(E),r.get(E));S!==null&&v.set(E,S),a=a.add(E)}}),u.push(this.documentOverlayCache.saveOverlays(e,p,v))}return X.waitFor(u)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,s){return function(u){return ye.isDocumentKey(u.path)&&u.collectionGroup===null&&u.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):TI(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,s):this.getDocumentsMatchingCollectionQuery(e,t,r,s)}getNextDocuments(e,t,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,s).next(a=>{const u=s-a.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,s-a.size):X.resolve(io());let h=Nu,f=a;return u.next(p=>X.forEach(p,(y,v)=>(h<v.largestBatchId&&(h=v.largestBatchId),a.get(y)?X.resolve():this.remoteDocumentCache.getEntry(e,y).next(E=>{f=f.insert(y,E)}))).next(()=>this.populateOverlays(e,p,a)).next(()=>this.computeViews(e,f,p,Me())).next(y=>({batchId:h,changes:AI(y)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new ye(t)).next(r=>{let s=fu();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,t,r,s){const a=t.collectionGroup;let u=fu();return this.indexManager.getCollectionParents(e,a).next(h=>X.forEach(h,f=>{const p=function(v,E){return new Xu(E,null,v.explicitOrderBy.slice(),v.filters.slice(),v.limit,v.limitType,v.startAt,v.endAt)}(t,f.child(a));return this.getDocumentsMatchingCollectionQuery(e,p,r,s).next(y=>{y.forEach((v,E)=>{u=u.insert(v,E)})})}).next(()=>u))}getDocumentsMatchingCollectionQuery(e,t,r,s){let a;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(u=>(a=u,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,a,s))).next(u=>{a.forEach((f,p)=>{const y=p.getKey();u.get(y)===null&&(u=u.insert(y,Wt.newInvalidDocument(y)))});let h=fu();return u.forEach((f,p)=>{const y=a.get(f);y!==void 0&&Eu(y.mutation,p,Ln.empty(),ut.now()),qd(t,p)&&(h=h.insert(f,p))}),h})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d2{constructor(e){this.serializer=e,this.Br=new Map,this.Lr=new Map}getBundleMetadata(e,t){return X.resolve(this.Br.get(t))}saveBundleMetadata(e,t){return this.Br.set(t.id,function(s){return{id:s.id,version:s.version,createTime:Mn(s.createTime)}}(t)),X.resolve()}getNamedQuery(e,t){return X.resolve(this.Lr.get(t))}saveNamedQuery(e,t){return this.Lr.set(t.name,function(s){return{name:s.name,query:t2(s.bundledQuery),readTime:Mn(s.readTime)}}(t)),X.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f2{constructor(){this.overlays=new xt(ye.comparator),this.kr=new Map}getOverlay(e,t){return X.resolve(this.overlays.get(t))}getOverlays(e,t){const r=io();return X.forEach(t,s=>this.getOverlay(e,s).next(a=>{a!==null&&r.set(s,a)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((s,a)=>{this.wt(e,t,a)}),X.resolve()}removeOverlaysForBatchId(e,t,r){const s=this.kr.get(r);return s!==void 0&&(s.forEach(a=>this.overlays=this.overlays.remove(a)),this.kr.delete(r)),X.resolve()}getOverlaysForCollection(e,t,r){const s=io(),a=t.length+1,u=new ye(t.child("")),h=this.overlays.getIteratorFrom(u);for(;h.hasNext();){const f=h.getNext().value,p=f.getKey();if(!t.isPrefixOf(p.path))break;p.path.length===a&&f.largestBatchId>r&&s.set(f.getKey(),f)}return X.resolve(s)}getOverlaysForCollectionGroup(e,t,r,s){let a=new xt((p,y)=>p-y);const u=this.overlays.getIterator();for(;u.hasNext();){const p=u.getNext().value;if(p.getKey().getCollectionGroup()===t&&p.largestBatchId>r){let y=a.get(p.largestBatchId);y===null&&(y=io(),a=a.insert(p.largestBatchId,y)),y.set(p.getKey(),p)}}const h=io(),f=a.getIterator();for(;f.hasNext()&&(f.getNext().value.forEach((p,y)=>h.set(p,y)),!(h.size()>=s)););return X.resolve(h)}wt(e,t,r){const s=this.overlays.get(r.key);if(s!==null){const u=this.kr.get(s.largestBatchId).delete(r.key);this.kr.set(s.largestBatchId,u)}this.overlays=this.overlays.insert(r.key,new DN(t,r));let a=this.kr.get(t);a===void 0&&(a=Me(),this.kr.set(t,a)),this.kr.set(t,a.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p2{constructor(){this.sessionToken=Zt.EMPTY_BYTE_STRING}getSessionToken(e){return X.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,X.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jg{constructor(){this.qr=new Lt(zt.Qr),this.$r=new Lt(zt.Ur)}isEmpty(){return this.qr.isEmpty()}addReference(e,t){const r=new zt(e,t);this.qr=this.qr.add(r),this.$r=this.$r.add(r)}Kr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Wr(new zt(e,t))}Gr(e,t){e.forEach(r=>this.removeReference(r,t))}zr(e){const t=new ye(new Je([])),r=new zt(t,e),s=new zt(t,e+1),a=[];return this.$r.forEachInRange([r,s],u=>{this.Wr(u),a.push(u.key)}),a}jr(){this.qr.forEach(e=>this.Wr(e))}Wr(e){this.qr=this.qr.delete(e),this.$r=this.$r.delete(e)}Jr(e){const t=new ye(new Je([])),r=new zt(t,e),s=new zt(t,e+1);let a=Me();return this.$r.forEachInRange([r,s],u=>{a=a.add(u.key)}),a}containsKey(e){const t=new zt(e,0),r=this.qr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class zt{constructor(e,t){this.key=e,this.Hr=t}static Qr(e,t){return ye.comparator(e.key,t.key)||Re(e.Hr,t.Hr)}static Ur(e,t){return Re(e.Hr,t.Hr)||ye.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m2{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.er=1,this.Yr=new Lt(zt.Qr)}checkEmpty(e){return X.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,s){const a=this.er;this.er++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const u=new NN(a,t,r,s);this.mutationQueue.push(u);for(const h of s)this.Yr=this.Yr.add(new zt(h.key,a)),this.indexManager.addToCollectionParentIndex(e,h.key.path.popLast());return X.resolve(u)}lookupMutationBatch(e,t){return X.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,s=this.Xr(r),a=s<0?0:s;return X.resolve(this.mutationQueue.length>a?this.mutationQueue[a]:null)}getHighestUnacknowledgedBatchId(){return X.resolve(this.mutationQueue.length===0?xg:this.er-1)}getAllMutationBatches(e){return X.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new zt(t,0),s=new zt(t,Number.POSITIVE_INFINITY),a=[];return this.Yr.forEachInRange([r,s],u=>{const h=this.Zr(u.Hr);a.push(h)}),X.resolve(a)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Lt(Re);return t.forEach(s=>{const a=new zt(s,0),u=new zt(s,Number.POSITIVE_INFINITY);this.Yr.forEachInRange([a,u],h=>{r=r.add(h.Hr)})}),X.resolve(this.ei(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,s=r.length+1;let a=r;ye.isDocumentKey(a)||(a=a.child(""));const u=new zt(new ye(a),0);let h=new Lt(Re);return this.Yr.forEachWhile(f=>{const p=f.key.path;return!!r.isPrefixOf(p)&&(p.length===s&&(h=h.add(f.Hr)),!0)},u),X.resolve(this.ei(h))}ei(e){const t=[];return e.forEach(r=>{const s=this.Zr(r);s!==null&&t.push(s)}),t}removeMutationBatch(e,t){ze(this.ti(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Yr;return X.forEach(t.mutations,s=>{const a=new zt(s.key,t.batchId);return r=r.delete(a),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.Yr=r})}rr(e){}containsKey(e,t){const r=new zt(t,0),s=this.Yr.firstAfterOrEqual(r);return X.resolve(t.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,X.resolve()}ti(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g2{constructor(e){this.ni=e,this.docs=function(){return new xt(ye.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,s=this.docs.get(r),a=s?s.size:0,u=this.ni(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:u}),this.size+=u-a,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return X.resolve(r?r.document.mutableCopy():Wt.newInvalidDocument(t))}getEntries(e,t){let r=Ti();return t.forEach(s=>{const a=this.docs.get(s);r=r.insert(s,a?a.document.mutableCopy():Wt.newInvalidDocument(s))}),X.resolve(r)}getDocumentsMatchingQuery(e,t,r,s){let a=Ti();const u=t.path,h=new ye(u.child("__id-9223372036854775808__")),f=this.docs.getIteratorFrom(h);for(;f.hasNext();){const{key:p,value:{document:y}}=f.getNext();if(!u.isPrefixOf(p.path))break;p.path.length>u.length+1||qb(Gb(y),r)<=0||(s.has(y.key)||qd(t,y))&&(a=a.insert(y.key,y.mutableCopy()))}return X.resolve(a)}getAllFromCollectionGroup(e,t,r,s){ve(9500)}ri(e,t){return X.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new _2(this)}getSize(e){return X.resolve(this.size)}}class _2 extends u2{constructor(e){super(),this.Or=e}applyChanges(e){const t=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?t.push(this.Or.addEntry(e,s)):this.Or.removeEntry(r)}),X.waitFor(t)}getFromCache(e,t){return this.Or.getEntry(e,t)}getAllFromCache(e,t){return this.Or.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y2{constructor(e){this.persistence=e,this.ii=new To(t=>Ng(t),Dg),this.lastRemoteSnapshotVersion=Ie.min(),this.highestTargetId=0,this.si=0,this.oi=new jg,this.targetCount=0,this._i=$a.ar()}forEachTarget(e,t){return this.ii.forEach((r,s)=>t(s)),X.resolve()}getLastRemoteSnapshotVersion(e){return X.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return X.resolve(this.si)}allocateTargetId(e){return this.highestTargetId=this._i.next(),X.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.si&&(this.si=t),X.resolve()}hr(e){this.ii.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this._i=new $a(t),this.highestTargetId=t),e.sequenceNumber>this.si&&(this.si=e.sequenceNumber)}addTargetData(e,t){return this.hr(t),this.targetCount+=1,X.resolve()}updateTargetData(e,t){return this.hr(t),X.resolve()}removeTargetData(e,t){return this.ii.delete(t.target),this.oi.zr(t.targetId),this.targetCount-=1,X.resolve()}removeTargets(e,t,r){let s=0;const a=[];return this.ii.forEach((u,h)=>{h.sequenceNumber<=t&&r.get(h.targetId)===null&&(this.ii.delete(u),a.push(this.removeMatchingKeysForTargetId(e,h.targetId)),s++)}),X.waitFor(a).next(()=>s)}getTargetCount(e){return X.resolve(this.targetCount)}getTargetData(e,t){const r=this.ii.get(t)||null;return X.resolve(r)}addMatchingKeys(e,t,r){return this.oi.Kr(t,r),X.resolve()}removeMatchingKeys(e,t,r){this.oi.Gr(t,r);const s=this.persistence.referenceDelegate,a=[];return s&&t.forEach(u=>{a.push(s.markPotentiallyOrphaned(e,u))}),X.waitFor(a)}removeMatchingKeysForTargetId(e,t){return this.oi.zr(t),X.resolve()}getMatchingKeysForTargetId(e,t){const r=this.oi.Jr(t);return X.resolve(r)}containsKey(e,t){return X.resolve(this.oi.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QI{constructor(e,t){this.ai={},this.overlays={},this.ui=new Wd(0),this.ci=!1,this.ci=!0,this.li=new p2,this.referenceDelegate=e(this),this.hi=new y2(this),this.indexManager=new n2,this.remoteDocumentCache=function(s){return new g2(s)}(r=>this.referenceDelegate.Pi(r)),this.serializer=new e2(t),this.Ti=new d2(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ci=!1,Promise.resolve()}get started(){return this.ci}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new f2,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.ai[e.toKey()];return r||(r=new m2(t,this.referenceDelegate),this.ai[e.toKey()]=r),r}getGlobalsCache(){return this.li}getTargetCache(){return this.hi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ti}runTransaction(e,t,r){de("MemoryPersistence","Starting transaction:",e);const s=new v2(this.ui.next());return this.referenceDelegate.Ii(),r(s).next(a=>this.referenceDelegate.di(s).next(()=>a)).toPromise().then(a=>(s.raiseOnCommittedEvent(),a))}Ei(e,t){return X.or(Object.values(this.ai).map(r=>()=>r.containsKey(e,t)))}}class v2 extends Qb{constructor(e){super(),this.currentSequenceNumber=e}}class Ug{constructor(e){this.persistence=e,this.Ai=new jg,this.Ri=null}static Vi(e){return new Ug(e)}get mi(){if(this.Ri)return this.Ri;throw ve(60996)}addReference(e,t,r){return this.Ai.addReference(r,t),this.mi.delete(r.toString()),X.resolve()}removeReference(e,t,r){return this.Ai.removeReference(r,t),this.mi.add(r.toString()),X.resolve()}markPotentiallyOrphaned(e,t){return this.mi.add(t.toString()),X.resolve()}removeTarget(e,t){this.Ai.zr(t.targetId).forEach(s=>this.mi.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(s=>{s.forEach(a=>this.mi.add(a.toString()))}).next(()=>r.removeTargetData(e,t))}Ii(){this.Ri=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return X.forEach(this.mi,r=>{const s=ye.fromPath(r);return this.fi(e,s).next(a=>{a||t.removeEntry(s,Ie.min())})}).next(()=>(this.Ri=null,t.apply(e)))}updateLimboDocument(e,t){return this.fi(e,t).next(r=>{r?this.mi.delete(t.toString()):this.mi.add(t.toString())})}Pi(e){return 0}fi(e,t){return X.or([()=>X.resolve(this.Ai.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}}class gd{constructor(e,t){this.persistence=e,this.gi=new To(r=>Xb(r.path),(r,s)=>r.isEqual(s)),this.garbageCollector=l2(this,t)}static Vi(e,t){return new gd(e,t)}Ii(){}di(e){return X.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}mr(e){const t=this.yr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>t.next(s=>r+s))}yr(e){let t=0;return this.gr(e,r=>{t++}).next(()=>t)}gr(e,t){return X.forEach(this.gi,(r,s)=>this.Sr(e,r,s).next(a=>a?X.resolve():t(s)))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0;const s=this.persistence.getRemoteDocumentCache(),a=s.newChangeBuffer();return s.ri(e,u=>this.Sr(e,u,t).next(h=>{h||(r++,a.removeEntry(u,Ie.min()))})).next(()=>a.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,t){return this.gi.set(t,e.currentSequenceNumber),X.resolve()}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.gi.set(r,e.currentSequenceNumber),X.resolve()}removeReference(e,t,r){return this.gi.set(r,e.currentSequenceNumber),X.resolve()}updateLimboDocument(e,t){return this.gi.set(t,e.currentSequenceNumber),X.resolve()}Pi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Wh(e.data.value)),t}Sr(e,t,r){return X.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const s=this.gi.get(t);return X.resolve(s!==void 0&&s>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bg{constructor(e,t,r,s){this.targetId=e,this.fromCache=t,this.Is=r,this.ds=s}static Es(e,t){let r=Me(),s=Me();for(const a of t.docChanges)switch(a.type){case 0:r=r.add(a.doc.key);break;case 1:s=s.add(a.doc.key)}return new Bg(e,t.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w2{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E2{constructor(){this.As=!1,this.Rs=!1,this.Vs=100,this.fs=function(){return QR()?8:Yb(an())>0?6:4}()}initialize(e,t){this.gs=e,this.indexManager=t,this.As=!0}getDocumentsMatchingQuery(e,t,r,s){const a={result:null};return this.ps(e,t).next(u=>{a.result=u}).next(()=>{if(!a.result)return this.ys(e,t,s,r).next(u=>{a.result=u})}).next(()=>{if(a.result)return;const u=new w2;return this.ws(e,t,u).next(h=>{if(a.result=h,this.Rs)return this.Ss(e,t,u,h.size)})}).next(()=>a.result)}Ss(e,t,r,s){return r.documentReadCount<this.Vs?(Ea()<=be.DEBUG&&de("QueryEngine","SDK will not create cache indexes for query:",Ta(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),X.resolve()):(Ea()<=be.DEBUG&&de("QueryEngine","Query:",Ta(t),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.fs*s?(Ea()<=be.DEBUG&&de("QueryEngine","The SDK decides to create cache indexes for query:",Ta(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Dr(t))):X.resolve())}ps(e,t){if(i0(t))return X.resolve(null);let r=Dr(t);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(t.limit!==null&&s===1&&(t=Om(t,null,"F"),r=Dr(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(a=>{const u=Me(...a);return this.gs.getDocuments(e,u).next(h=>this.indexManager.getMinOffset(e,r).next(f=>{const p=this.bs(t,h);return this.Ds(t,p,u,f.readTime)?this.ps(e,Om(t,null,"F")):this.vs(e,p,t,f)}))})))}ys(e,t,r,s){return i0(t)||s.isEqual(Ie.min())?X.resolve(null):this.gs.getDocuments(e,r).next(a=>{const u=this.bs(t,a);return this.Ds(t,u,r,s)?X.resolve(null):(Ea()<=be.DEBUG&&de("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Ta(t)),this.vs(e,u,t,Hb(s,Nu)).next(h=>h))})}bs(e,t){let r=new Lt(CI(e));return t.forEach((s,a)=>{qd(e,a)&&(r=r.add(a))}),r}Ds(e,t,r,s){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const a=e.limitType==="F"?t.last():t.first();return!!a&&(a.hasPendingWrites||a.version.compareTo(s)>0)}ws(e,t,r){return Ea()<=be.DEBUG&&de("QueryEngine","Using full collection scan to execute query:",Ta(t)),this.gs.getDocumentsMatchingQuery(e,t,ms.min(),r)}vs(e,t,r,s){return this.gs.getDocumentsMatchingQuery(e,r,s).next(a=>(t.forEach(u=>{a=a.insert(u.key,u)}),a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zg="LocalStore",T2=3e8;class I2{constructor(e,t,r,s){this.persistence=e,this.Cs=t,this.serializer=s,this.Fs=new xt(Re),this.Ms=new To(a=>Ng(a),Dg),this.xs=new Map,this.Os=e.getRemoteDocumentCache(),this.hi=e.getTargetCache(),this.Ti=e.getBundleCache(),this.Ns(r)}Ns(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new h2(this.Os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Os.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Fs))}}function C2(n,e,t,r){return new I2(n,e,t,r)}async function YI(n,e){const t=Ae(n);return await t.persistence.runTransaction("Handle user change","readonly",r=>{let s;return t.mutationQueue.getAllMutationBatches(r).next(a=>(s=a,t.Ns(e),t.mutationQueue.getAllMutationBatches(r))).next(a=>{const u=[],h=[];let f=Me();for(const p of s){u.push(p.batchId);for(const y of p.mutations)f=f.add(y.key)}for(const p of a){h.push(p.batchId);for(const y of p.mutations)f=f.add(y.key)}return t.localDocuments.getDocuments(r,f).next(p=>({Bs:p,removedBatchIds:u,addedBatchIds:h}))})})}function S2(n,e){const t=Ae(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),a=t.Os.newChangeBuffer({trackRemovals:!0});return function(h,f,p,y){const v=p.batch,E=v.keys();let S=X.resolve();return E.forEach(R=>{S=S.next(()=>y.getEntry(f,R)).next(N=>{const O=p.docVersions.get(R);ze(O!==null,48541),N.version.compareTo(O)<0&&(v.applyToRemoteDocument(N,p),N.isValidDocument()&&(N.setReadTime(p.commitVersion),y.addEntry(N)))})}),S.next(()=>h.mutationQueue.removeMutationBatch(f,v))}(t,r,e,a).next(()=>a.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(h){let f=Me();for(let p=0;p<h.mutationResults.length;++p)h.mutationResults[p].transformResults.length>0&&(f=f.add(h.batch.mutations[p].key));return f}(e))).next(()=>t.localDocuments.getDocuments(r,s))})}function JI(n){const e=Ae(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.hi.getLastRemoteSnapshotVersion(t))}function A2(n,e){const t=Ae(n),r=e.snapshotVersion;let s=t.Fs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",a=>{const u=t.Os.newChangeBuffer({trackRemovals:!0});s=t.Fs;const h=[];e.targetChanges.forEach((y,v)=>{const E=s.get(v);if(!E)return;h.push(t.hi.removeMatchingKeys(a,y.removedDocuments,v).next(()=>t.hi.addMatchingKeys(a,y.addedDocuments,v)));let S=E.withSequenceNumber(a.currentSequenceNumber);e.targetMismatches.get(v)!==null?S=S.withResumeToken(Zt.EMPTY_BYTE_STRING,Ie.min()).withLastLimboFreeSnapshotVersion(Ie.min()):y.resumeToken.approximateByteSize()>0&&(S=S.withResumeToken(y.resumeToken,r)),s=s.insert(v,S),function(N,O,V){return N.resumeToken.approximateByteSize()===0||O.snapshotVersion.toMicroseconds()-N.snapshotVersion.toMicroseconds()>=T2?!0:V.addedDocuments.size+V.modifiedDocuments.size+V.removedDocuments.size>0}(E,S,y)&&h.push(t.hi.updateTargetData(a,S))});let f=Ti(),p=Me();if(e.documentUpdates.forEach(y=>{e.resolvedLimboDocuments.has(y)&&h.push(t.persistence.referenceDelegate.updateLimboDocument(a,y))}),h.push(k2(a,u,e.documentUpdates).next(y=>{f=y.Ls,p=y.ks})),!r.isEqual(Ie.min())){const y=t.hi.getLastRemoteSnapshotVersion(a).next(v=>t.hi.setTargetsMetadata(a,a.currentSequenceNumber,r));h.push(y)}return X.waitFor(h).next(()=>u.apply(a)).next(()=>t.localDocuments.getLocalViewOfDocuments(a,f,p)).next(()=>f)}).then(a=>(t.Fs=s,a))}function k2(n,e,t){let r=Me(),s=Me();return t.forEach(a=>r=r.add(a)),e.getEntries(n,r).next(a=>{let u=Ti();return t.forEach((h,f)=>{const p=a.get(h);f.isFoundDocument()!==p.isFoundDocument()&&(s=s.add(h)),f.isNoDocument()&&f.version.isEqual(Ie.min())?(e.removeEntry(h,f.readTime),u=u.insert(h,f)):!p.isValidDocument()||f.version.compareTo(p.version)>0||f.version.compareTo(p.version)===0&&p.hasPendingWrites?(e.addEntry(f),u=u.insert(h,f)):de(zg,"Ignoring outdated watch update for ",h,". Current version:",p.version," Watch version:",f.version)}),{Ls:u,ks:s}})}function R2(n,e){const t=Ae(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=xg),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function x2(n,e){const t=Ae(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return t.hi.getTargetData(r,e).next(a=>a?(s=a,X.resolve(s)):t.hi.allocateTargetId(r).next(u=>(s=new rs(e,u,"TargetPurposeListen",r.currentSequenceNumber),t.hi.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=t.Fs.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(t.Fs=t.Fs.insert(r.targetId,r),t.Ms.set(e,r.targetId)),r})}async function Fm(n,e,t){const r=Ae(n),s=r.Fs.get(e),a=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",a,u=>r.persistence.referenceDelegate.removeTarget(u,s))}catch(u){if(!tl(u))throw u;de(zg,`Failed to update sequence numbers for target ${e}: ${u}`)}r.Fs=r.Fs.remove(e),r.Ms.delete(s.target)}function _0(n,e,t){const r=Ae(n);let s=Ie.min(),a=Me();return r.persistence.runTransaction("Execute query","readwrite",u=>function(f,p,y){const v=Ae(f),E=v.Ms.get(y);return E!==void 0?X.resolve(v.Fs.get(E)):v.hi.getTargetData(p,y)}(r,u,Dr(e)).next(h=>{if(h)return s=h.lastLimboFreeSnapshotVersion,r.hi.getMatchingKeysForTargetId(u,h.targetId).next(f=>{a=f})}).next(()=>r.Cs.getDocumentsMatchingQuery(u,e,t?s:Ie.min(),t?a:Me())).next(h=>(P2(r,_N(e),h),{documents:h,qs:a})))}function P2(n,e,t){let r=n.xs.get(e)||Ie.min();t.forEach((s,a)=>{a.readTime.compareTo(r)>0&&(r=a.readTime)}),n.xs.set(e,r)}class y0{constructor(){this.activeTargetIds=IN()}Gs(e){this.activeTargetIds=this.activeTargetIds.add(e)}zs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class b2{constructor(){this.Fo=new y0,this.Mo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.Fo.Gs(e),this.Mo[e]||"not-current"}updateQueryState(e,t,r){this.Mo[e]=t}removeLocalQueryTarget(e){this.Fo.zs(e)}isLocalQueryTarget(e){return this.Fo.activeTargetIds.has(e)}clearQueryState(e){delete this.Mo[e]}getAllActiveQueryTargets(){return this.Fo.activeTargetIds}isActiveQueryTarget(e){return this.Fo.activeTargetIds.has(e)}start(){return this.Fo=new y0,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N2{xo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v0="ConnectivityMonitor";class w0{constructor(){this.Oo=()=>this.No(),this.Bo=()=>this.Lo(),this.ko=[],this.qo()}xo(e){this.ko.push(e)}shutdown(){window.removeEventListener("online",this.Oo),window.removeEventListener("offline",this.Bo)}qo(){window.addEventListener("online",this.Oo),window.addEventListener("offline",this.Bo)}No(){de(v0,"Network connectivity changed: AVAILABLE");for(const e of this.ko)e(0)}Lo(){de(v0,"Network connectivity changed: UNAVAILABLE");for(const e of this.ko)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Oh=null;function jm(){return Oh===null?Oh=function(){return 268435456+Math.round(2147483648*Math.random())}():Oh++,"0x"+Oh.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rm="RestConnection",D2={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class O2{get Qo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.$o=t+"://"+e.host,this.Uo=`projects/${r}/databases/${s}`,this.Ko=this.databaseId.database===ud?`project_id=${r}`:`project_id=${r}&database_id=${s}`}Wo(e,t,r,s,a){const u=jm(),h=this.Go(e,t.toUriEncodedString());de(rm,`Sending RPC '${e}' ${u}:`,h,r);const f={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.Ko};this.zo(f,s,a);const{host:p}=new URL(h),y=Is(p);return this.jo(e,h,f,r,y).then(v=>(de(rm,`Received RPC '${e}' ${u}: `,v),v),v=>{throw ps(rm,`RPC '${e}' ${u} failed with error: `,v,"url: ",h,"request:",r),v})}Jo(e,t,r,s,a,u){return this.Wo(e,t,r,s,a)}zo(e,t,r){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Za}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((s,a)=>e[a]=s),r&&r.headers.forEach((s,a)=>e[a]=s)}Go(e,t){const r=D2[e];return`${this.$o}/v1/${t}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L2{constructor(e){this.Ho=e.Ho,this.Yo=e.Yo}Zo(e){this.Xo=e}e_(e){this.t_=e}n_(e){this.r_=e}onMessage(e){this.i_=e}close(){this.Yo()}send(e){this.Ho(e)}s_(){this.Xo()}o_(){this.t_()}__(e){this.r_(e)}a_(e){this.i_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sn="WebChannelConnection";class M2 extends O2{constructor(e){super(e),this.u_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}jo(e,t,r,s,a){const u=jm();return new Promise((h,f)=>{const p=new YT;p.setWithCredentials(!0),p.listenOnce(JT.COMPLETE,()=>{try{switch(p.getLastErrorCode()){case $h.NO_ERROR:const v=p.getResponseJson();de(sn,`XHR for RPC '${e}' ${u} received:`,JSON.stringify(v)),h(v);break;case $h.TIMEOUT:de(sn,`RPC '${e}' ${u} timed out`),f(new ue(Y.DEADLINE_EXCEEDED,"Request time out"));break;case $h.HTTP_ERROR:const E=p.getStatus();if(de(sn,`RPC '${e}' ${u} failed with status:`,E,"response text:",p.getResponseText()),E>0){let S=p.getResponseJson();Array.isArray(S)&&(S=S[0]);const R=S?.error;if(R&&R.status&&R.message){const N=function(V){const K=V.toLowerCase().replace(/_/g,"-");return Object.values(Y).indexOf(K)>=0?K:Y.UNKNOWN}(R.status);f(new ue(N,R.message))}else f(new ue(Y.UNKNOWN,"Server responded with status "+p.getStatus()))}else f(new ue(Y.UNAVAILABLE,"Connection failed."));break;default:ve(9055,{c_:e,streamId:u,l_:p.getLastErrorCode(),h_:p.getLastError()})}}finally{de(sn,`RPC '${e}' ${u} completed.`)}});const y=JSON.stringify(s);de(sn,`RPC '${e}' ${u} sending request:`,s),p.send(t,"POST",y,r,15)})}P_(e,t,r){const s=jm(),a=[this.$o,"/","google.firestore.v1.Firestore","/",e,"/channel"],u=eI(),h=ZT(),f={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},p=this.longPollingOptions.timeoutSeconds;p!==void 0&&(f.longPollingTimeout=Math.round(1e3*p)),this.useFetchStreams&&(f.useFetchStreams=!0),this.zo(f.initMessageHeaders,t,r),f.encodeInitMessageHeaders=!0;const y=a.join("");de(sn,`Creating RPC '${e}' stream ${s}: ${y}`,f);const v=u.createWebChannel(y,f);this.T_(v);let E=!1,S=!1;const R=new L2({Ho:O=>{S?de(sn,`Not sending because RPC '${e}' stream ${s} is closed:`,O):(E||(de(sn,`Opening RPC '${e}' stream ${s} transport.`),v.open(),E=!0),de(sn,`RPC '${e}' stream ${s} sending:`,O),v.send(O))},Yo:()=>v.close()}),N=(O,V,K)=>{O.listen(V,G=>{try{K(G)}catch(J){setTimeout(()=>{throw J},0)}})};return N(v,du.EventType.OPEN,()=>{S||(de(sn,`RPC '${e}' stream ${s} transport opened.`),R.s_())}),N(v,du.EventType.CLOSE,()=>{S||(S=!0,de(sn,`RPC '${e}' stream ${s} transport closed`),R.__(),this.I_(v))}),N(v,du.EventType.ERROR,O=>{S||(S=!0,ps(sn,`RPC '${e}' stream ${s} transport errored. Name:`,O.name,"Message:",O.message),R.__(new ue(Y.UNAVAILABLE,"The operation could not be completed")))}),N(v,du.EventType.MESSAGE,O=>{var V;if(!S){const K=O.data[0];ze(!!K,16349);const G=K,J=G?.error||((V=G[0])===null||V===void 0?void 0:V.error);if(J){de(sn,`RPC '${e}' stream ${s} received error:`,J);const ne=J.status;let se=function(k){const b=Ct[k];if(b!==void 0)return VI(b)}(ne),D=J.message;se===void 0&&(se=Y.INTERNAL,D="Unknown error status: "+ne+" with message "+J.message),S=!0,R.__(new ue(se,D)),v.close()}else de(sn,`RPC '${e}' stream ${s} received:`,K),R.a_(K)}}),N(h,XT.STAT_EVENT,O=>{O.stat===Am.PROXY?de(sn,`RPC '${e}' stream ${s} detected buffering proxy`):O.stat===Am.NOPROXY&&de(sn,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{R.o_()},0),R}terminate(){this.u_.forEach(e=>e.close()),this.u_=[]}T_(e){this.u_.push(e)}I_(e){this.u_=this.u_.filter(t=>t===e)}}function im(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jd(n){return new UN(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $g{constructor(e,t,r=1e3,s=1.5,a=6e4){this.Fi=e,this.timerId=t,this.d_=r,this.E_=s,this.A_=a,this.R_=0,this.V_=null,this.m_=Date.now(),this.reset()}reset(){this.R_=0}f_(){this.R_=this.A_}g_(e){this.cancel();const t=Math.floor(this.R_+this.p_()),r=Math.max(0,Date.now()-this.m_),s=Math.max(0,t-r);s>0&&de("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.R_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.V_=this.Fi.enqueueAfterDelay(this.timerId,s,()=>(this.m_=Date.now(),e())),this.R_*=this.E_,this.R_<this.d_&&(this.R_=this.d_),this.R_>this.A_&&(this.R_=this.A_)}y_(){this.V_!==null&&(this.V_.skipDelay(),this.V_=null)}cancel(){this.V_!==null&&(this.V_.cancel(),this.V_=null)}p_(){return(Math.random()-.5)*this.R_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E0="PersistentStream";class XI{constructor(e,t,r,s,a,u,h,f){this.Fi=e,this.w_=r,this.S_=s,this.connection=a,this.authCredentialsProvider=u,this.appCheckCredentialsProvider=h,this.listener=f,this.state=0,this.b_=0,this.D_=null,this.v_=null,this.stream=null,this.C_=0,this.F_=new $g(e,t)}M_(){return this.state===1||this.state===5||this.x_()}x_(){return this.state===2||this.state===3}start(){this.C_=0,this.state!==4?this.auth():this.O_()}async stop(){this.M_()&&await this.close(0)}N_(){this.state=0,this.F_.reset()}B_(){this.x_()&&this.D_===null&&(this.D_=this.Fi.enqueueAfterDelay(this.w_,6e4,()=>this.L_()))}k_(e){this.q_(),this.stream.send(e)}async L_(){if(this.x_())return this.close(0)}q_(){this.D_&&(this.D_.cancel(),this.D_=null)}Q_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.Q_(),this.F_.cancel(),this.b_++,e!==4?this.F_.reset():t&&t.code===Y.RESOURCE_EXHAUSTED?(Ei(t.toString()),Ei("Using maximum backoff delay to prevent overloading the backend."),this.F_.f_()):t&&t.code===Y.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.U_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.n_(t)}U_(){}auth(){this.state=1;const e=this.K_(this.b_),t=this.b_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.b_===t&&this.W_(r,s)},r=>{e(()=>{const s=new ue(Y.UNKNOWN,"Fetching auth token failed: "+r.message);return this.G_(s)})})}W_(e,t){const r=this.K_(this.b_);this.stream=this.z_(e,t),this.stream.Zo(()=>{r(()=>this.listener.Zo())}),this.stream.e_(()=>{r(()=>(this.state=2,this.v_=this.Fi.enqueueAfterDelay(this.S_,1e4,()=>(this.x_()&&(this.state=3),Promise.resolve())),this.listener.e_()))}),this.stream.n_(s=>{r(()=>this.G_(s))}),this.stream.onMessage(s=>{r(()=>++this.C_==1?this.j_(s):this.onNext(s))})}O_(){this.state=5,this.F_.g_(async()=>{this.state=0,this.start()})}G_(e){return de(E0,`close with error: ${e}`),this.stream=null,this.close(4,e)}K_(e){return t=>{this.Fi.enqueueAndForget(()=>this.b_===e?t():(de(E0,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class V2 extends XI{constructor(e,t,r,s,a,u){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,s,u),this.serializer=a}z_(e,t){return this.connection.P_("Listen",e,t)}j_(e){return this.onNext(e)}onNext(e){this.F_.reset();const t=WN(this.serializer,e),r=function(a){if(!("targetChange"in a))return Ie.min();const u=a.targetChange;return u.targetIds&&u.targetIds.length?Ie.min():u.readTime?Mn(u.readTime):Ie.min()}(e);return this.listener.J_(t,r)}H_(e){const t={};t.database=Vm(this.serializer),t.addTarget=function(a,u){let h;const f=u.target;if(h=Nm(f)?{documents:GN(a,f)}:{query:qN(a,f).Vt},h.targetId=u.targetId,u.resumeToken.approximateByteSize()>0){h.resumeToken=UI(a,u.resumeToken);const p=Lm(a,u.expectedCount);p!==null&&(h.expectedCount=p)}else if(u.snapshotVersion.compareTo(Ie.min())>0){h.readTime=pd(a,u.snapshotVersion.toTimestamp());const p=Lm(a,u.expectedCount);p!==null&&(h.expectedCount=p)}return h}(this.serializer,e);const r=QN(this.serializer,e);r&&(t.labels=r),this.k_(t)}Y_(e){const t={};t.database=Vm(this.serializer),t.removeTarget=e,this.k_(t)}}class F2 extends XI{constructor(e,t,r,s,a,u){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,s,u),this.serializer=a}get Z_(){return this.C_>0}start(){this.lastStreamToken=void 0,super.start()}U_(){this.Z_&&this.X_([])}z_(e,t){return this.connection.P_("Write",e,t)}j_(e){return ze(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,ze(!e.writeResults||e.writeResults.length===0,55816),this.listener.ea()}onNext(e){ze(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.F_.reset();const t=HN(e.writeResults,e.commitTime),r=Mn(e.commitTime);return this.listener.ta(r,t)}na(){const e={};e.database=Vm(this.serializer),this.k_(e)}X_(e){const t={streamToken:this.lastStreamToken,writes:e.map(r=>WI(this.serializer,r))};this.k_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j2{}class U2 extends j2{constructor(e,t,r,s){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=s,this.ra=!1}ia(){if(this.ra)throw new ue(Y.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,r,s){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,u])=>this.connection.Wo(e,Mm(t,r),s,a,u)).catch(a=>{throw a.name==="FirebaseError"?(a.code===Y.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new ue(Y.UNKNOWN,a.toString())})}Jo(e,t,r,s,a){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([u,h])=>this.connection.Jo(e,Mm(t,r),s,u,h,a)).catch(u=>{throw u.name==="FirebaseError"?(u.code===Y.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),u):new ue(Y.UNKNOWN,u.toString())})}terminate(){this.ra=!0,this.connection.terminate()}}class B2{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.sa=0,this.oa=null,this._a=!0}aa(){this.sa===0&&(this.ua("Unknown"),this.oa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.oa=null,this.ca("Backend didn't respond within 10 seconds."),this.ua("Offline"),Promise.resolve())))}la(e){this.state==="Online"?this.ua("Unknown"):(this.sa++,this.sa>=1&&(this.ha(),this.ca(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ua("Offline")))}set(e){this.ha(),this.sa=0,e==="Online"&&(this._a=!1),this.ua(e)}ua(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ca(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this._a?(Ei(t),this._a=!1):de("OnlineStateTracker",t)}ha(){this.oa!==null&&(this.oa.cancel(),this.oa=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mo="RemoteStore";class z2{constructor(e,t,r,s,a){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Pa=[],this.Ta=new Map,this.Ia=new Set,this.da=[],this.Ea=a,this.Ea.xo(u=>{r.enqueueAndForget(async()=>{Io(this)&&(de(mo,"Restarting streams for network reachability change."),await async function(f){const p=Ae(f);p.Ia.add(4),await nc(p),p.Aa.set("Unknown"),p.Ia.delete(4),await Xd(p)}(this))})}),this.Aa=new B2(r,s)}}async function Xd(n){if(Io(n))for(const e of n.da)await e(!0)}async function nc(n){for(const e of n.da)await e(!1)}function ZI(n,e){const t=Ae(n);t.Ta.has(e.targetId)||(t.Ta.set(e.targetId,e),qg(t)?Gg(t):nl(t).x_()&&Hg(t,e))}function Wg(n,e){const t=Ae(n),r=nl(t);t.Ta.delete(e),r.x_()&&eC(t,e),t.Ta.size===0&&(r.x_()?r.B_():Io(t)&&t.Aa.set("Unknown"))}function Hg(n,e){if(n.Ra.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Ie.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}nl(n).H_(e)}function eC(n,e){n.Ra.$e(e),nl(n).Y_(e)}function Gg(n){n.Ra=new MN({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),Et:e=>n.Ta.get(e)||null,lt:()=>n.datastore.serializer.databaseId}),nl(n).start(),n.Aa.aa()}function qg(n){return Io(n)&&!nl(n).M_()&&n.Ta.size>0}function Io(n){return Ae(n).Ia.size===0}function tC(n){n.Ra=void 0}async function $2(n){n.Aa.set("Online")}async function W2(n){n.Ta.forEach((e,t)=>{Hg(n,e)})}async function H2(n,e){tC(n),qg(n)?(n.Aa.la(e),Gg(n)):n.Aa.set("Unknown")}async function G2(n,e,t){if(n.Aa.set("Online"),e instanceof jI&&e.state===2&&e.cause)try{await async function(s,a){const u=a.cause;for(const h of a.targetIds)s.Ta.has(h)&&(await s.remoteSyncer.rejectListen(h,u),s.Ta.delete(h),s.Ra.removeTarget(h))}(n,e)}catch(r){de(mo,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await _d(n,r)}else if(e instanceof qh?n.Ra.Ye(e):e instanceof FI?n.Ra.it(e):n.Ra.et(e),!t.isEqual(Ie.min()))try{const r=await JI(n.localStore);t.compareTo(r)>=0&&await function(a,u){const h=a.Ra.Pt(u);return h.targetChanges.forEach((f,p)=>{if(f.resumeToken.approximateByteSize()>0){const y=a.Ta.get(p);y&&a.Ta.set(p,y.withResumeToken(f.resumeToken,u))}}),h.targetMismatches.forEach((f,p)=>{const y=a.Ta.get(f);if(!y)return;a.Ta.set(f,y.withResumeToken(Zt.EMPTY_BYTE_STRING,y.snapshotVersion)),eC(a,f);const v=new rs(y.target,f,p,y.sequenceNumber);Hg(a,v)}),a.remoteSyncer.applyRemoteEvent(h)}(n,t)}catch(r){de(mo,"Failed to raise snapshot:",r),await _d(n,r)}}async function _d(n,e,t){if(!tl(e))throw e;n.Ia.add(1),await nc(n),n.Aa.set("Offline"),t||(t=()=>JI(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{de(mo,"Retrying IndexedDB access"),await t(),n.Ia.delete(1),await Xd(n)})}function nC(n,e){return e().catch(t=>_d(n,t,e))}async function Zd(n){const e=Ae(n),t=vs(e);let r=e.Pa.length>0?e.Pa[e.Pa.length-1].batchId:xg;for(;q2(e);)try{const s=await R2(e.localStore,r);if(s===null){e.Pa.length===0&&t.B_();break}r=s.batchId,K2(e,s)}catch(s){await _d(e,s)}rC(e)&&iC(e)}function q2(n){return Io(n)&&n.Pa.length<10}function K2(n,e){n.Pa.push(e);const t=vs(n);t.x_()&&t.Z_&&t.X_(e.mutations)}function rC(n){return Io(n)&&!vs(n).M_()&&n.Pa.length>0}function iC(n){vs(n).start()}async function Q2(n){vs(n).na()}async function Y2(n){const e=vs(n);for(const t of n.Pa)e.X_(t.mutations)}async function J2(n,e,t){const r=n.Pa.shift(),s=Mg.from(r,e,t);await nC(n,()=>n.remoteSyncer.applySuccessfulWrite(s)),await Zd(n)}async function X2(n,e){e&&vs(n).Z_&&await async function(r,s){if(function(u){return MI(u)&&u!==Y.ABORTED}(s.code)){const a=r.Pa.shift();vs(r).N_(),await nC(r,()=>r.remoteSyncer.rejectFailedWrite(a.batchId,s)),await Zd(r)}}(n,e),rC(n)&&iC(n)}async function T0(n,e){const t=Ae(n);t.asyncQueue.verifyOperationInProgress(),de(mo,"RemoteStore received new credentials");const r=Io(t);t.Ia.add(3),await nc(t),r&&t.Aa.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ia.delete(3),await Xd(t)}async function Z2(n,e){const t=Ae(n);e?(t.Ia.delete(2),await Xd(t)):e||(t.Ia.add(2),await nc(t),t.Aa.set("Unknown"))}function nl(n){return n.Va||(n.Va=function(t,r,s){const a=Ae(t);return a.ia(),new V2(r,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,s)}(n.datastore,n.asyncQueue,{Zo:$2.bind(null,n),e_:W2.bind(null,n),n_:H2.bind(null,n),J_:G2.bind(null,n)}),n.da.push(async e=>{e?(n.Va.N_(),qg(n)?Gg(n):n.Aa.set("Unknown")):(await n.Va.stop(),tC(n))})),n.Va}function vs(n){return n.ma||(n.ma=function(t,r,s){const a=Ae(t);return a.ia(),new F2(r,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,s)}(n.datastore,n.asyncQueue,{Zo:()=>Promise.resolve(),e_:Q2.bind(null,n),n_:X2.bind(null,n),ea:Y2.bind(null,n),ta:J2.bind(null,n)}),n.da.push(async e=>{e?(n.ma.N_(),await Zd(n)):(await n.ma.stop(),n.Pa.length>0&&(de(mo,`Stopping write stream with ${n.Pa.length} pending writes`),n.Pa=[]))})),n.ma}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kg{constructor(e,t,r,s,a){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=s,this.removalCallback=a,this.deferred=new gi,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(u=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,s,a){const u=Date.now()+r,h=new Kg(e,t,u,s,a);return h.start(r),h}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new ue(Y.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Qg(n,e){if(Ei("AsyncQueue",`${e}: ${n}`),tl(n))return new ue(Y.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oa{static emptySet(e){return new Oa(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||ye.comparator(t.key,r.key):(t,r)=>ye.comparator(t.key,r.key),this.keyedMap=fu(),this.sortedSet=new xt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Oa)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const s=t.getNext().key,a=r.getNext().key;if(!s.isEqual(a))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new Oa;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I0{constructor(){this.fa=new xt(ye.comparator)}track(e){const t=e.doc.key,r=this.fa.get(t);r?e.type!==0&&r.type===3?this.fa=this.fa.insert(t,e):e.type===3&&r.type!==1?this.fa=this.fa.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.fa=this.fa.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.fa=this.fa.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.fa=this.fa.remove(t):e.type===1&&r.type===2?this.fa=this.fa.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.fa=this.fa.insert(t,{type:2,doc:e.doc}):ve(63341,{At:e,ga:r}):this.fa=this.fa.insert(t,e)}pa(){const e=[];return this.fa.inorderTraversal((t,r)=>{e.push(r)}),e}}class Wa{constructor(e,t,r,s,a,u,h,f,p){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=a,this.fromCache=u,this.syncStateChanged=h,this.excludesMetadataChanges=f,this.hasCachedResults=p}static fromInitialDocuments(e,t,r,s,a){const u=[];return t.forEach(h=>{u.push({type:0,doc:h})}),new Wa(e,t,Oa.emptySet(t),u,r,s,!0,!1,a)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Gd(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let s=0;s<t.length;s++)if(t[s].type!==r[s].type||!t[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eD{constructor(){this.ya=void 0,this.wa=[]}Sa(){return this.wa.some(e=>e.ba())}}class tD{constructor(){this.queries=C0(),this.onlineState="Unknown",this.Da=new Set}terminate(){(function(t,r){const s=Ae(t),a=s.queries;s.queries=C0(),a.forEach((u,h)=>{for(const f of h.wa)f.onError(r)})})(this,new ue(Y.ABORTED,"Firestore shutting down"))}}function C0(){return new To(n=>II(n),Gd)}async function sC(n,e){const t=Ae(n);let r=3;const s=e.query;let a=t.queries.get(s);a?!a.Sa()&&e.ba()&&(r=2):(a=new eD,r=e.ba()?0:1);try{switch(r){case 0:a.ya=await t.onListen(s,!0);break;case 1:a.ya=await t.onListen(s,!1);break;case 2:await t.onFirstRemoteStoreListen(s)}}catch(u){const h=Qg(u,`Initialization of query '${Ta(e.query)}' failed`);return void e.onError(h)}t.queries.set(s,a),a.wa.push(e),e.va(t.onlineState),a.ya&&e.Ca(a.ya)&&Yg(t)}async function oC(n,e){const t=Ae(n),r=e.query;let s=3;const a=t.queries.get(r);if(a){const u=a.wa.indexOf(e);u>=0&&(a.wa.splice(u,1),a.wa.length===0?s=e.ba()?0:1:!a.Sa()&&e.ba()&&(s=2))}switch(s){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function nD(n,e){const t=Ae(n);let r=!1;for(const s of e){const a=s.query,u=t.queries.get(a);if(u){for(const h of u.wa)h.Ca(s)&&(r=!0);u.ya=s}}r&&Yg(t)}function rD(n,e,t){const r=Ae(n),s=r.queries.get(e);if(s)for(const a of s.wa)a.onError(t);r.queries.delete(e)}function Yg(n){n.Da.forEach(e=>{e.next()})}var Um,S0;(S0=Um||(Um={})).Fa="default",S0.Cache="cache";class aC{constructor(e,t,r){this.query=e,this.Ma=t,this.xa=!1,this.Oa=null,this.onlineState="Unknown",this.options=r||{}}Ca(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new Wa(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.xa?this.Na(e)&&(this.Ma.next(e),t=!0):this.Ba(e,this.onlineState)&&(this.La(e),t=!0),this.Oa=e,t}onError(e){this.Ma.error(e)}va(e){this.onlineState=e;let t=!1;return this.Oa&&!this.xa&&this.Ba(this.Oa,e)&&(this.La(this.Oa),t=!0),t}Ba(e,t){if(!e.fromCache||!this.ba())return!0;const r=t!=="Offline";return(!this.options.ka||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Na(e){if(e.docChanges.length>0)return!0;const t=this.Oa&&this.Oa.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}La(e){e=Wa.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.xa=!0,this.Ma.next(e)}ba(){return this.options.source!==Um.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lC{constructor(e){this.key=e}}class uC{constructor(e){this.key=e}}class iD{constructor(e,t){this.query=e,this.Ha=t,this.Ya=null,this.hasCachedResults=!1,this.current=!1,this.Za=Me(),this.mutatedKeys=Me(),this.Xa=CI(e),this.eu=new Oa(this.Xa)}get tu(){return this.Ha}nu(e,t){const r=t?t.ru:new I0,s=t?t.eu:this.eu;let a=t?t.mutatedKeys:this.mutatedKeys,u=s,h=!1;const f=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,p=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((y,v)=>{const E=s.get(y),S=qd(this.query,v)?v:null,R=!!E&&this.mutatedKeys.has(E.key),N=!!S&&(S.hasLocalMutations||this.mutatedKeys.has(S.key)&&S.hasCommittedMutations);let O=!1;E&&S?E.data.isEqual(S.data)?R!==N&&(r.track({type:3,doc:S}),O=!0):this.iu(E,S)||(r.track({type:2,doc:S}),O=!0,(f&&this.Xa(S,f)>0||p&&this.Xa(S,p)<0)&&(h=!0)):!E&&S?(r.track({type:0,doc:S}),O=!0):E&&!S&&(r.track({type:1,doc:E}),O=!0,(f||p)&&(h=!0)),O&&(S?(u=u.add(S),a=N?a.add(y):a.delete(y)):(u=u.delete(y),a=a.delete(y)))}),this.query.limit!==null)for(;u.size>this.query.limit;){const y=this.query.limitType==="F"?u.last():u.first();u=u.delete(y.key),a=a.delete(y.key),r.track({type:1,doc:y})}return{eu:u,ru:r,Ds:h,mutatedKeys:a}}iu(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,s){const a=this.eu;this.eu=e.eu,this.mutatedKeys=e.mutatedKeys;const u=e.ru.pa();u.sort((y,v)=>function(S,R){const N=O=>{switch(O){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ve(20277,{At:O})}};return N(S)-N(R)}(y.type,v.type)||this.Xa(y.doc,v.doc)),this.su(r),s=s!=null&&s;const h=t&&!s?this.ou():[],f=this.Za.size===0&&this.current&&!s?1:0,p=f!==this.Ya;return this.Ya=f,u.length!==0||p?{snapshot:new Wa(this.query,e.eu,a,u,e.mutatedKeys,f===0,p,!1,!!r&&r.resumeToken.approximateByteSize()>0),_u:h}:{_u:h}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({eu:this.eu,ru:new I0,mutatedKeys:this.mutatedKeys,Ds:!1},!1)):{_u:[]}}au(e){return!this.Ha.has(e)&&!!this.eu.has(e)&&!this.eu.get(e).hasLocalMutations}su(e){e&&(e.addedDocuments.forEach(t=>this.Ha=this.Ha.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ha=this.Ha.delete(t)),this.current=e.current)}ou(){if(!this.current)return[];const e=this.Za;this.Za=Me(),this.eu.forEach(r=>{this.au(r.key)&&(this.Za=this.Za.add(r.key))});const t=[];return e.forEach(r=>{this.Za.has(r)||t.push(new uC(r))}),this.Za.forEach(r=>{e.has(r)||t.push(new lC(r))}),t}uu(e){this.Ha=e.qs,this.Za=Me();const t=this.nu(e.documents);return this.applyChanges(t,!0)}cu(){return Wa.fromInitialDocuments(this.query,this.eu,this.mutatedKeys,this.Ya===0,this.hasCachedResults)}}const Jg="SyncEngine";class sD{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class oD{constructor(e){this.key=e,this.lu=!1}}class aD{constructor(e,t,r,s,a,u){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=s,this.currentUser=a,this.maxConcurrentLimboResolutions=u,this.hu={},this.Pu=new To(h=>II(h),Gd),this.Tu=new Map,this.Iu=new Set,this.du=new xt(ye.comparator),this.Eu=new Map,this.Au=new jg,this.Ru={},this.Vu=new Map,this.mu=$a.ur(),this.onlineState="Unknown",this.fu=void 0}get isPrimaryClient(){return this.fu===!0}}async function lD(n,e,t=!0){const r=mC(n);let s;const a=r.Pu.get(e);return a?(r.sharedClientState.addLocalQueryTarget(a.targetId),s=a.view.cu()):s=await cC(r,e,t,!0),s}async function uD(n,e){const t=mC(n);await cC(t,e,!0,!1)}async function cC(n,e,t,r){const s=await x2(n.localStore,Dr(e)),a=s.targetId,u=n.sharedClientState.addLocalQueryTarget(a,t);let h;return r&&(h=await cD(n,e,a,u==="current",s.resumeToken)),n.isPrimaryClient&&t&&ZI(n.remoteStore,s),h}async function cD(n,e,t,r,s){n.gu=(v,E,S)=>async function(N,O,V,K){let G=O.view.nu(V);G.Ds&&(G=await _0(N.localStore,O.query,!1).then(({documents:D})=>O.view.nu(D,G)));const J=K&&K.targetChanges.get(O.targetId),ne=K&&K.targetMismatches.get(O.targetId)!=null,se=O.view.applyChanges(G,N.isPrimaryClient,J,ne);return k0(N,O.targetId,se._u),se.snapshot}(n,v,E,S);const a=await _0(n.localStore,e,!0),u=new iD(e,a.qs),h=u.nu(a.documents),f=tc.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",s),p=u.applyChanges(h,n.isPrimaryClient,f);k0(n,t,p._u);const y=new sD(e,t,u);return n.Pu.set(e,y),n.Tu.has(t)?n.Tu.get(t).push(e):n.Tu.set(t,[e]),p.snapshot}async function hD(n,e,t){const r=Ae(n),s=r.Pu.get(e),a=r.Tu.get(s.targetId);if(a.length>1)return r.Tu.set(s.targetId,a.filter(u=>!Gd(u,e))),void r.Pu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await Fm(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),t&&Wg(r.remoteStore,s.targetId),Bm(r,s.targetId)}).catch(el)):(Bm(r,s.targetId),await Fm(r.localStore,s.targetId,!0))}async function dD(n,e){const t=Ae(n),r=t.Pu.get(e),s=t.Tu.get(r.targetId);t.isPrimaryClient&&s.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),Wg(t.remoteStore,r.targetId))}async function fD(n,e,t){const r=wD(n);try{const s=await function(u,h){const f=Ae(u),p=ut.now(),y=h.reduce((S,R)=>S.add(R.key),Me());let v,E;return f.persistence.runTransaction("Locally write mutations","readwrite",S=>{let R=Ti(),N=Me();return f.Os.getEntries(S,y).next(O=>{R=O,R.forEach((V,K)=>{K.isValidDocument()||(N=N.add(V))})}).next(()=>f.localDocuments.getOverlayedDocuments(S,R)).next(O=>{v=O;const V=[];for(const K of h){const G=bN(K,v.get(K.key).overlayedDocument);G!=null&&V.push(new ks(K.key,G,mI(G.value.mapValue),kt.exists(!0)))}return f.mutationQueue.addMutationBatch(S,p,V,h)}).next(O=>{E=O;const V=O.applyToLocalDocumentSet(v,N);return f.documentOverlayCache.saveOverlays(S,O.batchId,V)})}).then(()=>({batchId:E.batchId,changes:AI(v)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(u,h,f){let p=u.Ru[u.currentUser.toKey()];p||(p=new xt(Re)),p=p.insert(h,f),u.Ru[u.currentUser.toKey()]=p}(r,s.batchId,t),await rc(r,s.changes),await Zd(r.remoteStore)}catch(s){const a=Qg(s,"Failed to persist write");t.reject(a)}}async function hC(n,e){const t=Ae(n);try{const r=await A2(t.localStore,e);e.targetChanges.forEach((s,a)=>{const u=t.Eu.get(a);u&&(ze(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?u.lu=!0:s.modifiedDocuments.size>0?ze(u.lu,14607):s.removedDocuments.size>0&&(ze(u.lu,42227),u.lu=!1))}),await rc(t,r,e)}catch(r){await el(r)}}function A0(n,e,t){const r=Ae(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const s=[];r.Pu.forEach((a,u)=>{const h=u.view.va(e);h.snapshot&&s.push(h.snapshot)}),function(u,h){const f=Ae(u);f.onlineState=h;let p=!1;f.queries.forEach((y,v)=>{for(const E of v.wa)E.va(h)&&(p=!0)}),p&&Yg(f)}(r.eventManager,e),s.length&&r.hu.J_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function pD(n,e,t){const r=Ae(n);r.sharedClientState.updateQueryState(e,"rejected",t);const s=r.Eu.get(e),a=s&&s.key;if(a){let u=new xt(ye.comparator);u=u.insert(a,Wt.newNoDocument(a,Ie.min()));const h=Me().add(a),f=new Yd(Ie.min(),new Map,new xt(Re),u,h);await hC(r,f),r.du=r.du.remove(a),r.Eu.delete(e),Xg(r)}else await Fm(r.localStore,e,!1).then(()=>Bm(r,e,t)).catch(el)}async function mD(n,e){const t=Ae(n),r=e.batch.batchId;try{const s=await S2(t.localStore,e);fC(t,r,null),dC(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await rc(t,s)}catch(s){await el(s)}}async function gD(n,e,t){const r=Ae(n);try{const s=await function(u,h){const f=Ae(u);return f.persistence.runTransaction("Reject batch","readwrite-primary",p=>{let y;return f.mutationQueue.lookupMutationBatch(p,h).next(v=>(ze(v!==null,37113),y=v.keys(),f.mutationQueue.removeMutationBatch(p,v))).next(()=>f.mutationQueue.performConsistencyCheck(p)).next(()=>f.documentOverlayCache.removeOverlaysForBatchId(p,y,h)).next(()=>f.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(p,y)).next(()=>f.localDocuments.getDocuments(p,y))})}(r.localStore,e);fC(r,e,t),dC(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await rc(r,s)}catch(s){await el(s)}}function dC(n,e){(n.Vu.get(e)||[]).forEach(t=>{t.resolve()}),n.Vu.delete(e)}function fC(n,e,t){const r=Ae(n);let s=r.Ru[r.currentUser.toKey()];if(s){const a=s.get(e);a&&(t?a.reject(t):a.resolve(),s=s.remove(e)),r.Ru[r.currentUser.toKey()]=s}}function Bm(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.Tu.get(e))n.Pu.delete(r),t&&n.hu.pu(r,t);n.Tu.delete(e),n.isPrimaryClient&&n.Au.zr(e).forEach(r=>{n.Au.containsKey(r)||pC(n,r)})}function pC(n,e){n.Iu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(Wg(n.remoteStore,t),n.du=n.du.remove(e),n.Eu.delete(t),Xg(n))}function k0(n,e,t){for(const r of t)r instanceof lC?(n.Au.addReference(r.key,e),_D(n,r)):r instanceof uC?(de(Jg,"Document no longer in limbo: "+r.key),n.Au.removeReference(r.key,e),n.Au.containsKey(r.key)||pC(n,r.key)):ve(19791,{yu:r})}function _D(n,e){const t=e.key,r=t.path.canonicalString();n.du.get(t)||n.Iu.has(r)||(de(Jg,"New document in limbo: "+t),n.Iu.add(r),Xg(n))}function Xg(n){for(;n.Iu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Iu.values().next().value;n.Iu.delete(e);const t=new ye(Je.fromString(e)),r=n.mu.next();n.Eu.set(r,new oD(t)),n.du=n.du.insert(t,r),ZI(n.remoteStore,new rs(Dr(Og(t.path)),r,"TargetPurposeLimboResolution",Wd.ue))}}async function rc(n,e,t){const r=Ae(n),s=[],a=[],u=[];r.Pu.isEmpty()||(r.Pu.forEach((h,f)=>{u.push(r.gu(f,e,t).then(p=>{var y;if((p||t)&&r.isPrimaryClient){const v=p?!p.fromCache:(y=t?.targetChanges.get(f.targetId))===null||y===void 0?void 0:y.current;r.sharedClientState.updateQueryState(f.targetId,v?"current":"not-current")}if(p){s.push(p);const v=Bg.Es(f.targetId,p);a.push(v)}}))}),await Promise.all(u),r.hu.J_(s),await async function(f,p){const y=Ae(f);try{await y.persistence.runTransaction("notifyLocalViewChanges","readwrite",v=>X.forEach(p,E=>X.forEach(E.Is,S=>y.persistence.referenceDelegate.addReference(v,E.targetId,S)).next(()=>X.forEach(E.ds,S=>y.persistence.referenceDelegate.removeReference(v,E.targetId,S)))))}catch(v){if(!tl(v))throw v;de(zg,"Failed to update sequence numbers: "+v)}for(const v of p){const E=v.targetId;if(!v.fromCache){const S=y.Fs.get(E),R=S.snapshotVersion,N=S.withLastLimboFreeSnapshotVersion(R);y.Fs=y.Fs.insert(E,N)}}}(r.localStore,a))}async function yD(n,e){const t=Ae(n);if(!t.currentUser.isEqual(e)){de(Jg,"User change. New user:",e.toKey());const r=await YI(t.localStore,e);t.currentUser=e,function(a,u){a.Vu.forEach(h=>{h.forEach(f=>{f.reject(new ue(Y.CANCELLED,u))})}),a.Vu.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await rc(t,r.Bs)}}function vD(n,e){const t=Ae(n),r=t.Eu.get(e);if(r&&r.lu)return Me().add(r.key);{let s=Me();const a=t.Tu.get(e);if(!a)return s;for(const u of a){const h=t.Pu.get(u);s=s.unionWith(h.view.tu)}return s}}function mC(n){const e=Ae(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=hC.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=vD.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=pD.bind(null,e),e.hu.J_=nD.bind(null,e.eventManager),e.hu.pu=rD.bind(null,e.eventManager),e}function wD(n){const e=Ae(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=mD.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=gD.bind(null,e),e}class yd{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Jd(e.databaseInfo.databaseId),this.sharedClientState=this.bu(e),this.persistence=this.Du(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Cu(e,this.localStore),this.indexBackfillerScheduler=this.Fu(e,this.localStore)}Cu(e,t){return null}Fu(e,t){return null}vu(e){return C2(this.persistence,new E2,e.initialUser,this.serializer)}Du(e){return new QI(Ug.Vi,this.serializer)}bu(e){return new b2}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}yd.provider={build:()=>new yd};class ED extends yd{constructor(e){super(),this.cacheSizeBytes=e}Cu(e,t){ze(this.persistence.referenceDelegate instanceof gd,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new o2(r,e.asyncQueue,t)}Du(e){const t=this.cacheSizeBytes!==void 0?En.withCacheSize(this.cacheSizeBytes):En.DEFAULT;return new QI(r=>gd.Vi(r,t),this.serializer)}}class zm{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>A0(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=yD.bind(null,this.syncEngine),await Z2(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new tD}()}createDatastore(e){const t=Jd(e.databaseInfo.databaseId),r=function(a){return new M2(a)}(e.databaseInfo);return function(a,u,h,f){return new U2(a,u,h,f)}(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return function(r,s,a,u,h){return new z2(r,s,a,u,h)}(this.localStore,this.datastore,e.asyncQueue,t=>A0(this.syncEngine,t,0),function(){return w0.C()?new w0:new N2}())}createSyncEngine(e,t){return function(s,a,u,h,f,p,y){const v=new aD(s,a,u,h,f,p);return y&&(v.fu=!0),v}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(s){const a=Ae(s);de(mo,"RemoteStore shutting down."),a.Ia.add(5),await nc(a),a.Ea.shutdown(),a.Aa.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()}}zm.provider={build:()=>new zm};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gC{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.xu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.xu(this.observer.error,e):Ei("Uncaught Error in snapshot listener:",e.toString()))}Ou(){this.muted=!0}xu(e,t){setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TD{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new ue(Y.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const t=await async function(s,a){const u=Ae(s),h={documents:a.map(v=>md(u.serializer,v))},f=await u.Jo("BatchGetDocuments",u.serializer.databaseId,Je.emptyPath(),h,a.length),p=new Map;f.forEach(v=>{const E=$N(u.serializer,v);p.set(E.key.toString(),E)});const y=[];return a.forEach(v=>{const E=p.get(v.toString());ze(!!E,55234,{key:v}),y.push(E)}),y}(this.datastore,e);return t.forEach(r=>this.recordVersion(r)),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new ec(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((t,r)=>{const s=ye.fromPath(r);this.mutations.push(new LI(s,this.precondition(s)))}),await async function(r,s){const a=Ae(r),u={writes:s.map(h=>WI(a.serializer,h))};await a.Wo("Commit",a.serializer.databaseId,Je.emptyPath(),u)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw ve(50498,{Wu:e.constructor.name});t=Ie.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!t.isEqual(r))throw new ue(Y.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(Ie.min())?kt.exists(!1):kt.updateTime(t):kt.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(Ie.min()))throw new ue(Y.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return kt.updateTime(t)}return kt.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ID{constructor(e,t,r,s,a){this.asyncQueue=e,this.datastore=t,this.options=r,this.updateFunction=s,this.deferred=a,this.Gu=r.maxAttempts,this.F_=new $g(this.asyncQueue,"transaction_retry")}zu(){this.Gu-=1,this.ju()}ju(){this.F_.g_(async()=>{const e=new TD(this.datastore),t=this.Ju(e);t&&t.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(s=>{this.Hu(s)}))}).catch(r=>{this.Hu(r)})})}Ju(e){try{const t=this.updateFunction(e);return!Ju(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}Hu(e){this.Gu>0&&this.Yu(e)?(this.Gu-=1,this.asyncQueue.enqueueAndForget(()=>(this.ju(),Promise.resolve()))):this.deferred.reject(e)}Yu(e){if(e.name==="FirebaseError"){const t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!MI(t)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ws="FirestoreClient";class CD{constructor(e,t,r,s,a){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=s,this.user=on.UNAUTHENTICATED,this.clientId=Rg.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=a,this.authCredentials.start(r,async u=>{de(ws,"Received user=",u.uid),await this.authCredentialListener(u),this.user=u}),this.appCheckCredentials.start(r,u=>(de(ws,"Received new app check token=",u),this.appCheckCredentialListener(u,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new gi;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=Qg(t,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function sm(n,e){n.asyncQueue.verifyOperationInProgress(),de(ws,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(async s=>{r.isEqual(s)||(await YI(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>{ps("Terminating Firestore due to IndexedDb database deletion"),n.terminate().then(()=>{de("Terminating Firestore due to IndexedDb database deletion completed successfully")}).catch(s=>{ps("Terminating Firestore due to IndexedDb database deletion failed",s)})}),n._offlineComponents=e}async function R0(n,e){n.asyncQueue.verifyOperationInProgress();const t=await SD(n);de(ws,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>T0(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,s)=>T0(e.remoteStore,s)),n._onlineComponents=e}async function SD(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){de(ws,"Using user provided OfflineComponentProvider");try{await sm(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function(s){return s.name==="FirebaseError"?s.code===Y.FAILED_PRECONDITION||s.code===Y.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(t))throw t;ps("Error using user provided cache. Falling back to memory cache: "+t),await sm(n,new yd)}}else de(ws,"Using default OfflineComponentProvider"),await sm(n,new ED(void 0));return n._offlineComponents}async function Zg(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(de(ws,"Using user provided OnlineComponentProvider"),await R0(n,n._uninitializedComponentsProvider._online)):(de(ws,"Using default OnlineComponentProvider"),await R0(n,new zm))),n._onlineComponents}function AD(n){return Zg(n).then(e=>e.syncEngine)}function kD(n){return Zg(n).then(e=>e.datastore)}async function $m(n){const e=await Zg(n),t=e.eventManager;return t.onListen=lD.bind(null,e.syncEngine),t.onUnlisten=hD.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=uD.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=dD.bind(null,e.syncEngine),t}function RD(n,e,t={}){const r=new gi;return n.asyncQueue.enqueueAndForget(async()=>function(a,u,h,f,p){const y=new gC({next:E=>{y.Ou(),u.enqueueAndForget(()=>oC(a,v)),E.fromCache&&f.source==="server"?p.reject(new ue(Y.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):p.resolve(E)},error:E=>p.reject(E)}),v=new aC(h,y,{includeMetadataChanges:!0,ka:!0});return sC(a,v)}(await $m(n),n.asyncQueue,e,t,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _C(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const x0=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yC="firestore.googleapis.com",P0=!0;class b0{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new ue(Y.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=yC,this.ssl=P0}else this.host=e.host,this.ssl=(t=e.ssl)!==null&&t!==void 0?t:P0;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=KI;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<i2)throw new ue(Y.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}Wb("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=_C((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(a){if(a.timeoutSeconds!==void 0){if(isNaN(a.timeoutSeconds))throw new ue(Y.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (must not be NaN)`);if(a.timeoutSeconds<5)throw new ue(Y.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (minimum allowed value is 5)`);if(a.timeoutSeconds>30)throw new ue(Y.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class ef{constructor(e,t,r,s){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new b0({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ue(Y.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new ue(Y.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new b0(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new Lb;switch(r.type){case"firstParty":return new jb(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new ue(Y.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const r=x0.get(t);r&&(de("ComponentProvider","Removing Datastore"),x0.delete(t),r.terminate())}(this),Promise.resolve()}}function xD(n,e,t,r={}){var s;n=In(n,ef);const a=Is(e),u=n._getSettings(),h=Object.assign(Object.assign({},u),{emulatorOptions:n._getEmulatorOptions()}),f=`${e}:${t}`;a&&(dg(`https://${f}`),fg("Firestore",!0)),u.host!==yC&&u.host!==f&&ps("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const p=Object.assign(Object.assign({},u),{host:f,ssl:a,emulatorOptions:r});if(!ds(p,h)&&(n._setSettings(p),r.mockUserToken)){let y,v;if(typeof r.mockUserToken=="string")y=r.mockUserToken,v=on.MOCK_USER;else{y=sT(r.mockUserToken,(s=n._app)===null||s===void 0?void 0:s.options.projectId);const E=r.mockUserToken.sub||r.mockUserToken.user_id;if(!E)throw new ue(Y.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");v=new on(E)}n._authCredentials=new Mb(new nI(y,v))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Co{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Co(this.firestore,e,this._query)}}class gt{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new us(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new gt(this.firestore,e,this._key)}toJSON(){return{type:gt._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if(Yu(t,gt._jsonSchema))return new gt(e,r||null,new ye(Je.fromString(t.referencePath)))}}gt._jsonSchemaVersion="firestore/documentReference/1.0",gt._jsonSchema={type:Rt("string",gt._jsonSchemaVersion),referencePath:Rt("string")};class us extends Co{constructor(e,t,r){super(e,t,Og(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new gt(this.firestore,null,new ye(e))}withConverter(e){return new us(this.firestore,e,this._path)}}function so(n,e,...t){if(n=Ze(n),iI("collection","path",e),n instanceof ef){const r=Je.fromString(e,...t);return Ww(r),new us(n,null,r)}{if(!(n instanceof gt||n instanceof us))throw new ue(Y.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(Je.fromString(e,...t));return Ww(r),new us(n.firestore,null,r)}}function wt(n,e,...t){if(n=Ze(n),arguments.length===1&&(e=Rg.newId()),iI("doc","path",e),n instanceof ef){const r=Je.fromString(e,...t);return $w(r),new gt(n,null,new ye(r))}{if(!(n instanceof gt||n instanceof us))throw new ue(Y.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(Je.fromString(e,...t));return $w(r),new gt(n.firestore,n instanceof us?n.converter:null,new ye(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const N0="AsyncQueue";class D0{constructor(e=Promise.resolve()){this.Zu=[],this.Xu=!1,this.ec=[],this.tc=null,this.nc=!1,this.rc=!1,this.sc=[],this.F_=new $g(this,"async_queue_retry"),this.oc=()=>{const r=im();r&&de(N0,"Visibility state changed to "+r.visibilityState),this.F_.y_()},this._c=e;const t=im();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.oc)}get isShuttingDown(){return this.Xu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.ac(),this.uc(e)}enterRestrictedMode(e){if(!this.Xu){this.Xu=!0,this.rc=e||!1;const t=im();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.oc)}}enqueue(e){if(this.ac(),this.Xu)return new Promise(()=>{});const t=new gi;return this.uc(()=>this.Xu&&this.rc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Zu.push(e),this.cc()))}async cc(){if(this.Zu.length!==0){try{await this.Zu[0](),this.Zu.shift(),this.F_.reset()}catch(e){if(!tl(e))throw e;de(N0,"Operation failed with retryable error: "+e)}this.Zu.length>0&&this.F_.g_(()=>this.cc())}}uc(e){const t=this._c.then(()=>(this.nc=!0,e().catch(r=>{throw this.tc=r,this.nc=!1,Ei("INTERNAL UNHANDLED ERROR: ",O0(r)),r}).then(r=>(this.nc=!1,r))));return this._c=t,t}enqueueAfterDelay(e,t,r){this.ac(),this.sc.indexOf(e)>-1&&(t=0);const s=Kg.createAndSchedule(this,e,t,r,a=>this.lc(a));return this.ec.push(s),s}ac(){this.tc&&ve(47125,{hc:O0(this.tc)})}verifyOperationInProgress(){}async Pc(){let e;do e=this._c,await e;while(e!==this._c)}Tc(e){for(const t of this.ec)if(t.timerId===e)return!0;return!1}Ic(e){return this.Pc().then(()=>{this.ec.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(const t of this.ec)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Pc()})}dc(e){this.sc.push(e)}lc(e){const t=this.ec.indexOf(e);this.ec.splice(t,1)}}function O0(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function L0(n){return function(t,r){if(typeof t!="object"||t===null)return!1;const s=t;for(const a of r)if(a in s&&typeof s[a]=="function")return!0;return!1}(n,["next","error","complete"])}class Fr extends ef{constructor(e,t,r,s){super(e,t,r,s),this.type="firestore",this._queue=new D0,this._persistenceKey=s?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new D0(e),this._firestoreClient=void 0,await e}}}function PD(n,e){const t=typeof n=="object"?n:gg(),r=typeof n=="string"?n:ud,s=Fd(t,"firestore").getImmediate({identifier:r});if(!s._initialized){const a=nT("firestore");a&&xD(s,...a)}return s}function ic(n){if(n._terminated)throw new ue(Y.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||bD(n),n._firestoreClient}function bD(n){var e,t,r;const s=n._freezeSettings(),a=function(h,f,p,y){return new tN(h,f,p,y.host,y.ssl,y.experimentalForceLongPolling,y.experimentalAutoDetectLongPolling,_C(y.experimentalLongPollingOptions),y.useFetchStreams,y.isUsingEmulator)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,s);n._componentsProvider||!((t=s.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=s.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),n._firestoreClient=new CD(n._authCredentials,n._appCheckCredentials,n._queue,a,n._componentsProvider&&function(h){const f=h?._online.build();return{_offline:h?._offline.build(f),_online:f}}(n._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class On{constructor(e){this._byteString=e}static fromBase64String(e){try{return new On(Zt.fromBase64String(e))}catch(t){throw new ue(Y.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new On(Zt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:On._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Yu(e,On._jsonSchema))return On.fromBase64String(e.bytes)}}On._jsonSchemaVersion="firestore/bytes/1.0",On._jsonSchema={type:Rt("string",On._jsonSchemaVersion),bytes:Rt("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rl{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new ue(Y.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Jt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tf{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Or{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new ue(Y.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new ue(Y.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Re(this._lat,e._lat)||Re(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Or._jsonSchemaVersion}}static fromJSON(e){if(Yu(e,Or._jsonSchema))return new Or(e.latitude,e.longitude)}}Or._jsonSchemaVersion="firestore/geoPoint/1.0",Or._jsonSchema={type:Rt("string",Or._jsonSchemaVersion),latitude:Rt("number"),longitude:Rt("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lr{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let a=0;a<r.length;++a)if(r[a]!==s[a])return!1;return!0}(this._values,e._values)}toJSON(){return{type:Lr._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Yu(e,Lr._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(t=>typeof t=="number"))return new Lr(e.vectorValues);throw new ue(Y.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Lr._jsonSchemaVersion="firestore/vectorValue/1.0",Lr._jsonSchema={type:Rt("string",Lr._jsonSchemaVersion),vectorValues:Rt("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ND=/^__.*__$/;class DD{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new ks(e,this.data,this.fieldMask,t,this.fieldTransforms):new Zu(e,this.data,t,this.fieldTransforms)}}class vC{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new ks(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function wC(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ve(40011,{Ec:n})}}class e_{constructor(e,t,r,s,a,u){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=s,a===void 0&&this.Ac(),this.fieldTransforms=a||[],this.fieldMask=u||[]}get path(){return this.settings.path}get Ec(){return this.settings.Ec}Rc(e){return new e_(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Vc(e){var t;const r=(t=this.path)===null||t===void 0?void 0:t.child(e),s=this.Rc({path:r,mc:!1});return s.fc(e),s}gc(e){var t;const r=(t=this.path)===null||t===void 0?void 0:t.child(e),s=this.Rc({path:r,mc:!1});return s.Ac(),s}yc(e){return this.Rc({path:void 0,mc:!0})}wc(e){return vd(e,this.settings.methodName,this.settings.Sc||!1,this.path,this.settings.bc)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}Ac(){if(this.path)for(let e=0;e<this.path.length;e++)this.fc(this.path.get(e))}fc(e){if(e.length===0)throw this.wc("Document fields must not be empty");if(wC(this.Ec)&&ND.test(e))throw this.wc('Document fields cannot begin and end with "__"')}}class OD{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||Jd(e)}Dc(e,t,r,s=!1){return new e_({Ec:e,methodName:t,bc:r,path:Jt.emptyPath(),mc:!1,Sc:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function il(n){const e=n._freezeSettings(),t=Jd(n._databaseId);return new OD(n._databaseId,!!e.ignoreUndefinedProperties,t)}function nf(n,e,t,r,s,a={}){const u=n.Dc(a.merge||a.mergeFields?2:0,e,t,s);i_("Data must be an object, but it was:",u,r);const h=EC(r,u);let f,p;if(a.merge)f=new Ln(u.fieldMask),p=u.fieldTransforms;else if(a.mergeFields){const y=[];for(const v of a.mergeFields){const E=Wm(e,v,t);if(!u.contains(E))throw new ue(Y.INVALID_ARGUMENT,`Field '${E}' is specified in your field mask but missing from your input data.`);IC(y,E)||y.push(E)}f=new Ln(y),p=u.fieldTransforms.filter(v=>f.covers(v.field))}else f=null,p=u.fieldTransforms;return new DD(new dn(h),f,p)}class rf extends tf{_toFieldTransform(e){if(e.Ec!==2)throw e.Ec===1?e.wc(`${this._methodName}() can only appear at the top level of your update data`):e.wc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof rf}}class t_ extends tf{_toFieldTransform(e){return new kN(e.path,new Mu)}isEqual(e){return e instanceof t_}}function n_(n,e,t,r){const s=n.Dc(1,e,t);i_("Data must be an object, but it was:",s,r);const a=[],u=dn.empty();As(r,(f,p)=>{const y=s_(e,f,t);p=Ze(p);const v=s.gc(y);if(p instanceof rf)a.push(y);else{const E=sc(p,v);E!=null&&(a.push(y),u.set(y,E))}});const h=new Ln(a);return new vC(u,h,s.fieldTransforms)}function r_(n,e,t,r,s,a){const u=n.Dc(1,e,t),h=[Wm(e,r,t)],f=[s];if(a.length%2!=0)throw new ue(Y.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let E=0;E<a.length;E+=2)h.push(Wm(e,a[E])),f.push(a[E+1]);const p=[],y=dn.empty();for(let E=h.length-1;E>=0;--E)if(!IC(p,h[E])){const S=h[E];let R=f[E];R=Ze(R);const N=u.gc(S);if(R instanceof rf)p.push(S);else{const O=sc(R,N);O!=null&&(p.push(S),y.set(S,O))}}const v=new Ln(p);return new vC(y,v,u.fieldTransforms)}function LD(n,e,t,r=!1){return sc(t,n.Dc(r?4:3,e))}function sc(n,e){if(TC(n=Ze(n)))return i_("Unsupported field value:",e,n),EC(n,e);if(n instanceof tf)return function(r,s){if(!wC(s.Ec))throw s.wc(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.wc(`${r._methodName}() is not currently supported inside arrays`);const a=r._toFieldTransform(s);a&&s.fieldTransforms.push(a)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.mc&&e.Ec!==4)throw e.wc("Nested arrays are not supported");return function(r,s){const a=[];let u=0;for(const h of r){let f=sc(h,s.yc(u));f==null&&(f={nullValue:"NULL_VALUE"}),a.push(f),u++}return{arrayValue:{values:a}}}(n,e)}return function(r,s){if((r=Ze(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return CN(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const a=ut.fromDate(r);return{timestampValue:pd(s.serializer,a)}}if(r instanceof ut){const a=new ut(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:pd(s.serializer,a)}}if(r instanceof Or)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof On)return{bytesValue:UI(s.serializer,r._byteString)};if(r instanceof gt){const a=s.databaseId,u=r.firestore._databaseId;if(!u.isEqual(a))throw s.wc(`Document reference is for database ${u.projectId}/${u.database} but should be for database ${a.projectId}/${a.database}`);return{referenceValue:Fg(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof Lr)return function(u,h){return{mapValue:{fields:{[fI]:{stringValue:pI},[cd]:{arrayValue:{values:u.toArray().map(p=>{if(typeof p!="number")throw h.wc("VectorValues must only contain numeric values.");return Lg(h.serializer,p)})}}}}}}(r,s);throw s.wc(`Unsupported field value: ${$d(r)}`)}(n,e)}function EC(n,e){const t={};return aI(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):As(n,(r,s)=>{const a=sc(s,e.Vc(r));a!=null&&(t[r]=a)}),{mapValue:{fields:t}}}function TC(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof ut||n instanceof Or||n instanceof On||n instanceof gt||n instanceof tf||n instanceof Lr)}function i_(n,e,t){if(!TC(t)||!sI(t)){const r=$d(t);throw r==="an object"?e.wc(n+" a custom object"):e.wc(n+" "+r)}}function Wm(n,e,t){if((e=Ze(e))instanceof rl)return e._internalPath;if(typeof e=="string")return s_(n,e);throw vd("Field path arguments must be of type string or ",n,!1,void 0,t)}const MD=new RegExp("[~\\*/\\[\\]]");function s_(n,e,t){if(e.search(MD)>=0)throw vd(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new rl(...e.split("."))._internalPath}catch{throw vd(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function vd(n,e,t,r,s){const a=r&&!r.isEmpty(),u=s!==void 0;let h=`Function ${e}() called with invalid data`;t&&(h+=" (via `toFirestore()`)"),h+=". ";let f="";return(a||u)&&(f+=" (found",a&&(f+=` in field ${r}`),u&&(f+=` in document ${s}`),f+=")"),new ue(Y.INVALID_ARGUMENT,h+n+f)}function IC(n,e){return n.some(t=>t.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wd{constructor(e,t,r,s,a){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=s,this._converter=a}get id(){return this._key.path.lastSegment()}get ref(){return new gt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new VD(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(o_("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class VD extends wd{data(){return super.data()}}function o_(n,e){return typeof e=="string"?s_(n,e):e instanceof rl?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CC(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new ue(Y.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class a_{}class FD extends a_{}function ka(n,e,...t){let r=[];e instanceof a_&&r.push(e),r=r.concat(t),function(a){const u=a.filter(f=>f instanceof l_).length,h=a.filter(f=>f instanceof sf).length;if(u>1||u>0&&h>0)throw new ue(Y.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)n=s._apply(n);return n}class sf extends FD{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new sf(e,t,r)}_apply(e){const t=this._parse(e);return SC(e._query,t),new Co(e.firestore,e.converter,Dm(e._query,t))}_parse(e){const t=il(e.firestore);return function(a,u,h,f,p,y,v){let E;if(p.isKeyField()){if(y==="array-contains"||y==="array-contains-any")throw new ue(Y.INVALID_ARGUMENT,`Invalid Query. You can't perform '${y}' queries on documentId().`);if(y==="in"||y==="not-in"){V0(v,y);const R=[];for(const N of v)R.push(M0(f,a,N));E={arrayValue:{values:R}}}else E=M0(f,a,v)}else y!=="in"&&y!=="not-in"&&y!=="array-contains-any"||V0(v,y),E=LD(h,u,v,y==="in"||y==="not-in");return At.create(p,y,E)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function ci(n,e,t){const r=e,s=o_("where",n);return sf._create(s,r,t)}class l_ extends a_{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new l_(e,t)}_parse(e){const t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:pr.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:(function(s,a){let u=s;const h=a.getFlattenedFilters();for(const f of h)SC(u,f),u=Dm(u,f)}(e._query,t),new Co(e.firestore,e.converter,Dm(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function M0(n,e,t){if(typeof(t=Ze(t))=="string"){if(t==="")throw new ue(Y.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!TI(e)&&t.indexOf("/")!==-1)throw new ue(Y.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(Je.fromString(t));if(!ye.isDocumentKey(r))throw new ue(Y.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Xw(n,new ye(r))}if(t instanceof gt)return Xw(n,t._key);throw new ue(Y.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${$d(t)}.`)}function V0(n,e){if(!Array.isArray(n)||n.length===0)throw new ue(Y.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function SC(n,e){const t=function(s,a){for(const u of s)for(const h of u.getFlattenedFilters())if(a.indexOf(h.op)>=0)return h.op;return null}(n.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new ue(Y.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new ue(Y.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class AC{convertValue(e,t="none"){switch(ys(e)){case 0:return null;case 1:return e.booleanValue;case 2:return vt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(_s(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw ve(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return As(e,(s,a)=>{r[s]=this.convertValue(a,t)}),r}convertVectorValue(e){var t,r,s;const a=(s=(r=(t=e.fields)===null||t===void 0?void 0:t[cd].arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.map(u=>vt(u.doubleValue));return new Lr(a)}convertGeoPoint(e){return new Or(vt(e.latitude),vt(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":const r=Hd(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Du(e));default:return null}}convertTimestamp(e){const t=gs(e);return new ut(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=Je.fromString(e);ze(qI(r),9688,{name:e});const s=new Ou(r.get(1),r.get(3)),a=new ye(r.popFirst(5));return s.isEqual(t)||Ei(`Document ${a} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function of(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}class jD extends AC{constructor(e){super(),this.firestore=e}convertBytes(e){return new On(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new gt(this.firestore,null,t)}}class Ra{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class cs extends wd{constructor(e,t,r,s,a,u){super(e,t,r,s,u),this._firestore=e,this._firestoreImpl=e,this.metadata=a}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Kh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(o_("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new ue(Y.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=cs._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}cs._jsonSchemaVersion="firestore/documentSnapshot/1.0",cs._jsonSchema={type:Rt("string",cs._jsonSchemaVersion),bundleSource:Rt("string","DocumentSnapshot"),bundleName:Rt("string"),bundle:Rt("string")};class Kh extends cs{data(e={}){return super.data(e)}}class lo{constructor(e,t,r,s){this._firestore=e,this._userDataWriter=t,this._snapshot=s,this.metadata=new Ra(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new Kh(this._firestore,this._userDataWriter,r.key,r,new Ra(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new ue(Y.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(s,a){if(s._snapshot.oldDocs.isEmpty()){let u=0;return s._snapshot.docChanges.map(h=>{const f=new Kh(s._firestore,s._userDataWriter,h.doc.key,h.doc,new Ra(s._snapshot.mutatedKeys.has(h.doc.key),s._snapshot.fromCache),s.query.converter);return h.doc,{type:"added",doc:f,oldIndex:-1,newIndex:u++}})}{let u=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(h=>a||h.type!==3).map(h=>{const f=new Kh(s._firestore,s._userDataWriter,h.doc.key,h.doc,new Ra(s._snapshot.mutatedKeys.has(h.doc.key),s._snapshot.fromCache),s.query.converter);let p=-1,y=-1;return h.type!==0&&(p=u.indexOf(h.doc.key),u=u.delete(h.doc.key)),h.type!==1&&(u=u.add(h.doc),y=u.indexOf(h.doc.key)),{type:UD(h.type),doc:f,oldIndex:p,newIndex:y}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new ue(Y.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=lo._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Rg.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],r=[],s=[];return this.docs.forEach(a=>{a._document!==null&&(t.push(a._document),r.push(this._userDataWriter.convertObjectMap(a._document.data.value.mapValue.fields,"previous")),s.push(a.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function UD(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ve(61501,{type:n})}}lo._jsonSchemaVersion="firestore/querySnapshot/1.0",lo._jsonSchema={type:Rt("string",lo._jsonSchemaVersion),bundleSource:Rt("string","QuerySnapshot"),bundleName:Rt("string"),bundle:Rt("string")};class af extends AC{constructor(e){super(),this.firestore=e}convertBytes(e){return new On(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new gt(this.firestore,null,t)}}function F0(n){n=In(n,Co);const e=In(n.firestore,Fr),t=ic(e),r=new af(e);return CC(n._query),RD(t,n._query).then(s=>new lo(e,r,n,s))}function kC(n,e,t){n=In(n,gt);const r=In(n.firestore,Fr),s=of(n.converter,e,t);return oc(r,[nf(il(r),"setDoc",n._key,s,n.converter!==null,t).toMutation(n._key,kt.none())])}function xa(n,e,t,...r){n=In(n,gt);const s=In(n.firestore,Fr),a=il(s);let u;return u=typeof(e=Ze(e))=="string"||e instanceof rl?r_(a,"updateDoc",n._key,e,t,r):n_(a,"updateDoc",n._key,e),oc(s,[u.toMutation(n._key,kt.exists(!0))])}function j0(n){return oc(In(n.firestore,Fr),[new ec(n._key,kt.none())])}function BD(n,e){const t=In(n.firestore,Fr),r=wt(n),s=of(n.converter,e);return oc(t,[nf(il(n.firestore),"addDoc",r._key,s,n.converter!==null,{}).toMutation(r._key,kt.exists(!1))]).then(()=>r)}function go(n,...e){var t,r,s;n=Ze(n);let a={includeMetadataChanges:!1,source:"default"},u=0;typeof e[u]!="object"||L0(e[u])||(a=e[u++]);const h={includeMetadataChanges:a.includeMetadataChanges,source:a.source};if(L0(e[u])){const v=e[u];e[u]=(t=v.next)===null||t===void 0?void 0:t.bind(v),e[u+1]=(r=v.error)===null||r===void 0?void 0:r.bind(v),e[u+2]=(s=v.complete)===null||s===void 0?void 0:s.bind(v)}let f,p,y;if(n instanceof gt)p=In(n.firestore,Fr),y=Og(n._key.path),f={next:v=>{e[u]&&e[u](zD(p,n,v))},error:e[u+1],complete:e[u+2]};else{const v=In(n,Co);p=In(v.firestore,Fr),y=v._query;const E=new af(p);f={next:S=>{e[u]&&e[u](new lo(p,E,v,S))},error:e[u+1],complete:e[u+2]},CC(n._query)}return function(E,S,R,N){const O=new gC(N),V=new aC(S,O,R);return E.asyncQueue.enqueueAndForget(async()=>sC(await $m(E),V)),()=>{O.Ou(),E.asyncQueue.enqueueAndForget(async()=>oC(await $m(E),V))}}(ic(p),y,h,f)}function oc(n,e){return function(r,s){const a=new gi;return r.asyncQueue.enqueueAndForget(async()=>fD(await AD(r),s,a)),a.promise}(ic(n),e)}function zD(n,e,t){const r=t.docs.get(e._key),s=new af(n);return new cs(n,s,e._key,r,new Ra(t.hasPendingWrites,t.fromCache),e.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $D={maxAttempts:5};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WD{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=il(e)}set(e,t,r){this._verifyNotCommitted();const s=is(e,this._firestore),a=of(s.converter,t,r),u=nf(this._dataReader,"WriteBatch.set",s._key,a,s.converter!==null,r);return this._mutations.push(u.toMutation(s._key,kt.none())),this}update(e,t,r,...s){this._verifyNotCommitted();const a=is(e,this._firestore);let u;return u=typeof(t=Ze(t))=="string"||t instanceof rl?r_(this._dataReader,"WriteBatch.update",a._key,t,r,s):n_(this._dataReader,"WriteBatch.update",a._key,t),this._mutations.push(u.toMutation(a._key,kt.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=is(e,this._firestore);return this._mutations=this._mutations.concat(new ec(t._key,kt.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new ue(Y.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function is(n,e){if((n=Ze(n)).firestore!==e)throw new ue(Y.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HD{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=il(e)}get(e){const t=is(e,this._firestore),r=new jD(this._firestore);return this._transaction.lookup([t._key]).then(s=>{if(!s||s.length!==1)return ve(24041);const a=s[0];if(a.isFoundDocument())return new wd(this._firestore,r,a.key,a,t.converter);if(a.isNoDocument())return new wd(this._firestore,r,t._key,null,t.converter);throw ve(18433,{doc:a})})}set(e,t,r){const s=is(e,this._firestore),a=of(s.converter,t,r),u=nf(this._dataReader,"Transaction.set",s._key,a,s.converter!==null,r);return this._transaction.set(s._key,u),this}update(e,t,r,...s){const a=is(e,this._firestore);let u;return u=typeof(t=Ze(t))=="string"||t instanceof rl?r_(this._dataReader,"Transaction.update",a._key,t,r,s):n_(this._dataReader,"Transaction.update",a._key,t),this._transaction.update(a._key,u),this}delete(e){const t=is(e,this._firestore);return this._transaction.delete(t._key),this}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GD extends HD{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=is(e,this._firestore),r=new af(this._firestore);return super.get(e).then(s=>new cs(this._firestore,r,t._key,s._document,new Ra(!1,!1),t.converter))}}function U0(n,e,t){n=In(n,Fr);const r=Object.assign(Object.assign({},$D),t);return function(a){if(a.maxAttempts<1)throw new ue(Y.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(a,u,h){const f=new gi;return a.asyncQueue.enqueueAndForget(async()=>{const p=await kD(a);new ID(a.asyncQueue,p,h,u,f).zu()}),f.promise}(ic(n),s=>e(new GD(n,s)),r)}function uo(){return new t_("serverTimestamp")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function u_(n){return ic(n=In(n,Fr)),new WD(n,e=>oc(n,e))}(function(e,t=!0){(function(s){Za=s})(wo),co(new fs("firestore",(r,{instanceIdentifier:s,options:a})=>{const u=r.getProvider("app").getImmediate(),h=new Fr(new Vb(r.getProvider("auth-internal")),new Ub(u,r.getProvider("app-check-internal")),function(p,y){if(!Object.prototype.hasOwnProperty.apply(p.options,["projectId"]))throw new ue(Y.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ou(p.options.projectId,y)}(u,s),u);return a=Object.assign({useFetchStreams:t},a),h._setSettings(a),h},"PUBLIC").setMultipleInstances(!0)),Pr(Fw,jw,e),Pr(Fw,jw,"esm2017")})();var B0={};const z0="@firebase/database",$0="1.0.20";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let RC="";function qD(n){RC=n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KD{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){t==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),Yt(t))}get(e){const t=this.domStorage_.getItem(this.prefixedName_(e));return t==null?null:Ru(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QD{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){t==null?delete this.cache_[e]:this.cache_[e]=t}get(e){return Br(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xC=function(n){try{if(typeof window<"u"&&typeof window[n]<"u"){const e=window[n];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new KD(e)}}catch{}return new QD},oo=xC("localStorage"),YD=xC("sessionStorage");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const La=new Vd("@firebase/database"),JD=function(){let n=1;return function(){return n++}}(),PC=function(n){const e=ax(n),t=new rx;t.update(e);const r=t.digest();return hg.encodeByteArray(r)},ac=function(...n){let e="";for(let t=0;t<n.length;t++){const r=n[t];Array.isArray(r)||r&&typeof r=="object"&&typeof r.length=="number"?e+=ac.apply(null,r):typeof r=="object"?e+=Yt(r):e+=r,e+=" "}return e};let Iu=null,W0=!0;const XD=function(n,e){le(!0,"Can't turn on custom loggers persistently."),La.logLevel=be.VERBOSE,Iu=La.log.bind(La)},Qt=function(...n){if(W0===!0&&(W0=!1,Iu===null&&YD.get("logging_enabled")===!0&&XD()),Iu){const e=ac.apply(null,n);Iu(e)}},lc=function(n){return function(...e){Qt(n,...e)}},Hm=function(...n){const e="FIREBASE INTERNAL ERROR: "+ac(...n);La.error(e)},Ii=function(...n){const e=`FIREBASE FATAL ERROR: ${ac(...n)}`;throw La.error(e),new Error(e)},Cn=function(...n){const e="FIREBASE WARNING: "+ac(...n);La.warn(e)},ZD=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&Cn("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},lf=function(n){return typeof n=="number"&&(n!==n||n===Number.POSITIVE_INFINITY||n===Number.NEGATIVE_INFINITY)},eO=function(n){if(document.readyState==="complete")n();else{let e=!1;const t=function(){if(!document.body){setTimeout(t,Math.floor(10));return}e||(e=!0,n())};document.addEventListener?(document.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&t()}),window.attachEvent("onload",t))}},Ha="[MIN_NAME]",_o="[MAX_NAME]",So=function(n,e){if(n===e)return 0;if(n===Ha||e===_o)return-1;if(e===Ha||n===_o)return 1;{const t=H0(n),r=H0(e);return t!==null?r!==null?t-r===0?n.length-e.length:t-r:-1:r!==null?1:n<e?-1:1}},tO=function(n,e){return n===e?0:n<e?-1:1},ou=function(n,e){if(e&&n in e)return e[n];throw new Error("Missing required key ("+n+") in object: "+Yt(e))},c_=function(n){if(typeof n!="object"||n===null)return Yt(n);const e=[];for(const r in n)e.push(r);e.sort();let t="{";for(let r=0;r<e.length;r++)r!==0&&(t+=","),t+=Yt(e[r]),t+=":",t+=c_(n[e[r]]);return t+="}",t},bC=function(n,e){const t=n.length;if(t<=e)return[n];const r=[];for(let s=0;s<t;s+=e)s+e>t?r.push(n.substring(s,t)):r.push(n.substring(s,s+e));return r};function Sn(n,e){for(const t in n)n.hasOwnProperty(t)&&e(t,n[t])}const NC=function(n){le(!lf(n),"Invalid JSON number");const e=11,t=52,r=(1<<e-1)-1;let s,a,u,h,f;n===0?(a=0,u=0,s=1/n===-1/0?1:0):(s=n<0,n=Math.abs(n),n>=Math.pow(2,1-r)?(h=Math.min(Math.floor(Math.log(n)/Math.LN2),r),a=h+r,u=Math.round(n*Math.pow(2,t-h)-Math.pow(2,t))):(a=0,u=Math.round(n/Math.pow(2,1-r-t))));const p=[];for(f=t;f;f-=1)p.push(u%2?1:0),u=Math.floor(u/2);for(f=e;f;f-=1)p.push(a%2?1:0),a=Math.floor(a/2);p.push(s?1:0),p.reverse();const y=p.join("");let v="";for(f=0;f<64;f+=8){let E=parseInt(y.substr(f,8),2).toString(16);E.length===1&&(E="0"+E),v=v+E}return v.toLowerCase()},nO=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},rO=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"},iO=new RegExp("^-?(0*)\\d{1,10}$"),sO=-2147483648,oO=2147483647,H0=function(n){if(iO.test(n)){const e=Number(n);if(e>=sO&&e<=oO)return e}return null},sl=function(n){try{n()}catch(e){setTimeout(()=>{const t=e.stack||"";throw Cn("Exception was thrown by user callback.",t),e},Math.floor(0))}},aO=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},Cu=function(n,e){const t=setTimeout(n,e);return typeof t=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(t):typeof t=="object"&&t.unref&&t.unref(),t};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lO{constructor(e,t){this.appCheckProvider=t,this.appName=e.name,Dn(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.appCheck=t?.getImmediate({optional:!0}),this.appCheck||t?.get().then(r=>this.appCheck=r)}getToken(e){if(this.serverAppAppCheckToken){if(e)throw new Error("Attempted reuse of `FirebaseServerApp.appCheckToken` after previous usage failed.");return Promise.resolve({token:this.serverAppAppCheckToken})}return this.appCheck?this.appCheck.getToken(e):new Promise((t,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){var t;(t=this.appCheckProvider)===null||t===void 0||t.get().then(r=>r.addTokenListener(e))}notifyForInvalidToken(){Cn(`Provided AppCheck credentials for the app named "${this.appName}" are invalid. This usually indicates your app was not initialized correctly.`)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uO{constructor(e,t,r){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(s=>this.auth_=s)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(t=>t&&t.code==="auth/token-not-initialized"?(Qt("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)):new Promise((t,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(t=>t.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(t=>t.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',Cn(e)}}class Qh{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}Qh.OWNER="owner";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h_="5",DC="v",OC="s",LC="r",MC="f",VC=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,FC="ls",jC="p",Gm="ac",UC="websocket",BC="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zC{constructor(e,t,r,s,a=!1,u="",h=!1,f=!1,p=null){this.secure=t,this.namespace=r,this.webSocketOnly=s,this.nodeAdmin=a,this.persistenceKey=u,this.includeNamespaceInQueryParams=h,this.isUsingEmulator=f,this.emulatorOptions=p,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=oo.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&oo.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${t}`}}function cO(n){return n.host!==n.internalHost||n.isCustomHost()||n.includeNamespaceInQueryParams}function $C(n,e,t){le(typeof e=="string","typeof type must == string"),le(typeof t=="object","typeof params must == object");let r;if(e===UC)r=(n.secure?"wss://":"ws://")+n.internalHost+"/.ws?";else if(e===BC)r=(n.secure?"https://":"http://")+n.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);cO(n)&&(t.ns=n.namespace);const s=[];return Sn(t,(a,u)=>{s.push(a+"="+u)}),r+s.join("&")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hO{constructor(){this.counters_={}}incrementCounter(e,t=1){Br(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return MR(this.counters_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const om={},am={};function d_(n){const e=n.toString();return om[e]||(om[e]=new hO),om[e]}function dO(n,e){const t=n.toString();return am[t]||(am[t]=e()),am[t]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fO{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){const r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let s=0;s<r.length;++s)r[s]&&sl(()=>{this.onMessage_(r[s])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G0="start",pO="close",mO="pLPCommand",gO="pRTLPCB",WC="id",HC="pw",GC="ser",_O="cb",yO="seg",vO="ts",wO="d",EO="dframe",qC=1870,KC=30,TO=qC-KC,IO=25e3,CO=3e4;class Pa{constructor(e,t,r,s,a,u,h){this.connId=e,this.repoInfo=t,this.applicationId=r,this.appCheckToken=s,this.authToken=a,this.transportSessionId=u,this.lastSessionId=h,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=lc(e),this.stats_=d_(t),this.urlFn=f=>(this.appCheckToken&&(f[Gm]=this.appCheckToken),$C(t,BC,f))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new fO(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(CO)),eO(()=>{if(this.isClosed_)return;this.scriptTagHolder=new f_((...a)=>{const[u,h,f,p,y]=a;if(this.incrementIncomingBytes_(a),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,u===G0)this.id=h,this.password=f;else if(u===pO)h?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(h,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+u)},(...a)=>{const[u,h]=a;this.incrementIncomingBytes_(a),this.myPacketOrderer.handleResponse(u,h)},()=>{this.onClosed_()},this.urlFn);const r={};r[G0]="t",r[GC]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(r[_O]=this.scriptTagHolder.uniqueCallbackIdentifier),r[DC]=h_,this.transportSessionId&&(r[OC]=this.transportSessionId),this.lastSessionId&&(r[FC]=this.lastSessionId),this.applicationId&&(r[jC]=this.applicationId),this.appCheckToken&&(r[Gm]=this.appCheckToken),typeof location<"u"&&location.hostname&&VC.test(location.hostname)&&(r[LC]=MC);const s=this.urlFn(r);this.log_("Connecting via long-poll to "+s),this.scriptTagHolder.addTag(s,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){Pa.forceAllow_=!0}static forceDisallow(){Pa.forceDisallow_=!0}static isAvailable(){return Pa.forceAllow_?!0:!Pa.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!nO()&&!rO()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const t=Yt(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const r=ZE(t),s=bC(r,TO);for(let a=0;a<s.length;a++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,s.length,s[a]),this.curSegmentNum++}addDisconnectPingFrame(e,t){this.myDisconnFrame=document.createElement("iframe");const r={};r[EO]="t",r[WC]=e,r[HC]=t,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const t=Yt(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}class f_{constructor(e,t,r,s){this.onDisconnect=r,this.urlFn=s,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=JD(),window[mO+this.uniqueCallbackIdentifier]=e,window[gO+this.uniqueCallbackIdentifier]=t,this.myIFrame=f_.createIFrame_();let a="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(a='<script>document.domain="'+document.domain+'";<\/script>');const u="<html><body>"+a+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(u),this.myIFrame.doc.close()}catch(h){Qt("frame writing exception"),h.stack&&Qt(h.stack),Qt(h)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||Qt("No IE domain setting required")}catch{const r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e[WC]=this.myID,e[HC]=this.myPW,e[GC]=this.currentSerial;let t=this.urlFn(e),r="",s=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+KC+r.length<=qC;){const u=this.pendingSegs.shift();r=r+"&"+yO+s+"="+u.seg+"&"+vO+s+"="+u.ts+"&"+wO+s+"="+u.d,s++}return t=t+r,this.addLongPollTag_(t,this.currentSerial),!0}else return!1}enqueueSegment(e,t,r){this.pendingSegs.push({seg:e,ts:t,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);const r=()=>{this.outstandingRequests.delete(t),this.newRequest_()},s=setTimeout(r,Math.floor(IO)),a=()=>{clearTimeout(s),r()};this.addTag(e,a)}addTag(e,t){setTimeout(()=>{try{if(!this.sendNewPolls)return;const r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){const s=r.readyState;(!s||s==="loaded"||s==="complete")&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),t())},r.onerror=()=>{Qt("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SO=16384,AO=45e3;let Ed=null;typeof MozWebSocket<"u"?Ed=MozWebSocket:typeof WebSocket<"u"&&(Ed=WebSocket);class cr{constructor(e,t,r,s,a,u,h){this.connId=e,this.applicationId=r,this.appCheckToken=s,this.authToken=a,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=lc(this.connId),this.stats_=d_(t),this.connURL=cr.connectionURL_(t,u,h,s,r),this.nodeAdmin=t.nodeAdmin}static connectionURL_(e,t,r,s,a){const u={};return u[DC]=h_,typeof location<"u"&&location.hostname&&VC.test(location.hostname)&&(u[LC]=MC),t&&(u[OC]=t),r&&(u[FC]=r),s&&(u[Gm]=s),a&&(u[jC]=a),$C(e,UC,u)}open(e,t){this.onDisconnect=t,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,oo.set("previous_websocket_failure",!0);try{let r;KR(),this.mySock=new Ed(this.connURL,[],r)}catch(r){this.log_("Error instantiating WebSocket.");const s=r.message||r.data;s&&this.log_(s),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=r=>{this.handleIncomingFrame(r)},this.mySock.onerror=r=>{this.log_("WebSocket error.  Closing connection.");const s=r.message||r.data;s&&this.log_(s),this.onClosed_()}}start(){}static forceDisallow(){cr.forceDisallow_=!0}static isAvailable(){let e=!1;if(typeof navigator<"u"&&navigator.userAgent){const t=/Android ([0-9]{0,}\.[0-9]{0,})/,r=navigator.userAgent.match(t);r&&r.length>1&&parseFloat(r[1])<4.4&&(e=!0)}return!e&&Ed!==null&&!cr.forceDisallow_}static previouslyFailed(){return oo.isInMemoryStorage||oo.get("previous_websocket_failure")===!0}markConnectionHealthy(){oo.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const t=this.frames.join("");this.frames=null;const r=Ru(t);this.onMessage(r)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(le(this.frames===null,"We already have a frame buffer"),e.length<=6){const t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(this.mySock===null)return;const t=e.data;if(this.bytesReceived+=t.length,this.stats_.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(t);else{const r=this.extractFrameCount_(t);r!==null&&this.appendFrame_(r)}}send(e){this.resetKeepAlive();const t=Yt(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const r=bC(t,SO);r.length>1&&this.sendString_(String(r.length));for(let s=0;s<r.length;s++)this.sendString_(r[s])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(AO))}sendString_(e){try{this.mySock.send(e)}catch(t){this.log_("Exception thrown from WebSocket.send():",t.message||t.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}cr.responsesRequiredToBeHealthy=2;cr.healthyTimeout=3e4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ju{static get ALL_TRANSPORTS(){return[Pa,cr]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}constructor(e){this.initTransports_(e)}initTransports_(e){const t=cr&&cr.isAvailable();let r=t&&!cr.previouslyFailed();if(e.webSocketOnly&&(t||Cn("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),r=!0),r)this.transports_=[cr];else{const s=this.transports_=[];for(const a of ju.ALL_TRANSPORTS)a&&a.isAvailable()&&s.push(a);ju.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}ju.globalTransportInitialized_=!1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kO=6e4,RO=5e3,xO=10*1024,PO=100*1024,lm="t",q0="d",bO="s",K0="r",NO="e",Q0="o",Y0="a",J0="n",X0="p",DO="h";class OO{constructor(e,t,r,s,a,u,h,f,p,y){this.id=e,this.repoInfo_=t,this.applicationId_=r,this.appCheckToken_=s,this.authToken_=a,this.onMessage_=u,this.onReady_=h,this.onDisconnect_=f,this.onKill_=p,this.lastSessionId=y,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=lc("c:"+this.id+":"),this.transportManager_=new ju(t),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(t,r)},Math.floor(0));const s=e.healthyTimeout||0;s>0&&(this.healthyTimeout_=Cu(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>PO?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>xO?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(s)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){const t={t:"d",d:e};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(lm in e){const t=e[lm];t===Y0?this.upgradeIfSecondaryHealthy_():t===K0?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):t===Q0&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const t=ou("t",e),r=ou("d",e);if(t==="c")this.onSecondaryControl_(r);else if(t==="d")this.pendingDataMessages.push(r);else throw new Error("Unknown protocol layer: "+t)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:X0,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:Y0,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:J0,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const t=ou("t",e),r=ou("d",e);t==="c"?this.onControl_(r):t==="d"&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const t=ou(lm,e);if(q0 in e){const r=e[q0];if(t===DO){const s=Object.assign({},r);this.repoInfo_.isUsingEmulator&&(s.h=this.repoInfo_.host),this.onHandshake_(s)}else if(t===J0){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let s=0;s<this.pendingDataMessages.length;++s)this.onDataMessage_(this.pendingDataMessages[s]);this.pendingDataMessages=[],this.tryCleanupConnection()}else t===bO?this.onConnectionShutdown_(r):t===K0?this.onReset_(r):t===NO?Hm("Server Error: "+r):t===Q0?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):Hm("Unknown control packet command: "+t)}}onHandshake_(e){const t=e.ts,r=e.v,s=e.h;this.sessionId=e.s,this.repoInfo_.host=s,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),h_!==r&&Cn("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,r),Cu(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(kO))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Cu(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(RO))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:X0,d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(oo.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QC{put(e,t,r,s){}merge(e,t,r,s){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,r){}onDisconnectMerge(e,t,r){}onDisconnectCancel(e,t){}reportStats(e){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YC{constructor(e){this.allowedEvents_=e,this.listeners_={},le(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){const r=[...this.listeners_[e]];for(let s=0;s<r.length;s++)r[s].callback.apply(r[s].context,t)}}on(e,t,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:r});const s=this.getInitialEvent(e);s&&t.apply(r,s)}off(e,t,r){this.validateEventType_(e);const s=this.listeners_[e]||[];for(let a=0;a<s.length;a++)if(s[a].callback===t&&(!r||r===s[a].context)){s.splice(a,1);return}}validateEventType_(e){le(this.allowedEvents_.find(t=>t===e),"Unknown event: "+e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Td extends YC{static getInstance(){return new Td}constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!pg()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}getInitialEvent(e){return le(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z0=32,eE=768;class tt{constructor(e,t){if(t===void 0){this.pieces_=e.split("/");let r=0;for(let s=0;s<this.pieces_.length;s++)this.pieces_[s].length>0&&(this.pieces_[r]=this.pieces_[s],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)this.pieces_[t]!==""&&(e+="/"+this.pieces_[t]);return e||"/"}}function Xe(){return new tt("")}function Ne(n){return n.pieceNum_>=n.pieces_.length?null:n.pieces_[n.pieceNum_]}function Es(n){return n.pieces_.length-n.pieceNum_}function st(n){let e=n.pieceNum_;return e<n.pieces_.length&&e++,new tt(n.pieces_,e)}function p_(n){return n.pieceNum_<n.pieces_.length?n.pieces_[n.pieces_.length-1]:null}function LO(n){let e="";for(let t=n.pieceNum_;t<n.pieces_.length;t++)n.pieces_[t]!==""&&(e+="/"+encodeURIComponent(String(n.pieces_[t])));return e||"/"}function Uu(n,e=0){return n.pieces_.slice(n.pieceNum_+e)}function JC(n){if(n.pieceNum_>=n.pieces_.length)return null;const e=[];for(let t=n.pieceNum_;t<n.pieces_.length-1;t++)e.push(n.pieces_[t]);return new tt(e,0)}function Et(n,e){const t=[];for(let r=n.pieceNum_;r<n.pieces_.length;r++)t.push(n.pieces_[r]);if(e instanceof tt)for(let r=e.pieceNum_;r<e.pieces_.length;r++)t.push(e.pieces_[r]);else{const r=e.split("/");for(let s=0;s<r.length;s++)r[s].length>0&&t.push(r[s])}return new tt(t,0)}function Le(n){return n.pieceNum_>=n.pieces_.length}function qn(n,e){const t=Ne(n),r=Ne(e);if(t===null)return e;if(t===r)return qn(st(n),st(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+n+")")}function MO(n,e){const t=Uu(n,0),r=Uu(e,0);for(let s=0;s<t.length&&s<r.length;s++){const a=So(t[s],r[s]);if(a!==0)return a}return t.length===r.length?0:t.length<r.length?-1:1}function XC(n,e){if(Es(n)!==Es(e))return!1;for(let t=n.pieceNum_,r=e.pieceNum_;t<=n.pieces_.length;t++,r++)if(n.pieces_[t]!==e.pieces_[r])return!1;return!0}function Kn(n,e){let t=n.pieceNum_,r=e.pieceNum_;if(Es(n)>Es(e))return!1;for(;t<n.pieces_.length;){if(n.pieces_[t]!==e.pieces_[r])return!1;++t,++r}return!0}class VO{constructor(e,t){this.errorPrefix_=t,this.parts_=Uu(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=Md(this.parts_[r]);ZC(this)}}function FO(n,e){n.parts_.length>0&&(n.byteLength_+=1),n.parts_.push(e),n.byteLength_+=Md(e),ZC(n)}function jO(n){const e=n.parts_.pop();n.byteLength_-=Md(e),n.parts_.length>0&&(n.byteLength_-=1)}function ZC(n){if(n.byteLength_>eE)throw new Error(n.errorPrefix_+"has a key path longer than "+eE+" bytes ("+n.byteLength_+").");if(n.parts_.length>Z0)throw new Error(n.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+Z0+") or object contains a cycle "+ro(n))}function ro(n){return n.parts_.length===0?"":"in property '"+n.parts_.join(".")+"'"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m_ extends YC{static getInstance(){return new m_}constructor(){super(["visible"]);let e,t;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(t="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(t="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(t="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,()=>{const r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}getInitialEvent(e){return le(e==="visible","Unknown event type: "+e),[this.visible_]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const au=1e3,UO=60*5*1e3,tE=30*1e3,BO=1.3,zO=3e4,$O="server_kill",nE=3;class _i extends QC{constructor(e,t,r,s,a,u,h,f){if(super(),this.repoInfo_=e,this.applicationId_=t,this.onDataUpdate_=r,this.onConnectStatus_=s,this.onServerInfoUpdate_=a,this.authTokenProvider_=u,this.appCheckTokenProvider_=h,this.authOverride_=f,this.id=_i.nextPersistentConnectionId_++,this.log_=lc("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=au,this.maxReconnectDelay_=UO,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,f)throw new Error("Auth override specified in options, but not supported on non Node.js platforms");m_.getInstance().on("visible",this.onVisible_,this),e.host.indexOf("fblocal")===-1&&Td.getInstance().on("online",this.onOnline_,this)}sendRequest(e,t,r){const s=++this.requestNumber_,a={r:s,a:e,b:t};this.log_(Yt(a)),le(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(a),r&&(this.requestCBHash_[s]=r)}get(e){this.initConnection_();const t=new ui,s={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:u=>{const h=u.d;u.s==="ok"?t.resolve(h):t.reject(h)}};this.outstandingGets_.push(s),this.outstandingGetCount_++;const a=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(a),t.promise}listen(e,t,r,s){this.initConnection_();const a=e._queryIdentifier,u=e._path.toString();this.log_("Listen called for "+u+" "+a),this.listens.has(u)||this.listens.set(u,new Map),le(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),le(!this.listens.get(u).has(a),"listen() called twice for same path/queryId.");const h={onComplete:s,hashFn:t,query:e,tag:r};this.listens.get(u).set(a,h),this.connected_&&this.sendListen_(h)}sendGet_(e){const t=this.outstandingGets_[e];this.sendRequest("g",t.request,r=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),t.onComplete&&t.onComplete(r)})}sendListen_(e){const t=e.query,r=t._path.toString(),s=t._queryIdentifier;this.log_("Listen on "+r+" for "+s);const a={p:r},u="q";e.tag&&(a.q=t._queryObject,a.t=e.tag),a.h=e.hashFn(),this.sendRequest(u,a,h=>{const f=h.d,p=h.s;_i.warnOnListenWarnings_(f,t),(this.listens.get(r)&&this.listens.get(r).get(s))===e&&(this.log_("listen response",h),p!=="ok"&&this.removeListen_(r,s),e.onComplete&&e.onComplete(p,f))})}static warnOnListenWarnings_(e,t){if(e&&typeof e=="object"&&Br(e,"w")){const r=Fa(e,"w");if(Array.isArray(r)&&~r.indexOf("no_index")){const s='".indexOn": "'+t._queryParams.getIndex().toString()+'"',a=t._path.toString();Cn(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${s} at ${a} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&e.length===40||nx(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=tE)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,t=tx(e)?"auth":"gauth",r={cred:e};this.authOverride_===null?r.noauth=!0:typeof this.authOverride_=="object"&&(r.authvar=this.authOverride_),this.sendRequest(t,r,s=>{const a=s.s,u=s.d||"error";this.authToken_===e&&(a==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(a,u))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{const t=e.s,r=e.d||"error";t==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(t,r)})}unlisten(e,t){const r=e._path.toString(),s=e._queryIdentifier;this.log_("Unlisten called for "+r+" "+s),le(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(r,s)&&this.connected_&&this.sendUnlisten_(r,s,e._queryObject,t)}sendUnlisten_(e,t,r,s){this.log_("Unlisten on "+e+" for "+t);const a={p:e},u="n";s&&(a.q=r,a.t=s),this.sendRequest(u,a)}onDisconnectPut(e,t,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,t,r):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:r})}onDisconnectMerge(e,t,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,t,r):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:r})}onDisconnectCancel(e,t){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})}sendOnDisconnect_(e,t,r,s){const a={p:t,d:r};this.log_("onDisconnect "+e,a),this.sendRequest(e,a,u=>{s&&setTimeout(()=>{s(u.s,u.d)},Math.floor(0))})}put(e,t,r,s){this.putInternal("p",e,t,r,s)}merge(e,t,r,s){this.putInternal("m",e,t,r,s)}putInternal(e,t,r,s,a){this.initConnection_();const u={p:t,d:r};a!==void 0&&(u.h=a),this.outstandingPuts_.push({action:e,request:u,onComplete:s}),this.outstandingPutCount_++;const h=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(h):this.log_("Buffering put: "+t)}sendPut_(e){const t=this.outstandingPuts_[e].action,r=this.outstandingPuts_[e].request,s=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(t,r,a=>{this.log_(t+" response",a),delete this.outstandingPuts_[e],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),s&&s(a.s,a.d)})}reportStats(e){if(this.connected_){const t={c:e};this.log_("reportStats",t),this.sendRequest("s",t,r=>{if(r.s!=="ok"){const a=r.d;this.log_("reportStats","Error sending stats: "+a)}})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+Yt(e));const t=e.r,r=this.requestCBHash_[t];r&&(delete this.requestCBHash_[t],r(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,t){this.log_("handleServerMessage",e,t),e==="d"?this.onDataUpdate_(t.p,t.d,!1,t.t):e==="m"?this.onDataUpdate_(t.p,t.d,!0,t.t):e==="c"?this.onListenRevoked_(t.p,t.q):e==="ac"?this.onAuthRevoked_(t.s,t.d):e==="apc"?this.onAppCheckRevoked_(t.s,t.d):e==="sd"?this.onSecurityDebugPacket_(t):Hm("Unrecognized action received from server: "+Yt(e)+`
Are you using the latest client?`)}onReady_(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){le(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=au,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=au,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>zO&&(this.reconnectDelay_=au),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const e=Math.max(0,new Date().getTime()-this.lastConnectionAttemptTime_);let t=Math.max(0,this.reconnectDelay_-e);t=Math.random()*t,this.log_("Trying to reconnect in "+t+"ms"),this.scheduleConnect_(t),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*BO)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),t=this.onReady_.bind(this),r=this.onRealtimeDisconnect_.bind(this),s=this.id+":"+_i.nextConnectionId_++,a=this.lastSessionId;let u=!1,h=null;const f=function(){h?h.close():(u=!0,r())},p=function(v){le(h,"sendRequest call when we're not connected not allowed."),h.sendRequest(v)};this.realtime_={close:f,sendRequest:p};const y=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[v,E]=await Promise.all([this.authTokenProvider_.getToken(y),this.appCheckTokenProvider_.getToken(y)]);u?Qt("getToken() completed but was canceled"):(Qt("getToken() completed. Creating connection."),this.authToken_=v&&v.accessToken,this.appCheckToken_=E&&E.token,h=new OO(s,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,t,r,S=>{Cn(S+" ("+this.repoInfo_.toString()+")"),this.interrupt($O)},a))}catch(v){this.log_("Failed to get token: "+v),u||(this.repoInfo_.nodeAdmin&&Cn(v),f())}}}interrupt(e){Qt("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){Qt("Resuming connection for reason: "+e),delete this.interruptReasons_[e],Zh(this.interruptReasons_)&&(this.reconnectDelay_=au,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const t=e-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:t})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(e,t){let r;t?r=t.map(a=>c_(a)).join("$"):r="default";const s=this.removeListen_(e,r);s&&s.onComplete&&s.onComplete("permission_denied")}removeListen_(e,t){const r=new tt(e).toString();let s;if(this.listens.has(r)){const a=this.listens.get(r);s=a.get(t),a.delete(t),a.size===0&&this.listens.delete(r)}else s=void 0;return s}onAuthRevoked_(e,t){Qt("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(e==="invalid_token"||e==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=nE&&(this.reconnectDelay_=tE,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,t){Qt("App check token revoked: "+e+"/"+t),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(e==="invalid_token"||e==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=nE&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const t of e.values())this.sendListen_(t);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let t="js";e["sdk."+t+"."+RC.replace(/\./g,"-")]=1,pg()?e["framework.cordova"]=1:oT()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=Td.getInstance().currentlyOnline();return Zh(this.interruptReasons_)&&e}}_i.nextPersistentConnectionId_=0;_i.nextConnectionId_=0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Be{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new Be(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uf{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){const r=new Be(Ha,e),s=new Be(Ha,t);return this.compare(r,s)!==0}minPost(){return Be.MIN}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Lh;class eS extends uf{static get __EMPTY_NODE(){return Lh}static set __EMPTY_NODE(e){Lh=e}compare(e,t){return So(e.name,t.name)}isDefinedOn(e){throw Ya("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return Be.MIN}maxPost(){return new Be(_o,Lh)}makePost(e,t){return le(typeof e=="string","KeyIndex indexValue must always be a string."),new Be(e,Lh)}toString(){return".key"}}const Ma=new eS;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mh{constructor(e,t,r,s,a=null){this.isReverse_=s,this.resultGenerator_=a,this.nodeStack_=[];let u=1;for(;!e.isEmpty();)if(e=e,u=t?r(e.key,t):1,s&&(u*=-1),u<0)this.isReverse_?e=e.left:e=e.right;else if(u===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),t;if(this.resultGenerator_?t=this.resultGenerator_(e.key,e.value):t={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class $t{constructor(e,t,r,s,a){this.key=e,this.value=t,this.color=r??$t.RED,this.left=s??Tn.EMPTY_NODE,this.right=a??Tn.EMPTY_NODE}copy(e,t,r,s,a){return new $t(e??this.key,t??this.value,r??this.color,s??this.left,a??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let s=this;const a=r(e,s.key);return a<0?s=s.copy(null,null,null,s.left.insert(e,t,r),null):a===0?s=s.copy(null,t,null,null,null):s=s.copy(null,null,null,null,s.right.insert(e,t,r)),s.fixUp_()}removeMin_(){if(this.left.isEmpty())return Tn.EMPTY_NODE;let e=this;return!e.left.isRed_()&&!e.left.left.isRed_()&&(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,t){let r,s;if(r=this,t(e,r.key)<0)!r.left.isEmpty()&&!r.left.isRed_()&&!r.left.left.isRed_()&&(r=r.moveRedLeft_()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed_()&&(r=r.rotateRight_()),!r.right.isEmpty()&&!r.right.isRed_()&&!r.right.left.isRed_()&&(r=r.moveRedRight_()),t(e,r.key)===0){if(r.right.isEmpty())return Tn.EMPTY_NODE;s=r.right.min_(),r=r.copy(s.key,s.value,null,null,r.right.removeMin_())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,$t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,$t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}$t.RED=!0;$t.BLACK=!1;class WO{copy(e,t,r,s,a){return this}insert(e,t,r){return new $t(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}class Tn{constructor(e,t=Tn.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new Tn(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,$t.BLACK,null,null))}remove(e){return new Tn(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,$t.BLACK,null,null))}get(e){let t,r=this.root_;for(;!r.isEmpty();){if(t=this.comparator_(e,r.key),t===0)return r.value;t<0?r=r.left:t>0&&(r=r.right)}return null}getPredecessorKey(e){let t,r=this.root_,s=null;for(;!r.isEmpty();)if(t=this.comparator_(e,r.key),t===0){if(r.left.isEmpty())return s?s.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}else t<0?r=r.left:t>0&&(s=r,r=r.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new Mh(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new Mh(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new Mh(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new Mh(this.root_,null,this.comparator_,!0,e)}}Tn.EMPTY_NODE=new WO;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HO(n,e){return So(n.name,e.name)}function g_(n,e){return So(n,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let qm;function GO(n){qm=n}const tS=function(n){return typeof n=="number"?"number:"+NC(n):"string:"+n},nS=function(n){if(n.isLeafNode()){const e=n.val();le(typeof e=="string"||typeof e=="number"||typeof e=="object"&&Br(e,".sv"),"Priority must be a string or number.")}else le(n===qm||n.isEmpty(),"priority of unexpected type.");le(n===qm||n.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let rE;class Bt{static set __childrenNodeConstructor(e){rE=e}static get __childrenNodeConstructor(){return rE}constructor(e,t=Bt.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=t,this.lazyHash_=null,le(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),nS(this.priorityNode_)}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new Bt(this.value_,e)}getImmediateChild(e){return e===".priority"?this.priorityNode_:Bt.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return Le(e)?this:Ne(e)===".priority"?this.priorityNode_:Bt.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,t){return null}updateImmediateChild(e,t){return e===".priority"?this.updatePriority(t):t.isEmpty()&&e!==".priority"?this:Bt.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,t).updatePriority(this.priorityNode_)}updateChild(e,t){const r=Ne(e);return r===null?t:t.isEmpty()&&r!==".priority"?this:(le(r!==".priority"||Es(e)===1,".priority must be the last token in a path"),this.updateImmediateChild(r,Bt.__childrenNodeConstructor.EMPTY_NODE.updateChild(st(e),t)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,t){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+tS(this.priorityNode_.val())+":");const t=typeof this.value_;e+=t+":",t==="number"?e+=NC(this.value_):e+=this.value_,this.lazyHash_=PC(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===Bt.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof Bt.__childrenNodeConstructor?-1:(le(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const t=typeof e.value_,r=typeof this.value_,s=Bt.VALUE_TYPE_ORDER.indexOf(t),a=Bt.VALUE_TYPE_ORDER.indexOf(r);return le(s>=0,"Unknown leaf type: "+t),le(a>=0,"Unknown leaf type: "+r),s===a?r==="object"?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:a-s}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const t=e;return this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)}else return!1}}Bt.VALUE_TYPE_ORDER=["object","boolean","number","string"];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let rS,iS;function qO(n){rS=n}function KO(n){iS=n}class QO extends uf{compare(e,t){const r=e.node.getPriority(),s=t.node.getPriority(),a=r.compareTo(s);return a===0?So(e.name,t.name):a}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return Be.MIN}maxPost(){return new Be(_o,new Bt("[PRIORITY-POST]",iS))}makePost(e,t){const r=rS(e);return new Be(t,new Bt("[PRIORITY-POST]",r))}toString(){return".priority"}}const Xt=new QO;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YO=Math.log(2);class JO{constructor(e){const t=a=>parseInt(Math.log(a)/YO,10),r=a=>parseInt(Array(a+1).join("1"),2);this.count=t(e+1),this.current_=this.count-1;const s=r(this.count);this.bits_=e+1&s}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const Id=function(n,e,t,r){n.sort(e);const s=function(f,p){const y=p-f;let v,E;if(y===0)return null;if(y===1)return v=n[f],E=t?t(v):v,new $t(E,v.node,$t.BLACK,null,null);{const S=parseInt(y/2,10)+f,R=s(f,S),N=s(S+1,p);return v=n[S],E=t?t(v):v,new $t(E,v.node,$t.BLACK,R,N)}},a=function(f){let p=null,y=null,v=n.length;const E=function(R,N){const O=v-R,V=v;v-=R;const K=s(O+1,V),G=n[O],J=t?t(G):G;S(new $t(J,G.node,N,null,K))},S=function(R){p?(p.left=R,p=R):(y=R,p=R)};for(let R=0;R<f.count;++R){const N=f.nextBitIsOne(),O=Math.pow(2,f.count-(R+1));N?E(O,$t.BLACK):(E(O,$t.BLACK),E(O,$t.RED))}return y},u=new JO(n.length),h=a(u);return new Tn(r||e,h)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let um;const wa={};class fi{static get Default(){return le(wa&&Xt,"ChildrenNode.ts has not been loaded"),um=um||new fi({".priority":wa},{".priority":Xt}),um}constructor(e,t){this.indexes_=e,this.indexSet_=t}get(e){const t=Fa(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof Tn?t:null}hasIndex(e){return Br(this.indexSet_,e.toString())}addIndex(e,t){le(e!==Ma,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const r=[];let s=!1;const a=t.getIterator(Be.Wrap);let u=a.getNext();for(;u;)s=s||e.isDefinedOn(u.node),r.push(u),u=a.getNext();let h;s?h=Id(r,e.getCompare()):h=wa;const f=e.toString(),p=Object.assign({},this.indexSet_);p[f]=e;const y=Object.assign({},this.indexes_);return y[f]=h,new fi(y,p)}addToIndexes(e,t){const r=ed(this.indexes_,(s,a)=>{const u=Fa(this.indexSet_,a);if(le(u,"Missing index implementation for "+a),s===wa)if(u.isDefinedOn(e.node)){const h=[],f=t.getIterator(Be.Wrap);let p=f.getNext();for(;p;)p.name!==e.name&&h.push(p),p=f.getNext();return h.push(e),Id(h,u.getCompare())}else return wa;else{const h=t.get(e.name);let f=s;return h&&(f=f.remove(new Be(e.name,h))),f.insert(e,e.node)}});return new fi(r,this.indexSet_)}removeFromIndexes(e,t){const r=ed(this.indexes_,s=>{if(s===wa)return s;{const a=t.get(e.name);return a?s.remove(new Be(e.name,a)):s}});return new fi(r,this.indexSet_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let lu;class Qe{static get EMPTY_NODE(){return lu||(lu=new Qe(new Tn(g_),null,fi.Default))}constructor(e,t,r){this.children_=e,this.priorityNode_=t,this.indexMap_=r,this.lazyHash_=null,this.priorityNode_&&nS(this.priorityNode_),this.children_.isEmpty()&&le(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}isLeafNode(){return!1}getPriority(){return this.priorityNode_||lu}updatePriority(e){return this.children_.isEmpty()?this:new Qe(this.children_,e,this.indexMap_)}getImmediateChild(e){if(e===".priority")return this.getPriority();{const t=this.children_.get(e);return t===null?lu:t}}getChild(e){const t=Ne(e);return t===null?this:this.getImmediateChild(t).getChild(st(e))}hasChild(e){return this.children_.get(e)!==null}updateImmediateChild(e,t){if(le(t,"We should always be passing snapshot nodes"),e===".priority")return this.updatePriority(t);{const r=new Be(e,t);let s,a;t.isEmpty()?(s=this.children_.remove(e),a=this.indexMap_.removeFromIndexes(r,this.children_)):(s=this.children_.insert(e,t),a=this.indexMap_.addToIndexes(r,this.children_));const u=s.isEmpty()?lu:this.priorityNode_;return new Qe(s,u,a)}}updateChild(e,t){const r=Ne(e);if(r===null)return t;{le(Ne(e)!==".priority"||Es(e)===1,".priority must be the last token in a path");const s=this.getImmediateChild(r).updateChild(st(e),t);return this.updateImmediateChild(r,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const t={};let r=0,s=0,a=!0;if(this.forEachChild(Xt,(u,h)=>{t[u]=h.val(e),r++,a&&Qe.INTEGER_REGEXP_.test(u)?s=Math.max(s,Number(u)):a=!1}),!e&&a&&s<2*r){const u=[];for(const h in t)u[h]=t[h];return u}else return e&&!this.getPriority().isEmpty()&&(t[".priority"]=this.getPriority().val()),t}hash(){if(this.lazyHash_===null){let e="";this.getPriority().isEmpty()||(e+="priority:"+tS(this.getPriority().val())+":"),this.forEachChild(Xt,(t,r)=>{const s=r.hash();s!==""&&(e+=":"+t+":"+s)}),this.lazyHash_=e===""?"":PC(e)}return this.lazyHash_}getPredecessorChildName(e,t,r){const s=this.resolveIndex_(r);if(s){const a=s.getPredecessorKey(new Be(e,t));return a?a.name:null}else return this.children_.getPredecessorKey(e)}getFirstChildName(e){const t=this.resolveIndex_(e);if(t){const r=t.minKey();return r&&r.name}else return this.children_.minKey()}getFirstChild(e){const t=this.getFirstChildName(e);return t?new Be(t,this.children_.get(t)):null}getLastChildName(e){const t=this.resolveIndex_(e);if(t){const r=t.maxKey();return r&&r.name}else return this.children_.maxKey()}getLastChild(e){const t=this.getLastChildName(e);return t?new Be(t,this.children_.get(t)):null}forEachChild(e,t){const r=this.resolveIndex_(e);return r?r.inorderTraversal(s=>t(s.name,s.node)):this.children_.inorderTraversal(t)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,t){const r=this.resolveIndex_(t);if(r)return r.getIteratorFrom(e,s=>s);{const s=this.children_.getIteratorFrom(e.name,Be.Wrap);let a=s.peek();for(;a!=null&&t.compare(a,e)<0;)s.getNext(),a=s.peek();return s}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,t){const r=this.resolveIndex_(t);if(r)return r.getReverseIteratorFrom(e,s=>s);{const s=this.children_.getReverseIteratorFrom(e.name,Be.Wrap);let a=s.peek();for(;a!=null&&t.compare(a,e)>0;)s.getNext(),a=s.peek();return s}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===uc?-1:0}withIndex(e){if(e===Ma||this.indexMap_.hasIndex(e))return this;{const t=this.indexMap_.addIndex(e,this.children_);return new Qe(this.children_,this.priorityNode_,t)}}isIndexed(e){return e===Ma||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const t=e;if(this.getPriority().equals(t.getPriority()))if(this.children_.count()===t.children_.count()){const r=this.getIterator(Xt),s=t.getIterator(Xt);let a=r.getNext(),u=s.getNext();for(;a&&u;){if(a.name!==u.name||!a.node.equals(u.node))return!1;a=r.getNext(),u=s.getNext()}return a===null&&u===null}else return!1;else return!1}}resolveIndex_(e){return e===Ma?null:this.indexMap_.get(e.toString())}}Qe.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class XO extends Qe{constructor(){super(new Tn(g_),Qe.EMPTY_NODE,fi.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return Qe.EMPTY_NODE}isEmpty(){return!1}}const uc=new XO;Object.defineProperties(Be,{MIN:{value:new Be(Ha,Qe.EMPTY_NODE)},MAX:{value:new Be(_o,uc)}});eS.__EMPTY_NODE=Qe.EMPTY_NODE;Bt.__childrenNodeConstructor=Qe;GO(uc);KO(uc);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZO=!0;function St(n,e=null){if(n===null)return Qe.EMPTY_NODE;if(typeof n=="object"&&".priority"in n&&(e=n[".priority"]),le(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof n=="object"&&".value"in n&&n[".value"]!==null&&(n=n[".value"]),typeof n!="object"||".sv"in n){const t=n;return new Bt(t,St(e))}if(!(n instanceof Array)&&ZO){const t=[];let r=!1;if(Sn(n,(u,h)=>{if(u.substring(0,1)!=="."){const f=St(h);f.isEmpty()||(r=r||!f.getPriority().isEmpty(),t.push(new Be(u,f)))}}),t.length===0)return Qe.EMPTY_NODE;const a=Id(t,HO,u=>u.name,g_);if(r){const u=Id(t,Xt.getCompare());return new Qe(a,St(e),new fi({".priority":u},{".priority":Xt}))}else return new Qe(a,St(e),fi.Default)}else{let t=Qe.EMPTY_NODE;return Sn(n,(r,s)=>{if(Br(n,r)&&r.substring(0,1)!=="."){const a=St(s);(a.isLeafNode()||!a.isEmpty())&&(t=t.updateImmediateChild(r,a))}}),t.updatePriority(St(e))}}qO(St);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eL extends uf{constructor(e){super(),this.indexPath_=e,le(!Le(e)&&Ne(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){const r=this.extractChild(e.node),s=this.extractChild(t.node),a=r.compareTo(s);return a===0?So(e.name,t.name):a}makePost(e,t){const r=St(e),s=Qe.EMPTY_NODE.updateChild(this.indexPath_,r);return new Be(t,s)}maxPost(){const e=Qe.EMPTY_NODE.updateChild(this.indexPath_,uc);return new Be(_o,e)}toString(){return Uu(this.indexPath_,0).join("/")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tL extends uf{compare(e,t){const r=e.node.compareTo(t.node);return r===0?So(e.name,t.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return Be.MIN}maxPost(){return Be.MAX}makePost(e,t){const r=St(e);return new Be(t,r)}toString(){return".value"}}const nL=new tL;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rL(n){return{type:"value",snapshotNode:n}}function iL(n,e){return{type:"child_added",snapshotNode:e,childName:n}}function sL(n,e){return{type:"child_removed",snapshotNode:e,childName:n}}function iE(n,e,t){return{type:"child_changed",snapshotNode:e,childName:n,oldSnap:t}}function oL(n,e){return{type:"child_moved",snapshotNode:e,childName:n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Xt}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return le(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return le(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Ha}hasEnd(){return this.endSet_}getIndexEndValue(){return le(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return le(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:_o}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return le(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===Xt}copy(){const e=new __;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function sE(n){const e={};if(n.isDefault())return e;let t;if(n.index_===Xt?t="$priority":n.index_===nL?t="$value":n.index_===Ma?t="$key":(le(n.index_ instanceof eL,"Unrecognized index type!"),t=n.index_.toString()),e.orderBy=Yt(t),n.startSet_){const r=n.startAfterSet_?"startAfter":"startAt";e[r]=Yt(n.indexStartValue_),n.startNameSet_&&(e[r]+=","+Yt(n.indexStartName_))}if(n.endSet_){const r=n.endBeforeSet_?"endBefore":"endAt";e[r]=Yt(n.indexEndValue_),n.endNameSet_&&(e[r]+=","+Yt(n.indexEndName_))}return n.limitSet_&&(n.isViewFromLeft()?e.limitToFirst=n.limit_:e.limitToLast=n.limit_),e}function oE(n){const e={};if(n.startSet_&&(e.sp=n.indexStartValue_,n.startNameSet_&&(e.sn=n.indexStartName_),e.sin=!n.startAfterSet_),n.endSet_&&(e.ep=n.indexEndValue_,n.endNameSet_&&(e.en=n.indexEndName_),e.ein=!n.endBeforeSet_),n.limitSet_){e.l=n.limit_;let t=n.viewFrom_;t===""&&(n.isViewFromLeft()?t="l":t="r"),e.vf=t}return n.index_!==Xt&&(e.i=n.index_.toString()),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cd extends QC{reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return t!==void 0?"tag$"+t:(le(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}constructor(e,t,r,s){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=r,this.appCheckTokenProvider_=s,this.log_=lc("p:rest:"),this.listens_={}}listen(e,t,r,s){const a=e._path.toString();this.log_("Listen called for "+a+" "+e._queryIdentifier);const u=Cd.getListenId_(e,r),h={};this.listens_[u]=h;const f=sE(e._queryParams);this.restRequest_(a+".json",f,(p,y)=>{let v=y;if(p===404&&(v=null,p=null),p===null&&this.onDataUpdate_(a,v,!1,r),Fa(this.listens_,u)===h){let E;p?p===401?E="permission_denied":E="rest_error:"+p:E="ok",s(E,null)}})}unlisten(e,t){const r=Cd.getListenId_(e,t);delete this.listens_[r]}get(e){const t=sE(e._queryParams),r=e._path.toString(),s=new ui;return this.restRequest_(r+".json",t,(a,u)=>{let h=u;a===404&&(h=null,a=null),a===null?(this.onDataUpdate_(r,h,!1,null),s.resolve(h)):s.reject(new Error(h))}),s.promise}refreshAuthToken(e){}restRequest_(e,t={},r){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([s,a])=>{s&&s.accessToken&&(t.auth=s.accessToken),a&&a.token&&(t.ac=a.token);const u=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+Ja(t);this.log_("Sending REST request for "+u);const h=new XMLHttpRequest;h.onreadystatechange=()=>{if(r&&h.readyState===4){this.log_("REST Response for "+u+" received. status:",h.status,"response:",h.responseText);let f=null;if(h.status>=200&&h.status<300){try{f=Ru(h.responseText)}catch{Cn("Failed to parse JSON response for "+u+": "+h.responseText)}r(null,f)}else h.status!==401&&h.status!==404&&Cn("Got unsuccessful REST response for "+u+" Status: "+h.status),r(h.status);r=null}},h.open("GET",u,!0),h.send()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aL{constructor(){this.rootNode_=Qe.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sd(){return{value:null,children:new Map}}function ol(n,e,t){if(Le(e))n.value=t,n.children.clear();else if(n.value!==null)n.value=n.value.updateChild(e,t);else{const r=Ne(e);n.children.has(r)||n.children.set(r,Sd());const s=n.children.get(r);e=st(e),ol(s,e,t)}}function Km(n,e){if(Le(e))return n.value=null,n.children.clear(),!0;if(n.value!==null){if(n.value.isLeafNode())return!1;{const t=n.value;return n.value=null,t.forEachChild(Xt,(r,s)=>{ol(n,new tt(r),s)}),Km(n,e)}}else if(n.children.size>0){const t=Ne(e);return e=st(e),n.children.has(t)&&Km(n.children.get(t),e)&&n.children.delete(t),n.children.size===0}else return!0}function Qm(n,e,t){n.value!==null?t(e,n.value):lL(n,(r,s)=>{const a=new tt(e.toString()+"/"+r);Qm(s,a,t)})}function lL(n,e){n.children.forEach((t,r)=>{e(r,t)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uL{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),t=Object.assign({},e);return this.last_&&Sn(this.last_,(r,s)=>{t[r]=t[r]-s}),this.last_=e,t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aE=10*1e3,cL=30*1e3,hL=5*60*1e3;class dL{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new uL(e);const r=aE+(cL-aE)*Math.random();Cu(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){const e=this.statsListener_.get(),t={};let r=!1;Sn(e,(s,a)=>{a>0&&Br(this.statsToReport_,s)&&(t[s]=a,r=!0)}),r&&this.server_.reportStats(t),Cu(this.reportStats_.bind(this),Math.floor(Math.random()*2*hL))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Rr;(function(n){n[n.OVERWRITE=0]="OVERWRITE",n[n.MERGE=1]="MERGE",n[n.ACK_USER_WRITE=2]="ACK_USER_WRITE",n[n.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(Rr||(Rr={}));function sS(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function oS(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function aS(n){return{fromUser:!1,fromServer:!0,queryId:n,tagged:!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ad{constructor(e,t,r){this.path=e,this.affectedTree=t,this.revert=r,this.type=Rr.ACK_USER_WRITE,this.source=sS()}operationForChild(e){if(Le(this.path)){if(this.affectedTree.value!=null)return le(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const t=this.affectedTree.subtree(new tt(e));return new Ad(Xe(),t,this.revert)}}else return le(Ne(this.path)===e,"operationForChild called for unrelated child."),new Ad(st(this.path),this.affectedTree,this.revert)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yo{constructor(e,t,r){this.source=e,this.path=t,this.snap=r,this.type=Rr.OVERWRITE}operationForChild(e){return Le(this.path)?new yo(this.source,Xe(),this.snap.getImmediateChild(e)):new yo(this.source,st(this.path),this.snap)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bu{constructor(e,t,r){this.source=e,this.path=t,this.children=r,this.type=Rr.MERGE}operationForChild(e){if(Le(this.path)){const t=this.children.subtree(new tt(e));return t.isEmpty()?null:t.value?new yo(this.source,Xe(),t.value):new Bu(this.source,Xe(),t)}else return le(Ne(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new Bu(this.source,st(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y_{constructor(e,t,r){this.node_=e,this.fullyInitialized_=t,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(Le(e))return this.isFullyInitialized()&&!this.filtered_;const t=Ne(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}function fL(n,e,t,r){const s=[],a=[];return e.forEach(u=>{u.type==="child_changed"&&n.index_.indexedValueChanged(u.oldSnap,u.snapshotNode)&&a.push(oL(u.childName,u.snapshotNode))}),uu(n,s,"child_removed",e,r,t),uu(n,s,"child_added",e,r,t),uu(n,s,"child_moved",a,r,t),uu(n,s,"child_changed",e,r,t),uu(n,s,"value",e,r,t),s}function uu(n,e,t,r,s,a){const u=r.filter(h=>h.type===t);u.sort((h,f)=>mL(n,h,f)),u.forEach(h=>{const f=pL(n,h,a);s.forEach(p=>{p.respondsTo(h.type)&&e.push(p.createEvent(f,n.query_))})})}function pL(n,e,t){return e.type==="value"||e.type==="child_removed"||(e.prevName=t.getPredecessorChildName(e.childName,e.snapshotNode,n.index_)),e}function mL(n,e,t){if(e.childName==null||t.childName==null)throw Ya("Should only compare child_ events.");const r=new Be(e.childName,e.snapshotNode),s=new Be(t.childName,t.snapshotNode);return n.index_.compare(r,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lS(n,e){return{eventCache:n,serverCache:e}}function Su(n,e,t,r){return lS(new y_(e,t,r),n.serverCache)}function uS(n,e,t,r){return lS(n.eventCache,new y_(e,t,r))}function Ym(n){return n.eventCache.isFullyInitialized()?n.eventCache.getNode():null}function vo(n){return n.serverCache.isFullyInitialized()?n.serverCache.getNode():null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let cm;const gL=()=>(cm||(cm=new Tn(tO)),cm);class lt{static fromObject(e){let t=new lt(null);return Sn(e,(r,s)=>{t=t.set(new tt(r),s)}),t}constructor(e,t=gL()){this.value=e,this.children=t}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(this.value!=null&&t(this.value))return{path:Xe(),value:this.value};if(Le(e))return null;{const r=Ne(e),s=this.children.get(r);if(s!==null){const a=s.findRootMostMatchingPathAndValue(st(e),t);return a!=null?{path:Et(new tt(r),a.path),value:a.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(Le(e))return this;{const t=Ne(e),r=this.children.get(t);return r!==null?r.subtree(st(e)):new lt(null)}}set(e,t){if(Le(e))return new lt(t,this.children);{const r=Ne(e),a=(this.children.get(r)||new lt(null)).set(st(e),t),u=this.children.insert(r,a);return new lt(this.value,u)}}remove(e){if(Le(e))return this.children.isEmpty()?new lt(null):new lt(null,this.children);{const t=Ne(e),r=this.children.get(t);if(r){const s=r.remove(st(e));let a;return s.isEmpty()?a=this.children.remove(t):a=this.children.insert(t,s),this.value===null&&a.isEmpty()?new lt(null):new lt(this.value,a)}else return this}}get(e){if(Le(e))return this.value;{const t=Ne(e),r=this.children.get(t);return r?r.get(st(e)):null}}setTree(e,t){if(Le(e))return t;{const r=Ne(e),a=(this.children.get(r)||new lt(null)).setTree(st(e),t);let u;return a.isEmpty()?u=this.children.remove(r):u=this.children.insert(r,a),new lt(this.value,u)}}fold(e){return this.fold_(Xe(),e)}fold_(e,t){const r={};return this.children.inorderTraversal((s,a)=>{r[s]=a.fold_(Et(e,s),t)}),t(e,this.value,r)}findOnPath(e,t){return this.findOnPath_(e,Xe(),t)}findOnPath_(e,t,r){const s=this.value?r(t,this.value):!1;if(s)return s;if(Le(e))return null;{const a=Ne(e),u=this.children.get(a);return u?u.findOnPath_(st(e),Et(t,a),r):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,Xe(),t)}foreachOnPath_(e,t,r){if(Le(e))return this;{this.value&&r(t,this.value);const s=Ne(e),a=this.children.get(s);return a?a.foreachOnPath_(st(e),Et(t,s),r):new lt(null)}}foreach(e){this.foreach_(Xe(),e)}foreach_(e,t){this.children.inorderTraversal((r,s)=>{s.foreach_(Et(e,r),t)}),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal((t,r)=>{r.value&&e(t,r.value)})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dr{constructor(e){this.writeTree_=e}static empty(){return new dr(new lt(null))}}function Au(n,e,t){if(Le(e))return new dr(new lt(t));{const r=n.writeTree_.findRootMostValueAndPath(e);if(r!=null){const s=r.path;let a=r.value;const u=qn(s,e);return a=a.updateChild(u,t),new dr(n.writeTree_.set(s,a))}else{const s=new lt(t),a=n.writeTree_.setTree(e,s);return new dr(a)}}}function lE(n,e,t){let r=n;return Sn(t,(s,a)=>{r=Au(r,Et(e,s),a)}),r}function uE(n,e){if(Le(e))return dr.empty();{const t=n.writeTree_.setTree(e,new lt(null));return new dr(t)}}function Jm(n,e){return Ao(n,e)!=null}function Ao(n,e){const t=n.writeTree_.findRootMostValueAndPath(e);return t!=null?n.writeTree_.get(t.path).getChild(qn(t.path,e)):null}function cE(n){const e=[],t=n.writeTree_.value;return t!=null?t.isLeafNode()||t.forEachChild(Xt,(r,s)=>{e.push(new Be(r,s))}):n.writeTree_.children.inorderTraversal((r,s)=>{s.value!=null&&e.push(new Be(r,s.value))}),e}function hs(n,e){if(Le(e))return n;{const t=Ao(n,e);return t!=null?new dr(new lt(t)):new dr(n.writeTree_.subtree(e))}}function Xm(n){return n.writeTree_.isEmpty()}function Ga(n,e){return cS(Xe(),n.writeTree_,e)}function cS(n,e,t){if(e.value!=null)return t.updateChild(n,e.value);{let r=null;return e.children.inorderTraversal((s,a)=>{s===".priority"?(le(a.value!==null,"Priority writes must always be leaf nodes"),r=a.value):t=cS(Et(n,s),a,t)}),!t.getChild(n).isEmpty()&&r!==null&&(t=t.updateChild(Et(n,".priority"),r)),t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hS(n,e){return gS(e,n)}function _L(n,e,t,r,s){le(r>n.lastWriteId,"Stacking an older write on top of newer ones"),s===void 0&&(s=!0),n.allWrites.push({path:e,snap:t,writeId:r,visible:s}),s&&(n.visibleWrites=Au(n.visibleWrites,e,t)),n.lastWriteId=r}function yL(n,e){for(let t=0;t<n.allWrites.length;t++){const r=n.allWrites[t];if(r.writeId===e)return r}return null}function vL(n,e){const t=n.allWrites.findIndex(h=>h.writeId===e);le(t>=0,"removeWrite called with nonexistent writeId.");const r=n.allWrites[t];n.allWrites.splice(t,1);let s=r.visible,a=!1,u=n.allWrites.length-1;for(;s&&u>=0;){const h=n.allWrites[u];h.visible&&(u>=t&&wL(h,r.path)?s=!1:Kn(r.path,h.path)&&(a=!0)),u--}if(s){if(a)return EL(n),!0;if(r.snap)n.visibleWrites=uE(n.visibleWrites,r.path);else{const h=r.children;Sn(h,f=>{n.visibleWrites=uE(n.visibleWrites,Et(r.path,f))})}return!0}else return!1}function wL(n,e){if(n.snap)return Kn(n.path,e);for(const t in n.children)if(n.children.hasOwnProperty(t)&&Kn(Et(n.path,t),e))return!0;return!1}function EL(n){n.visibleWrites=dS(n.allWrites,TL,Xe()),n.allWrites.length>0?n.lastWriteId=n.allWrites[n.allWrites.length-1].writeId:n.lastWriteId=-1}function TL(n){return n.visible}function dS(n,e,t){let r=dr.empty();for(let s=0;s<n.length;++s){const a=n[s];if(e(a)){const u=a.path;let h;if(a.snap)Kn(t,u)?(h=qn(t,u),r=Au(r,h,a.snap)):Kn(u,t)&&(h=qn(u,t),r=Au(r,Xe(),a.snap.getChild(h)));else if(a.children){if(Kn(t,u))h=qn(t,u),r=lE(r,h,a.children);else if(Kn(u,t))if(h=qn(u,t),Le(h))r=lE(r,Xe(),a.children);else{const f=Fa(a.children,Ne(h));if(f){const p=f.getChild(st(h));r=Au(r,Xe(),p)}}}else throw Ya("WriteRecord should have .snap or .children")}}return r}function fS(n,e,t,r,s){if(!r&&!s){const a=Ao(n.visibleWrites,e);if(a!=null)return a;{const u=hs(n.visibleWrites,e);if(Xm(u))return t;if(t==null&&!Jm(u,Xe()))return null;{const h=t||Qe.EMPTY_NODE;return Ga(u,h)}}}else{const a=hs(n.visibleWrites,e);if(!s&&Xm(a))return t;if(!s&&t==null&&!Jm(a,Xe()))return null;{const u=function(p){return(p.visible||s)&&(!r||!~r.indexOf(p.writeId))&&(Kn(p.path,e)||Kn(e,p.path))},h=dS(n.allWrites,u,e),f=t||Qe.EMPTY_NODE;return Ga(h,f)}}}function IL(n,e,t){let r=Qe.EMPTY_NODE;const s=Ao(n.visibleWrites,e);if(s)return s.isLeafNode()||s.forEachChild(Xt,(a,u)=>{r=r.updateImmediateChild(a,u)}),r;if(t){const a=hs(n.visibleWrites,e);return t.forEachChild(Xt,(u,h)=>{const f=Ga(hs(a,new tt(u)),h);r=r.updateImmediateChild(u,f)}),cE(a).forEach(u=>{r=r.updateImmediateChild(u.name,u.node)}),r}else{const a=hs(n.visibleWrites,e);return cE(a).forEach(u=>{r=r.updateImmediateChild(u.name,u.node)}),r}}function CL(n,e,t,r,s){le(r||s,"Either existingEventSnap or existingServerSnap must exist");const a=Et(e,t);if(Jm(n.visibleWrites,a))return null;{const u=hs(n.visibleWrites,a);return Xm(u)?s.getChild(t):Ga(u,s.getChild(t))}}function SL(n,e,t,r){const s=Et(e,t),a=Ao(n.visibleWrites,s);if(a!=null)return a;if(r.isCompleteForChild(t)){const u=hs(n.visibleWrites,s);return Ga(u,r.getNode().getImmediateChild(t))}else return null}function AL(n,e){return Ao(n.visibleWrites,e)}function kL(n,e,t,r,s,a,u){let h;const f=hs(n.visibleWrites,e),p=Ao(f,Xe());if(p!=null)h=p;else if(t!=null)h=Ga(f,t);else return[];if(h=h.withIndex(u),!h.isEmpty()&&!h.isLeafNode()){const y=[],v=u.getCompare(),E=a?h.getReverseIteratorFrom(r,u):h.getIteratorFrom(r,u);let S=E.getNext();for(;S&&y.length<s;)v(S,r)!==0&&y.push(S),S=E.getNext();return y}else return[]}function RL(){return{visibleWrites:dr.empty(),allWrites:[],lastWriteId:-1}}function Zm(n,e,t,r){return fS(n.writeTree,n.treePath,e,t,r)}function pS(n,e){return IL(n.writeTree,n.treePath,e)}function hE(n,e,t,r){return CL(n.writeTree,n.treePath,e,t,r)}function kd(n,e){return AL(n.writeTree,Et(n.treePath,e))}function xL(n,e,t,r,s,a){return kL(n.writeTree,n.treePath,e,t,r,s,a)}function v_(n,e,t){return SL(n.writeTree,n.treePath,e,t)}function mS(n,e){return gS(Et(n.treePath,e),n.writeTree)}function gS(n,e){return{treePath:n,writeTree:e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PL{constructor(){this.changeMap=new Map}trackChildChange(e){const t=e.type,r=e.childName;le(t==="child_added"||t==="child_changed"||t==="child_removed","Only child changes supported for tracking"),le(r!==".priority","Only non-priority child changes can be tracked.");const s=this.changeMap.get(r);if(s){const a=s.type;if(t==="child_added"&&a==="child_removed")this.changeMap.set(r,iE(r,e.snapshotNode,s.snapshotNode));else if(t==="child_removed"&&a==="child_added")this.changeMap.delete(r);else if(t==="child_removed"&&a==="child_changed")this.changeMap.set(r,sL(r,s.oldSnap));else if(t==="child_changed"&&a==="child_added")this.changeMap.set(r,iL(r,e.snapshotNode));else if(t==="child_changed"&&a==="child_changed")this.changeMap.set(r,iE(r,e.snapshotNode,s.oldSnap));else throw Ya("Illegal combination of changes: "+e+" occurred after "+s)}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bL{getCompleteChild(e){return null}getChildAfterChild(e,t,r){return null}}const _S=new bL;class w_{constructor(e,t,r=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=r}getCompleteChild(e){const t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{const r=this.optCompleteServerCache_!=null?new y_(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return v_(this.writes_,e,r)}}getChildAfterChild(e,t,r){const s=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:vo(this.viewCache_),a=xL(this.writes_,s,t,1,r,e);return a.length===0?null:a[0]}}function NL(n,e){le(e.eventCache.getNode().isIndexed(n.filter.getIndex()),"Event snap not indexed"),le(e.serverCache.getNode().isIndexed(n.filter.getIndex()),"Server snap not indexed")}function DL(n,e,t,r,s){const a=new PL;let u,h;if(t.type===Rr.OVERWRITE){const p=t;p.source.fromUser?u=eg(n,e,p.path,p.snap,r,s,a):(le(p.source.fromServer,"Unknown source."),h=p.source.tagged||e.serverCache.isFiltered()&&!Le(p.path),u=Rd(n,e,p.path,p.snap,r,s,h,a))}else if(t.type===Rr.MERGE){const p=t;p.source.fromUser?u=LL(n,e,p.path,p.children,r,s,a):(le(p.source.fromServer,"Unknown source."),h=p.source.tagged||e.serverCache.isFiltered(),u=tg(n,e,p.path,p.children,r,s,h,a))}else if(t.type===Rr.ACK_USER_WRITE){const p=t;p.revert?u=FL(n,e,p.path,r,s,a):u=ML(n,e,p.path,p.affectedTree,r,s,a)}else if(t.type===Rr.LISTEN_COMPLETE)u=VL(n,e,t.path,r,a);else throw Ya("Unknown operation type: "+t.type);const f=a.getChanges();return OL(e,u,f),{viewCache:u,changes:f}}function OL(n,e,t){const r=e.eventCache;if(r.isFullyInitialized()){const s=r.getNode().isLeafNode()||r.getNode().isEmpty(),a=Ym(n);(t.length>0||!n.eventCache.isFullyInitialized()||s&&!r.getNode().equals(a)||!r.getNode().getPriority().equals(a.getPriority()))&&t.push(rL(Ym(e)))}}function yS(n,e,t,r,s,a){const u=e.eventCache;if(kd(r,t)!=null)return e;{let h,f;if(Le(t))if(le(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const p=vo(e),y=p instanceof Qe?p:Qe.EMPTY_NODE,v=pS(r,y);h=n.filter.updateFullNode(e.eventCache.getNode(),v,a)}else{const p=Zm(r,vo(e));h=n.filter.updateFullNode(e.eventCache.getNode(),p,a)}else{const p=Ne(t);if(p===".priority"){le(Es(t)===1,"Can't have a priority with additional path components");const y=u.getNode();f=e.serverCache.getNode();const v=hE(r,t,y,f);v!=null?h=n.filter.updatePriority(y,v):h=u.getNode()}else{const y=st(t);let v;if(u.isCompleteForChild(p)){f=e.serverCache.getNode();const E=hE(r,t,u.getNode(),f);E!=null?v=u.getNode().getImmediateChild(p).updateChild(y,E):v=u.getNode().getImmediateChild(p)}else v=v_(r,p,e.serverCache);v!=null?h=n.filter.updateChild(u.getNode(),p,v,y,s,a):h=u.getNode()}}return Su(e,h,u.isFullyInitialized()||Le(t),n.filter.filtersNodes())}}function Rd(n,e,t,r,s,a,u,h){const f=e.serverCache;let p;const y=u?n.filter:n.filter.getIndexedFilter();if(Le(t))p=y.updateFullNode(f.getNode(),r,null);else if(y.filtersNodes()&&!f.isFiltered()){const S=f.getNode().updateChild(t,r);p=y.updateFullNode(f.getNode(),S,null)}else{const S=Ne(t);if(!f.isCompleteForPath(t)&&Es(t)>1)return e;const R=st(t),O=f.getNode().getImmediateChild(S).updateChild(R,r);S===".priority"?p=y.updatePriority(f.getNode(),O):p=y.updateChild(f.getNode(),S,O,R,_S,null)}const v=uS(e,p,f.isFullyInitialized()||Le(t),y.filtersNodes()),E=new w_(s,v,a);return yS(n,v,t,s,E,h)}function eg(n,e,t,r,s,a,u){const h=e.eventCache;let f,p;const y=new w_(s,e,a);if(Le(t))p=n.filter.updateFullNode(e.eventCache.getNode(),r,u),f=Su(e,p,!0,n.filter.filtersNodes());else{const v=Ne(t);if(v===".priority")p=n.filter.updatePriority(e.eventCache.getNode(),r),f=Su(e,p,h.isFullyInitialized(),h.isFiltered());else{const E=st(t),S=h.getNode().getImmediateChild(v);let R;if(Le(E))R=r;else{const N=y.getCompleteChild(v);N!=null?p_(E)===".priority"&&N.getChild(JC(E)).isEmpty()?R=N:R=N.updateChild(E,r):R=Qe.EMPTY_NODE}if(S.equals(R))f=e;else{const N=n.filter.updateChild(h.getNode(),v,R,E,y,u);f=Su(e,N,h.isFullyInitialized(),n.filter.filtersNodes())}}}return f}function dE(n,e){return n.eventCache.isCompleteForChild(e)}function LL(n,e,t,r,s,a,u){let h=e;return r.foreach((f,p)=>{const y=Et(t,f);dE(e,Ne(y))&&(h=eg(n,h,y,p,s,a,u))}),r.foreach((f,p)=>{const y=Et(t,f);dE(e,Ne(y))||(h=eg(n,h,y,p,s,a,u))}),h}function fE(n,e,t){return t.foreach((r,s)=>{e=e.updateChild(r,s)}),e}function tg(n,e,t,r,s,a,u,h){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let f=e,p;Le(t)?p=r:p=new lt(null).setTree(t,r);const y=e.serverCache.getNode();return p.children.inorderTraversal((v,E)=>{if(y.hasChild(v)){const S=e.serverCache.getNode().getImmediateChild(v),R=fE(n,S,E);f=Rd(n,f,new tt(v),R,s,a,u,h)}}),p.children.inorderTraversal((v,E)=>{const S=!e.serverCache.isCompleteForChild(v)&&E.value===null;if(!y.hasChild(v)&&!S){const R=e.serverCache.getNode().getImmediateChild(v),N=fE(n,R,E);f=Rd(n,f,new tt(v),N,s,a,u,h)}}),f}function ML(n,e,t,r,s,a,u){if(kd(s,t)!=null)return e;const h=e.serverCache.isFiltered(),f=e.serverCache;if(r.value!=null){if(Le(t)&&f.isFullyInitialized()||f.isCompleteForPath(t))return Rd(n,e,t,f.getNode().getChild(t),s,a,h,u);if(Le(t)){let p=new lt(null);return f.getNode().forEachChild(Ma,(y,v)=>{p=p.set(new tt(y),v)}),tg(n,e,t,p,s,a,h,u)}else return e}else{let p=new lt(null);return r.foreach((y,v)=>{const E=Et(t,y);f.isCompleteForPath(E)&&(p=p.set(y,f.getNode().getChild(E)))}),tg(n,e,t,p,s,a,h,u)}}function VL(n,e,t,r,s){const a=e.serverCache,u=uS(e,a.getNode(),a.isFullyInitialized()||Le(t),a.isFiltered());return yS(n,u,t,r,_S,s)}function FL(n,e,t,r,s,a){let u;if(kd(r,t)!=null)return e;{const h=new w_(r,e,s),f=e.eventCache.getNode();let p;if(Le(t)||Ne(t)===".priority"){let y;if(e.serverCache.isFullyInitialized())y=Zm(r,vo(e));else{const v=e.serverCache.getNode();le(v instanceof Qe,"serverChildren would be complete if leaf node"),y=pS(r,v)}y=y,p=n.filter.updateFullNode(f,y,a)}else{const y=Ne(t);let v=v_(r,y,e.serverCache);v==null&&e.serverCache.isCompleteForChild(y)&&(v=f.getImmediateChild(y)),v!=null?p=n.filter.updateChild(f,y,v,st(t),h,a):e.eventCache.getNode().hasChild(y)?p=n.filter.updateChild(f,y,Qe.EMPTY_NODE,st(t),h,a):p=f,p.isEmpty()&&e.serverCache.isFullyInitialized()&&(u=Zm(r,vo(e)),u.isLeafNode()&&(p=n.filter.updateFullNode(p,u,a)))}return u=e.serverCache.isFullyInitialized()||kd(r,Xe())!=null,Su(e,p,u,n.filter.filtersNodes())}}function jL(n,e){const t=vo(n.viewCache_);return t&&(n.query._queryParams.loadsAllData()||!Le(e)&&!t.getImmediateChild(Ne(e)).isEmpty())?t.getChild(e):null}function pE(n,e,t,r){e.type===Rr.MERGE&&e.source.queryId!==null&&(le(vo(n.viewCache_),"We should always have a full cache before handling merges"),le(Ym(n.viewCache_),"Missing event cache, even though we have a server cache"));const s=n.viewCache_,a=DL(n.processor_,s,e,t,r);return NL(n.processor_,a.viewCache),le(a.viewCache.serverCache.isFullyInitialized()||!s.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),n.viewCache_=a.viewCache,UL(n,a.changes,a.viewCache.eventCache.getNode())}function UL(n,e,t,r){const s=n.eventRegistrations_;return fL(n.eventGenerator_,e,t,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let mE;function BL(n){le(!mE,"__referenceConstructor has already been defined"),mE=n}function E_(n,e,t,r){const s=e.source.queryId;if(s!==null){const a=n.views.get(s);return le(a!=null,"SyncTree gave us an op for an invalid query."),pE(a,e,t,r)}else{let a=[];for(const u of n.views.values())a=a.concat(pE(u,e,t,r));return a}}function T_(n,e){let t=null;for(const r of n.views.values())t=t||jL(r,e);return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let gE;function zL(n){le(!gE,"__referenceConstructor has already been defined"),gE=n}class _E{constructor(e){this.listenProvider_=e,this.syncPointTree_=new lt(null),this.pendingWriteTree_=RL(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function vS(n,e,t,r,s){return _L(n.pendingWriteTree_,e,t,r,s),s?hf(n,new yo(sS(),e,t)):[]}function ao(n,e,t=!1){const r=yL(n.pendingWriteTree_,e);if(vL(n.pendingWriteTree_,e)){let a=new lt(null);return r.snap!=null?a=a.set(Xe(),!0):Sn(r.children,u=>{a=a.set(new tt(u),!0)}),hf(n,new Ad(r.path,a,t))}else return[]}function cf(n,e,t){return hf(n,new yo(oS(),e,t))}function $L(n,e,t){const r=lt.fromObject(t);return hf(n,new Bu(oS(),e,r))}function WL(n,e,t,r){const s=TS(n,r);if(s!=null){const a=IS(s),u=a.path,h=a.queryId,f=qn(u,e),p=new yo(aS(h),f,t);return CS(n,u,p)}else return[]}function HL(n,e,t,r){const s=TS(n,r);if(s){const a=IS(s),u=a.path,h=a.queryId,f=qn(u,e),p=lt.fromObject(t),y=new Bu(aS(h),f,p);return CS(n,u,y)}else return[]}function I_(n,e,t){const s=n.pendingWriteTree_,a=n.syncPointTree_.findOnPath(e,(u,h)=>{const f=qn(u,e),p=T_(h,f);if(p)return p});return fS(s,e,a,t,!0)}function hf(n,e){return wS(e,n.syncPointTree_,null,hS(n.pendingWriteTree_,Xe()))}function wS(n,e,t,r){if(Le(n.path))return ES(n,e,t,r);{const s=e.get(Xe());t==null&&s!=null&&(t=T_(s,Xe()));let a=[];const u=Ne(n.path),h=n.operationForChild(u),f=e.children.get(u);if(f&&h){const p=t?t.getImmediateChild(u):null,y=mS(r,u);a=a.concat(wS(h,f,p,y))}return s&&(a=a.concat(E_(s,n,r,t))),a}}function ES(n,e,t,r){const s=e.get(Xe());t==null&&s!=null&&(t=T_(s,Xe()));let a=[];return e.children.inorderTraversal((u,h)=>{const f=t?t.getImmediateChild(u):null,p=mS(r,u),y=n.operationForChild(u);y&&(a=a.concat(ES(y,h,f,p)))}),s&&(a=a.concat(E_(s,n,r,t))),a}function TS(n,e){return n.tagToQueryMap.get(e)}function IS(n){const e=n.indexOf("$");return le(e!==-1&&e<n.length-1,"Bad queryKey."),{queryId:n.substr(e+1),path:new tt(n.substr(0,e))}}function CS(n,e,t){const r=n.syncPointTree_.get(e);le(r,"Missing sync point for query tag that we're tracking");const s=hS(n.pendingWriteTree_,e);return E_(r,t,s,null)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C_{constructor(e){this.node_=e}getImmediateChild(e){const t=this.node_.getImmediateChild(e);return new C_(t)}node(){return this.node_}}class S_{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){const t=Et(this.path_,e);return new S_(this.syncTree_,t)}node(){return I_(this.syncTree_,this.path_)}}const GL=function(n){return n=n||{},n.timestamp=n.timestamp||new Date().getTime(),n},yE=function(n,e,t){if(!n||typeof n!="object")return n;if(le(".sv"in n,"Unexpected leaf node or priority contents"),typeof n[".sv"]=="string")return qL(n[".sv"],e,t);if(typeof n[".sv"]=="object")return KL(n[".sv"],e);le(!1,"Unexpected server value: "+JSON.stringify(n,null,2))},qL=function(n,e,t){switch(n){case"timestamp":return t.timestamp;default:le(!1,"Unexpected server value: "+n)}},KL=function(n,e,t){n.hasOwnProperty("increment")||le(!1,"Unexpected server value: "+JSON.stringify(n,null,2));const r=n.increment;typeof r!="number"&&le(!1,"Unexpected increment value: "+r);const s=e.node();if(le(s!==null&&typeof s<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!s.isLeafNode())return r;const u=s.getValue();return typeof u!="number"?r:u+r},QL=function(n,e,t,r){return A_(e,new S_(t,n),r)},SS=function(n,e,t){return A_(n,new C_(e),t)};function A_(n,e,t){const r=n.getPriority().val(),s=yE(r,e.getImmediateChild(".priority"),t);let a;if(n.isLeafNode()){const u=n,h=yE(u.getValue(),e,t);return h!==u.getValue()||s!==u.getPriority().val()?new Bt(h,St(s)):n}else{const u=n;return a=u,s!==u.getPriority().val()&&(a=a.updatePriority(new Bt(s))),u.forEachChild(Xt,(h,f)=>{const p=A_(f,e.getImmediateChild(h),t);p!==f&&(a=a.updateImmediateChild(h,p))}),a}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k_{constructor(e="",t=null,r={children:{},childCount:0}){this.name=e,this.parent=t,this.node=r}}function R_(n,e){let t=e instanceof tt?e:new tt(e),r=n,s=Ne(t);for(;s!==null;){const a=Fa(r.node.children,s)||{children:{},childCount:0};r=new k_(s,r,a),t=st(t),s=Ne(t)}return r}function al(n){return n.node.value}function AS(n,e){n.node.value=e,ng(n)}function kS(n){return n.node.childCount>0}function YL(n){return al(n)===void 0&&!kS(n)}function df(n,e){Sn(n.node.children,(t,r)=>{e(new k_(t,n,r))})}function RS(n,e,t,r){t&&e(n),df(n,s=>{RS(s,e,!0)})}function JL(n,e,t){let r=n.parent;for(;r!==null;){if(e(r))return!0;r=r.parent}return!1}function cc(n){return new tt(n.parent===null?n.name:cc(n.parent)+"/"+n.name)}function ng(n){n.parent!==null&&XL(n.parent,n.name,n)}function XL(n,e,t){const r=YL(t),s=Br(n.node.children,e);r&&s?(delete n.node.children[e],n.node.childCount--,ng(n)):!r&&!s&&(n.node.children[e]=t.node,n.node.childCount++,ng(n))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZL=/[\[\].#$\/\u0000-\u001F\u007F]/,eM=/[\[\].#$\u0000-\u001F\u007F]/,hm=10*1024*1024,x_=function(n){return typeof n=="string"&&n.length!==0&&!ZL.test(n)},xS=function(n){return typeof n=="string"&&n.length!==0&&!eM.test(n)},tM=function(n){return n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),xS(n)},PS=function(n){return n===null||typeof n=="string"||typeof n=="number"&&!lf(n)||n&&typeof n=="object"&&Br(n,".sv")},rg=function(n,e,t,r){ff(ja(n,"value"),e,t)},ff=function(n,e,t){const r=t instanceof tt?new VO(t,n):t;if(e===void 0)throw new Error(n+"contains undefined "+ro(r));if(typeof e=="function")throw new Error(n+"contains a function "+ro(r)+" with contents = "+e.toString());if(lf(e))throw new Error(n+"contains "+e.toString()+" "+ro(r));if(typeof e=="string"&&e.length>hm/3&&Md(e)>hm)throw new Error(n+"contains a string greater than "+hm+" utf8 bytes "+ro(r)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let s=!1,a=!1;if(Sn(e,(u,h)=>{if(u===".value")s=!0;else if(u!==".priority"&&u!==".sv"&&(a=!0,!x_(u)))throw new Error(n+" contains an invalid key ("+u+") "+ro(r)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);FO(r,u),ff(n,h,r),jO(r)}),s&&a)throw new Error(n+' contains ".value" child '+ro(r)+" in addition to actual children.")}},nM=function(n,e){let t,r;for(t=0;t<e.length;t++){r=e[t];const a=Uu(r);for(let u=0;u<a.length;u++)if(!(a[u]===".priority"&&u===a.length-1)){if(!x_(a[u]))throw new Error(n+"contains an invalid key ("+a[u]+") in path "+r.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}e.sort(MO);let s=null;for(t=0;t<e.length;t++){if(r=e[t],s!==null&&Kn(s,r))throw new Error(n+"contains a path "+s.toString()+" that is ancestor of another path "+r.toString());s=r}},rM=function(n,e,t,r){const s=ja(n,"values");if(!(e&&typeof e=="object")||Array.isArray(e))throw new Error(s+" must be an object containing the children to replace.");const a=[];Sn(e,(u,h)=>{const f=new tt(u);if(ff(s,h,Et(t,f)),p_(f)===".priority"&&!PS(h))throw new Error(s+"contains an invalid value for '"+f.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");a.push(f)}),nM(s,a)},iM=function(n,e,t){if(lf(e))throw new Error(ja(n,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!PS(e))throw new Error(ja(n,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")},bS=function(n,e,t,r){if(!xS(t))throw new Error(ja(n,e)+'was an invalid path = "'+t+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},sM=function(n,e,t,r){t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),bS(n,e,t)},mu=function(n,e){if(Ne(e)===".info")throw new Error(n+" failed = Can't modify data under /.info/")},oM=function(n,e){const t=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!x_(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||t.length!==0&&!tM(t))throw new Error(ja(n,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aM{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function NS(n,e){let t=null;for(let r=0;r<e.length;r++){const s=e[r],a=s.getPath();t!==null&&!XC(a,t.path)&&(n.eventLists_.push(t),t=null),t===null&&(t={events:[],path:a}),t.events.push(s)}t&&n.eventLists_.push(t)}function Ci(n,e,t){NS(n,t),lM(n,r=>Kn(r,e)||Kn(e,r))}function lM(n,e){n.recursionDepth_++;let t=!0;for(let r=0;r<n.eventLists_.length;r++){const s=n.eventLists_[r];if(s){const a=s.path;e(a)?(uM(n.eventLists_[r]),n.eventLists_[r]=null):t=!1}}t&&(n.eventLists_=[]),n.recursionDepth_--}function uM(n){for(let e=0;e<n.events.length;e++){const t=n.events[e];if(t!==null){n.events[e]=null;const r=t.getEventRunner();Iu&&Qt("event: "+t.toString()),sl(r)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cM="repo_interrupt",hM=25;class dM{constructor(e,t,r,s){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=r,this.appCheckProvider_=s,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new aM,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Sd(),this.transactionQueueTree_=new k_,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function fM(n,e,t){if(n.stats_=d_(n.repoInfo_),n.forceRestClient_||aO())n.server_=new Cd(n.repoInfo_,(r,s,a,u)=>{vE(n,r,s,a,u)},n.authTokenProvider_,n.appCheckProvider_),setTimeout(()=>wE(n,!0),0);else{if(typeof t<"u"&&t!==null){if(typeof t!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{Yt(t)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}n.persistentConnection_=new _i(n.repoInfo_,e,(r,s,a,u)=>{vE(n,r,s,a,u)},r=>{wE(n,r)},r=>{mM(n,r)},n.authTokenProvider_,n.appCheckProvider_,t),n.server_=n.persistentConnection_}n.authTokenProvider_.addTokenChangeListener(r=>{n.server_.refreshAuthToken(r)}),n.appCheckProvider_.addTokenChangeListener(r=>{n.server_.refreshAppCheckToken(r.token)}),n.statsReporter_=dO(n.repoInfo_,()=>new dL(n.stats_,n.server_)),n.infoData_=new aL,n.infoSyncTree_=new _E({startListening:(r,s,a,u)=>{let h=[];const f=n.infoData_.getNode(r._path);return f.isEmpty()||(h=cf(n.infoSyncTree_,r._path,f),setTimeout(()=>{u("ok")},0)),h},stopListening:()=>{}}),b_(n,"connected",!1),n.serverSyncTree_=new _E({startListening:(r,s,a,u)=>(n.server_.listen(r,a,s,(h,f)=>{const p=u(h,f);Ci(n.eventQueue_,r._path,p)}),[]),stopListening:(r,s)=>{n.server_.unlisten(r,s)}})}function pM(n){const t=n.infoData_.getNode(new tt(".info/serverTimeOffset")).val()||0;return new Date().getTime()+t}function P_(n){return GL({timestamp:pM(n)})}function vE(n,e,t,r,s){n.dataUpdateCount++;const a=new tt(e);t=n.interceptServerDataCallback_?n.interceptServerDataCallback_(e,t):t;let u=[];if(s)if(r){const f=ed(t,p=>St(p));u=HL(n.serverSyncTree_,a,f,s)}else{const f=St(t);u=WL(n.serverSyncTree_,a,f,s)}else if(r){const f=ed(t,p=>St(p));u=$L(n.serverSyncTree_,a,f)}else{const f=St(t);u=cf(n.serverSyncTree_,a,f)}let h=a;u.length>0&&(h=pf(n,a)),Ci(n.eventQueue_,h,u)}function wE(n,e){b_(n,"connected",e),e===!1&&_M(n)}function mM(n,e){Sn(e,(t,r)=>{b_(n,t,r)})}function b_(n,e,t){const r=new tt("/.info/"+e),s=St(t);n.infoData_.updateSnapshot(r,s);const a=cf(n.infoSyncTree_,r,s);Ci(n.eventQueue_,r,a)}function DS(n){return n.nextWriteId_++}function gM(n,e,t,r,s){N_(n,"set",{path:e.toString(),value:t,priority:r});const a=P_(n),u=St(t,r),h=I_(n.serverSyncTree_,e),f=SS(u,h,a),p=DS(n),y=vS(n.serverSyncTree_,e,f,p,!0);NS(n.eventQueue_,y),n.server_.put(e.toString(),u.val(!0),(E,S)=>{const R=E==="ok";R||Cn("set at "+e+" failed: "+E);const N=ao(n.serverSyncTree_,p,!R);Ci(n.eventQueue_,e,N),qa(n,s,E,S)});const v=FS(n,e);pf(n,v),Ci(n.eventQueue_,v,[])}function _M(n){N_(n,"onDisconnectEvents");const e=P_(n),t=Sd();Qm(n.onDisconnect_,Xe(),(s,a)=>{const u=QL(s,a,n.serverSyncTree_,e);ol(t,s,u)});let r=[];Qm(t,Xe(),(s,a)=>{r=r.concat(cf(n.serverSyncTree_,s,a));const u=FS(n,s);pf(n,u)}),n.onDisconnect_=Sd(),Ci(n.eventQueue_,Xe(),r)}function yM(n,e,t){n.server_.onDisconnectCancel(e.toString(),(r,s)=>{r==="ok"&&Km(n.onDisconnect_,e),qa(n,t,r,s)})}function EE(n,e,t,r){const s=St(t);n.server_.onDisconnectPut(e.toString(),s.val(!0),(a,u)=>{a==="ok"&&ol(n.onDisconnect_,e,s),qa(n,r,a,u)})}function vM(n,e,t,r,s){const a=St(t,r);n.server_.onDisconnectPut(e.toString(),a.val(!0),(u,h)=>{u==="ok"&&ol(n.onDisconnect_,e,a),qa(n,s,u,h)})}function wM(n,e,t,r){if(Zh(t)){Qt("onDisconnect().update() called with empty data.  Don't do anything."),qa(n,r,"ok",void 0);return}n.server_.onDisconnectMerge(e.toString(),t,(s,a)=>{s==="ok"&&Sn(t,(u,h)=>{const f=St(h);ol(n.onDisconnect_,Et(e,u),f)}),qa(n,r,s,a)})}function EM(n){n.persistentConnection_&&n.persistentConnection_.interrupt(cM)}function N_(n,...e){let t="";n.persistentConnection_&&(t=n.persistentConnection_.id+":"),Qt(t,...e)}function qa(n,e,t,r){e&&sl(()=>{if(t==="ok")e(null);else{const s=(t||"error").toUpperCase();let a=s;r&&(a+=": "+r);const u=new Error(a);u.code=s,e(u)}})}function OS(n,e,t){return I_(n.serverSyncTree_,e,t)||Qe.EMPTY_NODE}function D_(n,e=n.transactionQueueTree_){if(e||mf(n,e),al(e)){const t=MS(n,e);le(t.length>0,"Sending zero length transaction queue"),t.every(s=>s.status===0)&&TM(n,cc(e),t)}else kS(e)&&df(e,t=>{D_(n,t)})}function TM(n,e,t){const r=t.map(p=>p.currentWriteId),s=OS(n,e,r);let a=s;const u=s.hash();for(let p=0;p<t.length;p++){const y=t[p];le(y.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),y.status=1,y.retryCount++;const v=qn(e,y.path);a=a.updateChild(v,y.currentOutputSnapshotRaw)}const h=a.val(!0),f=e;n.server_.put(f.toString(),h,p=>{N_(n,"transaction put response",{path:f.toString(),status:p});let y=[];if(p==="ok"){const v=[];for(let E=0;E<t.length;E++)t[E].status=2,y=y.concat(ao(n.serverSyncTree_,t[E].currentWriteId)),t[E].onComplete&&v.push(()=>t[E].onComplete(null,!0,t[E].currentOutputSnapshotResolved)),t[E].unwatcher();mf(n,R_(n.transactionQueueTree_,e)),D_(n,n.transactionQueueTree_),Ci(n.eventQueue_,e,y);for(let E=0;E<v.length;E++)sl(v[E])}else{if(p==="datastale")for(let v=0;v<t.length;v++)t[v].status===3?t[v].status=4:t[v].status=0;else{Cn("transaction at "+f.toString()+" failed: "+p);for(let v=0;v<t.length;v++)t[v].status=4,t[v].abortReason=p}pf(n,e)}},u)}function pf(n,e){const t=LS(n,e),r=cc(t),s=MS(n,t);return IM(n,s,r),r}function IM(n,e,t){if(e.length===0)return;const r=[];let s=[];const u=e.filter(h=>h.status===0).map(h=>h.currentWriteId);for(let h=0;h<e.length;h++){const f=e[h],p=qn(t,f.path);let y=!1,v;if(le(p!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),f.status===4)y=!0,v=f.abortReason,s=s.concat(ao(n.serverSyncTree_,f.currentWriteId,!0));else if(f.status===0)if(f.retryCount>=hM)y=!0,v="maxretry",s=s.concat(ao(n.serverSyncTree_,f.currentWriteId,!0));else{const E=OS(n,f.path,u);f.currentInputSnapshot=E;const S=e[h].update(E.val());if(S!==void 0){ff("transaction failed: Data returned ",S,f.path);let R=St(S);typeof S=="object"&&S!=null&&Br(S,".priority")||(R=R.updatePriority(E.getPriority()));const O=f.currentWriteId,V=P_(n),K=SS(R,E,V);f.currentOutputSnapshotRaw=R,f.currentOutputSnapshotResolved=K,f.currentWriteId=DS(n),u.splice(u.indexOf(O),1),s=s.concat(vS(n.serverSyncTree_,f.path,K,f.currentWriteId,f.applyLocally)),s=s.concat(ao(n.serverSyncTree_,O,!0))}else y=!0,v="nodata",s=s.concat(ao(n.serverSyncTree_,f.currentWriteId,!0))}Ci(n.eventQueue_,t,s),s=[],y&&(e[h].status=2,function(E){setTimeout(E,Math.floor(0))}(e[h].unwatcher),e[h].onComplete&&(v==="nodata"?r.push(()=>e[h].onComplete(null,!1,e[h].currentInputSnapshot)):r.push(()=>e[h].onComplete(new Error(v),!1,null))))}mf(n,n.transactionQueueTree_);for(let h=0;h<r.length;h++)sl(r[h]);D_(n,n.transactionQueueTree_)}function LS(n,e){let t,r=n.transactionQueueTree_;for(t=Ne(e);t!==null&&al(r)===void 0;)r=R_(r,t),e=st(e),t=Ne(e);return r}function MS(n,e){const t=[];return VS(n,e,t),t.sort((r,s)=>r.order-s.order),t}function VS(n,e,t){const r=al(e);if(r)for(let s=0;s<r.length;s++)t.push(r[s]);df(e,s=>{VS(n,s,t)})}function mf(n,e){const t=al(e);if(t){let r=0;for(let s=0;s<t.length;s++)t[s].status!==2&&(t[r]=t[s],r++);t.length=r,AS(e,t.length>0?t:void 0)}df(e,r=>{mf(n,r)})}function FS(n,e){const t=cc(LS(n,e)),r=R_(n.transactionQueueTree_,e);return JL(r,s=>{dm(n,s)}),dm(n,r),RS(r,s=>{dm(n,s)}),t}function dm(n,e){const t=al(e);if(t){const r=[];let s=[],a=-1;for(let u=0;u<t.length;u++)t[u].status===3||(t[u].status===1?(le(a===u-1,"All SENT items should be at beginning of queue."),a=u,t[u].status=3,t[u].abortReason="set"):(le(t[u].status===0,"Unexpected transaction status in abort"),t[u].unwatcher(),s=s.concat(ao(n.serverSyncTree_,t[u].currentWriteId,!0)),t[u].onComplete&&r.push(t[u].onComplete.bind(null,new Error("set"),!1,null))));a===-1?AS(e,void 0):t.length=a+1,Ci(n.eventQueue_,cc(e),s);for(let u=0;u<r.length;u++)sl(r[u])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CM(n){let e="";const t=n.split("/");for(let r=0;r<t.length;r++)if(t[r].length>0){let s=t[r];try{s=decodeURIComponent(s.replace(/\+/g," "))}catch{}e+="/"+s}return e}function SM(n){const e={};n.charAt(0)==="?"&&(n=n.substring(1));for(const t of n.split("&")){if(t.length===0)continue;const r=t.split("=");r.length===2?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):Cn(`Invalid query segment '${t}' in query '${n}'`)}return e}const TE=function(n,e){const t=AM(n),r=t.namespace;t.domain==="firebase.com"&&Ii(t.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||r==="undefined")&&t.domain!=="localhost"&&Ii("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),t.secure||ZD();const s=t.scheme==="ws"||t.scheme==="wss";return{repoInfo:new zC(t.host,t.secure,r,s,e,"",r!==t.subdomain),path:new tt(t.pathString)}},AM=function(n){let e="",t="",r="",s="",a="",u=!0,h="https",f=443;if(typeof n=="string"){let p=n.indexOf("//");p>=0&&(h=n.substring(0,p-1),n=n.substring(p+2));let y=n.indexOf("/");y===-1&&(y=n.length);let v=n.indexOf("?");v===-1&&(v=n.length),e=n.substring(0,Math.min(y,v)),y<v&&(s=CM(n.substring(y,v)));const E=SM(n.substring(Math.min(n.length,v)));p=e.indexOf(":"),p>=0?(u=h==="https"||h==="wss",f=parseInt(e.substring(p+1),10)):p=e.length;const S=e.slice(0,p);if(S.toLowerCase()==="localhost")t="localhost";else if(S.split(".").length<=2)t=S;else{const R=e.indexOf(".");r=e.substring(0,R).toLowerCase(),t=e.substring(R+1),a=r}"ns"in E&&(a=E.ns)}return{host:e,port:f,domain:t,subdomain:r,secure:u,scheme:h,pathString:s,namespace:a}};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kM{constructor(e,t){this._repo=e,this._path=t}cancel(){const e=new ui;return yM(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){mu("OnDisconnect.remove",this._path);const e=new ui;return EE(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){mu("OnDisconnect.set",this._path),rg("OnDisconnect.set",e,this._path);const t=new ui;return EE(this._repo,this._path,e,t.wrapCallback(()=>{})),t.promise}setWithPriority(e,t){mu("OnDisconnect.setWithPriority",this._path),rg("OnDisconnect.setWithPriority",e,this._path),iM("OnDisconnect.setWithPriority",t);const r=new ui;return vM(this._repo,this._path,e,t,r.wrapCallback(()=>{})),r.promise}update(e){mu("OnDisconnect.update",this._path),rM("OnDisconnect.update",e,this._path);const t=new ui;return wM(this._repo,this._path,e,t.wrapCallback(()=>{})),t.promise}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O_{constructor(e,t,r,s){this._repo=e,this._path=t,this._queryParams=r,this._orderByCalled=s}get key(){return Le(this._path)?null:p_(this._path)}get ref(){return new ko(this._repo,this._path)}get _queryIdentifier(){const e=oE(this._queryParams),t=c_(e);return t==="{}"?"default":t}get _queryObject(){return oE(this._queryParams)}isEqual(e){if(e=Ze(e),!(e instanceof O_))return!1;const t=this._repo===e._repo,r=XC(this._path,e._path),s=this._queryIdentifier===e._queryIdentifier;return t&&r&&s}toJSON(){return this.toString()}toString(){return this._repo.toString()+LO(this._path)}}class ko extends O_{constructor(e,t){super(e,t,new __,!1)}get parent(){const e=JC(this._path);return e===null?null:new ko(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}}function IE(n,e){return n=Ze(n),n._checkNotDeleted("ref"),e!==void 0?RM(n._root,e):n._root}function RM(n,e){return n=Ze(n),Ne(n._path)===null?sM("child","path",e):bS("child","path",e),new ko(n._repo,Et(n._path,e))}function CE(n){return n=Ze(n),new kM(n._repo,n._path)}function SE(n,e){n=Ze(n),mu("set",n._path),rg("set",e,n._path);const t=new ui;return gM(n._repo,n._path,e,null,t.wrapCallback(()=>{})),t.promise}BL(ko);zL(ko);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xM="FIREBASE_DATABASE_EMULATOR_HOST",ig={};let PM=!1;function bM(n,e,t,r){const s=e.lastIndexOf(":"),a=e.substring(0,s),u=Is(a);n.repoInfo_=new zC(e,u,n.repoInfo_.namespace,n.repoInfo_.webSocketOnly,n.repoInfo_.nodeAdmin,n.repoInfo_.persistenceKey,n.repoInfo_.includeNamespaceInQueryParams,!0,t),r&&(n.authTokenProvider_=r)}function NM(n,e,t,r,s){let a=r||n.options.databaseURL;a===void 0&&(n.options.projectId||Ii("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Qt("Using default host for project ",n.options.projectId),a=`${n.options.projectId}-default-rtdb.firebaseio.com`);let u=TE(a,s),h=u.repoInfo,f;typeof process<"u"&&B0&&(f=B0[xM]),f?(a=`http://${f}?ns=${h.namespace}`,u=TE(a,s),h=u.repoInfo):u.repoInfo.secure;const p=new uO(n.name,n.options,e);oM("Invalid Firebase Database URL",u),Le(u.path)||Ii("Database URL must point to the root of a Firebase Database (not including a child path).");const y=OM(h,n,p,new lO(n,t));return new LM(y,n)}function DM(n,e){const t=ig[e];(!t||t[n.key]!==n)&&Ii(`Database ${e}(${n.repoInfo_}) has already been deleted.`),EM(n),delete t[n.key]}function OM(n,e,t,r){let s=ig[e.name];s||(s={},ig[e.name]=s);let a=s[n.toURLString()];return a&&Ii("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),a=new dM(n,PM,t,r),s[n.toURLString()]=a,a}class LM{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(fM(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new ko(this._repo,Xe())),this._rootInternal}_delete(){return this._rootInternal!==null&&(DM(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&Ii("Cannot call "+e+" on a deleted database.")}}function MM(n=gg(),e){const t=Fd(n,"database").getImmediate({identifier:e});if(!t._instanceStarted){const r=nT("database");r&&VM(t,...r)}return t}function VM(n,e,t,r={}){n=Ze(n),n._checkNotDeleted("useEmulator");const s=`${e}:${t}`,a=n._repoInternal;if(n._instanceStarted){if(s===n._repoInternal.repoInfo_.host&&ds(r,a.repoInfo_.emulatorOptions))return;Ii("connectDatabaseEmulator() cannot initialize or alter the emulator configuration after the database instance has started.")}let u;if(a.repoInfo_.nodeAdmin)r.mockUserToken&&Ii('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),u=new Qh(Qh.OWNER);else if(r.mockUserToken){const h=typeof r.mockUserToken=="string"?r.mockUserToken:sT(r.mockUserToken,n.app.options.projectId);u=new Qh(h)}Is(e)&&(dg(e),fg("Database",!0)),bM(a,s,r,u)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FM(n){qD(wo),co(new fs("database",(e,{instanceIdentifier:t})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("auth-internal"),a=e.getProvider("app-check-internal");return NM(r,s,a,t)},"PUBLIC").setMultipleInstances(!0)),Pr(z0,$0,n),Pr(z0,$0,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jM={".sv":"timestamp"};function fm(){return jM}_i.prototype.simpleListen=function(n,e){this.sendRequest("q",{p:n},e)};_i.prototype.echo=function(n,e){this.sendRequest("echo",{d:n},e)};FM();const UM={apiKey:"AIzaSyAtHGfl2GwWOaNO5GlJbwYP8U10lNSnz68",authDomain:"smite2pbsimulator.firebaseapp.com",projectId:"smite2pbsimulator",storageBucket:"smite2pbsimulator.appspot.com",messagingSenderId:"1019891524633",appId:"1:1019891524633:web:43b4556d609bed2c03f688"},L_=cT(UM),He=PD(L_),zr=kb(L_),AE=MM(L_);Cg(zr,n=>{n?console.log("User signed in with UID:",n.uid):console.log("User is signed out.")});const jS=U.createContext(void 0),BM=({children:n})=>{const[e,t]=U.useState("dark"),r=()=>{t(a=>a==="light"?"dark":"light")},s=U.useMemo(()=>({theme:e,toggleTheme:r}),[e]);return I.jsx(jS.Provider,{value:s,children:n})},US=()=>{const n=U.useContext(jS);if(n===void 0)throw new Error("useTheme must be used within a ThemeProvider");return n},hc=()=>{const[n]=zd(zr),[e,t]=U.useState(null),[r,s]=U.useState(!0),[a,u]=U.useState(null);return U.useEffect(()=>{if(!n){t(null),s(!1);return}const h=wt(He,"users",n.uid),f=go(h,p=>{p.exists()?t({id:p.id,...p.data()}):u("User profile not found in the database."),s(!1)},p=>{u("Failed to fetch user profile."),s(!1)});return()=>f()},[n]),{user:n,userProfile:e,loading:r,error:a}},Va=[{id:33,name:"Aladdin",image:"https://wiki.smite2.com/images/thumb/GodCard_Aladdin.png/720px-GodCard_Aladdin.png?87e68",roles:["Jungle","Mid","Carry"],skins:[""],voiceLine:"",position:"center 25%"},{id:11,name:"Agni",image:"https://wiki.smite2.com/images/thumb/GodCard_Agni.png/720px-GodCard_Agni.png?87e68",roles:["Mid","Carry"],skins:[""],voiceLine:"",position:"center 20%"},{id:27,name:"Achilles",image:"https://wiki.smite2.com/images/thumb/GodCard_Achilles.png/720px-GodCard_Achilles.png?3ef24",roles:["Solo","Jungle"],skins:[""],voiceLine:"",position:"center 20%"},{id:28,name:"Amaterasu",image:"https://wiki.smite2.com/images/thumb/GodCard_Amaterasu.png/720px-GodCard_Amaterasu.png?dad20",roles:["Solo","Jungle"],skins:[""],voiceLine:"",position:"center 25%"},{id:42,name:"Anhur",image:"https://wiki.smite2.com/images/thumb/GodCard_Anhur.png/720px-GodCard_Anhur.png?dad20",roles:["Carry"],skins:[""],voiceLine:"",position:"center 20%"},{id:13,name:"Anubis",image:"https://wiki.smite2.com/images/thumb/GodCard_Anubis.png/720px-GodCard_Anubis.png?7859a",roles:["Mid"],skins:[""],voiceLine:"",position:"center 15%"},{id:63,name:"Aphrodite",image:"https://wiki.smite2.com/images/thumb/GodCard_Aphrodite.png/720px-GodCard_Aphrodite.png?7859a",roles:["Support","Mid","Solo"],skins:[""],voiceLine:"",position:"center 20%"},{id:43,name:"Apollo",image:"https://wiki.smite2.com/images/thumb/GodCard_Apollo.png/720px-GodCard_Apollo.png?184d1",roles:["Carry"],skins:[""],voiceLine:"",position:"center 20%"},{id:1,name:"Ares",image:"https://wiki.smite2.com/images/thumb/GodCard_Ares.png/720px-GodCard_Ares.png?7859a",roles:["Support","Jungle"],skins:[""],voiceLine:"",position:"center 15%"},{id:44,name:"Artemis",image:"https://wiki.smite2.com/images/thumb/GodCard_Artemis.png/720px-GodCard_Artemis.png?ac80c",roles:["Carry","Mid"],skins:[""],voiceLine:"",position:"center 20%"},{id:2,name:"Athena",image:"https://wiki.smite2.com/images/thumb/GodCard_Athena.png/360px-GodCard_Athena.png?b6c55",roles:["Support","Jungle"],skins:[""],voiceLine:"",position:"center 15%"},{id:34,name:"Awilix",image:"https://wiki.smite2.com/images/thumb/GodCard_Awilix.png/720px-GodCard_Awilix.png?381d1",roles:["Jungle"],skins:[""],voiceLine:"",position:"center 20%"},{id:3,name:"Bacchus",image:"https://wiki.smite2.com/images/thumb/GodCard_Bacchus.png/720px-GodCard_Bacchus.png?b6c55",roles:["Support","Solo"],skins:[""],voiceLine:"",position:"center 25%"},{id:64,name:"Baron Samedi",image:"https://wiki.smite2.com/images/thumb/GodCard_Baron_Samedi.png/720px-GodCard_Baron_Samedi.png?75202",roles:["Support","Solo","Mid"],skins:[""],voiceLine:"",position:"center 10%"},{id:29,name:"Bellona",image:"https://wiki.smite2.com/images/thumb/GodCard_Bellona.png/720px-GodCard_Bellona.png?b6c55",roles:["Solo","Support"],skins:[""],voiceLine:"",position:"center 20%"},{id:4,name:"Cabrakan",image:"https://wiki.smite2.com/images/thumb/GodCard_Cabrakan.png/720px-GodCard_Cabrakan.png?381d1",roles:["Solo","Jungle","Support"],skins:[""],voiceLine:"",position:"center 20%"},{id:5,name:"Cerberus",image:"https://wiki.smite2.com/images/thumb/GodCard_Cerberus.png/720px-GodCard_Cerberus.png?ac80c",roles:["Solo","Support"],skins:[""],voiceLine:"",position:"center 30%"},{id:45,name:"Cernunnos",image:"https://wiki.smite2.com/images/thumb/GodCard_Cernunnos.png/720px-GodCard_Cernunnos.png?ac80c",roles:["Carry","Mid"],skins:[""],voiceLine:"",position:"center 15%"},{id:30,name:"Chaac",image:"https://wiki.smite2.com/images/thumb/GodCard_Chaac.png/720px-GodCard_Chaac.png?381d1",roles:["Solo","Mid"],skins:[""],voiceLine:"",position:"center 15%"},{id:46,name:"Cupid",image:"https://wiki.smite2.com/images/thumb/GodCard_Cupid.png/720px-GodCard_Cupid.png?ac80c",roles:["Carry","Support"],skins:[""],voiceLine:"",position:"center 25%"},{id:47,name:"Danzaburou",image:"https://wiki.smite2.com/images/thumb/GodCard_Danzaburou.png/720px-GodCard_Danzaburou.png?75202",roles:["Carry","Mid"],skins:[""],voiceLine:"",position:"center 20%"},{id:35,name:"Fenrir",image:"https://wiki.smite2.com/images/thumb/GodCard_Fenrir.png/720px-GodCard_Fenrir.png?87e68",roles:["Jungle","Support","Solo"],skins:[""],voiceLine:"",position:"center 20%"},{id:70,name:"Ganesha",image:"https://wiki.smite2.com/images/thumb/GodCard_Ganesha.png/720px-GodCard_Ganesha.png?57532",roles:["Support","Solo"],skins:[""],voiceLine:"",position:"center 25%"},{id:7,name:"Geb",image:"https://wiki.smite2.com/images/thumb/GodCard_Geb.png/720px-GodCard_Geb.png?ac80c",roles:["Support","Solo"],skins:[""],voiceLine:"",position:"center 20%"},{id:31,name:"Guan Yu",image:"https://wiki.smite2.com/images/thumb/GodCard_Guan_Yu.png/720px-GodCard_Guan_Yu.png?ac80c",roles:["Solo","Support"],skins:[""],voiceLine:"",position:"center 20%"},{id:65,name:"Hades",image:"https://wiki.smite2.com/images/thumb/GodCard_Hades.png/720px-GodCard_Hades.png?75202",roles:["Solo","Support","Mid"],skins:[""],voiceLine:"",position:"center 15%"},{id:66,name:"Hecate",image:"https://wiki.smite2.com/images/thumb/GodCard_Hecate.png/720px-GodCard_Hecate.png?75202",roles:["Support","Mid"],skins:[""],voiceLine:"",position:"center 10%"},{id:57,name:"Hercules",image:"https://wiki.smite2.com/images/thumb/GodCard_Hercules.png/720px-GodCard_Hercules.png?75202",roles:["Solo","Support","Jungle"],skins:[""],voiceLine:"",position:"center 20%"},{id:32,name:"Mulan",image:"https://wiki.smite2.com/images/thumb/GodCard_Hua_Mulan.png/720px-GodCard_Hua_Mulan.png?87e68",roles:["Solo"],skins:[""],voiceLine:"",position:"center 20%"},{id:60,name:"Hun Batz",image:"https://wiki.smite2.com/images/thumb/GodCard_Hun_Batz.png/720px-GodCard_Hun_Batz.png?cc9cb",roles:["Jungle","Support","Solo"],skins:[""],voiceLine:"",position:"center 20%"},{id:48,name:"Izanami",image:"https://wiki.smite2.com/images/thumb/GodCard_Izanami.png/720px-GodCard_Izanami.png?87e68",roles:["Carry"],skins:[""],voiceLine:"",position:"center 25%"},{id:49,name:"Jing Wei",image:"https://wiki.smite2.com/images/thumb/GodCard_Jing_Wei.png/720px-GodCard_Jing_Wei.png?87e68",roles:["Carry"],skins:[""],voiceLine:"",position:"center 20%"},{id:36,name:"Kali",image:"https://wiki.smite2.com/images/thumb/GodCard_Kali.png/720px-GodCard_Kali.png?cc9cb",roles:["Jungle","Carry"],skins:[""],voiceLine:"",position:"center 20%"},{id:8,name:"Khepri",image:"https://wiki.smite2.com/images/thumb/GodCard_Khepri.png/720px-GodCard_Khepri.png?cc9cb",roles:["Support"],skins:[""],voiceLine:"",position:"center 35%"},{id:18,name:"Kukulkan",image:"https://wiki.smite2.com/images/thumb/GodCard_Kukulkan.png/720px-GodCard_Kukulkan.png?cc9cb",roles:["Mid"],skins:[""],voiceLine:"",position:"center 30%"},{id:37,name:"Loki",image:"https://wiki.smite2.com/images/thumb/GodCard_Loki.png/720px-GodCard_Loki.png?cc9cb",roles:["Jungle"],skins:[""],voiceLine:"",position:"center 15%"},{id:50,name:"Medusa",image:"https://wiki.smite2.com/images/thumb/GodCard_Medusa.png/720px-GodCard_Medusa.png?e757b",roles:["Carry","Mid"],skins:[""],voiceLine:"",position:"center 30%"},{id:38,name:"Mercury",image:"https://wiki.smite2.com/images/thumb/GodCard_Mercury.png/720px-GodCard_Mercury.png?7520c",roles:["Jungle"],skins:[""],voiceLine:"",position:"center 20%"},{id:19,name:"Merlin",image:"https://wiki.smite2.com/images/thumb/GodCard_Merlin.png/720px-GodCard_Merlin.png?544c9",roles:["Mid","Solo"],skins:[""],voiceLine:"",position:"center 15%"},{id:67,name:"Mordred",image:"https://wiki.smite2.com/images/thumb/GodCard_Mordred.png/720px-GodCard_Mordred.png?b6c55",roles:["Solo","Jungle"],skins:[""],voiceLine:"",position:"center 20%"},{id:51,name:"Neith",image:"https://wiki.smite2.com/images/thumb/GodCard_Neith.png/720px-GodCard_Neith.png?e757b",roles:["Carry","Mid"],skins:[""],voiceLine:"",position:"center 25%"},{id:39,name:"Nemesis",image:"https://wiki.smite2.com/images/thumb/GodCard_Nemesis.png/720px-GodCard_Nemesis.png?87e68",roles:["Jungle","Solo"],skins:[""],voiceLine:"",position:"center 20%"},{id:20,name:"Nu Wa",image:"https://wiki.smite2.com/images/thumb/GodCard_Nu_Wa.png/720px-GodCard_Nu_Wa.png?75202",roles:["Mid","Carry"],skins:[""],voiceLine:"",position:"center 20%"},{id:58,name:"Odin",image:"https://wiki.smite2.com/images/thumb/GodCard_Odin.png/720px-GodCard_Odin.png?87e68",roles:["Solo","Support"],skins:[""],voiceLine:"",position:"center 20%"},{id:61,name:"Pele",image:"https://wiki.smite2.com/images/thumb/GodCard_Pele.png/720px-GodCard_Pele.png?cc9cb",roles:["Jungle","Mid","Carry","Solo"],skins:[""],voiceLine:"",position:"center 25%"},{id:21,name:"Poseidon",image:"https://wiki.smite2.com/images/thumb/GodCard_Poseidon.png/720px-GodCard_Poseidon.png?dcbb5",roles:["Mid","Carry","Jungle"],skins:[""],voiceLine:"",position:"center 15%"},{id:68,name:"Princess Bari",image:"https://wiki.smite2.com/images/thumb/GodCard_Princess_Bari.png/720px-GodCard_Princess_Bari.png?cc9cb",roles:["Carry","Mid"],skins:[""],voiceLine:"",position:"center 20%"},{id:55,name:"Ra",image:"https://wiki.smite2.com/images/thumb/GodCard_Ra.png/720px-GodCard_Ra.png?b6c55",roles:["Mid","Solo"],skins:[""],voiceLine:"",position:"center 15%"},{id:52,name:"Rama",image:"https://wiki.smite2.com/images/thumb/GodCard_Rama.png/720px-GodCard_Rama.png?cc9cb",roles:["Carry"],skins:[""],voiceLine:"",position:"center 20%"},{id:23,name:"Scylla",image:"https://wiki.smite2.com/images/thumb/GodCard_Scylla.png/720px-GodCard_Scylla.png?c2048",roles:["Mid"],skins:[""],voiceLine:"",position:"center 25%"},{id:9,name:"Sobek",image:"https://wiki.smite2.com/images/thumb/GodCard_Sobek.png/720px-GodCard_Sobek.png?b6c55",roles:["Support","Solo"],skins:[""],voiceLine:"",position:"center 25%"},{id:24,name:"Sol",image:"https://wiki.smite2.com/images/thumb/GodCard_Sol.png/720px-GodCard_Sol.png?cc9cb",roles:["Carry","Mid"],skins:[""],voiceLine:"",position:"center 20%"},{id:59,name:"Sun Wukong",image:"https://via.placeholder.com/100",roles:["Solo","Jungle"],skins:[""],voiceLine:"",position:"center 20%"},{id:40,name:"Susano",image:"https://wiki.smite2.com/images/thumb/GodCard_Susano.png/720px-GodCard_Susano.png?dcbb5",roles:["Jungle","Mid"],skins:[""],voiceLine:"",position:"center 20%"},{id:41,name:"Thanatos",image:"https://wiki.smite2.com/images/thumb/GodCard_Thanatos.png/720px-GodCard_Thanatos.png?c2048",roles:["Jungle","Solo"],skins:[""],voiceLine:"",position:"center 15%"},{id:69,name:"The Morrigan",image:"https://wiki.smite2.com/images/thumb/GodCard_The_Morrigan.png/720px-GodCard_The_Morrigan.png?75202",roles:["Carry","Mid","Support","Solo","Jungle"],skins:[""],voiceLine:"",position:"center 20%"},{id:62,name:"Thor",image:"https://wiki.smite2.com/images/thumb/GodCard_Thor.png/720px-GodCard_Thor.png?e757b",roles:["Jungle","Solo","Support"],skins:[""],voiceLine:"",position:"center 20%"},{id:53,name:"Ullr",image:"https://wiki.smite2.com/images/thumb/GodCard_Ullr.png/720px-GodCard_Ullr.png?55475",roles:["Carry","Mid"],skins:[""],voiceLine:"",position:"center 20%"},{id:56,name:"Vulcan",image:"https://wiki.smite2.com/images/thumb/GodCard_Vulcan.png/720px-GodCard_Vulcan.png?cc9cb",roles:["Mid"],skins:[""],voiceLine:"",position:"center 20%"},{id:54,name:"Yemoja",image:"https://wiki.smite2.com/images/thumb/GodCard_Yemoja.png/720px-GodCard_Yemoja.png?75202",roles:["Support"],skins:[""],voiceLine:"",position:"center 20%"},{id:10,name:"Ymir",image:"https://wiki.smite2.com/images/thumb/GodCard_Ymir.png/720px-GodCard_Ymir.png?7859a",roles:["Support","Solo","Jungle"],skins:[""],voiceLine:"",position:"center 10%"},{id:26,name:"Zeus",image:"https://wiki.smite2.com/images/thumb/GodCard_Zeus.png/720px-GodCard_Zeus.png?75202",roles:["Mid","Carry"],skins:[""],voiceLine:"",position:"center 15%"}],zM=()=>{const[n,e]=U.useState(!1),[t,r]=U.useState(.3),[s,a]=U.useState(new Map),u=p=>{if(n)return;let y=s.get(p);if(y)y.currentTime=0,y.volume=t,y.play().catch(v=>{console.error("Error playing audio:",v)});else{const v=p.replace(/ /g,"%20");y=new Audio(`${v}.ogg`),y.preload="auto",y.volume=t,a(S=>new Map(S).set(p,y));const E=()=>{y.currentTime=0,y.volume=t,y.play().catch(S=>{console.error("Error playing audio:",S)})};y.readyState>=2?E():(y.addEventListener("loadeddata",E,{once:!0}),y.addEventListener("canplaythrough",E,{once:!0}))}},h=p=>{r(p),s.forEach(y=>{y.volume=p})},f=()=>{e(p=>!p)};return U.useEffect(()=>{s.forEach(p=>{p.volume=n?0:t})},[n,t,s]),{isMuted:n,volume:t,playAudio:u,handleVolumeChange:h,toggleMute:f}},BS=U.createContext(null),gf=()=>{const n=U.useContext(BS);if(!n)throw new Error("useAudioContext must be used within an AudioProvider");return n},M_=({children:n})=>{const e=zM(),t=U.useRef(!1),r=U.useCallback(()=>{if(t.current)return;t.current=!0;const a=new Audio("data:audio/wav;base64,UklGRiQAAABXQVZFZm10IBAAAAABAAEARKwAAIhYAQACABAAZGF0YQAAAAA=");a.volume=0,a.play().catch(()=>{}),console.log("Audio unlocked")},[]),s={...e,unlockAudio:r};return I.jsx(BS.Provider,{value:s,children:n})},pm=["A","B","B","A","A","B","B","A","A","B"],$M=({mode:n})=>{const[e]=U.useState(Va),[t,r]=U.useState("BAN"),[s,a]=U.useState("A"),[u,h]=U.useState([]),[f,p]=U.useState({A:Array(5).fill(null),B:Array(5).fill(null)}),[y,v]=U.useState({A:Array(3).fill(null),B:Array(3).fill(null)}),{playAudio:E}=gf();return{mode:n,characters:e,phase:t,currentTeam:s,picks:f,bans:y,handleCharacterSelect:G=>{if(E(G.name),n!=="freedom")if(h(J=>[...J,{picks:f,bans:y,phase:t,currentTeam:s}]),t==="BAN")v(J=>{const ne={...J},se=[...J[s]],D=se.findIndex(k=>k===null);if(D!==-1)se[D]=G;else return J;return ne[s]=se,ne.A.filter(Boolean).length+ne.B.filter(Boolean).length>=6?(r("PICK"),a(pm[0])):a(k=>k==="A"?"B":"A"),ne});else{const J=f.A.filter(Boolean).length+f.B.filter(Boolean).length;p(se=>{const D={...se},A=[...D[s]],k=A.findIndex(b=>b===null);return k!==-1&&(A[k]=G),D[s]=A,D});const ne=J+1;ne<pm.length&&a(pm[ne])}},handleDragStart:(G,J)=>{G.dataTransfer.setData("characterId",J.id.toString())},handleDragOver:G=>{G.preventDefault()},handleDrop:(G,J,ne,se)=>{const D=parseInt(G.dataTransfer.getData("characterId")),A=e.find(k=>k.id===D);A&&(E(A.name),ne==="ban"?v(k=>({...k,[J]:[...k[J].slice(0,se),A,...k[J].slice(se+1)]})):p(k=>({...k,[J]:[...k[J].slice(0,se),A,...k[J].slice(se+1)]})))},handleUndo:()=>{if(u.length>0){const G=u.pop();G&&(p(G.picks),v(G.bans),r(G.phase),a(G.currentTeam))}},handleClear:()=>{p({A:Array(5).fill(null),B:Array(5).fill(null)}),v({A:Array(3).fill(null),B:Array(3).fill(null)}),r("BAN"),a("A"),h([])}}},WM=({initialState:n,draftId:e,currentUser:t})=>{const[r]=U.useState(Va),{playAudio:s}=gf(),a=U.useRef(n),[u,h]=U.useState(n?.status||"lobby"),[f,p]=U.useState({A:[],B:[]}),[y,v]=U.useState(!1);return U.useEffect(()=>{if(!n||!t)return;h(n.status);const N=n.bans?.A||[],O=n.bans?.B||[],V=A=>A.map(k=>Va.find(b=>b.name===k)||null);p({A:V(N),B:V(O)});const{pickOrder:K,currentPickIndex:G,status:J,picks:ne,teamA:se,teamB:D}=n;if((J==="banning"||J==="picking")&&G<K.length){const k=K[G].team,L=(k==="teamA"?se:D).captain===t.uid;let j=0;if(J==="picking")for(let x=G;x<K.length&&(K[x].team===k&&K[x].type==="pick");x++)j++;if(j>1){const x=n[k].players,De=Object.keys(x).includes(t.uid);let Ke=!1;if(L)for(let Oe=0;Oe<j;Oe++){const xe=G+Oe;if(!ne[xe]){Ke=!0;break}}else for(let Oe=0;Oe<j;Oe++){const xe=G+Oe;if(K[xe]?.uid===t.uid&&!ne[xe]){Ke=!0;break}}v(De&&Ke)}else{const x=K[G],De=t?.uid===x.uid;v(De||L)}}else v(!1);a.current=n},[n,t]),{mode:"standard",characters:r,phase:u,picks:{A:[],B:[]},bans:f,isMyTurn:y,handleCharacterSelect:async N=>{if(!e||!t)return;const O=wt(He,"drafts",e);s(N.name);try{await U0(He,async V=>{const K=await V.get(O);if(!K.exists())throw new Error("Draft document does not exist!");const G=K.data(),{status:J,pickOrder:ne,currentPickIndex:se,bans:D,picks:A,teamA:k,teamB:b}=G;let L=!1,j=-1;const x=ne[se];if(!x)return;const Oe=(x.team==="teamA"?k:b).captain===t.uid;if(J==="banning")L=ne[se].uid===t.uid||Oe,j=se;else if(J==="picking"){const ae=ne[se].team;let B=0;for(let Q=se;Q<ne.length&&(ne[Q].team===ae&&ne[Q].type==="pick");Q++)B++;if(B>0)if(Oe)for(let Q=0;Q<B;Q++){const fe=se+Q;if(!A[fe]){L=!0,j=fe;break}}else for(let Q=0;Q<B;Q++){const fe=se+Q;if(ne[fe]?.uid===t.uid&&!A[fe]){L=!0,j=fe;break}}else(ne[se].uid===t.uid||Oe)&&(L=!0,j=se)}if(!L){console.warn("Not your turn or you have already picked.");return}const xe=[...D?.A||[],...D?.B||[]],ie=Object.values(A||{}).map(ae=>ae.character);if(xe.includes(N.name)||ie.includes(N.name)){console.warn("Character already taken.");return}const ce={};if(J==="banning"){const ae=ne[se].team.slice(-1),B=D[ae]||[];ce[`bans.${ae}`]=[...B,N.name],ce.currentPickIndex=se+1,ne[ce.currentPickIndex]?.type==="pick"&&(ce.status="picking")}else if(J==="picking"){const ae=ne[j].uid;ce[`picks.${j}`]={uid:ae,character:N.name};const B={...A,[j]:{uid:ae,character:N.name}},Q=ne[se].team;let fe=0;for(let Te=se;Te<ne.length&&(ne[Te].team===Q&&ne[Te].type==="pick");Te++)fe++;let ke=0;for(let Te=0;Te<fe;Te++)B[se+Te]&&ke++;if(ke===fe){const Te=se+fe;ce.currentPickIndex=Te,Te>=ne.length&&(ce.status="complete")}}Object.keys(ce).length>0&&(ce.lastActionTimestamp=uo(),V.update(O,ce))})}catch(V){console.error("Draft transaction failed: ",V)}},handleReset:async()=>{if(!e)return;const N=wt(He,"drafts",e);await xa(N,{status:"lobby",pickOrder:[],currentPickIndex:0,teamA:{name:"Team A",captain:null,players:{}},teamB:{name:"Team B",captain:null,players:{}},bans:{A:[],B:[]},picks:{},availableGods:Va.map(O=>O.name),lastActionTimestamp:uo()})},handleLeave:async()=>{if(!e||!t)return;const N=wt(He,"drafts",e);try{await U0(He,async O=>{const V=await O.get(N);if(!V.exists())return;const K=V.data(),G={},J=t.uid;let ne=null;if(K.teamA.players[J]?ne="teamA":K.teamB.players[J]&&(ne="teamB"),ne){const se=K.leftPlayers||[];se.includes(J)||(G.leftPlayers=[...se,J]);const D={...K[ne].players};if(delete D[J],G[`${ne}.players`]=D,K[ne].captain===J){const L=Object.keys(D);G[`${ne}.captain`]=L.length>0?L[0]:null}const A=ne==="teamA"?"teamB":"teamA",k=ne==="teamA"?Object.keys(G["teamA.players"]).length:Object.keys(K.teamA.players).length,b=ne==="teamB"?Object.keys(G["teamB.players"]).length:Object.keys(K.teamB.players).length;k===0&&b===0&&(G.status="archived"),G.lastActionTimestamp=uo(),O.update(N,G)}})}catch(O){console.error("Failed to leave draft: ",O)}},handleDragStart:()=>{},handleDragOver:()=>{},handleDragLeave:()=>{},handleDrop:()=>{},handleStandardDrop:()=>{},handleUndo:()=>{},handleClear:()=>{}}},zS=(n,e)=>(U.useEffect(()=>{if(!n||!e)return;const r=IE(AE,`/status/${n}`),s={state:"offline",last_changed:fm(),draftId:e},a={state:"online",last_changed:fm(),draftId:e};return CE(r).set(s).then(()=>{SE(r,a)}),()=>{CE(r).cancel()}},[n,e]),{setViewingFinalTeams:U.useCallback(()=>{if(!n||!e)return;const r=IE(AE,`/status/${n}`);SE(r,{state:"viewingFinalTeams",last_changed:fm(),draftId:e})},[n,e])}),$S=U.createContext(null),Ai=()=>{const n=U.useContext($S);if(!n)throw new Error("useDraftContext must be used within a DraftProvider");return n},V_=({children:n,mode:e,initialState:t,draftId:r,currentUser:s,teamAName:a,teamBName:u,teamAColor:h,teamBColor:f})=>{const p=r?WM({initialState:t,draftId:r,currentUser:s}):$M({mode:e});zS(s?.uid,r);const y={...p,draftId:r,initialState:t,currentUser:s,teamAName:a,teamBName:u,teamAColor:h,teamBColor:f};return I.jsx($S.Provider,{value:y,children:n})},HM=()=>{const{isMuted:n,toggleMute:e,volume:t,handleVolumeChange:r}=gf();return I.jsxs("div",{className:"flex items-center gap-2.5",children:[I.jsx("button",{onClick:e,className:"text-2xl",children:n?"🔇":"🔊"}),I.jsx("input",{type:"range",min:"0",max:"1",step:"0.01",value:t,onChange:s=>r(parseFloat(s.target.value)),className:"w-24"})]})},WS=({user:n,userProfile:e})=>{const[t,r]=U.useState(!1),[s,a]=U.useState(!1),u=mr(),{theme:h,toggleTheme:f}=US(),p=()=>{VT(zr),u("/")},y=()=>{navigator.clipboard.writeText(n.uid),a(!0),setTimeout(()=>a(!1),2e3)};return I.jsxs("div",{className:"relative",children:[I.jsxs("button",{onClick:()=>r(!t),className:"flex items-center gap-2 text-white font-bold py-2 px-4 rounded focus:outline-none",children:[I.jsx("span",{children:e?.displayName||n.email}),I.jsx("svg",{className:`w-4 h-4 transition-transform duration-200 ${t?"transform rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:I.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})})]}),t&&I.jsx("div",{className:"absolute right-0 mt-2 w-56 bg-gray-700 rounded-md shadow-lg z-10",children:I.jsxs("div",{className:"py-1",children:[I.jsxs("div",{className:"px-4 py-2",children:[I.jsx("span",{className:"text-sm text-gray-400",children:"Player ID"}),I.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[I.jsx("input",{type:"text",value:n.uid,readOnly:!0,className:"w-full bg-gray-800 text-white text-xs rounded px-2 py-1 focus:outline-none"}),I.jsx("button",{onClick:y,className:"bg-gray-600 hover:bg-gray-500 text-white font-bold py-1 px-2 rounded text-xs",children:s?"Copied!":"Copy"})]})]}),I.jsx("div",{className:"border-t border-gray-600 my-1"}),I.jsx("button",{onClick:()=>u("/profile"),className:"block w-full text-left px-4 py-2 text-sm text-white hover:bg-gray-600",children:"Profile"}),I.jsx("button",{onClick:p,className:"block w-full text-left px-4 py-2 text-sm text-white hover:bg-gray-600",children:"Logout"}),I.jsx("div",{className:"border-t border-gray-600 my-1"}),I.jsxs("button",{onClick:f,className:"block w-full text-left px-4 py-2 text-sm text-white hover:bg-gray-600",children:["Switch to ",h==="light"?"Dark":"Light"," Mode"]})]})})]})},GM=()=>{const{user:n,userProfile:e}=hc(),t=mr();return I.jsxs("div",{className:"bg-dark-blue flex justify-between items-center px-5 border-b-2 border-light-blue shadow-lg",children:[I.jsx("div",{className:"flex-1"}),I.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center",children:[I.jsx("div",{className:"text-2xl font-bold tracking-[2px] text-gold text-center text-shadow-[0_0_10px_rgba(255,215,0,0.5)]",children:"SMITE 2 PICK/BAN SIMULATOR"}),I.jsxs("div",{className:"flex items-center gap-2.5",children:[I.jsx("div",{className:"text-chaos text-2xl text-shadow-border-glow",children:"BETA - NOT FINAL"}),I.jsx(HM,{})]})]}),I.jsx("div",{className:"flex-1 flex justify-end",children:n&&e?I.jsx(WS,{user:n,userProfile:e}):I.jsx("button",{onClick:()=>t("/login"),className:"bg-gray-600 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded",children:"Login"})})]})};function qM({mode:n,onModeChange:e}){return I.jsxs("div",{className:"bg-gray-800 rounded-full p-1 relative flex cursor-pointer w-52",children:[I.jsx("div",{className:`flex-1 flex items-center justify-center z-10 font-bold transition-colors duration-300 text-lg ${n==="standard"?"text-white":"text-gray-400"}`,onClick:()=>e("standard"),children:"Pick/Ban"}),I.jsx("div",{className:`flex-1 flex items-center justify-center z-10 font-bold transition-colors duration-300 text-lg ${n==="freedom"?"text-white":"text-gray-400"}`,onClick:()=>e("freedom"),children:"Free"}),I.jsx("div",{className:`absolute top-1 left-1 w-1/2 h-[calc(100%-8px)] rounded-full transition-transform duration-300 ${n==="freedom"?"transform translate-x-[calc(100%-8px)] bg-red-500":"bg-teal-500"}`})]})}const kE=({initialName:n,onNameChange:e,team:t})=>{const r=U.useRef(null);U.useEffect(()=>{r.current&&r.current.textContent!==n&&(r.current.textContent=n)},[n]);const s=a=>{e(a.currentTarget.textContent||"")};return I.jsx("div",{className:`text-2xl font-bold uppercase tracking-wider mb-1 p-1 rounded-md outline-none transition-all duration-200 bg-black/20 border border-white/10 hover:bg-black/30 hover:border-white/20 focus:bg-black/40 focus:shadow-[0_0_0_1px_var(--light-blue)] focus:border-light-blue ${t==="A"?"text-order shadow-[0_0_5px_rgba(0,204,255,0.5)]":"text-chaos shadow-[0_0_5px_rgba(255,51,102,0.5)]"}`,contentEditable:"true",suppressContentEditableWarning:!0,spellCheck:"false",ref:r,onInput:s})},KM=({teamAName:n,teamBName:e,onTeamANameChange:t,onTeamBNameChange:r,teamAColor:s,teamBColor:a,mode:u,setMode:h})=>{const{handleUndo:f,handleClear:p,currentTeam:y,phase:v,draftId:E,handleReset:S,handleLeave:R,initialState:N,picks:O,bans:V}=Ai(),K=mr(),G=!!E,J=()=>{let D;if(G&&N){const A=[],k=[];Object.entries(N.picks).forEach(([x,De])=>{const Ke=N.pickOrder[parseInt(x,10)];Ke?.team==="teamA"?A.push(De):Ke?.team==="teamB"&&k.push(De)});const b={...N.teamA.players,...N.teamB.players},L=A.reduce((x,De,Ke)=>{const Oe=`final-A-${Ke}`;return x[Oe]={uid:Oe,displayName:b[De.uid]?.displayName||"Unknown Player",pick:De.character},x},{}),j=k.reduce((x,De,Ke)=>{const Oe=`final-B-${Ke}`;return x[Oe]={uid:Oe,displayName:b[De.uid]?.displayName||"Unknown Player",pick:De.character},x},{});D={...N,teamA:{...N.teamA,players:L},teamB:{...N.teamB,players:j}}}else{const A=O.A.map((b,L)=>({uid:`local-A-${L}`,displayName:`Player ${L+1}`,pick:b?b.name:"N/A"})),k=O.B.map((b,L)=>({uid:`local-B-${L}`,displayName:`Player ${L+6}`,pick:b?b.name:"N/A"}));D={teamA:{name:n,players:A.reduce((b,L)=>({...b,[L.uid]:L}),{})},teamB:{name:e,players:k.reduce((b,L)=>({...b,[L.uid]:L}),{})},bans:{A:V.A.map(b=>b?b.name:null).filter(Boolean),B:V.B.map(b=>b?b.name:null).filter(Boolean)},status:"complete",pickOrder:[],currentPickIndex:0}}K("/final-teams",{state:{draft:D}})},ne=async()=>{R&&await R(),K("/")},se=()=>{if(G&&N){const{status:D,pickOrder:A,currentPickIndex:k,teamA:b,teamB:L}=N;if(D==="complete")return I.jsx("span",{children:"DRAFT COMPLETE"});if(D==="lobby")return I.jsx("span",{children:"DRAFT LOBBY"});const j=A[k];if(!j)return I.jsx("span",{children:"Waiting..."});let x=0;if(D==="picking"){const ie=A[k].team;for(let ce=k;ce<A.length&&(A[ce].team===ie&&A[ce].type==="pick");ce++)x++}if(x>1){const ie=j.team==="teamA"?n:e,ce=j.team==="teamA"?s:a;return I.jsxs(I.Fragment,{children:[I.jsx("span",{style:{color:ce},children:ie.toUpperCase()}),I.jsxs("span",{children:[" TO PICK (",x,")"]})]})}const Ke=(j.team==="teamA"?b:L).players[j.uid],Oe=j.team==="teamA"?s:a,xe=D==="banning"?"BAN":"PICK";return I.jsxs(I.Fragment,{children:[I.jsx("span",{style:{color:Oe},children:Ke.displayName.toUpperCase()}),I.jsx("span",{children:" TO "}),I.jsx("span",{className:xe==="BAN"?"text-red-500":"text-teal-400",children:xe})]})}return u==="freedom"?I.jsx("span",{children:"Free Mode - Drag any god to any position"}):I.jsxs(I.Fragment,{children:["Current Phase -"," ",I.jsx("span",{className:`turn-text ${y==="A"?"text-teal-400":"text-red-500"}`,style:{color:y==="A"?s:a},children:y==="A"?`${n.toUpperCase()}`:`${e.toUpperCase()}`})," ","-"," ",I.jsx("span",{className:`phase-text ${v==="BAN"?"text-red-500 shadow-[0_0_5px_rgba(255,51,51,0.5)] font-bold":"text-teal-400 font-bold"}`,children:v})]})};return I.jsxs("div",{className:"flex justify-center items-center py-2.5 px-5 bg-black/50 border-b border-light-blue shadow-[0_2px_10px_rgba(0,204,255,0.3)] relative z-20 flex-wrap gap-[30px]",children:[I.jsxs("div",{className:"flex flex-col items-center w-1/6",children:[I.jsx(kE,{initialName:n,onNameChange:t,team:"A"}),I.jsx("div",{className:"text-sm font-bold uppercase tracking-wider text-order",children:"1ST PICK"})]}),!G&&I.jsx(qM,{mode:u,onModeChange:h}),I.jsxs("div",{className:"flex justify-center items-center w-auto mx-auto relative z-10 gap-4",children:[G?I.jsxs(I.Fragment,{children:[I.jsx("button",{className:"bg-gray-700 text-white border border-gray-500 rounded-full py-2 px-5 text-base font-bold cursor-pointer transition-colors duration-200 hover:bg-gray-500 hover:border-gray-400",onClick:ne,children:"LEAVE"}),I.jsx("button",{className:"bg-red-700 text-white border border-red-500 rounded-full py-2 px-5 text-base font-bold cursor-pointer transition-colors duration-200 hover:bg-red-500 hover:border-red-400",onClick:S,children:"RESET"})]}):I.jsxs(I.Fragment,{children:[I.jsx("button",{className:"bg-gray-700 text-white border border-gray-500 rounded-full py-2 px-5 text-base font-bold cursor-pointer transition-colors duration-200 hover:bg-gray-500 hover:border-gray-400",onClick:f,children:"UNDO"}),I.jsx("button",{className:"bg-red-700 text-white border border-red-500 rounded-full py-2 px-5 text-base font-bold cursor-pointer transition-colors duration-200 hover:bg-red-500 hover:border-red-400",onClick:p,children:"CLEAR"})]}),I.jsx("button",{className:"bg-blue-700 text-white border border-blue-500 rounded-full py-2 px-5 text-base font-bold cursor-pointer transition-colors duration-200 hover:bg-blue-500 hover:border-blue-400",onClick:J,children:"FINAL TEAMS"})]}),I.jsx("div",{className:"bg-black/70 p-4 rounded-full text-center border border-light-blue shadow-border-glow text-2xl flex justify-center items-center min-w-[300px]",children:se()}),I.jsxs("div",{className:"flex flex-col items-center w-1/6",children:[I.jsx(kE,{initialName:e,onNameChange:r,team:"B"}),I.jsx("div",{className:"text-sm font-bold uppercase tracking-wider text-chaos",children:"2ND PICK"})]})]})},ll=n=>n.image,xd=[{name:"All",classes:"bg-gray-600 text-white",borderColor:"border-transparent",textColor:"text-gold"},{name:"Jungle",classes:"bg-jungle text-black",borderColor:"border-jungle",textColor:"text-jungle"},{name:"Support",classes:"bg-support text-white",borderColor:"border-support",textColor:"text-support"},{name:"Carry",classes:"bg-carry text-white",borderColor:"border-carry",textColor:"text-carry"},{name:"Mid",classes:"bg-mid text-white",borderColor:"border-mid",textColor:"text-mid"},{name:"Solo",classes:"bg-solo text-white",borderColor:"border-solo",textColor:"text-solo"}],QM=n=>{const e=xd.find(t=>t.name===n);return e?e.borderColor:"border-transparent"},YM=n=>{const e=xd.find(t=>t.name===n);return e?e.textColor:"text-gold"};function JM(){const{characters:n,initialState:e,picks:t,bans:r,handleCharacterSelect:s,handleDragStart:a,isMyTurn:u}=Ai(),[h,f]=U.useState("All"),p=S=>{if(e){const V=[...e.bans?.A||[],...e.bans?.B||[]],K=Object.values(e.picks||{}).map(J=>J.character);return!(V.includes(S.name)||K.includes(S.name))}const R=[...r?.A||[],...r?.B||[]].filter(Boolean).map(V=>V.name),N=[...t?.A||[],...t?.B||[]].filter(Boolean).map(V=>V.name);return!(R.includes(S.name)||N.includes(S.name))},y=n.filter(S=>h==null?!1:h==="All"?!0:S.roles.includes(h)),v=h==="All"?[...y].sort((S,R)=>S.name.localeCompare(R.name)):y,E=S=>{const R=u===void 0?!0:u;return p(S)&&R};return I.jsxs("div",{className:"flex-1 overflow-y-auto p-4 scroll-pt-2.5 scrollbar-custom",children:[I.jsx("div",{className:"flex justify-around mb-5",children:I.jsx("div",{className:"flex justify-center gap-2.5 md:flex-wrap",children:xd.map(S=>{const R=xd.find(O=>O.name===S.name),N=h===S.name;return I.jsx("button",{className:`py-2 px-4 rounded-md cursor-pointer transition-all duration-200 border-2 ${N?`${R?.classes} text-white shadow-[0_0_10px_var(--${S.name.toLowerCase()}-color)]`:`bg-gray-800/50 ${R?.borderColor} ${R?.textColor} hover:bg-gray-700/70`}`,onClick:()=>f(h===S.name?null:S.name),children:S.name},S.name)})})}),I.jsx("div",{className:"grid grid-cols-[repeat(auto-fill,minmax(120px,1fr))] gap-4 p-4 justify-center",children:v.map(S=>{const R=h==="All"?S.roles[0]:h||S.roles[0],N=E(S),O=p(S);return I.jsxs("div",{className:`bg-gray-700 rounded-md overflow-hidden transition-transform duration-200 flex flex-col border-3 ${QM(R)} ${O?"":"opacity-30 cursor-not-allowed"} ${N?"cursor-pointer hover:transform hover:-translate-y-px hover:scale-105":"cursor-not-allowed grayscale"}`,onClick:()=>N&&s(S),draggable:N,onDragStart:V=>N&&a(V,S),children:[I.jsx("img",{src:ll(S),alt:S.name}),I.jsxs("div",{className:"p-2 text-center bg-black/80 flex flex-col justify-center gap-0.5 flex-grow min-h-[3.5em]",children:[I.jsx("div",{className:"font-bold text-sm text-white leading-tight overflow-hidden",children:S.name}),I.jsx("div",{className:`text-xs ${YM(R)}`,children:R})]})]},S.id)})})]})}const XM=({bansA:n,bansB:e})=>{const{mode:t,handleDragOver:r,handleDragLeave:s,handleDrop:a,handleStandardDrop:u}=Ai(),h=(f,p)=>I.jsx("div",{className:`flex gap-2.5 ${f==="A"?"justify-start":"justify-end"}`,children:p.map((y,v)=>I.jsx("div",{className:"w-20 h-28 bg-black/50 border-2 border-red-500 rounded-md flex items-center justify-center",onDragOver:r,onDragLeave:s,onDrop:E=>t==="freedom"?a(E,f,"ban",v):u(E,f,"ban",v),children:y&&I.jsx("img",{src:ll(y),alt:y.name,className:"w-full h-full object-cover"})},v))});return I.jsxs("div",{className:"flex justify-between items-center p-4 bg-black/30 rounded-md mb-4",children:[h("A",n),I.jsx("div",{className:"text-2xl font-bold text-red-500",children:"BANS"}),h("B",e)]})},RE=({team:n})=>{const{initialState:e}=Ai();if(!e)return I.jsx("div",{className:"w-1/5",children:"Loading Team..."});const t=n==="A"?"teamA":"teamB",r=e[t],s=n==="A"?"border-order":"border-chaos";if(!r)return I.jsx("div",{className:"w-1/5",children:"Loading Team Data..."});const a=r.captain,u=e.pickOrder.map((v,E)=>({...v,originalIndex:E})).filter(v=>v.type==="pick"&&v.team===t).map(v=>v.originalIndex);for(;u.length<5;)u.push(-1);const{pickOrder:h,currentPickIndex:f,status:p}=e;let y=[];if(p==="picking"&&f<h.length){const v=h[f].team;if(t===v)for(let E=f;E<h.length&&(h[E].team===v&&h[E].type==="pick");E++)y.push(E)}else p==="banning"&&h[f]?.team===t&&y.push(f);return I.jsx("div",{className:"flex flex-col w-1/5 gap-2 py-2",children:u.map((v,E)=>{if(v===-1)return I.jsx("div",{className:`border-2 rounded-md h-full bg-black/30 ${s}`},`empty-${E}`);const S=e.pickOrder[v].uid,R=r.players[S],N=e.picks?.[v],O=N?Va.find(J=>J.name===N.character):null,V=O?{name:O.name,image:ll(O)}:null,K=R?.uid===a,G=y.includes(v)&&!N;return I.jsxs("div",{className:`border-2 rounded-md flex flex-col h-full justify-between overflow-hidden bg-black/30 relative ${s} ${G?"shadow-[0_0_15px_5px_#ffdf00]":""}`,children:[I.jsxs("div",{className:"text-center p-1 bg-black/50 flex justify-between items-center",children:[I.jsx("p",{className:"font-bold text-white truncate",children:R?.displayName||"Empty Slot"}),K&&I.jsx("p",{className:"text-xs text-yellow-400",children:"Captain"})]}),I.jsx("div",{className:"flex-grow flex items-center justify-center",children:V?I.jsx("img",{src:V.image,alt:V.name,className:"w-full h-full object-cover transform -translate-y-40"}):I.jsx("div",{className:"text-4xl text-gray-500",children:"?"})}),V&&I.jsx("div",{className:"text-white text-lg bg-black/70 absolute bottom-0 left-0 right-0 text-center p-1",children:V.name})]},v)})})},xE=({team:n,picks:e})=>{const{currentTeam:t,phase:r}=Ai(),s=n==="A"?"border-order":"border-chaos",a=n==="A"?[0,3,4,7,8]:[1,2,5,6,9];return I.jsx("div",{className:"flex flex-col w-1/5 gap-2 py-2",children:Array.from({length:5}).map((u,h)=>{const f=e[h],p=a[h],v=r==="PICK"&&t===n&&p===0&&!f;return I.jsxs("div",{className:`border-2 rounded-md flex flex-col h-full justify-between overflow-hidden bg-black/30 relative ${s} ${v?"shadow-[0_0_15px_5px_#ffdf00]":""}`,children:[I.jsx("div",{className:"text-center p-1 bg-black/50",children:I.jsxs("p",{className:"font-bold text-white",children:[n==="A"?"Order":"Chaos"," Pick ",h+1]})}),I.jsx("div",{className:"flex-grow flex items-center justify-center",children:f?I.jsx("img",{src:ll(f),alt:f.name,className:"w-full h-full object-cover transform -translate-y-40"}):I.jsx("div",{className:"text-4xl text-gray-500",children:"?"})}),f&&I.jsx("div",{className:"text-white text-lg bg-black/70 absolute bottom-0 left-0 right-0 text-center p-1",children:f.name})]},h)})})},ZM=()=>{const{draftId:n,currentUser:e}=Ai(),[t,r]=U.useState([]);U.useEffect(()=>{if(!n||!e)return;const a=ka(so(He,"drafts",n,"tradeRequests"),ci("to","==",e.uid),ci("status","==","pending")),u=go(a,h=>{r(h.docs.map(f=>({id:f.id,...f.data()})))});return()=>u()},[n,e]);const s=async(a,u)=>{if(!n)return;const h=t.find(y=>y.id===a);if(!h)return;const f=u_(He),p=wt(He,"drafts",n,"tradeRequests",a);if(u){const y=wt(He,"drafts",n),v=`teamA.players.${h.from}.pick`,E=`teamA.players.${h.to}.pick`;f.update(y,{[v]:h.toPick,[E]:h.fromPick}),f.update(p,{status:"accepted"})}else f.update(p,{status:"declined"});await f.commit()};return t.length===0?null:I.jsxs("div",{className:"absolute top-20 right-10 bg-gray-800 p-4 rounded-lg shadow-lg z-50",children:[I.jsx("h3",{className:"text-lg font-bold mb-2",children:"Incoming Trade Requests"}),t.map(a=>I.jsxs("div",{className:"p-2 border-b border-gray-700",children:[I.jsxs("p",{children:["From: ",a.fromName]}),I.jsxs("p",{children:["Your Pick: ",a.toPick]}),I.jsxs("p",{children:["Their Pick: ",a.fromPick]}),I.jsxs("div",{className:"flex gap-2 mt-2",children:[I.jsx("button",{onClick:()=>s(a.id,!0),className:"bg-green-600 hover:bg-green-700 text-white font-bold py-1 px-2 rounded",children:"Accept"}),I.jsx("button",{onClick:()=>s(a.id,!1),className:"bg-red-600 hover:bg-red-700 text-white font-bold py-1 px-2 rounded",children:"Decline"})]})]},a.id))]})},HS=({teamAName:n,onTeamANameChange:e,teamBName:t,onTeamBNameChange:r,teamAColor:s,teamBColor:a,mode:u,setMode:h})=>{const{bans:f,picks:p,draftId:y}=Ai(),{unlockAudio:v}=gf(),E=!!y;return U.useEffect(()=>{const S=()=>{v(),window.removeEventListener("click",S)};return window.addEventListener("click",S),()=>{window.removeEventListener("click",S)}},[v]),I.jsxs("div",{className:`bg-gradient-to-b from-dark-blue to-medium-blue text-white font-sans overflow-hidden flex flex-col h-screen ${u}`,children:[I.jsx(GM,{}),I.jsx(ZM,{}),I.jsx(KM,{teamAName:n,onTeamANameChange:e,teamBName:t,onTeamBNameChange:r,teamAColor:s,teamBColor:a,mode:u,setMode:h}),I.jsxs("div",{className:"flex overflow-y-auto px-4 gap-4 h-full w-full relative",children:[E?I.jsx(RE,{team:"A"}):I.jsx(xE,{team:"A",picks:p.A}),I.jsxs("div",{className:"flex-1 flex flex-col",children:[I.jsx(XM,{bansA:f.A,bansB:f.B}),I.jsx("div",{className:"flex-1 bg-black/30 rounded-md overflow-y-auto flex flex-col border-2 border-light-blue shadow-[0_0_10px_rgba(0,204,255,0.3)] p-2.5 lg:p-4",children:I.jsx(JM,{})})]}),E?I.jsx(RE,{team:"B"}):I.jsx(xE,{team:"B",picks:p.B})]})]})},F_=()=>{const[n]=zd(zr),[e,t]=U.useState([]),[r,s]=U.useState([]),[a,u]=U.useState(!0),[h,f]=U.useState(null),p=U.useCallback(N=>{const O=ka(so(He,"friends"),ci("members","array-contains",N.uid));return go(O,async V=>{if(u(!0),V.empty){t([]),u(!1);return}const K=V.docs.map(G=>G.data().members).flat().filter(G=>G!==N.uid);if(K.length>0){const G=ka(so(He,"users"),ci("uid","in",K)),ne=(await F0(G)).docs.map(se=>({id:se.id,...se.data()}));t(ne)}else t([]);u(!1)},()=>{f("Failed to fetch friends."),u(!1)})},[]),y=U.useCallback(N=>{const O=so(He,"friendRequests"),V=ka(O,ci("recipientId","==",N.uid),ci("status","==","pending"));return go(V,K=>{s(K.docs.map(G=>({id:G.id,...G.data()})))},()=>f("Failed to fetch friend requests."))},[]);return U.useEffect(()=>{if(n){const N=p(n),O=y(n);return()=>{N(),O()}}else t([]),s([]),u(!1)},[n,p,y]),{friends:e,incomingRequests:r,sendFriendRequest:async N=>{if(!n)return f("You must be logged in.");if(n.uid===N)return f("You can't send a request to yourself.");f(null);try{if((await F0(ka(so(He,"users"),ci("uid","==",N)))).empty)return f("User not found.");const K=[n.uid,N].sort().join("_"),G=wt(He,"friendRequests",K);await kC(G,{id:K,senderId:n.uid,senderEmail:n.email,recipientId:N,status:"pending",createdAt:uo()})}catch{f("Failed to send friend request.")}},acceptFriendRequest:async(N,O)=>{if(n)try{const V=u_(He),K=[n.uid,O].sort().join("_"),G=wt(He,"friends",K);V.set(G,{members:[n.uid,O],createdAt:uo()});const J=wt(He,"friendRequests",N);V.delete(J),await V.commit()}catch(V){console.error("Error accepting friend request:",V),f("Failed to accept friend request.")}},declineFriendRequest:async N=>{try{await j0(wt(He,"friendRequests",N))}catch{f("Failed to decline friend request.")}},removeFriend:async N=>{if(!n)return f("You must be logged in.");try{const O=[n.uid,N].sort().join("_"),V=wt(He,"friends",O);await j0(V)}catch{f("Failed to remove friend.")}},loading:a,error:h}},eV=n=>{const e=n.indexOf("@");if(e<=3)return n;const t=n.substring(0,3),r=n.substring(e);return`${t}***${r}`},tV=({sendFriendRequest:n,error:e})=>{const[t,r]=U.useState(""),s=a=>{a.preventDefault(),t.trim()&&(n(t.trim()),r(""))};return I.jsxs("form",{onSubmit:s,className:"flex flex-col gap-2 mt-4",children:[I.jsx("input",{type:"text",value:t,onChange:a=>r(a.target.value),placeholder:"Enter friend's Player ID to send request",className:"p-2 rounded bg-gray-700 text-white border border-gray-600",required:!0}),I.jsx("button",{type:"submit",className:"bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded",children:"Send Friend Request"}),e&&I.jsx("p",{className:"text-red-500 mt-2",children:e})]})},nV=({requests:n,acceptFriendRequest:e,declineFriendRequest:t})=>n.length===0?null:I.jsxs("div",{className:"mt-6 w-full max-w-md",children:[I.jsx("h2",{className:"text-2xl text-gold mb-4",children:"Incoming Requests"}),I.jsx("ul",{className:"bg-gray-900 p-4 rounded",children:n.map(r=>I.jsxs("li",{className:"flex justify-between items-center p-2 border-b border-gray-700",children:[I.jsx("span",{className:"text-white",children:r.senderEmail}),I.jsxs("div",{className:"flex gap-2",children:[I.jsx("button",{onClick:()=>e(r.id,r.senderId),className:"bg-green-600 hover:bg-green-700 text-white font-bold py-1 px-3 rounded",children:"Accept"}),I.jsx("button",{onClick:()=>t(r.id),className:"bg-red-600 hover:bg-red-700 text-white font-bold py-1 px-3 rounded",children:"Decline"})]})]},r.id))})]}),GS=()=>{const{friends:n,incomingRequests:e,sendFriendRequest:t,acceptFriendRequest:r,declineFriendRequest:s,removeFriend:a,loading:u,error:h}=F_();return u?I.jsx("p",{className:"text-white",children:"Loading friends..."}):I.jsxs("div",{className:"mt-6 w-full max-w-md",children:[I.jsx(tV,{sendFriendRequest:t,error:h}),I.jsx(nV,{requests:e,acceptFriendRequest:r,declineFriendRequest:s}),I.jsx("h2",{className:"text-2xl text-gold mb-4 mt-6",children:"Friends List"}),n.length===0?I.jsx("p",{className:"text-gray-400",children:"You have no friends yet. Send a request to add one!"}):I.jsx("ul",{className:"bg-gray-900 p-4 rounded",children:n.map(f=>I.jsxs("li",{className:"flex justify-between items-center p-2 border-b border-gray-700",children:[I.jsx("span",{className:"text-white",children:f.displayName||eV(f.email)}),I.jsx("button",{onClick:()=>a(f.uid),className:"bg-red-600 hover:bg-red-700 text-white font-bold py-1 px-3 rounded",children:"Remove"})]},f.id))})]})},rV=()=>{const[n]=zd(zr),{friends:e}=F_(),[t,r]=U.useState([]),[s,a]=U.useState(!0),[u,h]=U.useState(null);return U.useEffect(()=>{if(!n){r([]),a(!1);return}if(e.length===0){r([]),a(!1);return}a(!0);const f=e.map(E=>E.uid);if(f.length===0){r([]),a(!1);return}const p=so(He,"drafts"),y=ka(p,ci("hostId","in",f),ci("status","!=","archived")),v=go(y,E=>{const S=E.docs.map(R=>({id:R.id,...R.data()})).filter(R=>!R.leftPlayers?.includes(n.uid));r(S),a(!1)},E=>{console.error(E),h("Failed to fetch friend lobbies."),a(!1)});return()=>v()},[n,e]),{friendDrafts:t,loading:s,error:u}};function iV(n){if(!n||!n.seconds)return"just now";const e=new Date,t=new Date(n.seconds*1e3),r=Math.floor((e.getTime()-t.getTime())/1e3);if(r<60)return`${r} seconds ago`;const s=Math.floor(r/60);if(s<60)return`${s} minutes ago`;const a=Math.floor(s/60);return a<24?`${a} hours ago`:`${Math.floor(a/24)} days ago`}const sV=()=>{const{friendDrafts:n,loading:e,error:t}=rV(),{friends:r}=F_(),s=mr();if(e)return I.jsx("p",{className:"text-white",children:"Loading friend lobbies..."});if(t)return I.jsx("p",{className:"text-red-500",children:t});if(n.length===0)return I.jsx("p",{className:"text-gray-400",children:"No active lobbies from your friends."});const a=u=>{const h=r.find(f=>f.uid===u);return h?h.displayName:"A friend"};return I.jsxs("div",{className:"mt-6 w-full max-w-md",children:[I.jsx("h2",{className:"text-2xl text-gold mb-4",children:"Join a Friend's Lobby"}),I.jsx("ul",{className:"bg-gray-900 p-4 rounded",children:n.map(u=>I.jsxs("li",{className:"flex justify-between items-center p-2 border-b border-gray-700",children:[I.jsxs("div",{children:[I.jsx("span",{className:"text-white",children:u.draftName}),I.jsxs("p",{className:"text-gray-400 text-sm",children:["Hosted by ",a(u.hostId)," - ",iV(u.createdAt)]})]}),I.jsx("button",{onClick:()=>s(`/lobby/${u.id}`),className:"bg-green-600 hover:bg-green-700 text-white font-bold py-1 px-3 rounded",children:"Join"})]},u.id))})]})};var qS={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},PE=xr.createContext&&xr.createContext(qS),oV=["attr","size","title"];function aV(n,e){if(n==null)return{};var t=lV(n,e),r,s;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(n);for(s=0;s<a.length;s++)r=a[s],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(n,r)&&(t[r]=n[r])}return t}function lV(n,e){if(n==null)return{};var t={};for(var r in n)if(Object.prototype.hasOwnProperty.call(n,r)){if(e.indexOf(r)>=0)continue;t[r]=n[r]}return t}function Pd(){return Pd=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},Pd.apply(this,arguments)}function bE(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(n,s).enumerable})),t.push.apply(t,r)}return t}function bd(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?bE(Object(t),!0).forEach(function(r){uV(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):bE(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function uV(n,e,t){return e=cV(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function cV(n){var e=hV(n,"string");return typeof e=="symbol"?e:e+""}function hV(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function KS(n){return n&&n.map((e,t)=>xr.createElement(e.tag,bd({key:t},e.attr),KS(e.child)))}function j_(n){return e=>xr.createElement(dV,Pd({attr:bd({},n.attr)},e),KS(n.child))}function dV(n){var e=t=>{var{attr:r,size:s,title:a}=n,u=aV(n,oV),h=s||t.size||"1em",f;return t.className&&(f=t.className),n.className&&(f=(f?f+" ":"")+n.className),xr.createElement("svg",Pd({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,r,u,{className:f,style:bd(bd({color:n.color||t.color},t.style),n.style),height:h,width:h,xmlns:"http://www.w3.org/2000/svg"}),a&&xr.createElement("title",null,a),n.children)};return PE!==void 0?xr.createElement(PE.Consumer,null,t=>e(t)):e(qS)}function fV(n){return j_({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M416 208H272V64c0-17.67-14.33-32-32-32h-32c-17.67 0-32 14.33-32 32v144H32c-17.67 0-32 14.33-32 32v32c0 17.67 14.33 32 32 32h144v144c0 17.67 14.33 32 32 32h32c17.67 0 32-14.33 32-32V304h144c17.67 0 32-14.33 32-32v-32c0-17.67-14.33-32-32-32z"},child:[]}]})(n)}function pV(n){return j_({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M224 256c70.7 0 128-57.3 128-128S294.7 0 224 0 96 57.3 96 128s57.3 128 128 128zm89.6 32h-16.7c-22.2 10.2-46.9 16-72.9 16s-50.6-5.8-72.9-16h-16.7C60.2 288 0 348.2 0 422.4V464c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48v-41.6c0-74.2-60.2-134.4-134.4-134.4z"},child:[]}]})(n)}function mV(n){return j_({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M96 224c35.3 0 64-28.7 64-64s-28.7-64-64-64-64 28.7-64 64 28.7 64 64 64zm448 0c35.3 0 64-28.7 64-64s-28.7-64-64-64-64 28.7-64 64 28.7 64 64 64zm32 32h-64c-17.6 0-33.5 7.1-45.1 18.6 40.3 22.1 68.9 62 75.1 109.4h66c17.7 0 32-14.3 32-32v-32c0-35.3-28.7-64-64-64zm-256 0c61.9 0 112-50.1 112-112S381.9 32 320 32 208 82.1 208 144s50.1 112 112 112zm76.8 32h-8.3c-20.8 10-43.9 16-68.5 16s-47.6-6-68.5-16h-8.3C179.6 288 128 339.6 128 403.2V432c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48v-28.8c0-63.6-51.6-115.2-115.2-115.2zm-223.7-13.4C161.5 263.1 145.6 256 128 256H64c-35.3 0-64 28.7-64 64v32c0 17.7 14.3 32 32 32h65.9c6.3-47.4 34.9-87.3 75.2-109.4z"},child:[]}]})(n)}const gV=()=>{const n=mr(),{user:e,userProfile:t}=hc(),{theme:r}=US(),a={light:{bg:"bg-gray-100",text:"text-gray-800",cardBg:"bg-white/80",cardBorder:"border-gray-200",buttonText:"text-white",headerText:"text-blue-600",subHeaderText:"text-gray-600",footerBg:"bg-gray-200/80",footerBorder:"border-gray-300",backgroundImage:"url(/AI_Jing_Wei_Light_Theme.png)"},dark:{bg:"bg-[#121a23]",text:"text-white",cardBg:"bg-[#1a2430]/70",cardBorder:"border-gray-700",buttonText:"text-white",headerText:"text-yellow-400",subHeaderText:"text-gray-400",footerBg:"bg-[#1a2430]/70",footerBorder:"border-gray-700",backgroundImage:"url(/AI_Jing_Wei_Dark_Theme.png)"}}[r],u=async()=>{if(!e||!t){alert("You must be logged in and have a profile to create an online draft.");return}if(!t.displayName){alert("Please set a display name in your profile before creating a draft."),n("/profile");return}const h=prompt("Enter a name for your draft lobby:",`${t.displayName}'s Draft`);if(h)try{const f={draftName:h,status:"lobby",pickOrder:[],currentPickIndex:0,teamA:{name:"Team A",captain:null,players:{}},teamB:{name:"Team B",captain:null,players:{}},bans:{A:[],B:[]},picks:{A:[],B:[]},availableGods:Va.map(y=>y.name),createdAt:uo(),hostId:e.uid},p=await BD(so(He,"drafts"),f);n(`/lobby/${p.id}`)}catch(f){console.error("Error creating online draft: ",f),alert("Failed to create online draft. Please try again.")}};return I.jsxs("div",{className:`${a.bg} min-h-screen ${a.text} font-sans`,style:{backgroundImage:a.backgroundImage},children:[I.jsxs("div",{className:"container mx-auto px-4 py-8 relative",children:[I.jsx("div",{className:"absolute top-4 right-4",children:e&&t?I.jsx(WS,{user:e,userProfile:t}):I.jsx("button",{onClick:()=>n("/login"),className:"bg-gray-600 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded",children:"Login"})}),I.jsxs("div",{className:"text-center mb-12",children:[I.jsx("h1",{className:`text-5xl font-bold ${a.headerText} tracking-wider`,children:"SMITE 2 PICK/BAN SIMULATOR"}),I.jsx("p",{className:"text-red-500 font-semibold mt-2",children:"BETA - NOT FINAL"}),I.jsx("p",{className:`${a.subHeaderText} mt-4 max-w-2xl mx-auto`,children:"Practice your draft strategies for SMITE 2. Create custom drafts, invite friends, and perfect your team compositions."})]}),I.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 mb-12",children:[I.jsxs("div",{className:`${a.cardBg} p-6 rounded-lg border ${a.cardBorder}`,children:[I.jsxs("div",{className:"flex justify-between items-center mb-4",children:[I.jsx("h2",{className:"text-2xl font-bold",children:"Single Player Draft"}),I.jsx("span",{className:"text-xs font-semibold bg-gray-600 px-2 py-1 rounded",children:"PRACTICE"})]}),I.jsx("p",{className:`${a.subHeaderText} mb-6`,children:"Practice draft strategies on your own. Control both teams and experiment with different picks and bans."}),I.jsxs("button",{onClick:()=>n("/local"),className:`w-full bg-blue-600 hover:bg-blue-700 ${a.buttonText} font-bold py-3 px-4 rounded-lg flex items-center justify-center`,children:[I.jsx(pV,{className:"mr-2"})," 1-Player Draft"]})]}),I.jsxs("div",{className:`${a.cardBg} p-6 rounded-lg border ${a.cardBorder}`,children:[I.jsxs("div",{className:"flex justify-between items-center mb-4",children:[I.jsx("h2",{className:"text-2xl font-bold",children:"Multiplayer Draft"}),I.jsx("span",{className:"text-xs font-semibold bg-gray-600 px-2 py-1 rounded",children:"WITH FRIENDS"})]}),I.jsx("p",{className:`${a.subHeaderText} mb-6`,children:"Create a draft lobby and invite friends to join. Perfect for team practice or competitive preparation."}),I.jsxs("button",{onClick:u,className:`w-full bg-green-600 hover:bg-green-700 ${a.buttonText} font-bold py-3 px-4 rounded-lg flex items-center justify-center`,children:[I.jsx(mV,{className:"mr-2"})," 2-Player Draft"]})]})]}),I.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 mb-12",children:[I.jsxs("div",{children:[I.jsx("h2",{className:`text-3xl font-bold ${a.headerText} mb-4`,children:"Join a Friend's Draft"}),I.jsx("div",{className:`${a.cardBg} p-6 rounded-lg border ${a.cardBorder}`,children:I.jsx(sV,{})})]}),I.jsxs("div",{children:[I.jsxs("div",{className:"flex justify-between items-center mb-4",children:[I.jsx("h2",{className:`text-3xl font-bold ${a.headerText}`,children:"Friends List"}),I.jsxs("button",{className:`${a.subHeaderText} hover:text-white flex items-center`,children:[I.jsx(fV,{className:"mr-2"})," Add"]})]}),I.jsx("div",{className:`${a.cardBg} p-6 rounded-lg border ${a.cardBorder}`,children:I.jsx(GS,{})})]})]})]}),I.jsx("footer",{className:`${a.footerBg} border-t ${a.footerBorder} mt-12 py-6`,children:I.jsx("div",{className:"container mx-auto px-4 flex justify-between items-center",children:I.jsxs("div",{children:[I.jsx("h3",{className:`font-bold ${a.headerText}`,children:"SMITE 2 DRAFT SIMULATOR"}),I.jsx("p",{className:"text-xs text-gray-500",children:"© 2023 All Rights Reserved"})]})})})]})},_V=({player:n,teamColor:e})=>I.jsxs("div",{className:"text-center",children:[I.jsx("img",{src:ll(n.pick),alt:n.pick.name,className:"w-40 h-40 rounded-full object-cover border-8",style:{borderColor:e}}),I.jsx("p",{className:"text-2xl font-semibold mt-3",children:n.pick.name}),I.jsx("p",{className:"text-xl text-gray-400",children:n.displayName})]}),NE=({teamName:n,teamColor:e,players:t,bans:r})=>I.jsxs("div",{className:"w-full p-8",children:[I.jsx("h2",{className:"text-5xl font-bold mb-10 text-center",style:{color:e},children:n}),I.jsxs("div",{className:"mb-12",children:[I.jsx("h3",{className:"text-3xl font-semibold mb-8 text-center",children:"BANS"}),I.jsx("div",{className:"flex flex-wrap gap-8 justify-center",children:r.length>0?r.map(s=>I.jsxs("div",{className:"text-center",children:[I.jsx("img",{src:ll(s),alt:s.name,className:"w-24 h-24 rounded-md object-cover grayscale"}),I.jsx("p",{className:"text-lg",children:s.name})]},s.name)):I.jsx("p",{children:"No bans."})})]}),I.jsxs("div",{children:[I.jsx("h3",{className:"text-3xl font-semibold mb-8 text-center",children:"PICKS"}),I.jsx("div",{className:"flex flex-wrap gap-8 justify-center",children:t.length>0?t.map(s=>I.jsx(_V,{player:s,teamColor:e},s.uid)):I.jsx("p",{children:"No picks."})})]})]}),yV=()=>{const{initialState:n,characters:e}=Ai();if(!n)return I.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-900 text-white",children:"Loading Final Teams Data..."});const{teamA:t,teamB:r,bans:s}=n;if(!t||!r||!s)return I.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-900 text-white",children:"Error: Incomplete draft data."});const a=y=>e.find(v=>v.name===y),u=Object.entries(t.players).map(([y,v])=>({uid:y,displayName:v.displayName,pick:a(v.pick)})).filter(y=>y.pick),h=Object.entries(r.players).map(([y,v])=>({uid:y,displayName:v.displayName,pick:a(v.pick)})).filter(y=>y.pick),f=s.A.map(a).filter(Boolean),p=s.B.map(a).filter(Boolean);return I.jsxs("div",{className:"flex flex-col items-center justify-center min-h-screen bg-gray-900 text-white p-8",children:[I.jsx("h1",{className:"text-7xl font-bold mb-16",children:"Final Rosters"}),I.jsxs("div",{className:"flex w-full max-w-screen-2xl bg-gray-800 rounded-lg shadow-lg p-12",children:[I.jsx("div",{className:"w-1/2 pr-6",children:I.jsx(NE,{teamName:t.name||"Team A",teamColor:"#1abc9c",players:u,bans:f})}),I.jsx("div",{className:"border-l-4 border-gray-600 mx-6"}),I.jsx("div",{className:"w-1/2 pl-6",children:I.jsx(NE,{teamName:r.name||"Team B",teamColor:"#ff6666",players:h,bans:p})})]})]})},QS=()=>{const[n,e]=U.useState(null),[t,r]=U.useState(!0);return U.useEffect(()=>{const s=Cg(zr,a=>{e(a),r(!1)});return()=>s()},[]),{user:n,loading:t}},vV=()=>{const{draftId:n}=Ai(),{user:e}=QS(),{setViewingFinalTeams:t}=zS(e?.uid,n);return U.useEffect(()=>{t()},[t]),I.jsx(yV,{})},wV=()=>{const e=Ts().state?.draft,{user:t}=QS();return I.jsx(M_,{children:I.jsx(V_,{mode:"standard",initialState:e,draftId:e?.id,currentUser:t,teamAName:e?.teamA?.name||"ORDER",teamBName:e?.teamB?.name||"CHAOS",teamAColor:"#1abc9c",teamBColor:"#ff6666",children:I.jsx(vV,{})})})},EV=()=>{const n=mr(),[e,t]=U.useState(""),[r,s]=U.useState(""),[a,u]=U.useState(null),h=async f=>{f.preventDefault(),u(null);try{await pP(zr,e,r),n("/")}catch(p){u(p.message)}};return I.jsx("div",{className:"flex flex-col items-center justify-center h-screen bg-gray-800 text-white",children:I.jsxs("div",{className:"w-full max-w-md p-8 space-y-6 bg-gray-900 rounded-lg shadow-lg",children:[I.jsx("h1",{className:"text-2xl font-bold text-center text-gold",children:"Login"}),I.jsxs("form",{onSubmit:h,className:"space-y-6",children:[I.jsxs("div",{children:[I.jsx("label",{className:"block mb-2 text-sm font-bold text-gray-400",children:"Email"}),I.jsx("input",{type:"email",value:e,onChange:f=>t(f.target.value),className:"w-full px-4 py-2 text-gray-900 bg-gray-200 rounded-md focus:outline-none focus:ring-2 focus:ring-gold",required:!0})]}),I.jsxs("div",{children:[I.jsx("label",{className:"block mb-2 text-sm font-bold text-gray-400",children:"Password"}),I.jsx("input",{type:"password",value:r,onChange:f=>s(f.target.value),className:"w-full px-4 py-2 text-gray-900 bg-gray-200 rounded-md focus:outline-none focus:ring-2 focus:ring-gold",required:!0})]}),a&&I.jsx("p",{className:"text-red-500 text-xs italic",children:a}),I.jsx("button",{type:"submit",className:"w-full py-2 px-4 font-bold text-white bg-blue-600 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-900 focus:ring-blue-500",children:"Login"})]}),I.jsxs("p",{className:"text-sm text-center text-gray-400",children:["Don't have an account?"," ",I.jsx(Od,{to:"/signup",className:"font-bold text-gold hover:underline",children:"Sign Up"})]})]})})},TV=()=>{const n=mr(),[e,t]=U.useState(""),[r,s]=U.useState(""),[a,u]=U.useState(""),[h,f]=U.useState(""),[p,y]=U.useState(null),v=async E=>{if(E.preventDefault(),!e.trim()){y("Display name is required.");return}if(a!==h){y("Passwords do not match.");return}y(null);try{const R=(await fP(zr,r,a)).user;await kC(wt(He,"users",R.uid),{uid:R.uid,email:R.email,displayName:e.trim(),friends:[],createdAt:uo()}),n("/")}catch(S){y(S.message)}};return I.jsx("div",{className:"flex flex-col items-center justify-center h-screen bg-gray-800 text-white",children:I.jsxs("div",{className:"w-full max-w-md p-8 space-y-6 bg-gray-900 rounded-lg shadow-lg",children:[I.jsx("h1",{className:"text-2xl font-bold text-center text-gold",children:"Create Account"}),I.jsxs("form",{onSubmit:v,className:"space-y-6",children:[I.jsxs("div",{children:[I.jsx("label",{className:"block mb-2 text-sm font-bold text-gray-400",children:"Display Name"}),I.jsx("input",{type:"text",value:e,onChange:E=>t(E.target.value),className:"w-full px-4 py-2 text-gray-900 bg-gray-200 rounded-md focus:outline-none focus:ring-2 focus:ring-gold",required:!0})]}),I.jsxs("div",{children:[I.jsx("label",{className:"block mb-2 text-sm font-bold text-gray-400",children:"Email"}),I.jsx("input",{type:"email",value:r,onChange:E=>s(E.target.value),className:"w-full px-4 py-2 text-gray-900 bg-gray-200 rounded-md focus:outline-none focus:ring-2 focus:ring-gold",required:!0})]}),I.jsxs("div",{children:[I.jsx("label",{className:"block mb-2 text-sm font-bold text-gray-400",children:"Password"}),I.jsx("input",{type:"password",value:a,onChange:E=>u(E.target.value),className:"w-full px-4 py-2 text-gray-900 bg-gray-200 rounded-md focus:outline-none focus:ring-2 focus:ring-gold",required:!0})]}),I.jsxs("div",{children:[I.jsx("label",{className:"block mb-2 text-sm font-bold text-gray-400",children:"Confirm Password"}),I.jsx("input",{type:"password",value:h,onChange:E=>f(E.target.value),className:"w-full px-4 py-2 text-gray-900 bg-gray-200 rounded-md focus:outline-none focus:ring-2 focus:ring-gold",required:!0})]}),p&&I.jsx("p",{className:"text-red-500 text-xs italic",children:p}),I.jsx("button",{type:"submit",className:"w-full py-2 px-4 font-bold text-white bg-green-600 rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-900 focus:ring-green-500",children:"Sign Up"})]}),I.jsxs("p",{className:"text-sm text-center text-gray-400",children:["Already have an account?"," ",I.jsx(Od,{to:"/login",className:"font-bold text-gold hover:underline",children:"Login"})]})]})})},IV=()=>{const{user:n,userProfile:e,loading:t}=hc(),[r,s]=U.useState(""),[a,u]=U.useState(!1),[h,f]=U.useState(null),p=mr();U.useEffect(()=>{e?.displayName&&s(e.displayName)},[e]);const y=()=>{VT(zr),p("/")},v=async()=>{if(!n||!r.trim()){f("Display name cannot be empty.");return}f(null);try{const E=wt(He,"users",n.uid);await xa(E,{displayName:r.trim()}),u(!1)}catch{f("Failed to update display name.")}};return t?I.jsx("div",{className:"flex flex-col items-center justify-center min-h-screen bg-gray-800 text-white",children:"Loading profile..."}):n?I.jsx("div",{className:"flex flex-col items-center min-h-screen bg-gray-800 p-4 text-white",children:I.jsxs("div",{className:"w-full max-w-4xl",children:[I.jsxs("div",{className:"flex justify-between items-center mb-8",children:[I.jsx("button",{onClick:()=>p("/"),className:"bg-gray-600 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded",children:"← Back to Home"}),I.jsx("h1",{className:"text-4xl text-gold",children:"Your Profile"}),I.jsx("button",{onClick:y,className:"bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded",children:"Logout"})]}),I.jsxs("div",{className:"bg-gray-900 p-6 rounded-lg",children:[I.jsx("h2",{className:"text-2xl mb-4",children:"User Information"}),I.jsxs("div",{className:"space-y-4",children:[I.jsxs("p",{children:[I.jsx("span",{className:"font-bold",children:"Email:"})," ",n.email]}),I.jsxs("div",{children:[I.jsx("span",{className:"font-bold",children:"Display Name:"}),a?I.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[I.jsx("input",{type:"text",value:r,onChange:E=>s(E.target.value),className:"p-2 rounded bg-gray-700 text-white border border-gray-600"}),I.jsx("button",{onClick:v,className:"bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded",children:"Save"}),I.jsx("button",{onClick:()=>u(!1),className:"bg-gray-600 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded",children:"Cancel"})]}):I.jsxs("div",{className:"flex items-center gap-4",children:[I.jsx("span",{children:e?.displayName||"Not set"}),I.jsx("button",{onClick:()=>u(!0),className:"text-sm text-blue-400 hover:underline",children:"Edit"})]}),h&&I.jsx("p",{className:"text-red-500 mt-2",children:h})]})]})]}),I.jsx("div",{className:"mt-8",children:I.jsx(GS,{})})]})}):I.jsxs("div",{className:"flex flex-col items-center justify-center min-h-screen bg-gray-800 text-white",children:[I.jsx("p",{children:"You must be logged in to view this page."}),I.jsx("button",{onClick:()=>p("/login"),className:"mt-4 bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded",children:"Login"})]})},CV=()=>{const{draftId:n}=$E(),e=mr(),{user:t,userProfile:r}=hc(),[s,a]=xr.useState(null);xr.useEffect(()=>{if(!n)return;const E=go(wt(He,"drafts",n),S=>{if(S.exists()){const R=S.data();a(R),R.status!=="lobby"&&e(`/draft/${n}`)}else console.error("Draft not found!"),e("/")});return()=>E()},[n,e]);const u=async()=>{if(!n||!s)return;const{teamA:E,teamB:S}=s;let{captainA:R,captainB:N}={captainA:E.captain,captainB:S.captain};if(!R&&Object.keys(E.players).length>0&&(R=Object.keys(E.players)[0]),!N&&Object.keys(S.players).length>0&&(N=Object.keys(S.players)[0]),!R||!N){alert("Both teams must have at least one player to start the draft.");return}const O=Object.keys(E.players),V=Object.keys(S.players);if(O.length===0||V.length===0){alert("Both teams must have at least one player to start the draft.");return}const K=(D,A)=>{const k=[];for(let b=0;b<A;b++)k.push(D[b%D.length]);return k},G=K(O,5),J=K(V,5),ne=[{type:"ban",team:"teamA",uid:R},{type:"ban",team:"teamB",uid:N},{type:"ban",team:"teamA",uid:R},{type:"ban",team:"teamB",uid:N},{type:"ban",team:"teamA",uid:R},{type:"ban",team:"teamB",uid:N},{type:"pick",team:"teamA",uid:G[0]},{type:"pick",team:"teamB",uid:J[0]},{type:"pick",team:"teamB",uid:J[1]},{type:"pick",team:"teamA",uid:G[1]},{type:"pick",team:"teamA",uid:G[2]},{type:"pick",team:"teamB",uid:J[2]},{type:"pick",team:"teamB",uid:J[3]},{type:"pick",team:"teamA",uid:G[3]},{type:"pick",team:"teamA",uid:G[4]},{type:"pick",team:"teamB",uid:J[4]}],se=wt(He,"drafts",n);await xa(se,{status:"banning","teamA.captain":R,"teamB.captain":N,pickOrder:ne,currentPickIndex:0})},h=async E=>{if(!n||!t||!r)return;const S=`${E}.players.${t.uid}`;await xa(wt(He,"drafts",n),{[S]:{displayName:r.displayName,pick:null,hasPicked:!1}})},f=async E=>{if(!n||!t)return;const S=`${E}.captain`;await xa(wt(He,"drafts",n),{[S]:t.uid})},p=async E=>{if(!n||!t)return;const S=`${E}.captain`;await xa(wt(He,"drafts",n),{[S]:null})},y=async E=>{if(!n||!t||!r||!s)return;const S=E==="teamA"?"teamB":"teamA";if(Object.keys(s[S].players).length>=5){alert("The other team is full.");return}const R=u_(He),N=wt(He,"drafts",n),O={...s[E].players};delete O[t.uid];const V={[`${E}.players`]:O};s[E].captain===t.uid&&(V[`${E}.captain`]=null),V[`${S}.players.${t.uid}`]={displayName:r.displayName,pick:null,hasPicked:!1},R.update(N,V),await R.commit()};if(!s||!t||!r)return I.jsx("div",{children:"Loading Lobby..."});const v=E=>{const S=s[E],R=s.pickOrder.filter(J=>J.type==="pick"&&J.team===E).map(J=>J.uid),N=[...new Set(R)],O=N.length>0?N:Object.keys(S.players),V=Object.keys(S.players).some(J=>J===t.uid),K=t.uid in s.teamA.players||t.uid in s.teamB.players,G=S.captain===t.uid;return I.jsxs("div",{className:"w-1/2 p-4",children:[I.jsx("h2",{className:"text-2xl font-bold mb-2",children:S.name}),O.map(J=>{const ne=S.players[J];return ne?I.jsxs("div",{className:"flex items-center gap-2",children:[I.jsx("p",{children:ne.displayName}),S.captain===J&&I.jsx("span",{className:"text-yellow-400",children:"(Captain)"})]},J):null}),!K&&Object.keys(S.players).length<5&&I.jsx("button",{onClick:()=>h(E),className:"mt-2 bg-blue-600 hover:bg-blue-700 text-white font-bold py-1 px-2 rounded",children:"Join Team"}),V&&I.jsx("button",{onClick:()=>y(E),className:"mt-2 bg-purple-600 hover:bg-purple-700 text-white font-bold py-1 px-2 rounded",children:"Switch Team"}),V&&!G&&!S.captain&&I.jsx("button",{onClick:()=>f(E),className:"mt-2 bg-yellow-600 hover:bg-yellow-700 text-white font-bold py-1 px-2 rounded",children:"Become Captain"}),G&&I.jsx("button",{onClick:()=>p(E),className:"mt-2 bg-red-600 hover:bg-red-700 text-white font-bold py-1 px-2 rounded",children:"Relinquish Captain"})]})};return I.jsxs("div",{className:"flex flex-col items-center justify-center min-h-screen bg-gray-900 text-white p-4",children:[I.jsxs("h1",{className:"text-4xl font-bold mb-4",children:["Draft Lobby: ",s.draftName]}),I.jsxs("div",{className:"flex w-full max-w-4xl justify-around",children:[v("teamA"),v("teamB")]}),s.hostId===t.uid&&s.status==="lobby"&&I.jsx("button",{onClick:u,className:"mt-8 bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded",children:"Start Draft"})]})},SV=()=>{const[n,e]=U.useState("standard"),[t,r]=U.useState("ORDER"),[s,a]=U.useState("CHAOS");return I.jsx(M_,{children:I.jsx(V_,{mode:n,teamAName:t,teamBName:s,teamAColor:"#1abc9c",teamBColor:"#ff6666",children:I.jsx(HS,{teamAName:t,onTeamANameChange:r,teamBName:s,onTeamBNameChange:a,teamAColor:"#1abc9c",teamBColor:"#ff6666",mode:n,setMode:e})})})},AV=()=>{const{draftId:n}=$E(),[e,t]=U.useState(null),{user:r}=hc(),s=mr();if(U.useEffect(()=>{if(!n||!r)return;const p=wt(He,"drafts",n),y=go(p,v=>{if(v.exists()){const E=v.data();E.status==="lobby"?s(`/lobby/${n}`):t(E)}else console.error("Draft not found!"),s("/")});return()=>y()},[n,s,r]),!e||!r)return I.jsx("div",{className:"flex items-center justify-center h-screen bg-gray-800 text-white",children:"Loading Online Draft..."});const a=e.teamA?.name||"Team A",u=e.teamB?.name||"Team B",h="#1abc9c",f="#ff6666";return I.jsx(M_,{children:I.jsx(V_,{mode:"standard",initialState:e,draftId:n,currentUser:r,teamAName:a,teamBName:u,teamAColor:h,teamBColor:f,children:I.jsx(HS,{teamAName:a,onTeamANameChange:()=>{},teamBName:u,onTeamBNameChange:()=>{},teamAColor:h,teamBColor:f,mode:"standard",setMode:()=>{}})})})};function kV(){return I.jsx(BM,{children:I.jsxs(Zk,{children:[I.jsx(ai,{path:"/",element:I.jsx(gV,{})}),I.jsx(ai,{path:"/local",element:I.jsx(SV,{})}),I.jsx(ai,{path:"/draft/:draftId",element:I.jsx(AV,{})}),I.jsx(ai,{path:"/lobby/:draftId",element:I.jsx(CV,{})}),I.jsx(ai,{path:"/login",element:I.jsx(EV,{})}),I.jsx(ai,{path:"/signup",element:I.jsx(TV,{})}),I.jsx(ai,{path:"/profile",element:I.jsx(IV,{})}),I.jsx(ai,{path:"/final-teams",element:I.jsx(wV,{})})]})})}const RV=lk.createRoot(document.getElementById("root")),xV=()=>{const[n,e,t]=zd(zr);return e?I.jsx("div",{className:"flex items-center justify-center h-screen bg-gray-900 text-white",children:"Authenticating..."}):t?I.jsx("div",{className:"flex items-center justify-center h-screen bg-gray-900 text-white",children:I.jsxs("p",{children:["Authentication Error: ",t.message]})}):I.jsx(kV,{})};RV.render(I.jsx(xr.StrictMode,{children:I.jsx(IR,{children:I.jsx(xV,{})})}));
